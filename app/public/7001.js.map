{"version":3,"file":"7001.js","mappings":"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","sources":["webpack://camunda-modeler-client/./src/app/tabs/dmn/modeler/DmnModeler.js","webpack://camunda-modeler-client/./src/app/tabs/dmn/DmnEditor.js","webpack://camunda-modeler-client/./src/app/tabs/dmn/DmnTab.js"],"sourcesContent":["/**\r\n * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH\r\n * under one or more contributor license agreements. See the NOTICE file\r\n * distributed with this work for additional information regarding copyright\r\n * ownership.\r\n *\r\n * Camunda licenses this file to you under the MIT; you may not use this file\r\n * except in compliance with the MIT License.\r\n */\r\n\r\nimport { CamundaPlatformModeler as DmnModeler } from 'camunda-dmn-js';\r\nimport DrdViewer from './DrdViewer';\r\n\r\nimport addExporter from '@bpmn-io/add-exporter/add-exporter';\r\n\r\nimport completeDirectEditingModule from '../../bpmn/modeler/features/complete-direct-editing';\r\n\r\nimport propertiesPanelKeyboardBindingsModule from '../../bpmn/modeler/features/properties-panel-keyboard-bindings';\r\n\r\nimport Flags, {\r\n  DISABLE_ADJUST_ORIGIN,\r\n} from '../../../../util/Flags';\r\n\r\nimport openDrgElementModule from './features/overview/open-drg-element';\r\nimport overviewRendererModule from './features/overview/overview-renderer';\r\n\r\nimport executionPlatformModule from '@camunda/execution-platform';\r\nimport modelerModdle from 'modeler-moddle/resources/dmn-modeler.json';\r\n\r\nimport { DmnImprovedCanvasModule } from '@camunda/improved-canvas';\r\n\r\nconst NOOP_MODULE = [ 'value', null ];\r\n\r\nconst poweredByModule = {\r\n  poweredBy: NOOP_MODULE\r\n};\r\n\r\nconst OVERVIEW_ZOOM_SCALE = 0.66;\r\n\r\nconst LOW_PRIORITY = 500,\r\n      HIGH_PRIORITY = 2500;\r\n\r\n\r\nexport default class CamundaDmnModeler extends DmnModeler {\r\n\r\n  constructor(options = {}) {\r\n\r\n    const {\r\n      moddleExtensions = {},\r\n      drd,\r\n      decisionTable,\r\n      literalExpression,\r\n      exporter,\r\n      overview,\r\n      settings,\r\n      ...otherOptions\r\n    } = options;\r\n\r\n    let additionalModules = [];\r\n\r\n    if (settings.get('app.newContextPad')) {\r\n      additionalModules = [\r\n        ...additionalModules,\r\n        DmnImprovedCanvasModule\r\n      ];\r\n    }\r\n\r\n    super({\r\n      ...otherOptions,\r\n      boxedExpression: mergeModules(otherOptions.boxedExpression, [\r\n        poweredByModule,\r\n        executionPlatformModule,\r\n        {\r\n          viewDrd: NOOP_MODULE\r\n        }\r\n      ]),\r\n      drd: mergeModules({\r\n        ...drd,\r\n        disableAdjustOrigin: Flags.get(DISABLE_ADJUST_ORIGIN),\r\n      }, [\r\n        propertiesPanelKeyboardBindingsModule,\r\n        executionPlatformModule,\r\n        ...additionalModules\r\n      ]),\r\n      decisionTable: mergeModules(decisionTable, [\r\n        poweredByModule,\r\n        executionPlatformModule,\r\n        {\r\n          viewDrd: NOOP_MODULE\r\n        }\r\n      ]),\r\n      literalExpression: mergeModules(literalExpression, [\r\n        poweredByModule,\r\n        executionPlatformModule,\r\n        {\r\n          viewDrd: NOOP_MODULE\r\n        }\r\n      ]),\r\n      moddleExtensions: {\r\n        ...moddleExtensions,\r\n        modeler: modelerModdle\r\n      },\r\n      canvas: {\r\n        autoFocus: true\r\n      }\r\n    });\r\n\r\n    this.on('viewer.created', ({ viewer }) => {\r\n\r\n      viewer.on('commandStack.changed', event => {\r\n        this._emit('view.contentChanged', event);\r\n      });\r\n\r\n      viewer.on('selection.changed', event => {\r\n        this._emit('view.selectionChanged', event);\r\n      });\r\n\r\n      viewer.on([ 'directEditing.activate', 'directEditing.deactivate' ], event => {\r\n        this._emit('view.directEditingChanged', event);\r\n      });\r\n\r\n      viewer.on('error', ({ error }) => {\r\n        this._emit('error', {\r\n          viewer,\r\n          error\r\n        });\r\n      });\r\n\r\n      viewer.on('propertiesPanel.focusin', event => {\r\n        this._emit('propertiesPanel.focusin', event);\r\n      });\r\n\r\n      viewer.on('propertiesPanel.focusout', event => {\r\n        this._emit('propertiesPanel.focusout', event);\r\n      });\r\n\r\n    });\r\n\r\n    addExporter(exporter, this);\r\n\r\n    this._addOverview(overview);\r\n  }\r\n\r\n  showOverview(xml) {\r\n    return this._overview.importXML(xml).then(\r\n      () => {}, err => err\r\n    ).then(err => this._handleOverviewImport(err));\r\n  }\r\n\r\n  /**\r\n   * Get stack index of active viewer.\r\n   *\r\n   * @returns {?number} Stack index or null.\r\n   */\r\n  getStackIdx() {\r\n    const viewer = this.getActiveViewer();\r\n\r\n    if (!viewer) {\r\n      return null;\r\n    }\r\n\r\n    const commandStack = viewer.get('commandStack', false);\r\n\r\n    if (!commandStack) {\r\n      return null;\r\n    }\r\n\r\n    return commandStack._stackIdx;\r\n  }\r\n\r\n  _addOverview(options = {}) {\r\n    const { layout } = options;\r\n\r\n    const overview = this._overview = new DrdViewer({\r\n      drd: {\r\n        additionalModules: [\r\n          openDrgElementModule,\r\n          overviewRendererModule\r\n        ],\r\n        openDrgElement: {\r\n          layout\r\n        }\r\n      }\r\n    });\r\n\r\n    // (1) import overview initially\r\n    this.on('import.parse.start', ({ xml }) => {\r\n      this.showOverview(xml);\r\n    });\r\n\r\n    // keep track of view type\r\n    let previousActiveViewType;\r\n\r\n    this.on('views.changed', LOW_PRIORITY, ({ activeView }) => {\r\n      previousActiveViewType = activeView.type;\r\n    });\r\n\r\n    // (2) update overview on changes in modeler\r\n    let offCommandStackChanged;\r\n\r\n    this.on('views.changed', ({ activeView }) => {\r\n      if (previousActiveViewType === activeView.type) {\r\n        return;\r\n      }\r\n\r\n      // (2.1) remove previous listener\r\n      if (offCommandStackChanged) {\r\n        offCommandStackChanged();\r\n      }\r\n\r\n      const handleCommandStackChanged = () => {\r\n\r\n        // (2.3) stop listening until save XML done\r\n        offCommandStackChanged();\r\n\r\n        // (2.4) start listening again when save XML done\r\n        this.once('saveXML.done', onCommandStackChanged);\r\n\r\n        this._updateOverview();\r\n      };\r\n\r\n      const viewer = this._viewers[ activeView.type ];\r\n\r\n      const eventBus = viewer.get('eventBus', false);\r\n\r\n      const onCommandStackChanged = () => {\r\n        eventBus.on('commandStack.changed', handleCommandStackChanged);\r\n      };\r\n\r\n      offCommandStackChanged = () => {\r\n        eventBus.off('commandStack.changed', handleCommandStackChanged);\r\n      };\r\n\r\n      // (2.2) add new listener\r\n      onCommandStackChanged();\r\n    });\r\n\r\n    // (3) highlight current open DRG element on views changed\r\n    this.on('views.changed', ({ activeView }) => {\r\n      if (activeView.type !== 'drd') {\r\n        const activeViewer = overview.getActiveViewer();\r\n\r\n        if (activeViewer) {\r\n          activeViewer.get('eventBus').fire('drgElementOpened', {\r\n            id: activeView.element.id\r\n          });\r\n        }\r\n      }\r\n    });\r\n\r\n    // (4) propagate layout changes\r\n    this.on('overviewOpen', () => {\r\n      const activeViewer = this._overview.getActiveViewer();\r\n\r\n      if (activeViewer) {\r\n        activeViewer.get('eventBus').fire('overviewOpen');\r\n      }\r\n    });\r\n\r\n    overview.once('import.done', () => {\r\n      const activeViewer = overview.getActiveViewer();\r\n\r\n      if (!activeViewer) {\r\n        return;\r\n      }\r\n\r\n      // (5) open DRG element on click\r\n      activeViewer.on('openDrgElement', ({ id }) => {\r\n        const view = this.getViews().find(({ element }) => {\r\n          return element.id === id;\r\n        });\r\n\r\n        if (view && view.type !== 'drd') {\r\n          this.open(view);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  _updateOverview = () => {\r\n    if (!this._overview) {\r\n      return;\r\n    }\r\n\r\n    // Prevent others from hooking in when updating overview\r\n    this.once('saveXML.start', HIGH_PRIORITY, () => false);\r\n\r\n    return this.saveXML().then(\r\n      ({ xml }) => this.showOverview(xml)\r\n    ).catch(err => {\r\n      console.error(err);\r\n    });\r\n  };\r\n\r\n  _handleOverviewImport = err => {\r\n    if (!this._overview || !this._overview.getActiveViewer()) {\r\n      return;\r\n    }\r\n\r\n    if (err) {\r\n      console.error(err);\r\n    } else {\r\n      this._overview.getActiveViewer().get('canvas').zoom(OVERVIEW_ZOOM_SCALE);\r\n    }\r\n  };\r\n\r\n  attachOverviewTo = (parentNode) => {\r\n    this.detachOverview();\r\n\r\n    const activeViewer = this._overview.getActiveViewer();\r\n\r\n    if (!activeViewer) {\r\n      return;\r\n    }\r\n\r\n    this._emit('attachOverview');\r\n\r\n    this._overview.attachTo(parentNode);\r\n\r\n    activeViewer.get('canvas').resized();\r\n  };\r\n\r\n  detachOverview = () => {\r\n    const activeViewer = this._overview.getActiveViewer();\r\n\r\n    if (!activeViewer) {\r\n      return;\r\n    }\r\n\r\n    this._emit('detachOverview');\r\n\r\n    this._overview.detach();\r\n  };\r\n}\r\n\r\n\r\n// helpers ///////////////////////\r\n\r\nfunction mergeModules(editorConfig = {}, additionalModules) {\r\n\r\n  const editorModules = editorConfig.additionalModules || [];\r\n\r\n  return {\r\n    ...editorConfig,\r\n    additionalModules: [\r\n      completeDirectEditingModule,\r\n      ...editorModules,\r\n      ...additionalModules\r\n    ]\r\n  };\r\n}\r\n","/**\r\n * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH\r\n * under one or more contributor license agreements. See the NOTICE file\r\n * distributed with this work for additional information regarding copyright\r\n * ownership.\r\n *\r\n * Camunda licenses this file to you under the MIT; you may not use this file\r\n * except in compliance with the MIT License.\r\n */\r\n\r\nimport React from 'react';\r\n\r\nimport {\r\n  assign,\r\n  isFunction\r\n} from 'min-dash';\r\n\r\nimport classNames from 'classnames';\r\n\r\nimport {\r\n  Loader\r\n} from '../../primitives';\r\n\r\nimport {\r\n  debounce\r\n} from '../../../util';\r\n\r\nimport configureModeler from './util/configure';\r\n\r\nimport {\r\n  WithCache,\r\n  WithCachedState,\r\n  CachedComponent\r\n} from '../../cached';\r\n\r\nimport OverviewContainer from './OverviewContainer';\r\n\r\nimport PropertiesPanelContainer, { DEFAULT_LAYOUT as PROPERTIES_PANEL_DEFAULT_LAYOUT } from '../../resizable-container/PropertiesPanelContainer';\r\n\r\nimport CamundaDmnModeler from './modeler';\r\n\r\nimport { active as isInputActive } from '../../../util/dom/isInput';\r\n\r\nimport {\r\n  getDmnBoxedExpressionEditMenu,\r\n  getDmnDrdEditMenu,\r\n  getDmnDecisionTableEditMenu,\r\n  getDmnLiteralExpressionEditMenu\r\n} from './getDmnEditMenu';\r\n\r\nimport getDmnWindowMenu from './getDmnWindowMenu';\r\n\r\nimport * as css from './DmnEditor.less';\r\n\r\nimport generateImage from '../../util/generateImage';\r\n\r\nimport Metadata from '../../../util/Metadata';\r\n\r\nimport { findUsages as findNamespaceUsages } from '../util/namespace';\r\n\r\nimport { migrateDiagram } from '@bpmn-io/dmn-migrate';\r\n\r\nimport { DEFAULT_LAYOUT as overviewDefaultLayout } from './OverviewContainer';\r\n\r\nimport { EngineProfile, toSemver } from '../EngineProfile';\r\n\r\nimport EngineProfileHelper from '../EngineProfileHelper';\r\n\r\nimport { ENGINES } from '../../../util/Engines';\r\n\r\nconst EXPORT_AS = [ 'png', 'jpeg', 'svg' ];\r\n\r\nconst NAMESPACE_URL_DMN11 = 'http://www.omg.org/spec/DMN/20151101/dmn.xsd',\r\n      NAMESPACE_URL_DMN12 = 'http://www.omg.org/spec/DMN/20180521/MODEL/';\r\n\r\nconst CONFIG_KEY = 'editor.askDmnMigration';\r\n\r\nexport const DEFAULT_ENGINE_PROFILE = {\r\n  executionPlatform: ENGINES.PLATFORM,\r\n  executionPlatformVersion: undefined\r\n};\r\n\r\n\r\nexport class DmnEditor extends CachedComponent {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = { };\r\n\r\n    this.ref = React.createRef();\r\n    this.overviewRef = React.createRef();\r\n    this.propertiesPanelRef = React.createRef();\r\n\r\n    this.handleResize = debounce(this.handleResize);\r\n\r\n    this.engineProfile = new EngineProfileHelper({\r\n      get: () => {\r\n        const modeler = this.getModeler();\r\n        const activeViewer = modeler.getActiveViewer();\r\n        const executionPlatformHelper = activeViewer.get('executionPlatform');\r\n        const executionPlatform = executionPlatformHelper.getExecutionPlatform();\r\n\r\n        if (!executionPlatform) {\r\n          return DEFAULT_ENGINE_PROFILE;\r\n        }\r\n\r\n        return {\r\n          executionPlatform: executionPlatform.name,\r\n          executionPlatformVersion: toSemver(executionPlatform.version)\r\n        };\r\n      },\r\n      set: engineProfile => {\r\n        const modeler = this.getModeler();\r\n        const executionPlatformHelper = modeler.getActiveViewer().get('executionPlatform');\r\n\r\n        executionPlatformHelper.setExecutionPlatform({\r\n          name: engineProfile.executionPlatform,\r\n          version: engineProfile.executionPlatformVersion\r\n        });\r\n      },\r\n      getCached: () => this.getCached(),\r\n      setCached: (state) => this.setCached(state)\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    this._isMounted = true;\r\n\r\n    const modeler = this.getModeler();\r\n\r\n    this.listen('on');\r\n\r\n    modeler.attachTo(this.ref.current);\r\n\r\n    const activeViewer = modeler.getActiveViewer();\r\n\r\n    let propertiesPanel;\r\n\r\n    if (activeViewer) {\r\n      propertiesPanel = activeViewer.get('propertiesPanel', false);\r\n\r\n      if (propertiesPanel) {\r\n        propertiesPanel.attachTo(this.propertiesPanelRef.current);\r\n      }\r\n\r\n      // attach overview\r\n      if (this.overviewRef.current) {\r\n        modeler.attachOverviewTo(this.overviewRef.current);\r\n\r\n        if (isOverviewOpen(this.props)) {\r\n          modeler._emit('overviewOpen');\r\n        }\r\n      }\r\n    }\r\n\r\n    // grid may not be available, depending on the editor\r\n    activeViewer && activeViewer.get('grid', false)?.toggle(this.props.layout?.grid?.visible !== false);\r\n\r\n    this.checkImport();\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this._isMounted = false;\r\n\r\n    const modeler = this.getModeler();\r\n\r\n    this.listen('off');\r\n\r\n    modeler.detach();\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    this.checkImport(prevProps);\r\n\r\n    // We can only notify interested parties about overview open once its parent component was\r\n    // rendered\r\n    if (isOverviewOpened(prevProps, this.props)) {\r\n      const modeler = this.getModeler();\r\n\r\n      modeler._emit('overviewOpen');\r\n    }\r\n\r\n    if (isGridLayoutChange(prevProps, this.props)) {\r\n      const activeViewer = this.getModeler().getActiveViewer();\r\n\r\n      // grid may not be available, depending on the editor\r\n      activeViewer.get('grid', false)?.toggle(this.props.layout?.grid?.visible !== false);\r\n    }\r\n\r\n    if (isCachedStateChange(prevProps, this.props)) {\r\n      this.handleChanged();\r\n    }\r\n  }\r\n\r\n  ifMounted = (fn) => {\r\n    return (...args) => {\r\n      if (this._isMounted) {\r\n        fn(...args);\r\n      }\r\n    };\r\n  };\r\n\r\n  listen(fn) {\r\n    const modeler = this.getModeler();\r\n\r\n    [\r\n      'saveXML.done',\r\n      'attach',\r\n      'view.selectionChanged',\r\n      'view.directEditingChanged',\r\n      'propertiesPanel.focusin',\r\n      'propertiesPanel.focusout'\r\n    ].forEach((event) => {\r\n      modeler[fn](event, this.handleChanged);\r\n    });\r\n\r\n    modeler[fn]('views.changed', this.viewsChanged);\r\n\r\n    modeler[fn]('view.contentChanged', this.viewContentChanged);\r\n\r\n    modeler[fn]('error', this.handleError);\r\n  }\r\n\r\n  isDirty = () => {\r\n    let {\r\n      dirty,\r\n      modeler,\r\n      stackIdx\r\n    } = this.getCached();\r\n\r\n    return dirty || modeler.getStackIdx() !== stackIdx;\r\n  };\r\n\r\n  viewContentChanged = () => {\r\n    this.handleChanged();\r\n  };\r\n\r\n  handleImport(error, warnings) {\r\n    const {\r\n      activeSheet,\r\n      onImport,\r\n      xml\r\n    } = this.props;\r\n\r\n    const modeler = this.getModeler();\r\n\r\n    const stackIdx = modeler.getStackIdx();\r\n\r\n    let engineProfile = null;\r\n\r\n    if (!error) {\r\n      try {\r\n        engineProfile = this.engineProfile.get();\r\n      } catch (err) {\r\n        error = err;\r\n      }\r\n    }\r\n\r\n    onImport(error, warnings);\r\n\r\n    if (error) {\r\n      this.setCached({\r\n        dirty: false,\r\n        engineProfile,\r\n        lastXML: null\r\n      });\r\n    } else {\r\n      this.setCached({\r\n        dirty: false,\r\n        engineProfile,\r\n        lastXML: xml,\r\n        stackIdx\r\n      });\r\n\r\n      this.setState({\r\n        importing: false\r\n      });\r\n\r\n      if (activeSheet && activeSheet.element) {\r\n        return this.open(activeSheet.element);\r\n      }\r\n\r\n      const initialView = modeler._getInitialView(modeler._views);\r\n\r\n      this.open(initialView.element);\r\n    }\r\n\r\n  }\r\n\r\n  viewsChanged = ({ activeView }) => {\r\n    const {\r\n      activeSheet: previousActiveSheet,\r\n      onSheetsChanged\r\n    } = this.props;\r\n\r\n    const {\r\n      dirty,\r\n      stackIdx\r\n    } = this.getCached();\r\n\r\n    const previousActiveView = this.getCached().activeView;\r\n\r\n    const modeler = this.getModeler();\r\n\r\n    const { element } = activeView;\r\n\r\n    const activeSheet = {\r\n      ...activeView,\r\n      id: element.id,\r\n      name: 'Diagram',\r\n      order: -1\r\n    };\r\n\r\n    if (previousActiveSheet.id !== activeSheet.id) {\r\n      onSheetsChanged([ activeSheet ], activeSheet);\r\n    }\r\n\r\n    const activeViewer = modeler.getActiveViewer();\r\n\r\n    let propertiesPanel;\r\n\r\n    // only attach properties panel if view is switched\r\n    if (activeViewer &&\r\n      (!previousActiveView || previousActiveView.element !== activeView.element)) {\r\n      propertiesPanel = activeViewer.get('propertiesPanel', false);\r\n\r\n      if (propertiesPanel) {\r\n        propertiesPanel.attachTo(this.propertiesPanelRef.current);\r\n      }\r\n    }\r\n\r\n    // grid may not be available, depending on the editor\r\n    activeViewer && activeViewer.get('grid', false)?.toggle(this.props.layout?.grid?.visible !== false);\r\n\r\n    // attach or detach overview\r\n    if (activeView.type === 'drd') {\r\n      modeler.detachOverview();\r\n    } else if (previousActiveView && previousActiveView.type === 'drd') {\r\n      modeler.attachOverviewTo(this.overviewRef.current);\r\n\r\n      if (isOverviewOpen(this.props)) {\r\n        modeler._emit('overviewOpen');\r\n      }\r\n    }\r\n\r\n    // must be called last\r\n    this.setCached({\r\n      activeView,\r\n      dirty: dirty || modeler.getStackIdx() !== stackIdx\r\n    });\r\n\r\n    this.handleChanged();\r\n  };\r\n\r\n  undo = () => {\r\n    const modeler = this.getModeler();\r\n\r\n    modeler.getActiveViewer().get('commandStack').undo();\r\n  };\r\n\r\n  redo = () => {\r\n    const modeler = this.getModeler();\r\n\r\n    modeler.getActiveViewer().get('commandStack').redo();\r\n  };\r\n\r\n  handleChanged = () => {\r\n    const modeler = this.getModeler();\r\n\r\n    const {\r\n      onChanged\r\n    } = this.props;\r\n\r\n    const activeViewer = modeler.getActiveViewer(),\r\n          activeView = modeler.getActiveView();\r\n\r\n    if (!activeViewer) {\r\n      return;\r\n    }\r\n\r\n    const dirty = this.isDirty();\r\n\r\n    const commandStack = activeViewer.get('commandStack');\r\n\r\n    const hasPropertiesPanel = !!activeViewer.get('propertiesPanel', false);\r\n    const hasGrid = !!activeViewer.get('grid', false);\r\n\r\n    const hasOverview = activeView.type !== 'drd';\r\n\r\n    const inputActive = isInputActive();\r\n\r\n    const newState = {\r\n      close: true,\r\n      copy: false,\r\n      cut: false,\r\n      dirty,\r\n      exportAs: 'saveSVG' in activeViewer ? EXPORT_AS : false,\r\n      inputActive,\r\n      overview: hasOverview,\r\n      paste: false,\r\n      grid: hasGrid,\r\n      platform: 'platform',\r\n      propertiesPanel: hasPropertiesPanel,\r\n      redo: commandStack.canRedo(),\r\n      save: true,\r\n      undo: commandStack.canUndo()\r\n    };\r\n\r\n    const selection = activeViewer.get('selection', false);\r\n\r\n    const hasSelection = selection && !!selection.get();\r\n\r\n    const selectionLength = hasSelection ? selection.get().length : 0;\r\n\r\n    let editMenu;\r\n\r\n    if (activeView.type === 'drd') {\r\n\r\n      const canvasFocused = activeViewer.get('canvas').isFocused();\r\n\r\n      assign(newState, {\r\n        align: selectionLength > 1,\r\n        canvasFocused,\r\n        defaultCopyCutPaste: !canvasFocused,\r\n        defaultUndoRedo: !canvasFocused,\r\n        distribute: selectionLength > 2,\r\n        editLabel: canvasFocused && !!selectionLength,\r\n        find: canvasFocused,\r\n        lassoTool: canvasFocused,\r\n        moveCanvas: canvasFocused,\r\n        moveSelection: canvasFocused && !!selectionLength,\r\n        removeSelected: !canvasFocused || !!selectionLength,\r\n        selectAll: canvasFocused || inputActive,\r\n        zoom: true\r\n      });\r\n\r\n      editMenu = getDmnDrdEditMenu(newState);\r\n    } else if (activeView.type === 'decisionTable') {\r\n      assign(newState, {\r\n        defaultCopyCutPaste: true,\r\n        defaultUndoRedo: false,\r\n        hasSelection: activeViewer.get('selection').hasSelection(),\r\n        removeSelected: inputActive,\r\n        selectAll: inputActive\r\n      });\r\n\r\n      // ensure backwards compatibility\r\n      // https://github.com/camunda/camunda-modeler/commit/78357e3ed9e6e0255ac8225fbdf451a90457e8bf#diff-bd5be70c4e5eadf1a316c16085a72f0fL17\r\n      newState.dmnRuleEditing = !!selectionLength;\r\n      newState.dmnClauseEditing = !!selectionLength;\r\n\r\n      editMenu = getDmnDecisionTableEditMenu(newState);\r\n    } else if (activeView.type === 'literalExpression') {\r\n      assign(newState, {\r\n        defaultCopyCutPaste: true,\r\n        defaultUndoRedo: true,\r\n        removeSelected: true,\r\n        selectAll: true\r\n      });\r\n\r\n      // The literalExpressions editor does not fire events when\r\n      // elements are selected, so we always set inputActive to true.\r\n      // cf. https://github.com/camunda/camunda-modeler/pull/2394\r\n      newState.inputActive = true;\r\n\r\n      editMenu = getDmnLiteralExpressionEditMenu(newState);\r\n    } else if (activeView.type === 'boxedExpression') {\r\n\r\n      // TODO(@barmac): handle boxed expression differently than literal expression when needed\r\n      assign(newState, {\r\n        defaultCopyCutPaste: true,\r\n        defaultUndoRedo: true,\r\n        removeSelected: true,\r\n        selectAll: true\r\n      });\r\n\r\n      // The boxedExpression editor does not fire events when\r\n      // elements are selected, so we always set inputActive to true.\r\n      // cf. https://github.com/camunda/camunda-modeler/pull/2394\r\n      newState.inputActive = true;\r\n\r\n      editMenu = getDmnBoxedExpressionEditMenu(newState);\r\n    }\r\n\r\n    // ensure backwards compatibility\r\n    // https://github.com/camunda/camunda-modeler/commit/78357e3ed9e6e0255ac8225fbdf451a90457e8bf#diff-bd5be70c4e5eadf1a316c16085a72f0fL17\r\n    newState.activeEditor = activeView.type;\r\n    newState.dmn = true;\r\n    newState.editable = true;\r\n    newState.elementsSelected = !!selectionLength;\r\n    newState.inactiveInput = !inputActive;\r\n\r\n    const windowMenu = getDmnWindowMenu(newState);\r\n\r\n    if (typeof onChanged === 'function') {\r\n      onChanged({\r\n        ...newState,\r\n        editMenu,\r\n        windowMenu\r\n      });\r\n    }\r\n\r\n\r\n    const engineProfile = this.engineProfile.get();\r\n    this.engineProfile.setCached(engineProfile);\r\n\r\n    this.setState(newState);\r\n  };\r\n\r\n  handleError = (event) => {\r\n    const {\r\n      error\r\n    } = event;\r\n\r\n    const {\r\n      onError\r\n    } = this.props;\r\n\r\n    onError(error);\r\n  };\r\n\r\n  handleDistributeElements = (type) => {\r\n    this.triggerAction('distributeElements', {\r\n      type\r\n    });\r\n  };\r\n\r\n  handleAlignElements = (type) => {\r\n    this.triggerAction('alignElements', {\r\n      type\r\n    });\r\n  };\r\n\r\n  checkImport(prevProps) {\r\n    if (!this.isImportNeeded(prevProps)) {\r\n      return this.checkSheetChange(prevProps);\r\n    }\r\n\r\n    const { xml } = this.props;\r\n\r\n    this.importXML(xml);\r\n  }\r\n\r\n  isImportNeeded(prevProps) {\r\n    const {\r\n      importing\r\n    } = this.state;\r\n\r\n    if (importing) {\r\n      return false;\r\n    }\r\n\r\n    const {\r\n      xml\r\n    } = this.props;\r\n\r\n    if (prevProps && prevProps.xml === xml) {\r\n      return false;\r\n    }\r\n\r\n    const {\r\n      lastXML\r\n    } = this.getCached();\r\n\r\n    return xml !== lastXML;\r\n  }\r\n\r\n  async importXML(xml) {\r\n    const {\r\n      modeler\r\n    } = this.getCached();\r\n\r\n    this.setState({\r\n      importing: true\r\n    });\r\n\r\n    const importedXML = await this.handleMigration(xml);\r\n\r\n    if (!importedXML) {\r\n      this.props.onAction('close-tab');\r\n\r\n      return;\r\n    }\r\n\r\n    return modeler.importXML(importedXML).then(\r\n      this.ifMounted(({ warnings }) => this.handleImport(null, warnings)),\r\n      this.ifMounted((error) => this.handleImport(error, error.warnings))\r\n    );\r\n  }\r\n\r\n  handleMigration = async (xml) => {\r\n    const used = findNamespaceUsages(xml, NAMESPACE_URL_DMN11) ||\r\n      findNamespaceUsages(xml, NAMESPACE_URL_DMN12);\r\n\r\n    if (!used) {\r\n      return xml;\r\n    }\r\n\r\n    const askDmnMigration = await this.props.getConfig(CONFIG_KEY);\r\n\r\n    if (askDmnMigration !== false) {\r\n      const shouldMigrate = await this.shouldMigrate();\r\n\r\n      if (!shouldMigrate) {\r\n        return null;\r\n      }\r\n    }\r\n\r\n    const {\r\n      onContentUpdated\r\n    } = this.props;\r\n\r\n    let migratedXML;\r\n\r\n    try {\r\n      migratedXML = await migrateDiagram(xml);\r\n    } catch (err) {\r\n      this.handleError({\r\n        error: err\r\n      });\r\n\r\n      return null;\r\n    }\r\n\r\n    onContentUpdated(migratedXML);\r\n\r\n    return migratedXML;\r\n  };\r\n\r\n  async shouldMigrate() {\r\n    const { onAction } = this.props;\r\n\r\n    const { button, checkboxChecked } = await onAction('show-dialog', getMigrationDialog());\r\n\r\n    if (button === 'yes' && checkboxChecked) {\r\n      this.props.setConfig(CONFIG_KEY, false);\r\n    }\r\n\r\n    return button === 'yes';\r\n  }\r\n\r\n  checkSheetChange(prevProps) {\r\n    if (!this.shouldOpenActiveSheet(prevProps)) {\r\n      return;\r\n    }\r\n\r\n    this.open(this.props.activeSheet.element);\r\n  }\r\n\r\n  shouldOpenActiveSheet(prevProps) {\r\n    return !prevProps || prevProps.activeSheet.id !== this.props.activeSheet.id;\r\n  }\r\n\r\n  open = (element) => {\r\n    const {\r\n      activeView,\r\n      dirty,\r\n      modeler,\r\n      stackIdx\r\n    } = this.getCached();\r\n\r\n    let view = modeler.getView(element);\r\n\r\n    if (!view) {\r\n\r\n      // try to find view based on ID\r\n      // after re-import reference comparison won't work anymore\r\n      view = modeler.getViews().find(view => view.element.id === element.id);\r\n    }\r\n\r\n    if (!view) {\r\n      return;\r\n    }\r\n\r\n    if (!activeView || activeView.element !== element) {\r\n\r\n      // dirty must be cached before switching active view\r\n      // if active view has unsaved changes editor must still be dirty after switching active view\r\n      this.setCached({\r\n        dirty: dirty || this.getModeler().getStackIdx() !== stackIdx\r\n      });\r\n\r\n      modeler.open(view);\r\n\r\n      this.setCached({\r\n        stackIdx: this.getModeler().getStackIdx()\r\n      });\r\n    }\r\n  };\r\n\r\n  triggerAction = (action, context) => {\r\n    const {\r\n      layout = {},\r\n      onLayoutChanged: handleLayoutChange\r\n    } = this.props;\r\n\r\n    const {\r\n      propertiesPanel: propertiesPanelLayout = {}\r\n    } = layout;\r\n\r\n    const modeler = this.getModeler();\r\n\r\n    if (action === 'resize') {\r\n      return this.handleResize();\r\n    }\r\n\r\n    if (action === 'toggleGrid') {\r\n      const newLayout = {\r\n        grid: {\r\n          visible: layout.grid?.visible === false\r\n        }\r\n      };\r\n\r\n      return handleLayoutChange(newLayout);\r\n    }\r\n\r\n    if (action === 'toggleProperties') {\r\n      const newLayout = {\r\n        propertiesPanel: {\r\n          ...PROPERTIES_PANEL_DEFAULT_LAYOUT,\r\n          ...propertiesPanelLayout,\r\n          open: !propertiesPanelLayout.open\r\n        }\r\n      };\r\n\r\n      return handleLayoutChange(newLayout);\r\n    }\r\n\r\n    if (action === 'zoomIn') {\r\n      action = 'stepZoom';\r\n\r\n      context = {\r\n        value: 1\r\n      };\r\n    }\r\n\r\n    if (action === 'zoomOut') {\r\n      action = 'stepZoom';\r\n\r\n      context = {\r\n        value: -1\r\n      };\r\n    }\r\n\r\n    if (action === 'resetZoom') {\r\n      action = 'zoom';\r\n\r\n      context = {\r\n        value: 1\r\n      };\r\n    }\r\n\r\n    if (action === 'zoomFit') {\r\n      action = 'zoom';\r\n\r\n      context = {\r\n        value: 'fit-viewport'\r\n      };\r\n    }\r\n\r\n    if (action === 'toggleOverview') {\r\n      return this.toggleOverview();\r\n    } else if (action === 'resetOverview') {\r\n      return this.resetOverview();\r\n    }\r\n\r\n    return modeler.getActiveViewer()\r\n      .get('editorActions')\r\n      .trigger(action, context);\r\n  };\r\n\r\n  /**\r\n   * @returns {CamundaDmnModeler}\r\n   */\r\n  getModeler() {\r\n    const {\r\n      modeler\r\n    } = this.getCached();\r\n\r\n    return modeler;\r\n  }\r\n\r\n  handleResize = () => {\r\n    const {\r\n      modeler\r\n    } = this.getCached();\r\n\r\n    const view = modeler.getActiveView();\r\n\r\n    const viewType = view && view.type;\r\n\r\n    if (viewType !== 'drd') {\r\n      return;\r\n    }\r\n\r\n    const viewer = modeler.getActiveViewer();\r\n\r\n    const canvas = viewer.get('canvas');\r\n    const eventBus = viewer.get('eventBus');\r\n\r\n    canvas.resized();\r\n    eventBus.fire('propertiesPanel.resized');\r\n  };\r\n\r\n  async getXML() {\r\n    const {\r\n      lastXML,\r\n      modeler\r\n    } = this.getCached();\r\n\r\n    if (!this.isDirty()) {\r\n      return lastXML || this.props.xml;\r\n    }\r\n\r\n    try {\r\n      const { xml } = await modeler.saveXML({ format: true });\r\n\r\n      const stackIdx = modeler.getStackIdx();\r\n\r\n      this.setCached({\r\n        dirty: false,\r\n        lastXML: xml,\r\n        stackIdx\r\n      });\r\n\r\n      return xml;\r\n    } catch (error) {\r\n      this.handleError({ error });\r\n\r\n      return Promise.reject(error);\r\n    }\r\n  }\r\n\r\n  async exportAs(type) {\r\n    let svg;\r\n\r\n    try {\r\n      svg = await this.exportSVG();\r\n    } catch (error) {\r\n      this.handleError({ error });\r\n\r\n      return Promise.reject(error);\r\n    }\r\n\r\n    if (type === 'svg') {\r\n      return svg;\r\n    }\r\n\r\n    return generateImage(type, svg);\r\n  }\r\n\r\n  async exportSVG() {\r\n    const modeler = this.getModeler();\r\n\r\n    const viewer = modeler.getActiveViewer();\r\n\r\n    if (!viewer.saveSVG) {\r\n      return Promise.reject(new Error('SVG export not supported in current view'));\r\n    }\r\n\r\n    try {\r\n      const { svg } = await viewer.saveSVG();\r\n\r\n      return svg;\r\n    } catch (err) {\r\n\r\n      return Promise.reject(err);\r\n    }\r\n  }\r\n\r\n  handleEditDrdClick = () => {\r\n    const modeler = this.getModeler();\r\n\r\n    const drdView = modeler._views.find(({ type }) => type === 'drd');\r\n\r\n    if (drdView) {\r\n      modeler.open(drdView);\r\n    }\r\n  };\r\n\r\n  toggleOverview = () => {\r\n    const {\r\n      layout,\r\n      onLayoutChanged\r\n    } = this.props;\r\n\r\n    const dmnOverview = layout.dmnOverview || overviewDefaultLayout;\r\n\r\n    onLayoutChanged({\r\n      dmnOverview: {\r\n        ...dmnOverview,\r\n        open: !dmnOverview.open\r\n      }\r\n    });\r\n  };\r\n\r\n  resetOverview() {\r\n    const {\r\n      onLayoutChanged\r\n    } = this.props;\r\n\r\n    onLayoutChanged({\r\n      dmnOverview: {\r\n        ...overviewDefaultLayout\r\n      }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const engineProfile = this.engineProfile.getCached();\r\n\r\n    const {\r\n      layout,\r\n      onLayoutChanged\r\n    } = this.props;\r\n\r\n    const imported = this.getModeler().getDefinitions();\r\n\r\n    const {\r\n      importing\r\n    } = this.state;\r\n\r\n    const modeler = this.getModeler();\r\n\r\n    const activeView = modeler.getActiveView();\r\n\r\n    const isDrd = activeView && activeView.type === 'drd';\r\n\r\n    const activeViewer = modeler.getActiveViewer();\r\n\r\n    const overviewOpen = isOverviewOpen(this.props);\r\n\r\n    const hasPropertiesPanel = !importing && activeViewer && !!activeViewer.get('propertiesPanel', false);\r\n\r\n    return (\r\n      <div className={ css.DmnEditor }>\r\n\r\n        <Loader hidden={ imported && !importing } />\r\n\r\n        {\r\n          !isDrd && (\r\n            <div className=\"top\">\r\n              <button id=\"button-edit-drd\" className=\"button\" onClick={ this.handleEditDrdClick }>Edit DRD</button>\r\n              <button id=\"button-toggle-overview\" className=\"button\" onClick={ this.toggleOverview }>{ overviewOpen ? 'Close' : 'Open' } overview</button>\r\n            </div>\r\n          )\r\n        }\r\n\r\n        <div className=\"bottom\">\r\n\r\n          {\r\n            !isDrd && (\r\n              <OverviewContainer\r\n                className=\"overview\"\r\n                layout={ layout }\r\n                ref={ this.overviewRef }\r\n                onLayoutChanged={ onLayoutChanged } />\r\n            )\r\n          }\r\n\r\n          <div className={\r\n            classNames(\r\n              'diagram',\r\n              { 'drd': isDrd }\r\n            )\r\n          } ref={ this.ref }></div>\r\n\r\n          {\r\n            hasPropertiesPanel && (\r\n              <PropertiesPanelContainer\r\n                ref={ this.propertiesPanelRef }\r\n                layout={ layout }\r\n                onLayoutChanged={ onLayoutChanged } />\r\n            )\r\n          }\r\n\r\n        </div>\r\n\r\n        {\r\n          engineProfile && <EngineProfile\r\n            engineProfile={ engineProfile }\r\n            onChange={ (engineProfile) => this.engineProfile.set(engineProfile) } />\r\n        }\r\n\r\n      </div>\r\n    );\r\n  }\r\n\r\n  static createCachedState(props) {\r\n    const {\r\n      name,\r\n      version\r\n    } = Metadata;\r\n\r\n    const {\r\n      getPlugins,\r\n      onAction,\r\n      onError,\r\n      settings\r\n    } = props;\r\n\r\n    // notify interested parties that modeler will be configured\r\n    const handleMiddlewareExtensions = (middlewares) => {\r\n      onAction('emit-event', {\r\n        type: 'dmn.modeler.configure',\r\n        payload: {\r\n          middlewares\r\n        }\r\n      });\r\n    };\r\n\r\n    const {\r\n      options,\r\n      warnings\r\n    } = configureModeler(getPlugins, {\r\n      exporter: {\r\n        name,\r\n        version\r\n      },\r\n      settings\r\n    }, handleMiddlewareExtensions, 'platform');\r\n\r\n    if (warnings.length && isFunction(onError)) {\r\n      onError(\r\n        'Problem(s) configuring DMN editor: \\n\\t' +\r\n        warnings.map(error => error.message).join('\\n\\t') +\r\n        '\\n'\r\n      );\r\n    }\r\n\r\n    const modeler = new CamundaDmnModeler({\r\n      ...options,\r\n      position: 'absolute',\r\n      keyboard: {\r\n        bind: false\r\n      }\r\n    });\r\n\r\n    const stackIdx = modeler.getStackIdx();\r\n\r\n    // notify interested parties that modeler was created\r\n    onAction('emit-event', {\r\n      type: 'dmn.modeler.created',\r\n      payload: {\r\n        modeler\r\n      }\r\n    });\r\n\r\n    return {\r\n      __destroy: () => {\r\n        modeler.destroy();\r\n      },\r\n      dirty: false,\r\n      lastXML: null,\r\n      modeler,\r\n      stackIdx\r\n    };\r\n  }\r\n\r\n}\r\n\r\nexport default WithCache(WithCachedState(DmnEditor));\r\n\r\n// helpers //////////\r\n\r\nfunction isCachedStateChange(prevProps, props) {\r\n  return prevProps.cachedState !== props.cachedState;\r\n}\r\n\r\nfunction getMigrationDialog() {\r\n  return {\r\n    type: 'warning',\r\n    title: 'Deprecated DMN 1.1 Diagram Detected',\r\n    buttons: [\r\n      { id: 'cancel', label: 'Cancel' },\r\n      { id: 'yes', label: 'Yes' }\r\n    ],\r\n    defaultId: 1,\r\n    message: 'Would you like to migrate your diagram to DMN 1.3?',\r\n    detail: [\r\n      'Only DMN 1.3 diagrams can be opened with Camunda Modeler v4.0.0 or later.',\r\n    ].join('\\n'),\r\n    checkboxChecked: true,\r\n    checkboxLabel: 'Do not ask again.'\r\n  };\r\n}\r\n\r\n/**\r\n * Check layout whether overview is open.\r\n *\r\n * @param {Object} props\r\n *\r\n * @returns {boolean}\r\n */\r\nfunction isOverviewOpen(props) {\r\n  const layout = props.layout || {};\r\n\r\n  const dmnOverview = layout.dmnOverview;\r\n\r\n  return !dmnOverview || dmnOverview.open;\r\n}\r\n\r\n/**\r\n * Check layout whether overview was opened.\r\n *\r\n * @param {Object} prevProps\r\n * @param {Object} props\r\n *\r\n * @returns {boolean}\r\n */\r\nfunction isOverviewOpened(prevProps, props) {\r\n  return isOverviewOpen(prevProps) === false && isOverviewOpen(props) === true;\r\n}\r\n\r\n\r\n/**\r\n * Check whether grid layout changed since last open\r\n *\r\n * @param {Object} prevProps\r\n * @param {Object} props\r\n *\r\n * @returns {boolean}\r\n */\r\nfunction isGridLayoutChange(prevProps, props) {\r\n  return props.layout?.grid?.visible !== prevProps.layout?.grid?.visible;\r\n}\r\n","/**\r\n * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH\r\n * under one or more contributor license agreements. See the NOTICE file\r\n * distributed with this work for additional information regarding copyright\r\n * ownership.\r\n *\r\n * Camunda licenses this file to you under the MIT; you may not use this file\r\n * except in compliance with the MIT License.\r\n */\r\n\r\nimport DmnEditor from './DmnEditor';\r\nimport XMLEditor from '../xml';\r\n\r\nimport { createTab } from '../EditorTab';\r\n\r\n\r\nconst DmnTab = createTab('DmnTab', [\r\n  {\r\n    type: 'dmn',\r\n    editor: DmnEditor,\r\n    defaultName: 'Diagram (Camunda Platform)'\r\n  },\r\n  {\r\n    type: 'xml',\r\n    editor: XMLEditor,\r\n    isFallback: true,\r\n    defaultName: 'XML'\r\n  }\r\n]);\r\n\r\nexport default DmnTab;\r\n"],"names":["NOOP_MODULE","poweredByModule","poweredBy","CamundaDmnModeler","DmnModeler","constructor","options","moddleExtensions","drd","decisionTable","literalExpression","exporter","overview","settings","otherOptions","additionalModules","get","DmnImprovedCanvasModule","super","boxedExpression","mergeModules","executionPlatformModule","viewDrd","disableAdjustOrigin","Flags","DISABLE_ADJUST_ORIGIN","propertiesPanelKeyboardBindingsModule","modeler","modelerModdle","canvas","autoFocus","this","on","viewer","event","_emit","error","addExporter","_addOverview","showOverview","xml","_overview","importXML","then","err","_handleOverviewImport","getStackIdx","getActiveViewer","commandStack","_stackIdx","layout","DrdViewer","openDrgElementModule","overviewRendererModule","openDrgElement","previousActiveViewType","offCommandStackChanged","activeView","type","handleCommandStackChanged","once","onCommandStackChanged","_updateOverview","eventBus","_viewers","off","activeViewer","fire","id","element","view","getViews","find","open","saveXML","catch","console","zoom","attachOverviewTo","parentNode","detachOverview","attachTo","resized","detach","editorConfig","editorModules","completeDirectEditingModule","EXPORT_AS","CONFIG_KEY","DEFAULT_ENGINE_PROFILE","executionPlatform","ENGINES","PLATFORM","executionPlatformVersion","undefined","DmnEditor","CachedComponent","props","state","ref","React","overviewRef","propertiesPanelRef","handleResize","debounce","engineProfile","EngineProfileHelper","getModeler","getExecutionPlatform","name","toSemver","version","set","setExecutionPlatform","getCached","setCached","componentDidMount","_isMounted","listen","current","propertiesPanel","isOverviewOpen","toggle","grid","visible","checkImport","componentWillUnmount","componentDidUpdate","prevProps","isOverviewOpened","isGridLayoutChange","cachedState","isCachedStateChange","handleChanged","ifMounted","fn","args","forEach","viewsChanged","viewContentChanged","handleError","isDirty","dirty","stackIdx","handleImport","warnings","activeSheet","onImport","lastXML","setState","importing","initialView","_getInitialView","_views","previousActiveSheet","onSheetsChanged","previousActiveView","order","undo","redo","onChanged","getActiveView","hasPropertiesPanel","hasGrid","hasOverview","inputActive","isInputActive","newState","close","copy","cut","exportAs","paste","platform","canRedo","save","canUndo","selection","selectionLength","length","editMenu","canvasFocused","isFocused","assign","align","defaultCopyCutPaste","defaultUndoRedo","distribute","editLabel","lassoTool","moveCanvas","moveSelection","removeSelected","selectAll","getDmnDrdEditMenu","hasSelection","dmnRuleEditing","dmnClauseEditing","getDmnDecisionTableEditMenu","getDmnLiteralExpressionEditMenu","getDmnBoxedExpressionEditMenu","activeEditor","dmn","editable","elementsSelected","inactiveInput","windowMenu","getDmnWindowMenu","onError","handleDistributeElements","triggerAction","handleAlignElements","isImportNeeded","checkSheetChange","importedXML","handleMigration","onAction","async","findNamespaceUsages","getConfig","shouldMigrate","onContentUpdated","migratedXML","migrateDiagram","button","checkboxChecked","title","buttons","label","defaultId","message","detail","join","checkboxLabel","setConfig","shouldOpenActiveSheet","getView","action","context","onLayoutChanged","handleLayoutChange","propertiesPanelLayout","PROPERTIES_PANEL_DEFAULT_LAYOUT","value","toggleOverview","resetOverview","trigger","getXML","format","Promise","reject","svg","exportSVG","generateImage","saveSVG","Error","handleEditDrdClick","drdView","dmnOverview","overviewDefaultLayout","render","imported","getDefinitions","isDrd","overviewOpen","className","css","Loader","hidden","onClick","OverviewContainer","classNames","PropertiesPanelContainer","EngineProfile","onChange","createCachedState","Metadata","getPlugins","configureModeler","middlewares","payload","isFunction","map","position","keyboard","bind","__destroy","destroy","WithCache","WithCachedState","createTab","editor","defaultName","XMLEditor","isFallback"],"sourceRoot":""}