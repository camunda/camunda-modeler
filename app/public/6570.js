/*! For license information please see 6570.js.LICENSE.txt */
(self.webpackChunkcamunda_modeler_client=self.webpackChunkcamunda_modeler_client||[]).push([[6570],{93366(t,e,n){"use strict";function i(t,e){if(!t)throw new Error("config.exporter = { name, version } not configured");var n=t.name,i=t.version;if(!n||!i)throw new Error("config.exporter = { name, version } missing required props");e.on("saveXML.start",function(t){var e=t.definitions;e.exporter=n,e.exporterVersion=i})}n.d(e,{A:()=>i}),i.$inject=["config.exporter","eventBus"]},99186(t,e,n){"use strict";n.d(e,{A:()=>s});var i=n(57094),r={offset:{x:150,y:75},tolerance:50,alignOnSave:!0};function o(t,e,n,o,s,a){function l(t,n){var i=n.offset,r=n.tolerance,o={};return["x","y"].forEach(function(n){var s,a,l,c=-t[n]+i[n],h=e.get("gridSnapping",!1);h&&(s=c,a=h.getGridSpacing(),l||(l="round"),c=Math[l](s/a)*a),o[n]=Math.abs(c)<r?0:c}),o}function c(){var e=s.viewbox().inner,n=s.getRootElement().children;if(n.length){var i=l(e,t);0===i.x&&0===i.y||o.execute("elements.alignToOrigin",{elements:n,delta:i})}}function h(t){return function(e){n.once("commandStack.changed",function(){var n=e.delta,i=s.viewbox().scale;s.scroll({dx:t*n.x*i,dy:t*n.y*i})})}}var u,d,p;t=function(t){var e=(0,i.assign)({},r,t||{});return(0,i.isNumber)(e.offset)&&(e.offset={x:e.offset,y:e.offset}),e}(t),o.register("elements.alignToOrigin",{preExecute:function(t){var e=t.delta,n=t.elements;a.moveElements(n,e)},execute:h(-1),revert:h(1)}),t.alignOnSave&&(u=e.get("_parent",!1),d=n,((p=u&&u._eventBus)||d).on("saveXML.start",1250,c),p&&d.on("diagram.destroy",function(){p.off("saveXML.start",c)})),this.align=c,this.computeAdjustment=l,this._config=t}o.$inject=["config.alignToOrigin","injector","eventBus","commandStack","canvas","modeling"];const s={__init__:["alignToOrigin"],alignToOrigin:["type",o]}},27616(t,e,n){"use strict";n.d(e,{SE:()=>Vb,q_:()=>Hb});var i=n(49486);const r=Object.prototype.toString,o=Object.prototype.hasOwnProperty;function s(t){return"[object Array]"===r.call(t)}function a(t){return"[object Object]"===r.call(t)}function l(t){return"[object Number]"===r.call(t)}function c(t){const e=r.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e||"[object GeneratorFunction]"===e||"[object AsyncGeneratorFunction]"===e||"[object Proxy]"===e}function h(t){return"[object String]"===r.call(t)}function u(t,e){return!(null==t)&&o.call(t,e)}function d(t,e){let n,i;if(void 0===t)return;const r=s(t)?g:f;for(let o in t)if(u(t,o)&&(n=t[o],i=e(n,r(o)),!1===i))return n}function p(t,e){return!!function(t,e){const n=function(t){return c(t)?t:e=>e===t}(e);let i;return d(t,function(t,e){if(n(t,e))return i=t,!1}),i}(t,e)}function f(t){return t}function g(t){return Number(t)}function m(t,...e){return Object.assign(t,...e)}function v(t,e){let n={};return d(Object(t),function(t,i){-1===e.indexOf(i)&&(n[i]=t)}),n}function y(t,e){const n=`bio-improved-canvas-${t}`;if(!document.querySelector(`[data-css-file="${n}"]`)){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.setAttribute("data-css-file",n),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)),i.appendChild(r)}}var b=".bio-improved-canvas {\n  --gray-10: #f4f4f4;\n  --gray-20: #e0e0e0;\n  --gray-30: #c6c6c6;\n  --gray-40: #a8a8a8;\n  --gray-50: #878d96;\n  --gray-60: #697077;\n  --gray-80: #393939;\n  --gray-100: #161616;\n\n  --blue-60: #0f62fe;\n  --blue-70: #0043ce;\n}";function x(t,e){e.on("diagram.init",()=>t.getContainer().classList.add("bio-improved-canvas"))}x.$inject=["canvas","eventBus"];var w,_={__init__:["improvedCanvas"],improvedCanvas:["type",x]},O={__init__:["highContrastCanvas"],__depends__:[i.A,_],highContrastCanvas:["type",function(){y("base",b),y("high-contrast-canvas","/* Canvas */\n.bio-improved-canvas {\n  --palette-background-color: white;\n  --palette-separator-color: var(--gray-20);\n  --palette-entry-color: var(--gray-100);\n  --palette-border-color: var(--gray-20);\n  \n  --context-pad-entry-background-color: var(--gray-10);\n}\n\n.djs-container.bio-improved-canvas,\n.dmn-drd-container.bio-improved-canvas {\n  background-color: var(--gray-10);\n}\n\n.dmn-drd-container.bio-improved-canvas {\n  --dmn-definitions-background-color: white;\n  --dmn-definitions-border-color: var(--gray-20);\n}\n\n/* Grid */\n.bio-improved-canvas defs pattern circle {\n  fill: hsl(0, 0%, 87%) !important;\n  fill: var(--gray-40) !important;\n}\n")}]},k=!1;"undefined"!=typeof document&&((w=document.createElement("div")).innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',k=!w.getElementsByTagName("link").length,w=void 0);var S={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:k?[1,"X<div>","</div>"]:[0,"",""]};S.td=S.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],S.option=S.optgroup=[1,'<select multiple="multiple">',"</select>"],S.thead=S.tbody=S.colgroup=S.caption=S.tfoot=[1,"<table>","</table>"],S.polyline=S.ellipse=S.polygon=S.circle=S.text=S.line=S.path=S.rect=S.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];var E=function(t,e){if("string"!=typeof t)throw new TypeError("String expected");e||(e=document);var n=/<([\w:]+)/.exec(t);if(!n)return e.createTextNode(t);t=t.replace(/^\s+|\s+$/g,"");var i=n[1];if("body"==i)return(l=e.createElement("html")).innerHTML=t,l.removeChild(l.lastChild);var r=Object.prototype.hasOwnProperty.call(S,i)?S[i]:S._default,o=r[0],s=r[1],a=r[2],l=e.createElement("div");for(l.innerHTML=s+t+a;o--;)l=l.lastChild;if(l.firstChild==l.lastChild)return l.removeChild(l.firstChild);for(var c=e.createDocumentFragment();l.firstChild;)c.appendChild(l.removeChild(l.firstChild));return c};function C(t,e){return(e=e||document).querySelector(t)}var A,T,P,M,N,R,D,B,$={},L=[],I=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,q=Array.isArray;function F(t,e){for(var n in e)t[n]=e[n];return t}function V(t){var e=t.parentNode;e&&e.removeChild(t)}function j(t,e,n){var i,r,o,s={};for(o in e)"key"==o?i=e[o]:"ref"==o?r=e[o]:s[o]=e[o];if(arguments.length>2&&(s.children=arguments.length>3?A.call(arguments,2):n),"function"==typeof t&&null!=t.defaultProps)for(o in t.defaultProps)void 0===s[o]&&(s[o]=t.defaultProps[o]);return H(t,s,i,r,null)}function H(t,e,n,i,r){var o={type:t,props:e,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:null==r?++P:r,__i:-1,__u:0};return null==r&&null!=T.vnode&&T.vnode(o),o}function z(t){return t.children}function Q(t,e){this.props=t,this.context=e}function W(t,e){if(null==e)return t.__?W(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e)return n.__e;return"function"==typeof t.type?W(t):null}function X(t){var e,n;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e){t.__e=t.__c.base=n.__e;break}return X(t)}}function U(t){(!t.__d&&(t.__d=!0)&&M.push(t)&&!G.__r++||N!==T.debounceRendering)&&((N=T.debounceRendering)||R)(G)}function G(){var t,e,n,i,r,o,s,a,l;for(M.sort(D);t=M.shift();)t.__d&&(e=M.length,i=void 0,o=(r=(n=t).__v).__e,a=[],l=[],(s=n.__P)&&((i=F({},r)).__v=r.__v+1,T.vnode&&T.vnode(i),rt(s,i,r,n.__n,void 0!==s.ownerSVGElement,32&r.__u?[o]:null,a,null==o?W(r):o,!!(32&r.__u),l),i.__.__k[i.__i]=i,ot(a,i,l),i.__e!=o&&X(i)),M.length>e&&M.sort(D));G.__r=0}function Y(t,e,n,i,r,o,s,a,l,c,h){var u,d,p,f,g,m=i&&i.__k||L,v=e.length;for(n.__d=l,function(t,e,n){var i,r,o,s,a,l=e.length,c=n.length,h=c,u=0;for(t.__k=[],i=0;i<l;i++)null!=(r=t.__k[i]=null==(r=e[i])||"boolean"==typeof r||"function"==typeof r?null:"string"==typeof r||"number"==typeof r||"bigint"==typeof r||r.constructor==String?H(null,r,null,null,r):q(r)?H(z,{children:r},null,null,null):void 0===r.constructor&&r.__b>0?H(r.type,r.props,r.key,r.ref?r.ref:null,r.__v):r)?(r.__=t,r.__b=t.__b+1,a=J(r,n,s=i+u,h),r.__i=a,o=null,-1!==a&&(h--,(o=n[a])&&(o.__u|=131072)),null==o||null===o.__v?(-1==a&&u--,"function"!=typeof r.type&&(r.__u|=65536)):a!==s&&(a===s+1?u++:a>s?h>l-s?u+=a-s:u--:u=a<s&&a==s-1?a-s:0,a!==i+u&&(r.__u|=65536))):(o=n[i])&&null==o.key&&o.__e&&(o.__e==t.__d&&(t.__d=W(o)),at(o,o,!1),n[i]=null,h--);if(h)for(i=0;i<c;i++)null!=(o=n[i])&&!(131072&o.__u)&&(o.__e==t.__d&&(t.__d=W(o)),at(o,o))}(n,e,m),l=n.__d,u=0;u<v;u++)null!=(p=n.__k[u])&&"boolean"!=typeof p&&"function"!=typeof p&&(d=-1===p.__i?$:m[p.__i]||$,p.__i=u,rt(t,p,d,r,o,s,a,l,c,h),f=p.__e,p.ref&&d.ref!=p.ref&&(d.ref&&st(d.ref,null,p),h.push(p.ref,p.__c||f,p)),null==g&&null!=f&&(g=f),65536&p.__u||d.__k===p.__k?l=Z(p,l,t):"function"==typeof p.type&&void 0!==p.__d?l=p.__d:f&&(l=f.nextSibling),p.__d=void 0,p.__u&=-196609);n.__d=l,n.__e=g}function Z(t,e,n){var i,r;if("function"==typeof t.type){for(i=t.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=t,e=Z(i[r],e,n));return e}return t.__e!=e&&(n.insertBefore(t.__e,e||null),e=t.__e),e&&e.nextSibling}function K(t,e){return e=e||[],null==t||"boolean"==typeof t||(q(t)?t.some(function(t){K(t,e)}):e.push(t)),e}function J(t,e,n,i){var r=t.key,o=t.type,s=n-1,a=n+1,l=e[n];if(null===l||l&&r==l.key&&o===l.type)return n;if(i>(null==l||131072&l.__u?0:1))for(;s>=0||a<e.length;){if(s>=0){if((l=e[s])&&!(131072&l.__u)&&r==l.key&&o===l.type)return s;s--}if(a<e.length){if((l=e[a])&&!(131072&l.__u)&&r==l.key&&o===l.type)return a;a++}}return-1}function tt(t,e,n){"-"===e[0]?t.setProperty(e,null==n?"":n):t[e]=null==n?"":"number"!=typeof n||I.test(e)?n:n+"px"}function et(t,e,n,i,r){var o;t:if("style"===e)if("string"==typeof n)t.style.cssText=n;else{if("string"==typeof i&&(t.style.cssText=i=""),i)for(e in i)n&&e in n||tt(t.style,e,"");if(n)for(e in n)i&&n[e]===i[e]||tt(t.style,e,n[e])}else if("o"===e[0]&&"n"===e[1])o=e!==(e=e.replace(/(PointerCapture)$|Capture$/,"$1")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=n,n?i?n.u=i.u:(n.u=Date.now(),t.addEventListener(e,o?it:nt,o)):t.removeEventListener(e,o?it:nt,o);else{if(r)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==e&&"height"!==e&&"href"!==e&&"list"!==e&&"form"!==e&&"tabIndex"!==e&&"download"!==e&&"rowSpan"!==e&&"colSpan"!==e&&"role"!==e&&e in t)try{t[e]=null==n?"":n;break t}catch(t){}"function"==typeof n||(null==n||!1===n&&"-"!==e[4]?t.removeAttribute(e):t.setAttribute(e,n))}}function nt(t){var e=this.l[t.type+!1];if(t.t){if(t.t<=e.u)return}else t.t=Date.now();return e(T.event?T.event(t):t)}function it(t){return this.l[t.type+!0](T.event?T.event(t):t)}function rt(t,e,n,i,r,o,s,a,l,c){var h,u,d,p,f,g,m,v,y,b,x,w,_,O,k,S=e.type;if(void 0!==e.constructor)return null;128&n.__u&&(l=!!(32&n.__u),o=[a=e.__e=n.__e]),(h=T.__b)&&h(e);t:if("function"==typeof S)try{if(v=e.props,y=(h=S.contextType)&&i[h.__c],b=h?y?y.props.value:h.__:i,n.__c?m=(u=e.__c=n.__c).__=u.__E:("prototype"in S&&S.prototype.render?e.__c=u=new S(v,b):(e.__c=u=new Q(v,b),u.constructor=S,u.render=lt),y&&y.sub(u),u.props=v,u.state||(u.state={}),u.context=b,u.__n=i,d=u.__d=!0,u.__h=[],u._sb=[]),null==u.__s&&(u.__s=u.state),null!=S.getDerivedStateFromProps&&(u.__s==u.state&&(u.__s=F({},u.__s)),F(u.__s,S.getDerivedStateFromProps(v,u.__s))),p=u.props,f=u.state,u.__v=e,d)null==S.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),null!=u.componentDidMount&&u.__h.push(u.componentDidMount);else{if(null==S.getDerivedStateFromProps&&v!==p&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(v,b),!u.__e&&(null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(v,u.__s,b)||e.__v===n.__v)){for(e.__v!==n.__v&&(u.props=v,u.state=u.__s,u.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.forEach(function(t){t&&(t.__=e)}),x=0;x<u._sb.length;x++)u.__h.push(u._sb[x]);u._sb=[],u.__h.length&&s.push(u);break t}null!=u.componentWillUpdate&&u.componentWillUpdate(v,u.__s,b),null!=u.componentDidUpdate&&u.__h.push(function(){u.componentDidUpdate(p,f,g)})}if(u.context=b,u.props=v,u.__P=t,u.__e=!1,w=T.__r,_=0,"prototype"in S&&S.prototype.render){for(u.state=u.__s,u.__d=!1,w&&w(e),h=u.render(u.props,u.state,u.context),O=0;O<u._sb.length;O++)u.__h.push(u._sb[O]);u._sb=[]}else do{u.__d=!1,w&&w(e),h=u.render(u.props,u.state,u.context),u.state=u.__s}while(u.__d&&++_<25);u.state=u.__s,null!=u.getChildContext&&(i=F(F({},i),u.getChildContext())),d||null==u.getSnapshotBeforeUpdate||(g=u.getSnapshotBeforeUpdate(p,f)),Y(t,q(k=null!=h&&h.type===z&&null==h.key?h.props.children:h)?k:[k],e,n,i,r,o,s,a,l,c),u.base=e.__e,e.__u&=-161,u.__h.length&&s.push(u),m&&(u.__E=u.__=null)}catch(t){e.__v=null,l||null!=o?(e.__e=a,e.__u|=l?160:32,o[o.indexOf(a)]=null):(e.__e=n.__e,e.__k=n.__k),T.__e(t,e,n)}else null==o&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=function(t,e,n,i,r,o,s,a,l){var c,h,u,d,p,f,g,m=n.props,v=e.props,y=e.type;if("svg"===y&&(r=!0),null!=o)for(c=0;c<o.length;c++)if((p=o[c])&&"setAttribute"in p==!!y&&(y?p.localName===y:3===p.nodeType)){t=p,o[c]=null;break}if(null==t){if(null===y)return document.createTextNode(v);t=r?document.createElementNS("http://www.w3.org/2000/svg",y):document.createElement(y,v.is&&v),o=null,a=!1}if(null===y)m===v||a&&t.data===v||(t.data=v);else{if(o=o&&A.call(t.childNodes),m=n.props||$,!a&&null!=o)for(m={},c=0;c<t.attributes.length;c++)m[(p=t.attributes[c]).name]=p.value;for(c in m)p=m[c],"children"==c||("dangerouslySetInnerHTML"==c?u=p:"key"===c||c in v||et(t,c,null,p,r));for(c in v)p=v[c],"children"==c?d=p:"dangerouslySetInnerHTML"==c?h=p:"value"==c?f=p:"checked"==c?g=p:"key"===c||a&&"function"!=typeof p||m[c]===p||et(t,c,p,m[c],r);if(h)a||u&&(h.__html===u.__html||h.__html===t.innerHTML)||(t.innerHTML=h.__html),e.__k=[];else if(u&&(t.innerHTML=""),Y(t,q(d)?d:[d],e,n,i,r&&"foreignObject"!==y,o,s,o?o[0]:n.__k&&W(n,0),a,l),null!=o)for(c=o.length;c--;)null!=o[c]&&V(o[c]);a||(c="value",void 0!==f&&(f!==t[c]||"progress"===y&&!f||"option"===y&&f!==m[c])&&et(t,c,f,m[c],!1),c="checked",void 0!==g&&g!==t[c]&&et(t,c,g,m[c],!1))}return t}(n.__e,e,n,i,r,o,s,l,c);(h=T.diffed)&&h(e)}function ot(t,e,n){e.__d=void 0;for(var i=0;i<n.length;i++)st(n[i],n[++i],n[++i]);T.__c&&T.__c(e,t),t.some(function(e){try{t=e.__h,e.__h=[],t.some(function(t){t.call(e)})}catch(t){T.__e(t,e.__v)}})}function st(t,e,n){try{"function"==typeof t?t(e):t.current=e}catch(t){T.__e(t,n)}}function at(t,e,n){var i,r;if(T.unmount&&T.unmount(t),(i=t.ref)&&(i.current&&i.current!==t.__e||st(i,null,e)),null!=(i=t.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(t){T.__e(t,e)}i.base=i.__P=null,t.__c=void 0}if(i=t.__k)for(r=0;r<i.length;r++)i[r]&&at(i[r],e,n||"function"!=typeof t.type);n||null==t.__e||V(t.__e),t.__=t.__e=t.__d=void 0}function lt(t,e,n){return this.constructor(t,n)}function ct(t,e,n){var i,r,o;T.__&&T.__(t,e),i=e.__k,r=[],o=[],rt(e,t=e.__k=j(z,null,[t]),i||$,$,void 0!==e.ownerSVGElement,i?null:e.firstChild?A.call(e.childNodes):null,r,i?i.__e:e.firstChild,!1,o),ot(r,t,o)}function ht(t,e){var n={__c:e="__cC"+B++,__:t,Consumer:function(t,e){return t.children(e)},Provider:function(t){var n,i;return this.getChildContext||(n=[],(i={})[e]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(t){this.props.value!==t.value&&n.some(function(t){t.__e=!0,U(t)})},this.sub=function(t){n.push(t);var e=t.componentWillUnmount;t.componentWillUnmount=function(){n.splice(n.indexOf(t),1),e&&e.call(t)}}),t.children}};return n.Provider.__=n.Consumer.contextType=n}A=L.slice,T={__e:function(t,e,n,i){for(var r,o,s;e=e.__;)if((r=e.__c)&&!r.__)try{if((o=r.constructor)&&null!=o.getDerivedStateFromError&&(r.setState(o.getDerivedStateFromError(t)),s=r.__d),null!=r.componentDidCatch&&(r.componentDidCatch(t,i||{}),s=r.__d),s)return r.__E=r}catch(e){t=e}throw t}},P=0,Q.prototype.setState=function(t,e){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=F({},this.state),"function"==typeof t&&(t=t(F({},n),this.props)),t&&F(n,t),null!=t&&this.__v&&(e&&this._sb.push(e),U(this))},Q.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),U(this))},Q.prototype.render=z,M=[],R="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,D=function(t,e){return t.__v.__b-e.__v.__b},G.__r=0,B=0;var ut,dt,pt,ft,gt=0,mt=[],vt=[],yt=T.__b,bt=T.__r,xt=T.diffed,wt=T.__c,_t=T.unmount;function Ot(t,e){T.__h&&T.__h(dt,t,gt||e),gt=0;var n=dt.__H||(dt.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({__V:vt}),n.__[t]}function kt(t){return gt=1,function(t,e){var n=Ot(ut++,2);if(n.t=t,!n.__c&&(n.__=[Bt(void 0,e),function(t){var e=n.__N?n.__N[0]:n.__[0],i=n.t(e,t);e!==i&&(n.__N=[i,n.__[1]],n.__c.setState({}))}],n.__c=dt,!dt.u)){var i=function(t,e,i){if(!n.__c.__H)return!0;var o=n.__c.__H.__.filter(function(t){return t.__c});if(o.every(function(t){return!t.__N}))return!r||r.call(this,t,e,i);var s=!1;return o.forEach(function(t){if(t.__N){var e=t.__[0];t.__=t.__N,t.__N=void 0,e!==t.__[0]&&(s=!0)}}),!(!s&&n.__c.props===t)&&(!r||r.call(this,t,e,i))};dt.u=!0;var r=dt.shouldComponentUpdate,o=dt.componentWillUpdate;dt.componentWillUpdate=function(t,e,n){if(this.__e){var s=r;r=void 0,i(t,e,n),r=s}o&&o.call(this,t,e,n)},dt.shouldComponentUpdate=i}return n.__N||n.__}(Bt,t)}function St(t,e){var n=Ot(ut++,3);!T.__s&&Dt(n.__H,e)&&(n.__=t,n.i=e,dt.__H.__h.push(n))}function Et(t){return gt=5,Ct(function(){return{current:t}},[])}function Ct(t,e){var n=Ot(ut++,7);return Dt(n.__H,e)?(n.__V=t(),n.i=e,n.__h=t,n.__V):n.__}function At(t){var e=dt.context[t.__c],n=Ot(ut++,9);return n.c=t,e?(null==n.__&&(n.__=!0,e.sub(dt)),e.props.value):t.__}function Tt(){for(var t;t=mt.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(Nt),t.__H.__h.forEach(Rt),t.__H.__h=[]}catch(e){t.__H.__h=[],T.__e(e,t.__v)}}T.__b=function(t){dt=null,yt&&yt(t)},T.__r=function(t){bt&&bt(t),ut=0;var e=(dt=t.__c).__H;e&&(pt===dt?(e.__h=[],dt.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.__V=vt,t.__N=t.i=void 0})):(e.__h.forEach(Nt),e.__h.forEach(Rt),e.__h=[],ut=0)),pt=dt},T.diffed=function(t){xt&&xt(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(1!==mt.push(e)&&ft===T.requestAnimationFrame||((ft=T.requestAnimationFrame)||Mt)(Tt)),e.__H.__.forEach(function(t){t.i&&(t.__H=t.i),t.__V!==vt&&(t.__=t.__V),t.i=void 0,t.__V=vt})),pt=dt=null},T.__c=function(t,e){e.some(function(t){try{t.__h.forEach(Nt),t.__h=t.__h.filter(function(t){return!t.__||Rt(t)})}catch(n){e.some(function(t){t.__h&&(t.__h=[])}),e=[],T.__e(n,t.__v)}}),wt&&wt(t,e)},T.unmount=function(t){_t&&_t(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(t){try{Nt(t)}catch(t){e=t}}),n.__H=void 0,e&&T.__e(e,n.__v))};var Pt="function"==typeof requestAnimationFrame;function Mt(t){var e,n=function(){clearTimeout(i),Pt&&cancelAnimationFrame(e),setTimeout(t)},i=setTimeout(n,100);Pt&&(e=requestAnimationFrame(n))}function Nt(t){var e=dt,n=t.__c;"function"==typeof n&&(t.__c=void 0,n()),dt=e}function Rt(t){var e=dt;t.__c=t.__(),dt=e}function Dt(t,e){return!t||t.length!==e.length||e.some(function(e,n){return e!==t[n]})}function Bt(t,e){return"function"==typeof e?e(t):e}function $t(t,e){for(var n in e)t[n]=e[n];return t}function Lt(t,e){for(var n in t)if("__source"!==n&&!(n in e))return!0;for(var i in e)if("__source"!==i&&t[i]!==e[i])return!0;return!1}function It(t){this.props=t}(It.prototype=new Q).isPureReactComponent=!0,It.prototype.shouldComponentUpdate=function(t,e){return Lt(this.props,t)||Lt(this.state,e)};var qt=T.__b;T.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),qt&&qt(t)};var Ft="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Vt(t){function e(e){var n=$t({},e);return delete n.ref,t(n,e.ref||null)}return e.$$typeof=Ft,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(t.displayName||t.name)+")",e}var jt=T.__e;T.__e=function(t,e,n,i){if(t.then)for(var r,o=e;o=o.__;)if((r=o.__c)&&r.__c)return null==e.__e&&(e.__e=n.__e,e.__k=n.__k),r.__c(t,e);jt(t,e,n,i)};var Ht=T.unmount;function zt(t,e,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach(function(t){"function"==typeof t.__c&&t.__c()}),t.__c.__H=null),null!=(t=$t({},t)).__c&&(t.__c.__P===n&&(t.__c.__P=e),t.__c=null),t.__k=t.__k&&t.__k.map(function(t){return zt(t,e,n)})),t}function Qt(t,e,n){return t&&n&&(t.__v=null,t.__k=t.__k&&t.__k.map(function(t){return Qt(t,e,n)}),t.__c&&t.__c.__P===e&&(t.__e&&n.appendChild(t.__e),t.__c.__e=!0,t.__c.__P=n)),t}function Wt(){this.__u=0,this.t=null,this.__b=null}function Xt(t){var e=t.__.__c;return e&&e.__a&&e.__a(t)}function Ut(){this.u=null,this.o=null}T.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&32&t.__u&&(t.type=null),Ht&&Ht(t)},(Wt.prototype=new Q).__c=function(t,e){var n=e.__c,i=this;null==i.t&&(i.t=[]),i.t.push(n);var r=Xt(i.__v),o=!1,s=function(){o||(o=!0,n.__R=null,r?r(a):a())};n.__R=s;var a=function(){if(! --i.__u){if(i.state.__a){var t=i.state.__a;i.__v.__k[0]=Qt(t,t.__c.__P,t.__c.__O)}var e;for(i.setState({__a:i.__b=null});e=i.t.pop();)e.forceUpdate()}};i.__u++||32&e.__u||i.setState({__a:i.__b=i.__v.__k[0]}),t.then(s,s)},Wt.prototype.componentWillUnmount=function(){this.t=[]},Wt.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),i=this.__v.__k[0].__c;this.__v.__k[0]=zt(this.__b,n,i.__O=i.__P)}this.__b=null}var r=e.__a&&j(z,null,t.fallback);return r&&(r.__u&=-33),[j(z,null,e.__a?null:t.children),r]};var Gt=function(t,e,n){if(++n[1]===n[0]&&t.o.delete(e),t.props.revealOrder&&("t"!==t.props.revealOrder[0]||!t.o.size))for(n=t.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;t.u=n=n[2]}};function Yt(t){return this.getChildContext=function(){return t.context},t.children}function Zt(t){var e=this,n=t.i;e.componentWillUnmount=function(){ct(null,e.l),e.l=null,e.i=null},e.i&&e.i!==n&&e.componentWillUnmount(),e.l||(e.i=n,e.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(t){this.childNodes.push(t),e.i.appendChild(t)},insertBefore:function(t,n){this.childNodes.push(t),e.i.appendChild(t)},removeChild:function(t){this.childNodes.splice(this.childNodes.indexOf(t)>>>1,1),e.i.removeChild(t)}}),ct(j(Yt,{context:e.context},t.__v),e.l)}function Kt(t,e){var n=j(Zt,{__v:t,i:e});return n.containerInfo=e,n}(Ut.prototype=new Q).__a=function(t){var e=this,n=Xt(e.__v),i=e.o.get(t);return i[0]++,function(r){var o=function(){e.props.revealOrder?(i.push(r),Gt(e,t,i)):r()};n?n(o):o()}},Ut.prototype.render=function(t){this.u=null,this.o=new Map;var e=K(t.children);t.revealOrder&&"b"===t.revealOrder[0]&&e.reverse();for(var n=e.length;n--;)this.o.set(e[n],this.u=[1,0,this.u]);return t.children},Ut.prototype.componentDidUpdate=Ut.prototype.componentDidMount=function(){var t=this;this.o.forEach(function(e,n){Gt(t,n,e)})};var Jt="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,te=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,ee=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,ne=/[A-Z0-9]/g,ie="undefined"!=typeof document,re=function(t){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/:/fil|che|ra/).test(t)};Q.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(Q.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})});var oe=T.event;function se(){}function ae(){return this.cancelBubble}function le(){return this.defaultPrevented}T.event=function(t){return oe&&(t=oe(t)),t.persist=se,t.isPropagationStopped=ae,t.isDefaultPrevented=le,t.nativeEvent=t};var ce={enumerable:!1,configurable:!0,get:function(){return this.class}},he=T.vnode;T.vnode=function(t){"string"==typeof t.type&&function(t){var e=t.props,n=t.type,i={};for(var r in e){var o=e[r];if(!("value"===r&&"defaultValue"in e&&null==o||ie&&"children"===r&&"noscript"===n||"class"===r||"className"===r)){var s=r.toLowerCase();"defaultValue"===r&&"value"in e&&null==e.value?r="value":"download"===r&&!0===o?o="":"ondoubleclick"===s?r="ondblclick":"onchange"!==s||"input"!==n&&"textarea"!==n||re(e.type)?"onfocus"===s?r="onfocusin":"onblur"===s?r="onfocusout":ee.test(r)?r=s:-1===n.indexOf("-")&&te.test(r)?r=r.replace(ne,"-$&").toLowerCase():null===o&&(o=void 0):s=r="oninput","oninput"===s&&i[r=s]&&(r="oninputCapture"),i[r]=o}}"select"==n&&i.multiple&&Array.isArray(i.value)&&(i.value=K(e.children).forEach(function(t){t.props.selected=-1!=i.value.indexOf(t.props.value)})),"select"==n&&null!=i.defaultValue&&(i.value=K(e.children).forEach(function(t){t.props.selected=i.multiple?-1!=i.defaultValue.indexOf(t.props.value):i.defaultValue==t.props.value})),e.class&&!e.className?(i.class=e.class,Object.defineProperty(i,"className",ce)):(e.className&&!e.class||e.class&&e.className)&&(i.class=i.className=e.className),t.props=i}(t),t.$$typeof=Jt,he&&he(t)};var ue=T.__r;T.__r=function(t){ue&&ue(t),t.__c};var de=T.diffed;T.diffed=function(t){de&&de(t);var e=t.props,n=t.__e;null!=n&&"textarea"===t.type&&"value"in e&&e.value!==n.value&&(n.value=null==e.value?"":e.value)};var pe=0;function fe(t,e,n,i,r,o){var s,a,l={};for(a in e)"ref"==a?s=e[a]:l[a]=e[a];var c={type:t,props:l,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--pe,__i:-1,__u:0,__source:r,__self:o};if("function"==typeof t&&(s=t.defaultProps))for(a in s)void 0===l[a]&&(l[a]=s[a]);return T.vnode&&T.vnode(c),c}function ge(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var me,ve,ye={exports:{}},be=(me||(me=1,ve=ye,function(){var t={}.hasOwnProperty;function e(){for(var n=[],i=0;i<arguments.length;i++){var r=arguments[i];if(r){var o=typeof r;if("string"===o||"number"===o)n.push(r);else if(Array.isArray(r)){if(r.length){var s=e.apply(null,r);s&&n.push(s)}}else if("object"===o){if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]")){n.push(r.toString());continue}for(var a in r)t.call(r,a)&&r[a]&&n.push(a)}}}return n.join(" ")}ve.exports?(e.default=e,ve.exports=e):window.classNames=e}()),ye.exports),xe=ge(be);const we=1024;let _e=0,Oe=class{constructor(t,e){this.from=t,this.to=e}};class ke{constructor(t={}){this.id=_e++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=Ce.match(t)),e=>{let n=t(e);return void 0===n?null:[this,n]}}}ke.closedBy=new ke({deserialize:t=>t.split(" ")}),ke.openedBy=new ke({deserialize:t=>t.split(" ")}),ke.group=new ke({deserialize:t=>t.split(" ")}),ke.isolate=new ke({deserialize:t=>{if(t&&"rtl"!=t&&"ltr"!=t&&"auto"!=t)throw new RangeError("Invalid value for isolate: "+t);return t||"auto"}}),ke.contextHash=new ke({perNode:!0}),ke.lookAhead=new ke({perNode:!0}),ke.mounted=new ke({perNode:!0});class Se{constructor(t,e,n){this.tree=t,this.overlay=e,this.parser=n}static get(t){return t&&t.props&&t.props[ke.mounted.id]}}const Ee=Object.create(null);class Ce{constructor(t,e,n,i=0){this.name=t,this.props=e,this.id=n,this.flags=i}static define(t){let e=t.props&&t.props.length?Object.create(null):Ee,n=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),i=new Ce(t.name||"",e,t.id,n);if(t.props)for(let n of t.props)if(Array.isArray(n)||(n=n(i)),n){if(n[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[n[0].id]=n[1]}return i}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop(ke.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let n in t)for(let i of n.split(" "))e[i]=t[n];return t=>{for(let n=t.prop(ke.group),i=-1;i<(n?n.length:0);i++){let r=e[i<0?t.name:n[i]];if(r)return r}}}}Ce.none=new Ce("",Object.create(null),0,8);class Ae{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let n of this.types){let i=null;for(let e of t){let t=e(n);t&&(i||(i=Object.assign({},n.props)),i[t[0].id]=t[1])}e.push(i?new Ce(n.name,i,n.id,n.flags):n)}return new Ae(e)}}const Te=new WeakMap,Pe=new WeakMap;var Me;!function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"}(Me||(Me={}));class Ne{constructor(t,e,n,i,r){if(this.type=t,this.children=e,this.positions=n,this.length=i,this.props=null,r&&r.length){this.props=Object.create(null);for(let[t,e]of r)this.props["number"==typeof t?t:t.id]=e}}toString(){let t=Se.get(this);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let n=t.toString();n&&(e&&(e+=","),e+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new Qe(this.topNode,t)}cursorAt(t,e=0,n=0){let i=Te.get(this)||this.topNode,r=new Qe(i);return r.moveTo(t,e),Te.set(this,r._tree),r}get topNode(){return new Ie(this,0,0,null)}resolve(t,e=0){let n=$e(Te.get(this)||this.topNode,t,e,!1);return Te.set(this,n),n}resolveInner(t,e=0){let n=$e(Pe.get(this)||this.topNode,t,e,!0);return Pe.set(this,n),n}resolveStack(t,e=0){return function(t,e,n){let i=t.resolveInner(e,n),r=null;for(let t=i instanceof Ie?i:i.context.parent;t;t=t.parent)if(t.index<0){let o=t.parent;(r||(r=[i])).push(o.resolve(e,n)),t=o}else{let o=Se.get(t.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let s=new Ie(o.tree,o.overlay[0].from+t.from,-1,t);(r||(r=[i])).push($e(s,e,n,!1))}}return r?He(r):i}(this,t,e)}iterate(t){let{enter:e,leave:n,from:i=0,to:r=this.length}=t,o=t.mode||0,s=(o&Me.IncludeAnonymous)>0;for(let t=this.cursor(o|Me.IncludeAnonymous);;){let o=!1;if(t.from<=r&&t.to>=i&&(!s&&t.type.isAnonymous||!1!==e(t))){if(t.firstChild())continue;o=!0}for(;o&&n&&(s||!t.type.isAnonymous)&&n(t),!t.nextSibling();){if(!t.parent())return;o=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:Ge(Ce.none,this.children,this.positions,0,this.children.length,0,this.length,(t,e,n)=>new Ne(this.type,t,e,n,this.propValues),t.makeTree||((t,e,n)=>new Ne(Ce.none,t,e,n)))}static build(t){return function(t){var e;let{buffer:n,nodeSet:i,maxBufferLength:r=we,reused:o=[],minRepeatType:s=i.types.length}=t,a=Array.isArray(n)?new Re(n,n.length):n,l=i.types,c=0,h=0;function u(t,e,n,m,v,y){let{id:b,start:x,end:w,size:_}=a,O=h;for(;_<0;){if(a.next(),-1==_){let e=o[b];return n.push(e),void m.push(x-t)}if(-3==_)return void(c=b);if(-4==_)return void(h=b);throw new RangeError(`Unrecognized record size: ${_}`)}let k,S,E=l[b],C=x-t;if(w-x<=r&&(S=function(t,e){let n=a.fork(),i=0,o=0,l=0,c=n.end-r,h={size:0,start:0,skip:0};t:for(let r=n.pos-t;n.pos>r;){let t=n.size;if(n.id==e&&t>=0){h.size=i,h.start=o,h.skip=l,l+=4,i+=4,n.next();continue}let a=n.pos-t;if(t<0||a<r||n.start<c)break;let u=n.id>=s?4:0,d=n.start;for(n.next();n.pos>a;){if(n.size<0){if(-3!=n.size)break t;u+=4}else n.id>=s&&(u+=4);n.next()}o=d,i+=t,l+=u}return(e<0||i==t)&&(h.size=i,h.start=o,h.skip=l),h.size>4?h:void 0}(a.pos-e,v))){let e=new Uint16Array(S.size-S.skip),n=a.pos-S.size,r=e.length;for(;a.pos>n;)r=g(S.start,e,r);k=new De(e,w-S.start,i),C=S.start-t}else{let t=a.pos-_;a.next();let e=[],n=[],i=b>=s?b:-1,o=0,l=w;for(;a.pos>t;)i>=0&&a.id==i&&a.size>=0?(a.end<=l-r&&(p(e,n,x,o,a.end,l,i,O),o=e.length,l=a.end),a.next()):y>2500?d(x,t,e,n):u(x,t,e,n,i,y+1);if(i>=0&&o>0&&o<e.length&&p(e,n,x,o,x,l,i,O),e.reverse(),n.reverse(),i>-1&&o>0){let t=function(t){return(e,n,i)=>{let r,o,s=0,a=e.length-1;if(a>=0&&(r=e[a])instanceof Ne){if(!a&&r.type==t&&r.length==i)return r;(o=r.prop(ke.lookAhead))&&(s=n[a]+r.length+o)}return f(t,e,n,i,s)}}(E);k=Ge(E,e,n,0,e.length,0,w-x,t,t)}else k=f(E,e,n,w-x,O-w)}n.push(k),m.push(C)}function d(t,e,n,o){let s=[],l=0,c=-1;for(;a.pos>e;){let{id:t,start:e,end:n,size:i}=a;if(i>4)a.next();else{if(c>-1&&e<c)break;c<0&&(c=n-r),s.push(t,e,n),l++,a.next()}}if(l){let e=new Uint16Array(4*l),r=s[s.length-2];for(let t=s.length-3,n=0;t>=0;t-=3)e[n++]=s[t],e[n++]=s[t+1]-r,e[n++]=s[t+2]-r,e[n++]=n;n.push(new De(e,s[2]-r,i)),o.push(r-t)}}function p(t,e,n,r,o,s,a,l){let c=[],h=[];for(;t.length>r;)c.push(t.pop()),h.push(e.pop()+n-o);t.push(f(i.types[a],c,h,s-o,l-s)),e.push(o-n)}function f(t,e,n,i,r=0,o){if(c){let t=[ke.contextHash,c];o=o?[t].concat(o):[t]}if(r>25){let t=[ke.lookAhead,r];o=o?[t].concat(o):[t]}return new Ne(t,e,n,i,o)}function g(t,e,n){let{id:i,start:r,end:o,size:l}=a;if(a.next(),l>=0&&i<s){let s=n;if(l>4){let i=a.pos-(l-4);for(;a.pos>i;)n=g(t,e,n)}e[--n]=s,e[--n]=o-t,e[--n]=r-t,e[--n]=i}else-3==l?c=i:-4==l&&(h=i);return n}let m=[],v=[];for(;a.pos>0;)u(t.start||0,t.bufferStart||0,m,v,-1,0);let y=null!==(e=t.length)&&void 0!==e?e:m.length?v[0]+m[0].length:0;return new Ne(l[t.topID],m.reverse(),v.reverse(),y)}(t)}}Ne.empty=new Ne(Ce.none,[],[],0);class Re{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Re(this.buffer,this.index)}}class De{constructor(t,e,n){this.buffer=t,this.length=e,this.set=n}get type(){return Ce.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],n=this.buffer[t+3],i=this.set.types[e],r=i.name;if(/\W/.test(r)&&!i.isError&&(r=JSON.stringify(r)),n==(t+=4))return r;let o=[];for(;t<n;)o.push(this.childString(t)),t=this.buffer[t+3];return r+"("+o.join(",")+")"}findChild(t,e,n,i,r){let{buffer:o}=this,s=-1;for(let a=t;a!=e&&!(Be(r,i,o[a+1],o[a+2])&&(s=a,n>0));a=o[a+3]);return s}slice(t,e,n){let i=this.buffer,r=new Uint16Array(e-t),o=0;for(let s=t,a=0;s<e;){r[a++]=i[s++],r[a++]=i[s++]-n;let e=r[a++]=i[s++]-n;r[a++]=i[s++]-t,o=Math.max(o,e)}return new De(r,o,this.set)}}function Be(t,e,n,i){switch(t){case-2:return n<e;case-1:return i>=e&&n<e;case 0:return n<e&&i>e;case 1:return n<=e&&i>e;case 2:return i>e;case 4:return!0}}function $e(t,e,n,i){for(var r;t.from==t.to||(n<1?t.from>=e:t.from>e)||(n>-1?t.to<=e:t.to<e);){let e=!i&&t instanceof Ie&&t.index<0?null:t.parent;if(!e)return t;t=e}let o=i?0:Me.IgnoreOverlays;if(i)for(let i=t,s=i.parent;s;i=s,s=i.parent)i instanceof Ie&&i.index<0&&(null===(r=s.enter(e,n,o))||void 0===r?void 0:r.from)!=i.from&&(t=s);for(;;){let i=t.enter(e,n,o);if(!i)return t;t=i}}class Le{cursor(t=0){return new Qe(this,t)}getChild(t,e=null,n=null){let i=qe(this,t,e,n);return i.length?i[0]:null}getChildren(t,e=null,n=null){return qe(this,t,e,n)}resolve(t,e=0){return $e(this,t,e,!1)}resolveInner(t,e=0){return $e(this,t,e,!0)}matchContext(t){return Fe(this,t)}enterUnfinishedNodesBefore(t){let e=this.childBefore(t),n=this;for(;e;){let t=e.lastChild;if(!t||t.to!=e.to)break;t.type.isError&&t.from==t.to?(n=e,e=t.prevSibling):e=t}return n}get node(){return this}get next(){return this.parent}}class Ie extends Le{constructor(t,e,n,i){super(),this._tree=t,this.from=e,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,n,i,r=0){for(let o=this;;){for(let{children:s,positions:a}=o._tree,l=e>0?s.length:-1;t!=l;t+=e){let l=s[t],c=a[t]+o.from;if(Be(i,n,c,c+l.length))if(l instanceof De){if(r&Me.ExcludeBuffers)continue;let s=l.findChild(0,l.buffer.length,e,n-c,i);if(s>-1)return new je(new Ve(o,l,t,c),null,s)}else if(r&Me.IncludeAnonymous||!l.type.isAnonymous||We(l)){let s;if(!(r&Me.IgnoreMounts)&&(s=Se.get(l))&&!s.overlay)return new Ie(s.tree,c,t,o);let a=new Ie(l,c,t,o);return r&Me.IncludeAnonymous||!a.type.isAnonymous?a:a.nextChild(e<0?l.children.length-1:0,e,n,i)}}if(r&Me.IncludeAnonymous||!o.type.isAnonymous)return null;if(t=o.index>=0?o.index+e:e<0?-1:o._parent._tree.children.length,o=o._parent,!o)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,n=0){let i;if(!(n&Me.IgnoreOverlays)&&(i=Se.get(this._tree))&&i.overlay){let n=t-this.from;for(let{from:t,to:r}of i.overlay)if((e>0?t<=n:t<n)&&(e<0?r>=n:r>n))return new Ie(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,n)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function qe(t,e,n,i){let r=t.cursor(),o=[];if(!r.firstChild())return o;if(null!=n)for(;!r.type.is(n);)if(!r.nextSibling())return o;for(;;){if(null!=i&&r.type.is(i))return o;if(r.type.is(e)&&o.push(r.node),!r.nextSibling())return null==i?o:[]}}function Fe(t,e,n=e.length-1){for(let i=t.parent;n>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[n]&&e[n]!=i.name)return!1;n--}}return!0}class Ve{constructor(t,e,n,i){this.parent=t,this.buffer=e,this.index=n,this.start=i}}class je extends Le{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,n){super(),this.context=t,this._parent=e,this.index=n,this.type=t.buffer.set.types[t.buffer.buffer[n]]}child(t,e,n){let{buffer:i}=this.context,r=i.findChild(this.index+4,i.buffer[this.index+3],t,e-this.context.start,n);return r<0?null:new je(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,n=0){if(n&Me.ExcludeBuffers)return null;let{buffer:i}=this.context,r=i.findChild(this.index+4,i.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new je(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new je(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new je(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}get tree(){return null}toTree(){let t=[],e=[],{buffer:n}=this.context,i=this.index+4,r=n.buffer[this.index+3];if(r>i){let o=n.buffer[this.index+1];t.push(n.slice(i,r,o)),e.push(0)}return new Ne(this.type,t,e,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function He(t){if(!t.length)return null;let e=0,n=t[0];for(let i=1;i<t.length;i++){let r=t[i];(r.from>n.from||r.to<n.to)&&(n=r,e=i)}let i=n instanceof Ie&&n.index<0?null:n.parent,r=t.slice();return i?r[e]=i:r.splice(e,1),new ze(r,n)}class ze{constructor(t,e){this.heads=t,this.node=e}get next(){return He(this.heads)}}class Qe{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof Ie)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:n,buffer:i}=this.buffer;return this.type=e||i.set.types[i.buffer[t]],this.from=n+i.buffer[t+1],this.to=n+i.buffer[t+2],!0}yield(t){return!!t&&(t instanceof Ie?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,n){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,n,this.mode));let{buffer:i}=this.buffer,r=i.findChild(this.index+4,i.buffer[this.index+3],t,e-this.buffer.start,n);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,n=this.mode){return this.buffer?!(n&Me.ExcludeBuffers)&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Me.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&Me.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,n=this.stack.length-1;if(t<0){let t=n<0?0:this.stack[n]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(n<0?e.buffer.length:e.buffer[this.stack[n]+3]))return this.yieldBuf(t)}return n<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,n,{buffer:i}=this;if(i){if(t>0){if(this.index<i.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(i.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:n}=i)}else({index:e,_parent:n}=this._tree);for(;n;({index:e,_parent:n}=n))if(e>-1)for(let i=e+t,r=t<0?-1:n._tree.children.length;i!=r;i+=t){let t=n._tree.children[i];if(this.mode&Me.IncludeAnonymous||t instanceof De||!t.type.isAnonymous||We(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,n=0;if(t&&t.context==this.buffer)t:for(let i=this.index,r=this.stack.length;r>=0;){for(let o=t;o;o=o._parent)if(o.index==i){if(i==this.index)return o;e=o,n=r+1;break t}i=this.stack[--r]}for(let t=n;t<this.stack.length;t++)e=new je(this.buffer,e,this.stack[t]);return this.bufferNode=new je(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let n=0;;){let i=!1;if(this.type.isAnonymous||!1!==t(this)){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;i&&e&&e(this),i=this.type.isAnonymous,!this.nextSibling();){if(!n)return;this.parent(),n--,i=!0}}}matchContext(t){if(!this.buffer)return Fe(this.node,t);let{buffer:e}=this.buffer,{types:n}=e.set;for(let i=t.length-1,r=this.stack.length-1;i>=0;r--){if(r<0)return Fe(this.node,t,i);let o=n[e.buffer[this.stack[r]]];if(!o.isAnonymous){if(t[i]&&t[i]!=o.name)return!1;i--}}return!0}}function We(t){return t.children.some(t=>t instanceof De||!t.type.isAnonymous||We(t))}const Xe=new WeakMap;function Ue(t,e){if(!t.isAnonymous||e instanceof De||e.type!=t)return 1;let n=Xe.get(e);if(null==n){n=1;for(let i of e.children){if(i.type!=t||!(i instanceof Ne)){n=1;break}n+=Ue(t,i)}Xe.set(e,n)}return n}function Ge(t,e,n,i,r,o,s,a,l){let c=0;for(let n=i;n<r;n++)c+=Ue(t,e[n]);let h=Math.ceil(1.5*c/8),u=[],d=[];return function e(n,i,r,s,a){for(let c=r;c<s;){let r=c,p=i[c],f=Ue(t,n[c]);for(c++;c<s;c++){let e=Ue(t,n[c]);if(f+e>=h)break;f+=e}if(c==r+1){if(f>h){let t=n[r];e(t.children,t.positions,0,t.children.length,i[r]+a);continue}u.push(n[r])}else{let e=i[c-1]+n[c-1].length-p;u.push(Ge(t,n,i,r,c,p,e,null,l))}d.push(p+a-o)}}(e,n,i,r,0),(a||l)(u,d,s)}class Ye{constructor(t,e,n,i,r=!1,o=!1){this.from=t,this.to=e,this.tree=n,this.offset=i,this.open=(r?1:0)|(o?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(t,e=[],n=!1){let i=[new Ye(0,t.length,t,0,!1,n)];for(let n of e)n.to>t.length&&i.push(n);return i}static applyChanges(t,e,n=128){if(!e.length)return t;let i=[],r=1,o=t.length?t[0]:null;for(let s=0,a=0,l=0;;s++){let c=s<e.length?e[s]:null,h=c?c.fromA:1e9;if(h-a>=n)for(;o&&o.from<h;){let e=o;if(a>=e.from||h<=e.to||l){let t=Math.max(e.from,a)-l,n=Math.min(e.to,h)-l;e=t>=n?null:new Ye(t,n,e.tree,e.offset+l,s>0,!!c)}if(e&&i.push(e),o.to>h)break;o=r<t.length?t[r++]:null}if(!c)break;a=c.toA,l=c.toA-c.toB}return i}}class Ze{startParse(t,e,n){return"string"==typeof t&&(t=new Ke(t)),n=n?n.length?n.map(t=>new Oe(t.from,t.to)):[new Oe(0,0)]:[new Oe(0,t.length)],this.createParse(t,e||[],n)}parse(t,e,n){let i=this.startParse(t,e,n);for(;;){let t=i.advance();if(t)return t}}}class Ke{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}class Je{constructor(t,e,n,i,r){this.parser=t,this.parse=e,this.overlay=n,this.target=i,this.from=r}}function tn(t){if(!t.length||t.some(t=>t.from>=t.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(t))}class en{constructor(t,e,n,i,r,o,s){this.parser=t,this.predicate=e,this.mounts=n,this.index=i,this.start=r,this.target=o,this.prev=s,this.depth=0,this.ranges=[]}}const nn=new ke({perNode:!0});class rn{constructor(t,e,n,i,r){this.nest=e,this.input=n,this.fragments=i,this.ranges=r,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=t}advance(){if(this.baseParse){let t=this.baseParse.advance();if(!t)return null;if(this.baseParse=null,this.baseTree=t,this.startInner(),null!=this.stoppedAt)for(let t of this.inner)t.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let t=this.baseTree;return null!=this.stoppedAt&&(t=new Ne(t.type,t.children,t.positions,t.length,t.propValues.concat([[nn,this.stoppedAt]]))),t}let t=this.inner[this.innerDone],e=t.parse.advance();if(e){this.innerDone++;let n=Object.assign(Object.create(null),t.target.props);n[ke.mounted.id]=new Se(e,t.overlay,t.parser),t.target.props=n}return null}get parsedPos(){if(this.baseParse)return 0;let t=this.input.length;for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].from<t&&(t=Math.min(t,this.inner[e].parse.parsedPos));return t}stopAt(t){if(this.stoppedAt=t,this.baseParse)this.baseParse.stopAt(t);else for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].parse.stopAt(t)}startInner(){let t=new cn(this.fragments),e=null,n=null,i=new Qe(new Ie(this.baseTree,this.ranges[0].from,0,null),Me.IncludeAnonymous|Me.IgnoreMounts);t:for(let r,o;;){let s,a=!0;if(null!=this.stoppedAt&&i.from>=this.stoppedAt)a=!1;else if(t.hasNode(i)){if(e){let t=e.mounts.find(t=>t.frag.from<=i.from&&t.frag.to>=i.to&&t.mount.overlay);if(t)for(let n of t.mount.overlay){let r=n.from+t.pos,o=n.to+t.pos;r>=i.from&&o<=i.to&&!e.ranges.some(t=>t.from<o&&t.to>r)&&e.ranges.push({from:r,to:o})}}a=!1}else if(n&&(o=on(n.ranges,i.from,i.to)))a=2!=o;else if(!i.type.isAnonymous&&(r=this.nest(i,this.input))&&(i.from<i.to||!r.overlay)){i.tree||an(i);let o=t.findMounts(i.from,r.parser);if("function"==typeof r.overlay)e=new en(r.parser,r.overlay,o,this.inner.length,i.from,i.tree,e);else{let t=hn(this.ranges,r.overlay||(i.from<i.to?[new Oe(i.from,i.to)]:[]));t.length&&tn(t),!t.length&&r.overlay||this.inner.push(new Je(r.parser,t.length?r.parser.startParse(this.input,dn(o,t),t):r.parser.startParse(""),r.overlay?r.overlay.map(t=>new Oe(t.from-i.from,t.to-i.from)):null,i.tree,t.length?t[0].from:i.from)),r.overlay?t.length&&(n={ranges:t,depth:0,prev:n}):a=!1}}else e&&(s=e.predicate(i))&&(!0===s&&(s=new Oe(i.from,i.to)),s.from<s.to&&e.ranges.push(s));if(a&&i.firstChild())e&&e.depth++,n&&n.depth++;else for(;!i.nextSibling();){if(!i.parent())break t;if(e&&! --e.depth){let t=hn(this.ranges,e.ranges);t.length&&(tn(t),this.inner.splice(e.index,0,new Je(e.parser,e.parser.startParse(this.input,dn(e.mounts,t),t),e.ranges.map(t=>new Oe(t.from-e.start,t.to-e.start)),e.target,t[0].from))),e=e.prev}n&&! --n.depth&&(n=n.prev)}}}}function on(t,e,n){for(let i of t){if(i.from>=n)break;if(i.to>e)return i.from<=e&&i.to>=n?2:1}return 0}function sn(t,e,n,i,r,o){if(e<n){let s=t.buffer[e+1];i.push(t.slice(e,n,s)),r.push(s-o)}}function an(t){let{node:e}=t,n=[],i=e.context.buffer;do{n.push(t.index),t.parent()}while(!t.tree);let r=t.tree,o=r.children.indexOf(i),s=r.children[o],a=s.buffer,l=[o];r.children[o]=function t(i,r,o,c,h,u){let d=n[u],p=[],f=[];sn(s,i,d,p,f,c);let g=a[d+1],m=a[d+2];l.push(p.length);let v=u?t(d+4,a[d+3],s.set.types[a[d]],g,m-g,u-1):e.toTree();return p.push(v),f.push(g-c),sn(s,a[d+3],r,p,f,c),new Ne(o,p,f,h)}(0,a.length,Ce.none,0,s.length,n.length-1);for(let e of l){let n=t.tree.children[e],i=t.tree.positions[e];t.yield(new Ie(n,i+t.from,e,t._tree))}}class ln{constructor(t,e){this.offset=e,this.done=!1,this.cursor=t.cursor(Me.IncludeAnonymous|Me.IgnoreMounts)}moveTo(t){let{cursor:e}=this,n=t-this.offset;for(;!this.done&&e.from<n;)e.to>=t&&e.enter(n,1,Me.IgnoreOverlays|Me.ExcludeBuffers)||e.next(!1)||(this.done=!0)}hasNode(t){if(this.moveTo(t.from),!this.done&&this.cursor.from+this.offset==t.from&&this.cursor.tree)for(let e=this.cursor.tree;;){if(e==t.tree)return!0;if(!(e.children.length&&0==e.positions[0]&&e.children[0]instanceof Ne))break;e=e.children[0]}return!1}}let cn=class{constructor(t){var e;if(this.fragments=t,this.curTo=0,this.fragI=0,t.length){let n=this.curFrag=t[0];this.curTo=null!==(e=n.tree.prop(nn))&&void 0!==e?e:n.to,this.inner=new ln(n.tree,-n.offset)}else this.curFrag=this.inner=null}hasNode(t){for(;this.curFrag&&t.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=t.from&&this.curTo>=t.to&&this.inner.hasNode(t)}nextFrag(){var t;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let e=this.curFrag=this.fragments[this.fragI];this.curTo=null!==(t=e.tree.prop(nn))&&void 0!==t?t:e.to,this.inner=new ln(e.tree,-e.offset)}}findMounts(t,e){var n;let i=[];if(this.inner){this.inner.cursor.moveTo(t,1);for(let t=this.inner.cursor.node;t;t=t.parent){let r=null===(n=t.tree)||void 0===n?void 0:n.prop(ke.mounted);if(r&&r.parser==e)for(let e=this.fragI;e<this.fragments.length;e++){let n=this.fragments[e];if(n.from>=t.to)break;n.tree==this.curFrag.tree&&i.push({frag:n,pos:t.from-n.offset,mount:r})}}}return i}};function hn(t,e){let n=null,i=e;for(let r=1,o=0;r<t.length;r++){let s=t[r-1].to,a=t[r].from;for(;o<i.length;o++){let t=i[o];if(t.from>=a)break;t.to<=s||(n||(i=n=e.slice()),t.from<s?(n[o]=new Oe(t.from,s),t.to>a&&n.splice(o+1,0,new Oe(a,t.to))):t.to>a?n[o--]=new Oe(a,t.to):n.splice(o--,1))}}return i}function un(t,e,n,i){let r=0,o=0,s=!1,a=!1,l=-1e9,c=[];for(;;){let h=r==t.length?1e9:s?t[r].to:t[r].from,u=o==e.length?1e9:a?e[o].to:e[o].from;if(s!=a){let t=Math.max(l,n),e=Math.min(h,u,i);t<e&&c.push(new Oe(t,e))}if(l=Math.min(h,u),1e9==l)break;h==l&&(s?(s=!1,r++):s=!0),u==l&&(a?(a=!1,o++):a=!0)}return c}function dn(t,e){let n=[];for(let{pos:i,mount:r,frag:o}of t){let t=i+(r.overlay?r.overlay[0].from:0),s=t+r.tree.length,a=Math.max(o.from,t),l=Math.min(o.to,s);if(r.overlay){let s=r.overlay.map(t=>new Oe(t.from+i,t.to+i)),c=un(e,s,a,l);for(let e=0,i=a;;e++){let s=e==c.length,a=s?l:c[e].from;if(a>i&&n.push(new Ye(i,a,r.tree,-t,o.from>=i||o.openStart,o.to<=a||o.openEnd)),s)break;i=c[e].to}}else n.push(new Ye(a,l,r.tree,-t,o.from>=t||o.openStart,o.to<=s||o.openEnd))}return n}class pn{constructor(t,e,n,i,r,o,s,a,l,c=0,h){this.p=t,this.stack=e,this.state=n,this.reducePos=i,this.pos=r,this.score=o,this.buffer=s,this.bufferBase=a,this.curContext=l,this.lookAhead=c,this.parent=h}toString(){return`[${this.stack.filter((t,e)=>e%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,e,n=0){let i=t.parser.context;return new pn(t,[],e,n,n,0,[],0,i?new fn(i,i.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(t,e){this.stack.push(this.state,e,this.bufferBase+this.buffer.length),this.state=t}reduce(t){var e;let n=t>>19,i=65535&t,{parser:r}=this.p,o=r.dynamicPrecedence(i);if(o&&(this.score+=o),0==n)return this.pushState(r.getGoto(this.state,i,!0),this.reducePos),i<r.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,4,!0),void this.reduceContext(i,this.reducePos);let s=this.stack.length-3*(n-1)-(262144&t?6:0),a=s?this.stack[s-2]:this.p.ranges[0].from,l=this.reducePos-a;l>=2e3&&!(null===(e=this.p.parser.nodeSet.types[i])||void 0===e?void 0:e.isAnonymous)&&(a==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=l):this.p.lastBigReductionSize<l&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=a,this.p.lastBigReductionSize=l));let c=s?this.stack[s-1]:0,h=this.bufferBase+this.buffer.length-c;if(i<r.minRepeatTerm||131072&t){let t=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,a,t,h+4,!0)}if(262144&t)this.state=this.stack[s];else{let t=this.stack[s-3];this.state=r.getGoto(t,i,!0)}for(;this.stack.length>s;)this.stack.pop();this.reduceContext(i,a)}storeNode(t,e,n,i=4,r=!1){if(0==t&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let t=this,i=this.buffer.length;if(0==i&&t.parent&&(i=t.bufferBase-t.parent.bufferBase,t=t.parent),i>0&&0==t.buffer[i-4]&&t.buffer[i-1]>-1){if(e==n)return;if(t.buffer[i-2]>=e)return void(t.buffer[i-2]=n)}}if(r&&this.pos!=n){let r=this.buffer.length;if(r>0&&0!=this.buffer[r-4])for(;r>0&&this.buffer[r-2]>n;)this.buffer[r]=this.buffer[r-4],this.buffer[r+1]=this.buffer[r-3],this.buffer[r+2]=this.buffer[r-2],this.buffer[r+3]=this.buffer[r-1],r-=4,i>4&&(i-=4);this.buffer[r]=t,this.buffer[r+1]=e,this.buffer[r+2]=n,this.buffer[r+3]=i}else this.buffer.push(t,e,n,i)}shift(t,e,n,i){if(131072&t)this.pushState(65535&t,this.pos);else if(262144&t)this.pos=i,this.shiftContext(e,n),e<=this.p.parser.maxNode&&this.buffer.push(e,n,i,4);else{let r=t,{parser:o}=this.p;(i>this.pos||e<=o.maxNode)&&(this.pos=i,o.stateFlag(r,1)||(this.reducePos=i)),this.pushState(r,n),this.shiftContext(e,n),e<=o.maxNode&&this.buffer.push(e,n,i,4)}}apply(t,e,n,i){65536&t?this.reduce(t):this.shift(t,e,n,i)}useNode(t,e){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=t)&&(this.p.reused.push(t),n++);let i=this.pos;this.reducePos=this.pos=i+t.length,this.pushState(e,i),this.buffer.push(n,i,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,t,this,this.p.stream.reset(this.pos-t.length)))}split(){let t=this,e=t.buffer.length;for(;e>0&&t.buffer[e-2]>t.reducePos;)e-=4;let n=t.buffer.slice(e),i=t.bufferBase+e;for(;t&&i==t.bufferBase;)t=t.parent;return new pn(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,i,this.curContext,this.lookAhead,t)}recoverByDelete(t,e){let n=t<=this.p.parser.maxNode;n&&this.storeNode(t,this.pos,e,4),this.storeNode(0,this.pos,e,n?8:4),this.pos=this.reducePos=e,this.score-=190}canShift(t){for(let e=new gn(this);;){let n=this.p.parser.stateSlot(e.state,4)||this.p.parser.hasAction(e.state,t);if(0==n)return!1;if(!(65536&n))return!0;e.reduce(n)}}recoverByInsert(t){if(this.stack.length>=300)return[];let e=this.p.parser.nextStates(this.state);if(e.length>8||this.stack.length>=120){let n=[];for(let i,r=0;r<e.length;r+=2)(i=e[r+1])!=this.state&&this.p.parser.hasAction(i,t)&&n.push(e[r],i);if(this.stack.length<120)for(let t=0;n.length<8&&t<e.length;t+=2){let i=e[t+1];n.some((t,e)=>1&e&&t==i)||n.push(e[t],i)}e=n}let n=[];for(let t=0;t<e.length&&n.length<4;t+=2){let i=e[t+1];if(i==this.state)continue;let r=this.split();r.pushState(i,this.pos),r.storeNode(0,r.pos,r.pos,4,!0),r.shiftContext(e[t],this.pos),r.reducePos=this.pos,r.score-=200,n.push(r)}return n}forceReduce(){let{parser:t}=this.p,e=t.stateSlot(this.state,5);if(!(65536&e))return!1;if(!t.validAction(this.state,e)){let n=e>>19,i=65535&e,r=this.stack.length-3*n;if(r<0||t.getGoto(this.stack[r],i,!1)<0){let t=this.findForcedReduction();if(null==t)return!1;e=t}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}findForcedReduction(){let{parser:t}=this.p,e=[],n=(i,r)=>{if(!e.includes(i))return e.push(i),t.allActions(i,e=>{if(393216&e);else if(65536&e){let n=(e>>19)-r;if(n>1){let i=65535&e,r=this.stack.length-3*n;if(r>=0&&t.getGoto(this.stack[r],i,!1)>=0)return n<<19|65536|i}}else{let t=n(e,r+1);if(null!=t)return t}})};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:t}=this.p;return 65535==t.data[t.stateSlot(this.state,1)]&&!t.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(t){if(this.state!=t.state||this.stack.length!=t.stack.length)return!1;for(let e=0;e<this.stack.length;e+=3)if(this.stack[e]!=t.stack[e])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(t){return this.p.parser.dialect.flags[t]}shiftContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,t,this,this.p.stream.reset(e)))}reduceContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,t,this,this.p.stream.reset(e)))}emitContext(){let t=this.buffer.length-1;(t<0||-3!=this.buffer[t])&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let t=this.buffer.length-1;(t<0||-4!=this.buffer[t])&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(t){if(t!=this.curContext.context){let e=new fn(this.curContext.tracker,t);e.hash!=this.curContext.hash&&this.emitContext(),this.curContext=e}}setLookAhead(t){t>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=t)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class fn{constructor(t,e){this.tracker=t,this.context=e,this.hash=t.strict?t.hash(e):0}}class gn{constructor(t){this.start=t,this.state=t.state,this.stack=t.stack,this.base=this.stack.length}reduce(t){let e=65535&t,n=t>>19;0==n?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(n-1);let i=this.start.p.parser.getGoto(this.stack[this.base-3],e,!0);this.state=i}}class mn{constructor(t,e,n){this.stack=t,this.pos=e,this.index=n,this.buffer=t.buffer,0==this.index&&this.maybeNext()}static create(t,e=t.bufferBase+t.buffer.length){return new mn(t,e,e-t.bufferBase)}maybeNext(){let t=this.stack.parent;null!=t&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new mn(this.stack,this.pos,this.index)}}function vn(t,e=Uint16Array){if("string"!=typeof t)return t;let n=null;for(let i=0,r=0;i<t.length;){let o=0;for(;;){let e=t.charCodeAt(i++),n=!1;if(126==e){o=65535;break}e>=92&&e--,e>=34&&e--;let r=e-32;if(r>=46&&(r-=46,n=!0),o+=r,n)break;o*=46}n?n[r++]=o:n=new e(o)}return n}class yn{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const bn=new yn;class xn{constructor(t,e){this.input=t,this.ranges=e,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=bn,this.rangeIndex=0,this.pos=this.chunkPos=e[0].from,this.range=e[0],this.end=e[e.length-1].to,this.readNext()}resolveOffset(t,e){let n=this.range,i=this.rangeIndex,r=this.pos+t;for(;r<n.from;){if(!i)return null;let t=this.ranges[--i];r-=n.from-t.to,n=t}for(;e<0?r>n.to:r>=n.to;){if(i==this.ranges.length-1)return null;let t=this.ranges[++i];r+=t.from-n.to,n=t}return r}clipPos(t){if(t>=this.range.from&&t<this.range.to)return t;for(let e of this.ranges)if(e.to>t)return Math.max(t,e.from);return this.end}peek(t){let e,n,i=this.chunkOff+t;if(i>=0&&i<this.chunk.length)e=this.pos+t,n=this.chunk.charCodeAt(i);else{let i=this.resolveOffset(t,1);if(null==i)return-1;if(e=i,e>=this.chunk2Pos&&e<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(e-this.chunk2Pos);else{let t=this.rangeIndex,i=this.range;for(;i.to<=e;)i=this.ranges[++t];this.chunk2=this.input.chunk(this.chunk2Pos=e),e+this.chunk2.length>i.to&&(this.chunk2=this.chunk2.slice(0,i.to-e)),n=this.chunk2.charCodeAt(0)}}return e>=this.token.lookAhead&&(this.token.lookAhead=e+1),n}acceptToken(t,e=0){let n=e?this.resolveOffset(e,-1):this.pos;if(null==n||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=t,this.token.end=n}acceptTokenTo(t,e){this.token.value=t,this.token.end=e}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:t,chunkPos:e}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=t,this.chunk2Pos=e,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let t=this.input.chunk(this.pos),e=this.pos+t.length;this.chunk=e>this.range.to?t.slice(0,this.range.to-this.pos):t,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(t=1){for(this.chunkOff+=t;this.pos+t>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();t-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=t,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(t,e){if(e?(this.token=e,e.start=t,e.lookAhead=t+1,e.value=e.extended=-1):this.token=bn,this.pos!=t){if(this.pos=t,t==this.end)return this.setDone(),this;for(;t<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;t>=this.range.to;)this.range=this.ranges[++this.rangeIndex];t>=this.chunkPos&&t<this.chunkPos+this.chunk.length?this.chunkOff=t-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(t,e){if(t>=this.chunkPos&&e<=this.chunkPos+this.chunk.length)return this.chunk.slice(t-this.chunkPos,e-this.chunkPos);if(t>=this.chunk2Pos&&e<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(t-this.chunk2Pos,e-this.chunk2Pos);if(t>=this.range.from&&e<=this.range.to)return this.input.read(t,e);let n="";for(let i of this.ranges){if(i.from>=e)break;i.to>t&&(n+=this.input.read(Math.max(i.from,t),Math.min(i.to,e)))}return n}}class wn{constructor(t,e){this.data=t,this.id=e}token(t,e){let{parser:n}=e.p;!function(t,e,n,i,r,o){let s=0,a=1<<i,{dialect:l}=n.p.parser;t:for(;0!=(a&t[s]);){let n=t[s+1];for(let i=s+3;i<n;i+=2)if((t[i+1]&a)>0){let n=t[i];if(l.allows(n)&&(-1==e.token.value||e.token.value==n||kn(n,e.token.value,r,o))){e.acceptToken(n);break}}let i=e.next,c=0,h=t[s+2];if(!(e.next<0&&h>c&&65535==t[n+3*h-3])){for(;c<h;){let r=c+h>>1,o=n+r+(r<<1),a=t[o],l=t[o+1]||65536;if(i<a)h=r;else{if(!(i>=l)){s=t[o+2],e.advance();continue t}c=r+1}}break}s=t[n+3*h-1]}}(this.data,t,e,this.id,n.data,n.tokenPrecTable)}}wn.prototype.contextual=wn.prototype.fallback=wn.prototype.extend=!1,wn.prototype.fallback=wn.prototype.extend=!1;class _n{constructor(t,e={}){this.token=t,this.contextual=!!e.contextual,this.fallback=!!e.fallback,this.extend=!!e.extend}}function On(t,e,n){for(let i,r=e;65535!=(i=t[r]);r++)if(i==n)return r-e;return-1}function kn(t,e,n,i){let r=On(n,i,e);return r<0||On(n,i,t)<r}const Sn="undefined"!=typeof process&&process.env&&/\bparse\b/.test(process.env.LOG);let En=null;function Cn(t,e,n){let i=t.cursor(Me.IncludeAnonymous);for(i.moveTo(e);;)if(!(n<0?i.childBefore(e):i.childAfter(e)))for(;;){if((n<0?i.to<e:i.from>e)&&!i.type.isError)return n<0?Math.max(0,Math.min(i.to-1,e-25)):Math.min(t.length,Math.max(i.from+1,e+25));if(n<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return n<0?0:t.length}}let An=class{constructor(t,e){this.fragments=t,this.nodeSet=e,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let t=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(t){for(this.safeFrom=t.openStart?Cn(t.tree,t.from+t.offset,1)-t.offset:t.from,this.safeTo=t.openEnd?Cn(t.tree,t.to+t.offset,-1)-t.offset:t.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(t.tree),this.start.push(-t.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(t){if(t<this.nextStart)return null;for(;this.fragment&&this.safeTo<=t;)this.nextFragment();if(!this.fragment)return null;for(;;){let e=this.trees.length-1;if(e<0)return this.nextFragment(),null;let n=this.trees[e],i=this.index[e];if(i==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let r=n.children[i],o=this.start[e]+n.positions[i];if(o>t)return this.nextStart=o,null;if(r instanceof Ne){if(o==t){if(o<this.safeFrom)return null;let t=o+r.length;if(t<=this.safeTo){let e=r.prop(ke.lookAhead);if(!e||t+e<this.fragment.to)return r}}this.index[e]++,o+r.length>=Math.max(this.safeFrom,t)&&(this.trees.push(r),this.start.push(o),this.index.push(0))}else this.index[e]++,this.nextStart=o+r.length}}};class Tn{constructor(t,e){this.stream=e,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=t.tokenizers.map(t=>new yn)}getActions(t){let e=0,n=null,{parser:i}=t.p,{tokenizers:r}=i,o=i.stateSlot(t.state,3),s=t.curContext?t.curContext.hash:0,a=0;for(let i=0;i<r.length;i++){if(!(1<<i&o))continue;let l=r[i],c=this.tokens[i];if((!n||l.fallback)&&((l.contextual||c.start!=t.pos||c.mask!=o||c.context!=s)&&(this.updateCachedToken(c,l,t),c.mask=o,c.context=s),c.lookAhead>c.end+25&&(a=Math.max(c.lookAhead,a)),0!=c.value)){let i=e;if(c.extended>-1&&(e=this.addActions(t,c.extended,c.end,e)),e=this.addActions(t,c.value,c.end,e),!l.extend&&(n=c,e>i))break}}for(;this.actions.length>e;)this.actions.pop();return a&&t.setLookAhead(a),n||t.pos!=this.stream.end||(n=new yn,n.value=t.p.parser.eofTerm,n.start=n.end=t.pos,e=this.addActions(t,n.value,n.end,e)),this.mainToken=n,this.actions}getMainToken(t){if(this.mainToken)return this.mainToken;let e=new yn,{pos:n,p:i}=t;return e.start=n,e.end=Math.min(n+1,i.stream.end),e.value=n==i.stream.end?i.parser.eofTerm:0,e}updateCachedToken(t,e,n){let i=this.stream.clipPos(n.pos);if(e.token(this.stream.reset(i,t),n),t.value>-1){let{parser:e}=n.p;for(let i=0;i<e.specialized.length;i++)if(e.specialized[i]==t.value){let r=e.specializers[i](this.stream.read(t.start,t.end),n);if(r>=0&&n.p.parser.dialect.allows(r>>1)){1&r?t.extended=r>>1:t.value=r>>1;break}}}else t.value=0,t.end=this.stream.clipPos(i+1)}putAction(t,e,n,i){for(let e=0;e<i;e+=3)if(this.actions[e]==t)return i;return this.actions[i++]=t,this.actions[i++]=e,this.actions[i++]=n,i}addActions(t,e,n,i){let{state:r}=t,{parser:o}=t.p,{data:s}=o;for(let t=0;t<2;t++)for(let a=o.stateSlot(r,t?2:1);;a+=3){if(65535==s[a]){if(1!=s[a+1]){0==i&&2==s[a+1]&&(i=this.putAction($n(s,a+2),e,n,i));break}a=$n(s,a+2)}s[a]==e&&(i=this.putAction($n(s,a+1),e,n,i))}return i}}class Pn{constructor(t,e,n,i){this.parser=t,this.input=e,this.ranges=i,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new xn(e,i),this.tokens=new Tn(t,this.stream),this.topTerm=t.top[1];let{from:r}=i[0];this.stacks=[pn.start(this,t.top[0],r)],this.fragments=n.length&&this.stream.end-r>4*t.bufferLength?new An(n,t.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let t,e,n=this.stacks,i=this.minStackPos,r=this.stacks=[];if(this.bigReductionCount>300&&1==n.length){let[t]=n;for(;t.forceReduce()&&t.stack.length&&t.stack[t.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<n.length;o++){let s=n[o];for(;;){if(this.tokens.mainToken=null,s.pos>i)r.push(s);else{if(this.advanceStack(s,r,n))continue;{t||(t=[],e=[]),t.push(s);let n=this.tokens.getMainToken(s);e.push(n.value,n.end)}}break}}if(!r.length){let e=t&&function(t){let e=null;for(let n of t){let t=n.p.stoppedAt;(n.pos==n.p.stream.end||null!=t&&n.pos>t)&&n.p.parser.stateFlag(n.state,2)&&(!e||e.score<n.score)&&(e=n)}return e}(t);if(e)return Sn&&console.log("Finish with "+this.stackID(e)),this.stackToTree(e);if(this.parser.strict)throw Sn&&t&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+i);this.recovering||(this.recovering=5)}if(this.recovering&&t){let n=null!=this.stoppedAt&&t[0].pos>this.stoppedAt?t[0]:this.runRecovery(t,e,r);if(n)return Sn&&console.log("Force-finish "+this.stackID(n)),this.stackToTree(n.forceAll())}if(this.recovering){let t=1==this.recovering?1:3*this.recovering;if(r.length>t)for(r.sort((t,e)=>e.score-t.score);r.length>t;)r.pop();r.some(t=>t.reducePos>i)&&this.recovering--}else if(r.length>1){t:for(let t=0;t<r.length-1;t++){let e=r[t];for(let n=t+1;n<r.length;n++){let i=r[n];if(e.sameState(i)||e.buffer.length>500&&i.buffer.length>500){if(!((e.score-i.score||e.buffer.length-i.buffer.length)>0)){r.splice(t--,1);continue t}r.splice(n--,1)}}}r.length>12&&r.splice(12,r.length-12)}this.minStackPos=r[0].pos;for(let t=1;t<r.length;t++)r[t].pos<this.minStackPos&&(this.minStackPos=r[t].pos);return null}stopAt(t){if(null!=this.stoppedAt&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}advanceStack(t,e,n){let i=t.pos,{parser:r}=this,o=Sn?this.stackID(t)+" -> ":"";if(null!=this.stoppedAt&&i>this.stoppedAt)return t.forceReduce()?t:null;if(this.fragments){let e=t.curContext&&t.curContext.tracker.strict,n=e?t.curContext.hash:0;for(let s=this.fragments.nodeAt(i);s;){let i=this.parser.nodeSet.types[s.type.id]==s.type?r.getGoto(t.state,s.type.id):-1;if(i>-1&&s.length&&(!e||(s.prop(ke.contextHash)||0)==n))return t.useNode(s,i),Sn&&console.log(o+this.stackID(t)+` (via reuse of ${r.getName(s.type.id)})`),!0;if(!(s instanceof Ne)||0==s.children.length||s.positions[0]>0)break;let a=s.children[0];if(!(a instanceof Ne&&0==s.positions[0]))break;s=a}}let s=r.stateSlot(t.state,4);if(s>0)return t.reduce(s),Sn&&console.log(o+this.stackID(t)+` (via always-reduce ${r.getName(65535&s)})`),!0;if(t.stack.length>=8400)for(;t.stack.length>6e3&&t.forceReduce(););let a=this.tokens.getActions(t);for(let s=0;s<a.length;){let l=a[s++],c=a[s++],h=a[s++],u=s==a.length||!n,d=u?t:t.split(),p=this.tokens.mainToken;if(d.apply(l,c,p?p.start:d.pos,h),Sn&&console.log(o+this.stackID(d)+` (via ${65536&l?`reduce of ${r.getName(65535&l)}`:"shift"} for ${r.getName(c)} @ ${i}${d==t?"":", split"})`),u)return!0;d.pos>i?e.push(d):n.push(d)}return!1}advanceFully(t,e){let n=t.pos;for(;;){if(!this.advanceStack(t,null,null))return!1;if(t.pos>n)return Mn(t,e),!0}}runRecovery(t,e,n){let i=null,r=!1;for(let o=0;o<t.length;o++){let s=t[o],a=e[o<<1],l=e[1+(o<<1)],c=Sn?this.stackID(s)+" -> ":"";if(s.deadEnd){if(r)continue;if(r=!0,s.restart(),Sn&&console.log(c+this.stackID(s)+" (restarted)"),this.advanceFully(s,n))continue}let h=s.split(),u=c;for(let t=0;h.forceReduce()&&t<10&&(Sn&&console.log(u+this.stackID(h)+" (via force-reduce)"),!this.advanceFully(h,n));t++)Sn&&(u=this.stackID(h)+" -> ");for(let t of s.recoverByInsert(a))Sn&&console.log(c+this.stackID(t)+" (via recover-insert)"),this.advanceFully(t,n);this.stream.end>s.pos?(l==s.pos&&(l++,a=0),s.recoverByDelete(a,l),Sn&&console.log(c+this.stackID(s)+` (via recover-delete ${this.parser.getName(a)})`),Mn(s,n)):(!i||i.score<s.score)&&(i=s)}return i}stackToTree(t){return t.close(),Ne.build({buffer:mn.create(t),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:t.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(t){let e=(En||(En=new WeakMap)).get(t);return e||En.set(t,e=String.fromCodePoint(this.nextStackID++)),e+t}}function Mn(t,e){for(let n=0;n<e.length;n++){let i=e[n];if(i.pos==t.pos&&i.sameState(t))return void(e[n].score<t.score&&(e[n]=t))}e.push(t)}class Nn{constructor(t,e,n){this.source=t,this.flags=e,this.disabled=n}allows(t){return!this.disabled||0==this.disabled[t]}}const Rn=t=>t;class Dn{constructor(t){this.start=t.start,this.shift=t.shift||Rn,this.reduce=t.reduce||Rn,this.reuse=t.reuse||Rn,this.hash=t.hash||(()=>0),this.strict=!1!==t.strict}}class Bn extends Ze{constructor(t){if(super(),this.wrappers=[],14!=t.version)throw new RangeError(`Parser version (${t.version}) doesn't match runtime version (14)`);let e=t.nodeNames.split(" ");this.minRepeatTerm=e.length;for(let n=0;n<t.repeatNodeCount;n++)e.push("");let n=Object.keys(t.topRules).map(e=>t.topRules[e][1]),i=[];for(let t=0;t<e.length;t++)i.push([]);function r(t,e,n){i[t].push([e,e.deserialize(String(n))])}if(t.nodeProps)for(let e of t.nodeProps){let t=e[0];"string"==typeof t&&(t=ke[t]);for(let n=1;n<e.length;){let i=e[n++];if(i>=0)r(i,t,e[n++]);else{let o=e[n+-i];for(let s=-i;s>0;s--)r(e[n++],t,o);n++}}}this.nodeSet=new Ae(e.map((e,r)=>Ce.define({name:r>=this.minRepeatTerm?void 0:e,id:r,props:i[r],top:n.indexOf(r)>-1,error:0==r,skipped:t.skippedNodes&&t.skippedNodes.indexOf(r)>-1}))),t.propSources&&(this.nodeSet=this.nodeSet.extend(...t.propSources)),this.strict=!1,this.bufferLength=we;let o=vn(t.tokenData);this.context=t.context,this.specializerSpecs=t.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let t=0;t<this.specializerSpecs.length;t++)this.specialized[t]=this.specializerSpecs[t].term;this.specializers=this.specializerSpecs.map(Ln),this.states=vn(t.states,Uint32Array),this.data=vn(t.stateData),this.goto=vn(t.goto),this.maxTerm=t.maxTerm,this.tokenizers=t.tokenizers.map(t=>"number"==typeof t?new wn(o,t):t),this.topRules=t.topRules,this.dialects=t.dialects||{},this.dynamicPrecedences=t.dynamicPrecedences||null,this.tokenPrecTable=t.tokenPrec,this.termNames=t.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(t,e,n){let i=new Pn(this,t,e,n);for(let r of this.wrappers)i=r(i,t,e,n);return i}getGoto(t,e,n=!1){let i=this.goto;if(e>=i[0])return-1;for(let r=i[e+1];;){let e=i[r++],o=1&e,s=i[r++];if(o&&n)return s;for(let n=r+(e>>1);r<n;r++)if(i[r]==t)return s;if(o)return-1}}hasAction(t,e){let n=this.data;for(let i=0;i<2;i++)for(let r,o=this.stateSlot(t,i?2:1);;o+=3){if(65535==(r=n[o])){if(1!=n[o+1]){if(2==n[o+1])return $n(n,o+2);break}r=n[o=$n(n,o+2)]}if(r==e||0==r)return $n(n,o+1)}return 0}stateSlot(t,e){return this.states[6*t+e]}stateFlag(t,e){return(this.stateSlot(t,0)&e)>0}validAction(t,e){return!!this.allActions(t,t=>t==e||null)}allActions(t,e){let n=this.stateSlot(t,4),i=n?e(n):void 0;for(let n=this.stateSlot(t,1);null==i;n+=3){if(65535==this.data[n]){if(1!=this.data[n+1])break;n=$n(this.data,n+2)}i=e($n(this.data,n+1))}return i}nextStates(t){let e=[];for(let n=this.stateSlot(t,1);;n+=3){if(65535==this.data[n]){if(1!=this.data[n+1])break;n=$n(this.data,n+2)}if(!(1&this.data[n+2])){let t=this.data[n+1];e.some((e,n)=>1&n&&e==t)||e.push(this.data[n],t)}}return e}configure(t){let e=Object.assign(Object.create(Bn.prototype),this);if(t.props&&(e.nodeSet=this.nodeSet.extend(...t.props)),t.top){let n=this.topRules[t.top];if(!n)throw new RangeError(`Invalid top rule name ${t.top}`);e.top=n}return t.tokenizers&&(e.tokenizers=this.tokenizers.map(e=>{let n=t.tokenizers.find(t=>t.from==e);return n?n.to:e})),t.specializers&&(e.specializers=this.specializers.slice(),e.specializerSpecs=this.specializerSpecs.map((n,i)=>{let r=t.specializers.find(t=>t.from==n.external);if(!r)return n;let o=Object.assign(Object.assign({},n),{external:r.to});return e.specializers[i]=Ln(o),o})),t.contextTracker&&(e.context=t.contextTracker),t.dialect&&(e.dialect=this.parseDialect(t.dialect)),null!=t.strict&&(e.strict=t.strict),t.wrap&&(e.wrappers=e.wrappers.concat(t.wrap)),null!=t.bufferLength&&(e.bufferLength=t.bufferLength),e}hasWrappers(){return this.wrappers.length>0}getName(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.nodeSet.types[t].name||t)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(t){let e=this.dynamicPrecedences;return null==e?0:e[t]||0}parseDialect(t){let e=Object.keys(this.dialects),n=e.map(()=>!1);if(t)for(let i of t.split(" ")){let t=e.indexOf(i);t>=0&&(n[t]=!0)}let i=null;for(let t=0;t<e.length;t++)if(!n[t])for(let n,r=this.dialects[e[t]];65535!=(n=this.data[r++]);)(i||(i=new Uint8Array(this.maxTerm+1)))[n]=1;return new Nn(t,n,i)}static deserialize(t){return new Bn(t)}}function $n(t,e){return t[e]|t[e+1]<<16}function Ln(t){if(t.external){let e=t.extend?1:0;return(n,i)=>t.external(n,i)<<1|e}return t.get}let In=0;class qn{constructor(t,e,n){this.set=t,this.base=e,this.modified=n,this.id=In++}static define(t){if(null==t?void 0:t.base)throw new Error("Can not derive from a modified tag");let e=new qn([],null,[]);if(e.set.push(e),t)for(let n of t.set)e.set.push(n);return e}static defineModifier(){let t=new Vn;return e=>e.modified.indexOf(t)>-1?e:Vn.get(e.base||e,e.modified.concat(t).sort((t,e)=>t.id-e.id))}}let Fn=0;class Vn{constructor(){this.instances=[],this.id=Fn++}static get(t,e){if(!e.length)return t;let n=e[0].instances.find(n=>n.base==t&&function(t,e){return t.length==e.length&&t.every((t,n)=>t==e[n])}(e,n.modified));if(n)return n;let i=[],r=new qn(i,t,e);for(let t of e)t.instances.push(r);let o=function(t){let e=[[]];for(let n=0;n<t.length;n++)for(let i=0,r=e.length;i<r;i++)e.push(e[i].concat(t[n]));return e.sort((t,e)=>e.length-t.length)}(e);for(let e of t.set)if(!e.modified.length)for(let t of o)i.push(Vn.get(e,t));return r}}function jn(t){let e=Object.create(null);for(let n in t){let i=t[n];Array.isArray(i)||(i=[i]);for(let t of n.split(" "))if(t){let n=[],r=2,o=t;for(let e=0;;){if("..."==o&&e>0&&e+3==t.length){r=1;break}let i=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(o);if(!i)throw new RangeError("Invalid path: "+t);if(n.push("*"==i[0]?"":'"'==i[0][0]?JSON.parse(i[0]):i[0]),e+=i[0].length,e==t.length)break;let s=t[e++];if(e==t.length&&"!"==s){r=0;break}if("/"!=s)throw new RangeError("Invalid path: "+t);o=t.slice(e)}let s=n.length-1,a=n[s];if(!a)throw new RangeError("Invalid path: "+t);let l=new zn(i,r,s>0?n.slice(0,s):null);e[a]=l.sort(e[a])}}return Hn.add(e)}const Hn=new ke;class zn{constructor(t,e,n,i){this.tags=t,this.mode=e,this.context=n,this.next=i}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}function Qn(t,e){let n=Object.create(null);for(let e of t)if(Array.isArray(e.tag))for(let t of e.tag)n[t.id]=e.class;else n[e.tag.id]=e.class;let{scope:i,all:r=null}=e||{};return{style:t=>{let e=r;for(let i of t)for(let t of i.set){let i=n[t.id];if(i){e=e?e+" "+i:i;break}}return e},scope:i}}function Wn(t,e,n,i=0,r=t.length){let o=new Xn(i,Array.isArray(e)?e:[e],n);o.highlightRange(t.cursor(),i,r,"",o.highlighters),o.flush(r)}zn.empty=new zn([],2,null);class Xn{constructor(t,e,n){this.at=t,this.highlighters=e,this.span=n,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,n,i,r){let{type:o,from:s,to:a}=t;if(s>=n||a<=e)return;o.isTop&&(r=this.highlighters.filter(t=>!t.scope||t.scope(o)));let l=i,c=function(t){let e=t.type.prop(Hn);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}(t)||zn.empty,h=function(t,e){let n=null;for(let i of t){let t=i.style(e);t&&(n=n?n+" "+t:t)}return n}(r,c.tags);if(h&&(l&&(l+=" "),l+=h,1==c.mode&&(i+=(i?" ":"")+h)),this.startSpan(Math.max(e,s),l),c.opaque)return;let u=t.tree&&t.tree.prop(ke.mounted);if(u&&u.overlay){let o=t.node.enter(u.overlay[0].from+s,1),c=this.highlighters.filter(t=>!t.scope||t.scope(u.tree.type)),h=t.firstChild();for(let d=0,p=s;;d++){let f=d<u.overlay.length?u.overlay[d]:null,g=f?f.from+s:a,m=Math.max(e,p),v=Math.min(n,g);if(m<v&&h)for(;t.from<v&&(this.highlightRange(t,m,v,i,r),this.startSpan(Math.min(v,t.to),l),!(t.to>=g)&&t.nextSibling()););if(!f||g>n)break;p=f.to+s,p>e&&(this.highlightRange(o.cursor(),Math.max(e,f.from+s),Math.min(n,p),"",c),this.startSpan(Math.min(n,p),l))}h&&t.parent()}else if(t.firstChild()){u&&(i="");do{if(!(t.to<=e)){if(t.from>=n)break;this.highlightRange(t,e,n,i,r),this.startSpan(Math.min(n,t.to),l)}}while(t.nextSibling());t.parent()}}}const Un=qn.define,Gn=Un(),Yn=Un(),Zn=Un(Yn),Kn=Un(Yn),Jn=Un(),ti=Un(Jn),ei=Un(Jn),ni=Un(),ii=Un(ni),ri=Un(),oi=Un(),si=Un(),ai=Un(si),li=Un(),ci={comment:Gn,lineComment:Un(Gn),blockComment:Un(Gn),docComment:Un(Gn),name:Yn,variableName:Un(Yn),typeName:Zn,tagName:Un(Zn),propertyName:Kn,attributeName:Un(Kn),className:Un(Yn),labelName:Un(Yn),namespace:Un(Yn),macroName:Un(Yn),literal:Jn,string:ti,docString:Un(ti),character:Un(ti),attributeValue:Un(ti),number:ei,integer:Un(ei),float:Un(ei),bool:Un(Jn),regexp:Un(Jn),escape:Un(Jn),color:Un(Jn),url:Un(Jn),keyword:ri,self:Un(ri),null:Un(ri),atom:Un(ri),unit:Un(ri),modifier:Un(ri),operatorKeyword:Un(ri),controlKeyword:Un(ri),definitionKeyword:Un(ri),moduleKeyword:Un(ri),operator:oi,derefOperator:Un(oi),arithmeticOperator:Un(oi),logicOperator:Un(oi),bitwiseOperator:Un(oi),compareOperator:Un(oi),updateOperator:Un(oi),definitionOperator:Un(oi),typeOperator:Un(oi),controlOperator:Un(oi),punctuation:si,separator:Un(si),bracket:ai,angleBracket:Un(ai),squareBracket:Un(ai),paren:Un(ai),brace:Un(ai),content:ni,heading:ii,heading1:Un(ii),heading2:Un(ii),heading3:Un(ii),heading4:Un(ii),heading5:Un(ii),heading6:Un(ii),contentSeparator:Un(ni),list:Un(ni),quote:Un(ni),emphasis:Un(ni),strong:Un(ni),link:Un(ni),monospace:Un(ni),strikethrough:Un(ni),inserted:Un(),deleted:Un(),changed:Un(),invalid:Un(),meta:li,documentMeta:Un(li),annotation:Un(li),processingInstruction:Un(li),definition:qn.defineModifier(),constant:qn.defineModifier(),function:qn.defineModifier(),standard:qn.defineModifier(),local:qn.defineModifier(),special:qn.defineModifier()};Qn([{tag:ci.link,class:"tok-link"},{tag:ci.heading,class:"tok-heading"},{tag:ci.emphasis,class:"tok-emphasis"},{tag:ci.strong,class:"tok-strong"},{tag:ci.keyword,class:"tok-keyword"},{tag:ci.atom,class:"tok-atom"},{tag:ci.bool,class:"tok-bool"},{tag:ci.url,class:"tok-url"},{tag:ci.labelName,class:"tok-labelName"},{tag:ci.inserted,class:"tok-inserted"},{tag:ci.deleted,class:"tok-deleted"},{tag:ci.literal,class:"tok-literal"},{tag:ci.string,class:"tok-string"},{tag:ci.number,class:"tok-number"},{tag:[ci.regexp,ci.escape,ci.special(ci.string)],class:"tok-string2"},{tag:ci.variableName,class:"tok-variableName"},{tag:ci.local(ci.variableName),class:"tok-variableName tok-local"},{tag:ci.definition(ci.variableName),class:"tok-variableName tok-definition"},{tag:ci.special(ci.variableName),class:"tok-variableName2"},{tag:ci.definition(ci.propertyName),class:"tok-propertyName tok-definition"},{tag:ci.typeName,class:"tok-typeName"},{tag:ci.namespace,class:"tok-namespace"},{tag:ci.className,class:"tok-className"},{tag:ci.macroName,class:"tok-macroName"},{tag:ci.propertyName,class:"tok-propertyName"},{tag:ci.operator,class:"tok-operator"},{tag:ci.comment,class:"tok-comment"},{tag:ci.meta,class:"tok-meta"},{tag:ci.invalid,class:"tok-invalid"},{tag:ci.punctuation,class:"tok-punctuation"}]);const hi=121,ui=122,di=4,pi=130,fi=19,gi=139,mi=23,vi=140,yi=41,bi=67,xi=152,wi=69,_i=153,Oi=71,ki=154,Si=165,Ei=88,Ci=89,Ai=167,Ti=96,Pi=169,Mi="undefined"!=typeof process&&process.env&&/\bfparse(:dbg)?\b/.test(process.env.LOG),Ni="undefined"!=typeof process&&process.env&&/\bfparse:dbg\b/.test(process.env.LOG),Ri="undefined"!=typeof process&&process.env&&/\bcontext\b/.test(process.env.LOG),Di=[9,11,12,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],Bi=Ii("\n\r"),$i="*".charCodeAt(0),Li=Ii("'./-+*^");function Ii(t){return Array.from(t).map(t=>t.charCodeAt(0))}function qi(t){return 63===t||t>=65&&t<=90||95===t||t>=97&&t<=122||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=55296&&t<=56319||t>=56320&&t<=57343}function Fi(t){return t>=48&&t<=57||183===t||t>=768&&t<=879||t>=8255&&t<=8256}function Vi(t){return Di.includes(t)}function ji(t,e){return e.concat(t.split(/\n/g).join("\n"+e))}function Hi(t,e=0){const n=t.peek(e);return n===$i&&t.peek(e+1)===$i?{offset:2,token:"**"}:(i=n,Li.includes(i)?{offset:1,token:String.fromCharCode(n)}:null);var i}function zi(t,e=0,n=!1){for(let i=!1,r=[],o=0;;o++){const s=t.peek(e+o);if(!(qi(s)||(i||n)&&Fi(s)))return r.length?{token:String.fromCharCode(...r),offset:o}:null;i||(i=!0),r.push(s)}}function Qi(t,e){for(let n=!1,i=0;;i++){if(!Vi(t.peek(e+i)))return n?{token:" ",offset:i}:null;n||(n=!0)}}const Wi={[hi]:"identifier",[ui]:"nameIdentifier"},Xi=new _n((t,e)=>{Ni&&console.log("%s: T <identifier | nameIdentifier>",t.pos);const n=function(t,e){const n=e.contextKeys(),i=e.tokens;for(let e=0,r=[],o=null;;){const s=i.length+r.length>0,a=r.length>0,l=zi(t,e,s)||s&&Hi(t,e)||a&&Qi(t,e);if(!l)return o;const{token:c,offset:h}=l;if(e+=h," "===c)continue;r=[...r,c];const u=[...i,...r].join(" ");if(n.some(t=>t===u)){const t=r[0];o={token:t,offset:t.length,term:122}}if(!n.some(t=>t.startsWith(u))){if(tr.some(t=>t===u)){const t=r[0];o={token:t,offset:t.length,term:121}}if(!tr.some(t=>t.startsWith(u)))return o}}}(t,e.context),i=e.context.tokens,r=n||zi(t,0,i.length>0);r&&(t.advance(r.offset),t.acceptToken(n?n.term:121),Mi&&console.log("%s: MATCH <%s> <%s>",t.pos,n?Wi[n.term]:"identifier",r.token))},{contextual:!0}),Ui=new _n((t,e)=>{Ni&&console.log("%s: T <propertyIdentifier>",t.pos);const n=zi(t,0,e.context.tokens.length>0);n&&(t.advance(n.offset),t.acceptToken(120),Mi&&console.log("%s: MATCH <propertyIdentifier> <%s>",t.pos,n.token))}),Gi=new _n((t,e)=>{let n;Ni&&console.log("%s: T <insertSemi>",t.pos);let i=!1;for(n=0;;n++){const e=t.peek(n);if(!Di.includes(e)){Bi.includes(e)&&(i=!0);break}}if(i){const e=zi(t,n+1);if(Qi(t,n+1)||e&&/^(then|else|return|satisfies)$/.test(e.token))return;Mi&&console.log("%s: MATCH <insertSemi>",t.pos),t.acceptToken(123)}}),Yi={[ki]:"FunctionInvocation",[_i]:"FilterExpression",[xi]:"PathExpression"},Zi={[Pi]:"Context",[Ai]:"FunctionDefinition",[pi]:"ForExpression",[Si]:"List",[gi]:"IfExpression",[vi]:"QuantifiedExpression"},Ki={[Ti]:"Context",[Ci]:"FunctionDefinition",[di]:"ForExpression",[Ei]:"List",[fi]:"IfExpression",[mi]:"QuantifiedExpression",[bi]:"PathExpression",[Oi]:"FunctionInvocation",[wi]:"FilterExpression",[yi]:"ArithmeticExpression"};class Ji{constructor(t){this.fn=t}get(t){return this.fn(t)}static of(t){return new Ji(t)}}const tr=Object.keys({"date and time":1,date:1,time:1,duration:1});class er{constructor(t={}){this.value=t}getKeys(){return Object.keys(this.value)}get(t){const e=this.value[t],n=this.constructor;return n.isAtomic(e)?e:n.of(e)}set(t,e){return this.constructor.of({...this.value,[t]:e})}static isAtomic(t){return!t||t instanceof this||t instanceof Ji||"object"!=typeof t}static of(...t){const e=t=>t&&"object"==typeof t?t instanceof this?t.value:{...t}:{};return new this(t.reduce((t,n)=>({...t,...e(n)}),{}))}}class nr{constructor({name:t="Expressions",tokens:e=[],children:n=[],parent:i=null,context:r=null,value:o=null,raw:s=null}={}){this.name=t,this.tokens=e,this.children=n,this.parent=i,this.context=r,this.value=o,this.raw=s}enterScope(t){const e=this.of({name:t,parent:this});return Ri&&console.log("[%s] enter",e.path,e.context),e}exitScope(t){return this.parent?(Ri&&console.log("[%s] exit %o\n%s",this.path,this.context,ji(t,"  ")),this.parent.pushChild(this)):(Ri&&console.log("[%s] NO exit %o\n%s",this.path,this.context,ji(t,"  ")),this)}token(t){return Ri&&console.log("[%s] token <%s> + <%s>",this.path,this.tokens.join(" "),t),this.assign({tokens:[...this.tokens,t]})}literal(t){return Ri&&console.log("[%s] literal %o",this.path,t),this.pushChild(this.of({name:"Literal",value:t}))}computedValue(){for(let t=this;;t=sr(t.children)){if(!t)return null;if(t.value)return t.value}}contextKeys(){return this.context.getKeys().map(ir)}get path(){return this.parent?.path?.concat(" > ",this.name)||this.name}get(t){const e=[t,t&&ir(t)],n=this.context.getKeys().find(t=>e.includes(ir(t)));if(void 0===n)return;const i=this.context.get(n);return i instanceof Ji?i.get(this):i}resolveName(){const t=this.tokens.join(" "),e=this.assign({tokens:[]}),n=this.of({name:"VariableName",parent:e,value:this.get(t),raw:t});return Ri&&console.log("[%s] resolve name <%s=%s>",n.path,t,this.get(t)),e.pushChild(n)}pushChild(t){if(!t)return this;const e=this.assign({children:[...this.children,t]});return t.parent=e,e}pushChildren(t){let e=this;for(const n of t)e=e.pushChild(n);return e}declareName(){if(0===this.tokens.length)throw Error("no tokens to declare name");const t=this.tokens.join(" ");return Ri&&console.log("[%s] declareName <%s>",this.path,t),this.assign({tokens:[]}).pushChild(this.of({name:"Name",value:t}))}define(t,e){if("string"!=typeof t)return Ri&&console.log("[%s] no define <%s=%s>",this.path,t,e),this;Ri&&console.log("[%s] define <%s=%s>",this.path,t,e);const n=this.context.set(t,e);return this.assign({context:n})}assign(t={}){return nr.of({...this,...t})}of(t={}){const e={context:this.context,parent:this.parent};return nr.of({...e,...t})}static of(t){const{name:e,tokens:n=[],children:i=[],parent:r=null,context:o,value:s,raw:a}=t;if(!o)throw new Error("must provide <context>");return new nr({name:e,tokens:[...n],children:[...i],context:o,parent:r,value:s,raw:a})}}function ir(t){return t.replace(/\s*([./\-'+]|\*\*?)\s*/g," $1 ").replace(/\s{2,}/g," ").trim()}function rr(t,e,n){const i=t.children.filter(t=>t.name!==e),r=t.children.filter(t=>t.name===e),o=i[0],s=i[Math.max(1,i.length-1)],a=o?.computedValue(),l=s?.computedValue()||null;return t.assign({children:r}).enterScope(e).pushChildren(i).exitScope(n).define(a,l)}const or=function(t={},e=er){const n=nr.of({context:e.of(t)});return new Dn({start:n,reduce(t,n,i,r){if(19===n){const[n,i]=t.children.slice(-2);t=t.assign({value:e.of(n?.computedValue(),i?.computedValue())})}if(88===n&&(t=t.assign({value:e.of(...t.children.map(t=>t?.computedValue()))})),69===n){const[e,n]=t.children.slice(-2);t=t.assign({value:e?.computedValue()})}if(71===n){const[e,...n]=t.children;"get value"===e?.raw&&(t=function(t,e){if(!e.length)return t.assign({value:null});if("Name"===e[0].name&&(e=function(t){const e={};for(let n=0;n<t.length;n+=2){const[i,r]=t.slice(n,n+2);e[i.value]=r}return["m","key"].map(t=>e[t])}(e)),2!==e.length)return t.assign({value:null});const[n,i]=e,r=i?.computedValue(),o=n?.computedValue();return o&&"object"==typeof o&&"string"==typeof r?t.assign({value:[ir(r),r].reduce((t,e)=>o.get(e)||t,null)}):t.assign({value:null})}(t,n))}const o=Zi[n];if(o)return t.enterScope(o);const s=Yi[n];if(s){const{children:i,context:r}=t,o=i.slice(0,-1),a=sr(i);let l=null;return 152===n&&(l=e.of(a?.computedValue())),153===n&&(l=e.of(r,a?.computedValue()).set("item",a?.computedValue())),t.assign({children:o}).enterScope(s).pushChild(a).assign({context:l||r})}const a=r.read(r.pos,i.pos);if(Ki[n])return t.exitScope(a);if(97===n){const n=t.children.filter(t=>"ContextEntry"!==t.name),i=n[0],r=sr(n);return rr(t,"ContextEntry",a).assign({value:e.of(t.value).set(i?.computedValue(),r?.computedValue())})}if(7===n||27===n)return rr(t,"InExpression",a);if(138===n)return t.define("partial",Ji.of(t=>sr(t.children)?.computedValue()));if(75===n){const e=sr(t.children).computedValue();return t.define(e,1)}if(144===n||145===n||146===n){const e=t.children.slice(0,-1),n=sr(t.children);return t.assign({children:e}).enterScope("ArithmeticExpression").pushChild(n)}if(147===n)return t.enterScope("ArithmeticExpression");if(9===n||10===n||100===n)return t.token(a);if(79===n)return t.literal(a.replace(/^"|"$/g,""));if(80===n)return t.literal("true"===a);if(78===n)return t.literal(parseFloat(a));if(159===n)return t.literal(null);if(47===n)return t.resolveName();if(8===n||99===n)return t.declareName();if((127===n||37===n)&&t.tokens.length>0)throw new Error("uncleared name");if(127===n){let e=t;for(;e.parent;)e=e.exitScope(a);return e}return t}})}({});function sr(t){return t[t.length-1]}const ar=jn({StringLiteral:ci.string,NumericLiteral:ci.number,BooleanLiteral:ci.bool,"AtLiteral!":ci.special(ci.string),CompareOp:ci.compareOperator,ArithOp:ci.arithmeticOperator,"for if then else some every satisfies between return":ci.controlKeyword,"in instance of and or":ci.operatorKeyword,function:ci.definitionKeyword,as:ci.keyword,"Type/...":ci.typeName,Wildcard:ci.special(ci.variableName),null:ci.null,LineComment:ci.lineComment,BlockComment:ci.blockComment,'VariableName! "?"':ci.variableName,"DateTimeConstructor! SpecialFunctionName!":ci.function(ci.special(ci.variableName)),"List Interval":ci.list,Context:ci.definition(ci.literal),"Name!":ci.definition(ci.variableName),"Key/Name! ContextEntryType/Name!":ci.definition(ci.propertyName),"PathExpression/VariableName!":ci.function(ci.propertyName),"FormalParameter/ParameterName!":ci.function(ci.definition(ci.variableName)),"( )":ci.paren,"[ ]":ci.squareBracket,"{ }":ci.brace,".":ci.derefOperator,", ;":ci.separator,"..":ci.punctuation}),lr={__proto__:null,for:10,in:32,return:36,if:40,then:42,else:44,some:48,every:50,satisfies:56,or:60,and:64,between:72,instance:86,of:89,days:99,time:101,duration:103,years:105,months:107,date:109,list:115,context:121,function:128,null:154,true:326,false:326,"?":168,external:184,not:209},cr=Bn.deserialize({version:14,states:"CpO`QYOOO`QYOOO$gQYOOOOQU'#Ce'#CeO$qQYO'#C`O%zQYO'#FPOOQQ'#Fe'#FeO&UQYO'#FeO`QYO'#DVOOQU'#Em'#EmO'rQ^O'#D]OOQO'#Fl'#FlO)oQWO'#DuOOQQ'#D|'#D|OOQQ'#D}'#D}OOQQ'#EO'#EOO)tOWO'#ERO)oQWO'#EPOOQQ'#EP'#EPOOQQ'#Fr'#FrOOQQ'#Fp'#FpOOQQ'#Fw'#FwOOQQ'#ET'#ETO`QYO'#EVOOQQ'#FR'#FRO)yQ^O'#FRO+pQYO'#EWO+wQWO'#EXOOQP'#F{'#F{O+|QXO'#E`OOQQ'#Fx'#FxOOQQ'#FQ'#FQQOQWOOOOQQ'#FS'#FSOOQQ'#F]'#F]O`QYO'#CoOOQQ'#F^'#F^O$qQYO'#CsO,XQYO'#DvOOQQ'#Fq'#FqO,^QYO'#EQOOQO'#EQ'#EQO`QYO'#EUO`QYO'#ETOOQO'#Fy'#FyQ,fQWOOO,kQYO'#DRO-bQWO'#FaOOQO'#DT'#DTO-mQYO'#FeO-tQWOOO.kQYO'#CdO.xQYO'#FUOOQQ'#Cc'#CcO.}QYO'#FTOOQQ'#Cb'#CbO/VQYO,58zO`QYO,59iOOQQ'#Fb'#FbOOQQ'#Fc'#FcOOQQ'#Fd'#FdO`QYO,59qO`QYO,59qO`QYO,59qOOQQ'#Fj'#FjO$qQYO,5:]OOQQ'#Fk'#FkO`QYO,5:_O`QYO,59eO`QYO,59gO`QYO,59iO0uQYO,59iO0|QYO,59rOOQQ,5:h,5:hO1RQYO,59qOOQU-E8k-E8kO2uQYO'#FmOOQQ,5:a,5:aOOQQ,5:m,5:mOOQQ,5:k,5:kO2|QYO,5:qOOQQ,5;m,5;mO3WQYO,5:pO3eQWO,5:rO3jQYO,5:sOOQP'#Ed'#EdO4aQXO'#EcOOQO'#Eb'#EbO4hQWO'#EaO4mQWO'#F|O4uQWO,5:zO4zQYO,59ZO.xQYO'#F`OOQQ'#Cw'#CwO5RQYO'#F_OOQQ'#Cv'#CvO5ZQYO,59_O5`QYO,5:bO5eQYO,5:lO3PQYO,5:pO5jQYO,5:oO`QYO'#EvQ,fQWOOO`QYO'#ElO6aQWO,5;{O`QYOOOOQR'#Cf'#CfOOQQ'#Ei'#EiO7ZQYO,59OO`QYO,5;pOOQQ'#FX'#FXO$qQYO'#EjO7kQYO,5;oO`QYO1G.fOOQQ'#F['#F[O8bQYO1G/TO;XQYO1G/]O;cQYO1G/]O;mQYO1G/]OOQQ1G/w1G/wO=aQYO1G/yO=hQYO1G/PO>qQYO1G/RO?zQYO1G/TO`QYO1G/TOOQQ1G/T1G/TO@bQYO1G/^O@|Q^O'#CdOB`QYO'#FoOOQO'#Dy'#DyOBjQWO'#DxOBoQWO'#FnOOQO'#Dw'#DwOOQO'#Dz'#DzOBwQWO,5<XOOQQ1G0]1G0]O`QYO1G0[O`QYO'#ErOB|QWO,5<ZOOQQ1G0^1G0^OCXQWO'#EZOCdQWO'#FzOOQO'#EY'#EYOClQWO1G0_OOQP'#Et'#EtOCqQXO,5:}O`QYO,5:{OCxQXO'#EuODQQWO,5<hOOQQ1G0f1G0fO`QYO1G.uO`QYO,5;zO$qQYO'#EkODYQYO,5;yO`QYO1G.yODbQYO1G/|OOQO1G0W1G0WOOQO,5;b,5;bOOQO-E8t-E8tOOQO,5;W,5;WOOQO-E8j-E8jODgQWOOOOQQ-E8g-E8gODlQYO'#CmOOQQ1G1[1G1[OOQQ,5;U,5;UOOQQ-E8h-E8hODyQYO7+$QOOQQ7+%e7+%eO`QYO7+$oOEpQYO,5:qOE}QWO7+$oOFSQYO'#D[OOQQ'#DZ'#DZOGvQYO'#D^OG{QYO'#D^OHQQYO'#D^OHVQ`O'#DfOH[Q`O'#DiOHaQ`O'#DmOOQQ7+$x7+$xO`QYO,5:dO$qQYO'#EqOHfQWO,5<YOOQQ1G1s1G1sOIlQYO7+%vOIyQYO,5;^OOQO-E8p-E8pO@bQYO,5:uO$qQYO'#EsOJWQWO,5<fOJ`QYO7+%yOOQP-E8r-E8rOJgQYO1G0gOOQO,5;a,5;aOOQO-E8s-E8sOJqQYO7+$aOJxQYO1G1fOOQQ,5;V,5;VOOQQ-E8i-E8iOKSQYO7+$eOOQO7+%h7+%hO`QYO,59XOKyQYO<<HZOOQQ<<HZ<<HZO$qQYO'#EnOMSQYO,59vONvQYO,59xON{QYO,59xO! QQYO,59xO! VQYO,5:QO$qQYO,5:TO! qQbO,5:XO! xQYO1G0OOOQO,5;],5;]OOQO-E8o-E8oO!!SQYO<<IbOOQQ<<Ib<<IbOOQO1G0a1G0aOOQO,5;_,5;_OOQO-E8q-E8qO!%OQYO'#E]OOQQ<<Ie<<IeO`QYO<<IeO`QYO<<G{O!%uQYO1G.sOOQQ,5;Y,5;YOOQQ-E8l-E8lO!&PQYO1G/dOOQQ1G/d1G/dO!&UQbO'#D]O!&gQ`O'#D[O!&rQ`O1G/lO!&wQWO'#DlO!&|Q`O'#FfOOQO'#Dk'#DkO!'UQ`O1G/oOOQO'#Dp'#DpO!'ZQ`O'#FhOOQO'#Do'#DoO!'cQ`O1G/sOOQQAN?PAN?PO!'hQYOAN=gOOQQ7+%O7+%OO!(_Q`O,59vOOQQ7+%W7+%WO! VQYO,5:WO$qQYO'#EoO!(jQ`O,5<QOOQQ7+%Z7+%ZO! VQYO'#EpO!(rQ`O,5<SO!(zQ`O7+%_OOQO1G/r1G/rOOQO,5;Z,5;ZOOQO-E8m-E8mOOQO,5;[,5;[OOQO-E8n-E8nO@bQYO<<HyOOQQAN>eAN>eO$qQYO'#EnO! VQYO<<HyO!)PQ`O7+%_O!)UQ`O1G/sO! qQbO,5:XO!)ZQ`O'#Dm",stateData:"!)h~O#qOS#rOSPOSQOS~OTqOZVO[UOdrOhtOitOs{OvgO!SyO!TyO!UvO!WxO!b|O!fzO!heO!owO!vhO#RlO#mRO#nRO$g]O$h^O$i_O$j`O~OTqO[UOdrOhtOitOs{OvgO!SyO!TyO!UvO!WxO!b|O!fzO!heO!owO!vhO#RlO#mRO#nRO$g]O$h^O$i_O$j`O~OZ!RO#[!SO~P!|O#mRO#nRO~OZ![O[![O]!]O^!]O_!^O`!iOn!fOp!gOr!ZOs!ZOt!hO{!jO!h!dO#y!bOv$`X~O#k#sX$q#sX~P$yO$g!kOT$XXZ$XX[$XXd$XXh$XXi$XXs$XXv$XX!S$XX!T$XX!U$XX!W$XX!b$XX!f$XX!h$XX!o$XX!v$XX#R$XX#m$XX#n$XX$h$XX$i$XX$j$XX~O#mRO#nROZ!PX[!PX]!PX^!PX_!PX`!PXn!PXp!PXr!PXs!PXt!PXv!PX{!PX!h!PX#k!PX#o!PX#y!PX$q!PX#}!PXx!PX#|!PX!f!PXe!PXb!PX#Q!PXf!PXl!PX~Ov!nO~O$h^O~O#o!sOZ#uX[#uX]#uX^#uX_#uX`#uXn#uXp#uXr#uXs#uXt#uXv#uX{#uX!h#uX#k#uX#y#uX$q#uX#}#uXx#uX#|#uX!f#uXe#uXb#uX#Q#uXf#uXl#uX~O!f$cP~P`Ov!vO~O#l!wO$h^O#Q$pP~Op#TO~Op#UOv!tX~O$q#XO~O#kuX#}uX$quXxuX#|uX!fuXeuXbuX#QuXfuXluX~P$yO#}#ZO#k$TXx$TX~O#k#ZX~P&UOv#]O~OZ#^O[#^O]#^O^#^O_#^O#mRO#nRO#y#^O#z#^O$ZWX~O`WXxWX#}WX~P-yO`#bO~O#}#cOb#wX~Ob#fO~OTqOZVO[UOdrOhtOitOs{O!SyO!TyO!UvO!WxO!b|O!fzO!heO!owO!vhO#RlO#mRO#nRO$g]O$h^O$i_O$j`O~Ov#pO~P/[O|#rO~O{!jO!h!dO#y!bOZya[ya]ya^ya_ya`yanyapyaryasyatyav$`X#kya$qya#}yaxya#|ya!fyaeyabya#Qyafyalya~Ox$cP~P`Ox#{O#|#|O~P$yO#|#|O#}#}O!f$cX~P$yO!f$PO~O#mRO#nROx$nP~OZ#^O[#^O]#^O^#^O_#^O#l!wO#y#^O#z#^O~O$Z#VX~P3uO$Z$WO~O#}$XO#Q$pX~O#Q$ZO~Oe$[O~P$yO#}$^Ol$RX~Ol$`O~O!V$aO~O!S$bO~O#k!wa$q!wa#}!wax!wa#|!wa!f!wae!wab!wa#Q!waf!wal!wa~P$yO#}#ZO#k$Tax$Ta~OZ#^O[#^O]#^O^#^O_#^O#mRO#nRO#y#^O#z#^O~O`Wa$ZWaxWa#}Wa~P6lO#}#cOb#wa~OZ![O[![O]!]O^!]O_!^O{!jO!h!dO#y!bOv$`X~O`qinqipqirqisqitqi#kqi$qqi#}qixqi#|qi!fqieqibqi#Qqifqilqi~P7sO_!^O{!jO!h!dO#y!bOZyi[yi`yinyipyiryisyityiv$`X#kyi$qyi#}yixyi#|yi!fyieyibyi#Qyifyilyi~O]!]O^!]O~P9kO]yi^yi~P9kO{!jO!h!dO#y!bOZyi[yi]yi^yi_yi`yinyipyiryisyityiv$`X#kyi$qyi#}yixyi#|yi!fyieyibyi#Qyifyilyi~O!f$nO~P$yO`!iOp!gOr!ZOs!ZOt!hOnmi#kmi$qmi#}mixmi#|mi!fmiemibmi#Qmifmilmi~P7sO`!iOr!ZOs!ZOt!hOnoipoi#koi$qoi#}oixoi#|oi!foieoiboi#Qoifoiloi~P7sO`!iOn!fOp$oOr!ZOs!ZOt!hO~P7sO!R$tO!U$uO!W$vO!Z$wO!^$xO!b$yO#mRO#nRO~OZ#aX[#aX]#aX^#aX_#aX`#aXn#aXp#aXr#aXs#aXt#aXv#aXx#aX{#aX!h#aX#m#aX#n#aX#o#aX#y#aX#}#aX~P-yO#}#}Ox$cX~P$yO$Z${O~O#}$|Ox$bX~Ox%OO~O#}#}O!f$cax$ca~O$Z%SOx!}X#}!}X~O#}%TOx$nX~Ox%VO~O$Z#Va~P3uO#l!wO$h^O~O#}$XO#Q$pa~O#}$^Ol$Ra~O!T%aO~OxpO~O#|%bObaX#}aX~P$yO#kSq$qSq#}SqxSq#|Sq!fSqeSqbSq#QSqfSqlSq~P$yOx#{O#|#|O#}uX~P$yOx%dO~O#y%eOZ!OX[!OX]!OX^!OX_!OX`!OXn!OXp!OXr!OXs!OXt!OXv!OX{!OX!h!OX#k!OX$q!OX#}!OXx!OX#|!OX!f!OXe!OXb!OX#Q!OXf!OXl!OX~Op%gO~Op%hO~Op%iO~O![%jO~O![%kO~O![%lO~O#}$|Ox$ba~OZ![O[![O]!]O^!]O_!^O`!iOn!fOp!gOr!ZOs!ZOt!hO{!jO#y!bOv$`X~Ox%qO!f%qO!h%pO~PHnO!f#fa#}#fax#fa~P$yO#}%TOx$na~O#O%wO~P`O#Q#Ti#}#Ti~P$yOf%xO~P$yOl$Si#}$Si~P$yO#kgq$qgq#}gqxgq#|gq!fgqegqbgq#Qgqfgqlgq~P$yO`qynqypqyrqysqytqy#kqy$qqy#}qyxqy#|qy!fqyeqybqy#Qqyfqylqy~P7sO#y%eOZ!Oa[!Oa]!Oa^!Oa_!Oa`!Oan!Oap!Oar!Oas!Oat!Oav!Oa{!Oa!h!Oa#k!Oa$q!Oa#}!Oax!Oa#|!Oa!f!Oae!Oab!Oa#Q!Oaf!Oal!Oa~O!S%|O~O!V%|O~O!S%}O~O!R$tO!U$uO!W$vO!Z$wO!^$xO!b&sO#mRO#nRO~O!X$[P~P! VOx!li#}!li~P$yOT$_XZ$_X[$_X]!xy^!xy_!xy`!xyd$_Xh$_Xi$_Xn!xyp!xyr!xys$_Xt!xyv$_X{!xy!S$_X!T$_X!U$_X!W$_X!b$_X!f$_X!h$_X!o$_X!v$_X#R$_X#k!xy#m$_X#n$_X#y!xy$g$_X$h$_X$i$_X$j$_X$q!xy#}!xyx!xy#|!xye!xyb!xy#Q!xyf!xyl!xy~O#k#PX$q#PX#}#PXx#PX#|#PX!f#PXe#PXb#PX#Q#PXf#PXl#PX~P$yObai#}ai~P$yO!T&]O~O#mRO#nRO!X!PX#y!PX#}!PX~O#y&nO!X!OX#}!OX~O!X&_O~O$Z&`O~O#}&aO!X$YX~O!X&cO~O#}&dO!X$[X~O!X&fO~O#kc!R$qc!R#}c!Rxc!R#|c!R!fc!Rec!Rbc!R#Qc!Rfc!Rlc!R~P$yO#y&nO!X!Oa#}!Oa~O#}&aO!X$Ya~O#}&dO!X$[a~O$]&lO~O$]&oO~O!X&pO~O![&rO~OQP_^$g]#y~",goto:"Du$qPPPP$rP%k%n%t&W'qPPPPPP'zP$rPPP$rPP'}(QP$rP$rP$rPPP(WP(cP$r$rPP(l)R)^)RPPPPPPP)RPP)RP*k*n)RP*t*z$rP$rP$r+R+z+},T+zP,]-U,],].U.}P$r/v$r0o0o1h1kP1qPP0o1w1}.Q2RPP2ZP2^2e2k2q2w4S4^4d4j4p4w4}5T5ZPPPPPPPP5a5j7q8j9c9fPP9jPP9p9s:l;e;h;l;q<`=O=o>hP>kP>o?b@T@|ASAV$rA]A]PPPPBU7qB}CvCyDr!mhOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%xR!YSQ!WSR$k#cS!US#cS#Ou$^W#u!n!v$|%TT&R%k&a#WXOPQWYgjsz{!Z!_!`!a!c!e!f!g!h!i#X#Z#]#a#e#p#r#|#}$W$[$]$`$o${%S%V%b%e%j%l%w%x&O&`&d&l&n&o&rb!TSu!v#c$^$|%T%k&aU#_!T#`#sR#s!nU#_!T#`#sT$U!x$VR$j#aR#SuQ#QuR%^$^U!PQ#]#pQ#q!iR$e#ZQpQQ$g#]R$q#pQ$z#rQ%r%SQ&Q%jU&V%l&d&rQ&g&`T&m&l&oc$s#r%S%j%l&`&d&l&o&r!liOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%xQ#k!cU$r#r%S&lS%z%e&n]&P%j%l&`&d&o&rR&U%kQ&S%kR&h&aQ&Y%lR&q&rS&W%l&rR&j&d!mZOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%xR#z!nQ#w!nR%n$|S#v!n$|T$Q!v%T!mcOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%x!lcOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%xQ!p`T!ym$X!maOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%x!mbOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%x!mfOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%x!mnOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%xR$T!vQ$R!vR%s%TQ%v%VR&Z%wQ!{mR%Y$XT!zm$XS!xm$XT$U!x$VRpQS#`!T#sR$h#`Q#d!WR$l#dQ$_#QR%_$_Q#[!PR$f#[!vYOPQWgjsz{!Z!_!`!a!c!e!f!g!h!i!n#X#Z#]#a#e#p#r#|#}$W$[$]$`$o${%S%V%b%e%w%x&lS!mY&O_&O%j%l&`&d&n&o&rQ%f$rS%{%f&^R&^&PQ&b&SR&i&bQ&e&WR&k&eQ$}#wR%o$}S$O!t#tR%R$OQ%U$RR%t%UQ$V!xR%W$VQ$Y!{R%Z$YQ#Y}R$d#YQpOQ}PR$c#XUTOP#XW!OQ!i#Z#]Q!lWQ!rgQ!tjQ!}sQ#VzQ#W{Q#g!ZQ#h!_Q#i!`Q#j!aQ#l!eQ#m!fQ#n!gQ#o!hQ#t!nQ$i#aQ$m#eQ$p#pQ%P#|Q%Q#}Q%X$WQ%[$[Q%]$]Q%`$`Q%c$oQ%m${S%u%V%wQ%y%bR&[%x!moOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%x!mSOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%xR!XST!VS#cQ#a!UR$]#OR#e!Y!msOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%x!muOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%xR#RuT#Pu$^V!QQ#]#p!X!_T!O!r!t!}#V#W#g#l#m#n#o#t$i$m$p%P%Q%X%[%]%`%c%m%u%y&[!Z!`T!O!r!t!}#V#W#g#h#l#m#n#o#t$i$m$p%P%Q%X%[%]%`%c%m%u%y&[!]!aT!O!r!t!}#V#W#g#h#i#l#m#n#o#t$i$m$p%P%Q%X%[%]%`%c%m%u%y&[!mWOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%xR&T%kT&X%l&r!a!cT!O!l!r!t!}#V#W#g#h#i#j#l#m#n#o#t$i$m$p%P%Q%X%[%]%`%c%m%u%y&[!a!eT!O!l!r!t!}#V#W#g#h#i#j#l#m#n#o#t$i$m$p%P%Q%X%[%]%`%c%m%u%y&[!m[OPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%xQ!o[R!qaR#x!nQ!ujR#y!n!mdOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%x!mjOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%x!mkOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%xR$S!v!mmOPQWgjsz{!Z!_!`!a!e!f!g!h!i!n#X#Z#]#a#e#p#|#}$W$[$]$`$o${%V%b%w%xR!|m",nodeNames:" LineComment BlockComment Expression ForExpression for InExpressions InExpression Name Identifier Identifier ArithOp ArithOp ArithOp ArithOp ArithOp in IterationContext return IfExpression if then else QuantifiedExpression some every InExpressions InExpression satisfies Disjunction or Conjunction and Comparison CompareOp CompareOp between PositiveUnaryTest ( PositiveUnaryTests ) ArithmeticExpression InstanceOfExpression instance of Type QualifiedName VariableName SpecialType days time duration years months date > ListType list < ContextType context ContextEntryTypes ContextEntryType FunctionType function ArgumentTypes ArgumentType PathExpression ] FilterExpression [ FunctionInvocation SpecialFunctionName NamedParameters NamedParameter ParameterName PositionalParameters null NumericLiteral StringLiteral BooleanLiteral DateTimeLiteral DateTimeConstructor AtLiteral ? SimplePositiveUnaryTest Interval ParenthesizedExpression List FunctionDefinition FormalParameters FormalParameter external FunctionBody } { Context ContextEntry Key Name Identifier Expressions UnaryTests Wildcard not",maxTerm:171,context:or,nodeProps:[["closedBy",38,")",70,"]",95,"}"],["openedBy",40,"(",68,"[",94,"{"],["group",-5,77,78,79,80,81,"Literal"]],propSources:[ar],skippedNodes:[0,1,2],repeatNodeCount:14,tokenData:"+l~RuXY#fYZ$ZZ[#f]^$Zpq#fqr$`rs$kwx&cxy&hyz&mz{&r{|'P|}'U}!O'Z!O!P'h!P!Q(Q!Q![){![!]*^!]!^*c!^!_*h!_!`$f!`!a*w!b!c+R!}#O+W#P#Q+]#Q#R&z#o#p+b#q#r+g$f$g#f#BY#BZ#f$IS$I_#f$I|$I}$Z$I}$JO$Z$JT$JU#f$KV$KW#f&FU&FV#f?HT?HU#f~#kY#q~XY#fZ[#fpq#f$f$g#f#BY#BZ#f$IS$I_#f$JT$JU#f$KV$KW#f&FU&FV#f?HT?HU#f~$`O#r~~$cP!_!`$f~$kOr~~$pW$h~OY$kZr$krs%Ys#O$k#O#P%_#P;'S$k;'S;=`&]<%lO$k~%_O$h~~%bRO;'S$k;'S;=`%k;=`O$k~%pX$h~OY$kZr$krs%Ys#O$k#O#P%_#P;'S$k;'S;=`&];=`<%l$k<%lO$k~&`P;=`<%l$k~&hO#z~~&mOv~~&rOx~~&wP^~z{&z~'PO_~~'UO[~~'ZO#}~R'`PZP!`!a'cQ'hO$]Q~'mQ#y~!O!P's!Q!['x~'xO#|~~'}P$g~!Q!['x~(VQ]~z{(]!P!Q)d~(`TOz(]z{(o{;'S(];'S;=`)^<%lO(]~(rVOz(]z{(o{!P(]!P!Q)X!Q;'S(];'S;=`)^<%lO(]~)^OQ~~)aP;=`<%l(]~)iSP~OY)dZ;'S)d;'S;=`)u<%lO)d~)xP;=`<%l)d~*QQ$g~!O!P*W!Q![){~*ZP!Q!['x~*cO$Z~~*hO$q~R*oP![QsP!_!`*rP*wOsPR+OP!XQsP!_!`*r~+WO$j~~+]O!h~~+bO!f~~+gO#R~~+lO#Q~",tokenizers:[Ui,Xi,Gi,0,1],topRules:{Expression:[0,3],Expressions:[1,101],UnaryTests:[2,102]},dynamicPrecedences:{31:-1,71:-1,73:-1},specialized:[{term:121,get:t=>lr[t]||-1}],tokenPrec:2500});class hr{lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,n){[t,e]=br(this,t,e);let i=[];return this.decompose(0,t,i,2),n.length&&n.decompose(0,n.length,i,3),this.decompose(e,this.length,i,1),dr.from(i,this.length-(e-t)+n.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){[t,e]=br(this,t,e);let n=[];return this.decompose(t,e,n,0),dr.from(n,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),n=this.length-this.scanIdentical(t,-1),i=new gr(this),r=new gr(t);for(let t=e,o=e;;){if(i.next(t),r.next(t),t=0,i.lineBreak!=r.lineBreak||i.done!=r.done||i.value!=r.value)return!1;if(o+=i.value.length,i.done||o>=n)return!0}}iter(t=1){return new gr(this,t)}iterRange(t,e=this.length){return new mr(this,t,e)}iterLines(t,e){let n;if(null==t)n=this.iter();else{null==e&&(e=this.lines+1);let i=this.line(t).from;n=this.iterRange(i,Math.max(i,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new vr(n)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}constructor(){}static of(t){if(0==t.length)throw new RangeError("A document must have at least one line");return 1!=t.length||t[0]?t.length<=32?new ur(t):dr.from(ur.split(t,[])):hr.empty}}class ur extends hr{constructor(t,e=function(t){let e=-1;for(let n of t)e+=n.length+1;return e}(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,n,i){for(let r=0;;r++){let o=this.text[r],s=i+o.length;if((e?n:s)>=t)return new yr(i,s,n,o);i=s+1,n++}}decompose(t,e,n,i){let r=t<=0&&e>=this.length?this:new ur(fr(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(1&i){let t=n.pop(),e=pr(r.text,t.text.slice(),0,r.length);if(e.length<=32)n.push(new ur(e,t.length+r.length));else{let t=e.length>>1;n.push(new ur(e.slice(0,t)),new ur(e.slice(t)))}}else n.push(r)}replace(t,e,n){if(!(n instanceof ur))return super.replace(t,e,n);[t,e]=br(this,t,e);let i=pr(this.text,pr(n.text,fr(this.text,0,t)),e),r=this.length+n.length-(e-t);return i.length<=32?new ur(i,r):dr.from(ur.split(i,[]),r)}sliceString(t,e=this.length,n="\n"){[t,e]=br(this,t,e);let i="";for(let r=0,o=0;r<=e&&o<this.text.length;o++){let s=this.text[o],a=r+s.length;r>t&&o&&(i+=n),t<a&&e>r&&(i+=s.slice(Math.max(0,t-r),e-r)),r=a+1}return i}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let n=[],i=-1;for(let r of t)n.push(r),i+=r.length+1,32==n.length&&(e.push(new ur(n,i)),n=[],i=-1);return i>-1&&e.push(new ur(n,i)),e}}class dr extends hr{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let e of t)this.lines+=e.lines}lineInner(t,e,n,i){for(let r=0;;r++){let o=this.children[r],s=i+o.length,a=n+o.lines-1;if((e?a:s)>=t)return o.lineInner(t,e,n,i);i=s+1,n=a+1}}decompose(t,e,n,i){for(let r=0,o=0;o<=e&&r<this.children.length;r++){let s=this.children[r],a=o+s.length;if(t<=a&&e>=o){let r=i&((o<=t?1:0)|(a>=e?2:0));o>=t&&a<=e&&!r?n.push(s):s.decompose(t-o,e-o,n,r)}o=a+1}}replace(t,e,n){if([t,e]=br(this,t,e),n.lines<this.lines)for(let i=0,r=0;i<this.children.length;i++){let o=this.children[i],s=r+o.length;if(t>=r&&e<=s){let a=o.replace(t-r,e-r,n),l=this.lines-o.lines+a.lines;if(a.lines<l>>4&&a.lines>l>>6){let r=this.children.slice();return r[i]=a,new dr(r,this.length-(e-t)+n.length)}return super.replace(r,s,a)}r=s+1}return super.replace(t,e,n)}sliceString(t,e=this.length,n="\n"){[t,e]=br(this,t,e);let i="";for(let r=0,o=0;r<this.children.length&&o<=e;r++){let s=this.children[r],a=o+s.length;o>t&&r&&(i+=n),t<a&&e>o&&(i+=s.sliceString(t-o,e-o,n)),o=a+1}return i}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof dr))return 0;let n=0,[i,r,o,s]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;i+=e,r+=e){if(i==o||r==s)return n;let a=this.children[i],l=t.children[r];if(a!=l)return n+a.scanIdentical(l,e);n+=a.length+1}}static from(t,e=t.reduce((t,e)=>t+e.length+1,-1)){let n=0;for(let e of t)n+=e.lines;if(n<32){let n=[];for(let e of t)e.flatten(n);return new ur(n,e)}let i=Math.max(32,n>>5),r=i<<1,o=i>>1,s=[],a=0,l=-1,c=[];function h(t){let e;if(t.lines>r&&t instanceof dr)for(let e of t.children)h(e);else t.lines>o&&(a>o||!a)?(u(),s.push(t)):t instanceof ur&&a&&(e=c[c.length-1])instanceof ur&&t.lines+e.lines<=32?(a+=t.lines,l+=t.length+1,c[c.length-1]=new ur(e.text.concat(t.text),e.length+1+t.length)):(a+t.lines>i&&u(),a+=t.lines,l+=t.length+1,c.push(t))}function u(){0!=a&&(s.push(1==c.length?c[0]:dr.from(c,l)),l=-1,a=c.length=0)}for(let e of t)h(e);return u(),1==s.length?s[0]:new dr(s,e)}}function pr(t,e,n=0,i=1e9){for(let r=0,o=0,s=!0;o<t.length&&r<=i;o++){let a=t[o],l=r+a.length;l>=n&&(l>i&&(a=a.slice(0,i-r)),r<n&&(a=a.slice(n-r)),s?(e[e.length-1]+=a,s=!1):e.push(a)),r=l+1}return e}function fr(t,e,n){return pr(t,[""],e,n)}hr.empty=new ur([""],0);class gr{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof ur?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,i=this.nodes[n],r=this.offsets[n],o=r>>1,s=i instanceof ur?i.text.length:i.children.length;if(o==(e>0?s:0)){if(0==n)return this.done=!0,this.value="",this;e>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&r)==(e>0?0:1)){if(this.offsets[n]+=e,0==t)return this.lineBreak=!0,this.value="\n",this;t--}else if(i instanceof ur){let r=i.text[o+(e<0?-1:0)];if(this.offsets[n]+=e,r.length>Math.max(0,t))return this.value=0==t?r:e>0?r.slice(t):r.slice(0,r.length-t),this;t-=r.length}else{let r=i.children[o+(e<0?-1:0)];t>r.length?(t-=r.length,this.offsets[n]+=e):(e<0&&this.offsets[n]--,this.nodes.push(r),this.offsets.push(e>0?1:(r instanceof ur?r.text.length:r.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class mr{constructor(t,e,n){this.value="",this.done=!1,this.cursor=new gr(t,e>n?-1:1),this.pos=e>n?t.length:0,this.from=Math.min(e,n),this.to=Math.max(e,n)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let n=e<0?this.pos-this.from:this.to-this.pos;t>n&&(t=n),n-=t;let{value:i}=this.cursor.next(t);return this.pos+=(i.length+t)*e,this.value=i.length<=n?i:e<0?i.slice(i.length-n):i.slice(0,n),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class vr{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:n,value:i}=this.inner.next(t);return e&&this.afterBreak?(this.value="",this.afterBreak=!1):e?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(hr.prototype[Symbol.iterator]=function(){return this.iter()},gr.prototype[Symbol.iterator]=mr.prototype[Symbol.iterator]=vr.prototype[Symbol.iterator]=function(){return this});let yr=class{constructor(t,e,n,i){this.from=t,this.to=e,this.number=n,this.text=i}get length(){return this.to-this.from}};function br(t,e,n){return[e=Math.max(0,Math.min(t.length,e)),Math.max(e,Math.min(t.length,n))]}let xr="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(t=>t?parseInt(t,36):1);for(let t=1;t<xr.length;t++)xr[t]+=xr[t-1];function wr(t){for(let e=1;e<xr.length;e+=2)if(xr[e]>t)return xr[e-1]<=t;return!1}function _r(t){return t>=127462&&t<=127487}function Or(t,e,n=!0,i=!0){return(n?kr:Sr)(t,e,i)}function kr(t,e,n){if(e==t.length)return e;e&&Er(t.charCodeAt(e))&&Cr(t.charCodeAt(e-1))&&e--;let i=Ar(t,e);for(e+=Pr(i);e<t.length;){let r=Ar(t,e);if(8205==i||8205==r||n&&wr(r))e+=Pr(r),i=r;else{if(!_r(r))break;{let n=0,i=e-2;for(;i>=0&&_r(Ar(t,i));)n++,i-=2;if(n%2==0)break;e+=2}}}return e}function Sr(t,e,n){for(;e>0;){let i=kr(t,e-2,n);if(i<e)return i;e--}return 0}function Er(t){return t>=56320&&t<57344}function Cr(t){return t>=55296&&t<56320}function Ar(t,e){let n=t.charCodeAt(e);if(!Cr(n)||e+1==t.length)return n;let i=t.charCodeAt(e+1);return Er(i)?i-56320+(n-55296<<10)+65536:n}function Tr(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}function Pr(t){return t<65536?1:2}const Mr=/\r\n?|\n/;var Nr=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(Nr||(Nr={}));class Rr{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let n=this.sections[e+1];t+=n<0?this.sections[e]:n}return t}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(t){for(let e=0,n=0,i=0;e<this.sections.length;){let r=this.sections[e++],o=this.sections[e++];o<0?(t(n,i,r),i+=r):i+=o,n+=r}}iterChangedRanges(t,e=!1){Lr(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let n=this.sections[e++],i=this.sections[e++];i<0?t.push(n,i):t.push(i,n)}return new Rr(t)}composeDesc(t){return this.empty?t:t.empty?this:qr(this,t)}mapDesc(t,e=!1){return t.empty?this:Ir(this,t,e)}mapPos(t,e=-1,n=Nr.Simple){let i=0,r=0;for(let o=0;o<this.sections.length;){let s=this.sections[o++],a=this.sections[o++],l=i+s;if(a<0){if(l>t)return r+(t-i);r+=s}else{if(n!=Nr.Simple&&l>=t&&(n==Nr.TrackDel&&i<t&&l>t||n==Nr.TrackBefore&&i<t||n==Nr.TrackAfter&&l>t))return null;if(l>t||l==t&&e<0&&!s)return t==i||e<0?r:r+a;r+=a}i=l}if(t>i)throw new RangeError(`Position ${t} is out of range for changeset of length ${i}`);return r}touchesRange(t,e=t){for(let n=0,i=0;n<this.sections.length&&i<=e;){let r=i+this.sections[n++];if(this.sections[n++]>=0&&i<=e&&r>=t)return!(i<t&&r>e)||"cover";i=r}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let n=this.sections[e++],i=this.sections[e++];t+=(t?" ":"")+n+(i>=0?":"+i:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(t=>"number"!=typeof t))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Rr(t)}static create(t){return new Rr(t)}}class Dr extends Rr{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return Lr(this,(e,n,i,r,o)=>t=t.replace(i,i+(n-e),o),!1),t}mapDesc(t,e=!1){return Ir(this,t,e,!0)}invert(t){let e=this.sections.slice(),n=[];for(let i=0,r=0;i<e.length;i+=2){let o=e[i],s=e[i+1];if(s>=0){e[i]=s,e[i+1]=o;let a=i>>1;for(;n.length<a;)n.push(hr.empty);n.push(o?t.slice(r,r+o):hr.empty)}r+=o}return new Dr(e,n)}compose(t){return this.empty?t:t.empty?this:qr(this,t,!0)}map(t,e=!1){return t.empty?this:Ir(this,t,e,!0)}iterChanges(t,e=!1){Lr(this,t,e)}get desc(){return Rr.create(this.sections)}filter(t){let e=[],n=[],i=[],r=new Fr(this);t:for(let o=0,s=0;;){let a=o==t.length?1e9:t[o++];for(;s<a||s==a&&0==r.len;){if(r.done)break t;let t=Math.min(r.len,a-s);Br(i,t,-1);let o=-1==r.ins?-1:0==r.off?r.ins:0;Br(e,t,o),o>0&&$r(n,e,r.text),r.forward(t),s+=t}let l=t[o++];for(;s<l;){if(r.done)break t;let t=Math.min(r.len,l-s);Br(e,t,-1),Br(i,t,-1==r.ins?-1:0==r.off?r.ins:0),r.forward(t),s+=t}}return{changes:new Dr(e,n),filtered:Rr.create(i)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let n=this.sections[e],i=this.sections[e+1];i<0?t.push(n):0==i?t.push([n]):t.push([n].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,n){let i=[],r=[],o=0,s=null;function a(t=!1){if(!t&&!i.length)return;o<e&&Br(i,e-o,-1);let n=new Dr(i,r);s=s?s.compose(n.map(s)):n,i=[],r=[],o=0}return function t(l){if(Array.isArray(l))for(let e of l)t(e);else if(l instanceof Dr){if(l.length!=e)throw new RangeError(`Mismatched change set length (got ${l.length}, expected ${e})`);a(),s=s?s.compose(l.map(s)):l}else{let{from:t,to:s=t,insert:c}=l;if(t>s||t<0||s>e)throw new RangeError(`Invalid change range ${t} to ${s} (in doc of length ${e})`);let h=c?"string"==typeof c?hr.of(c.split(n||Mr)):c:hr.empty,u=h.length;if(t==s&&0==u)return;t<o&&a(),t>o&&Br(i,t-o,-1),Br(i,s-t,u),$r(r,i,h),o=s}}(t),a(!s),s}static empty(t){return new Dr(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],n=[];for(let i=0;i<t.length;i++){let r=t[i];if("number"==typeof r)e.push(r,-1);else{if(!Array.isArray(r)||"number"!=typeof r[0]||r.some((t,e)=>e&&"string"!=typeof t))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==r.length)e.push(r[0],0);else{for(;n.length<i;)n.push(hr.empty);n[i]=hr.of(r.slice(1)),e.push(r[0],n[i].length)}}}return new Dr(e,n)}static createSet(t,e){return new Dr(t,e)}}function Br(t,e,n,i=!1){if(0==e&&n<=0)return;let r=t.length-2;r>=0&&n<=0&&n==t[r+1]?t[r]+=e:0==e&&0==t[r]?t[r+1]+=n:i?(t[r]+=e,t[r+1]+=n):t.push(e,n)}function $r(t,e,n){if(0==n.length)return;let i=e.length-2>>1;if(i<t.length)t[t.length-1]=t[t.length-1].append(n);else{for(;t.length<i;)t.push(hr.empty);t.push(n)}}function Lr(t,e,n){let i=t.inserted;for(let r=0,o=0,s=0;s<t.sections.length;){let a=t.sections[s++],l=t.sections[s++];if(l<0)r+=a,o+=a;else{let c=r,h=o,u=hr.empty;for(;c+=a,h+=l,l&&i&&(u=u.append(i[s-2>>1])),!(n||s==t.sections.length||t.sections[s+1]<0);)a=t.sections[s++],l=t.sections[s++];e(r,c,o,h,u),r=c,o=h}}}function Ir(t,e,n,i=!1){let r=[],o=i?[]:null,s=new Fr(t),a=new Fr(e);for(let t=-1;;)if(-1==s.ins&&-1==a.ins){let t=Math.min(s.len,a.len);Br(r,t,-1),s.forward(t),a.forward(t)}else if(a.ins>=0&&(s.ins<0||t==s.i||0==s.off&&(a.len<s.len||a.len==s.len&&!n))){let e=a.len;for(Br(r,a.ins,-1);e;){let n=Math.min(s.len,e);s.ins>=0&&t<s.i&&s.len<=n&&(Br(r,0,s.ins),o&&$r(o,r,s.text),t=s.i),s.forward(n),e-=n}a.next()}else{if(!(s.ins>=0)){if(s.done&&a.done)return o?Dr.createSet(r,o):Rr.create(r);throw new Error("Mismatched change set lengths")}{let e=0,n=s.len;for(;n;)if(-1==a.ins){let t=Math.min(n,a.len);e+=t,n-=t,a.forward(t)}else{if(!(0==a.ins&&a.len<n))break;n-=a.len,a.next()}Br(r,e,t<s.i?s.ins:0),o&&t<s.i&&$r(o,r,s.text),t=s.i,s.forward(s.len-n)}}}function qr(t,e,n=!1){let i=[],r=n?[]:null,o=new Fr(t),s=new Fr(e);for(let t=!1;;){if(o.done&&s.done)return r?Dr.createSet(i,r):Rr.create(i);if(0==o.ins)Br(i,o.len,0,t),o.next();else if(0!=s.len||s.done){if(o.done||s.done)throw new Error("Mismatched change set lengths");{let e=Math.min(o.len2,s.len),n=i.length;if(-1==o.ins){let n=-1==s.ins?-1:s.off?0:s.ins;Br(i,e,n,t),r&&n&&$r(r,i,s.text)}else-1==s.ins?(Br(i,o.off?0:o.len,e,t),r&&$r(r,i,o.textBit(e))):(Br(i,o.off?0:o.len,s.off?0:s.ins,t),r&&!s.off&&$r(r,i,s.text));t=(o.ins>e||s.ins>=0&&s.len>e)&&(t||i.length>n),o.forward2(e),s.forward(e)}}else Br(i,0,s.ins,t),r&&$r(r,i,s.text),s.next()}}class Fr{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?hr.empty:t[e]}textBit(t){let{inserted:e}=this.set,n=this.i-2>>1;return n>=e.length&&!t?hr.empty:e[n].slice(this.off,null==t?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){-1==this.ins?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class Vr{constructor(t,e,n){this.from=t,this.to=e,this.flags=n}get anchor(){return 32&this.flags?this.to:this.from}get head(){return 32&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 8&this.flags?-1:16&this.flags?1:0}get bidiLevel(){let t=7&this.flags;return 7==t?null:t}get goalColumn(){let t=this.flags>>6;return 16777215==t?void 0:t}map(t,e=-1){let n,i;return this.empty?n=i=t.mapPos(this.from,e):(n=t.mapPos(this.from,1),i=t.mapPos(this.to,-1)),n==this.from&&i==this.to?this:new Vr(n,i,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return jr.range(t,e);let n=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return jr.range(this.anchor,n)}eq(t,e=!1){return!(this.anchor!=t.anchor||this.head!=t.head||e&&this.empty&&this.assoc!=t.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||"number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid JSON representation for SelectionRange");return jr.range(t.anchor,t.head)}static create(t,e,n){return new Vr(t,e,n)}}class jr{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:jr.create(this.ranges.map(n=>n.map(t,e)),this.mainIndex)}eq(t,e=!1){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(t.ranges[n],e))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new jr([this.main],0)}addRange(t,e=!0){return jr.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let n=this.ranges.slice();return n[e]=t,jr.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||"number"!=typeof t.main||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new jr(t.ranges.map(t=>Vr.fromJSON(t)),t.main)}static single(t,e=t){return new jr([jr.range(t,e)],0)}static create(t,e=0){if(0==t.length)throw new RangeError("A selection needs at least one range");for(let n=0,i=0;i<t.length;i++){let r=t[i];if(r.empty?r.from<=n:r.from<n)return jr.normalized(t.slice(),e);n=r.to}return new jr(t,e)}static cursor(t,e=0,n,i){return Vr.create(t,t,(0==e?0:e<0?8:16)|(null==n?7:Math.min(6,n))|(null!=i?i:16777215)<<6)}static range(t,e,n,i){let r=(null!=n?n:16777215)<<6|(null==i?7:Math.min(6,i));return e<t?Vr.create(e,t,48|r):Vr.create(t,e,(e>t?8:0)|r)}static normalized(t,e=0){let n=t[e];t.sort((t,e)=>t.from-e.from),e=t.indexOf(n);for(let n=1;n<t.length;n++){let i=t[n],r=t[n-1];if(i.empty?i.from<=r.to:i.from<r.to){let o=r.from,s=Math.max(i.to,r.to);n<=e&&e--,t.splice(--n,2,i.anchor>i.head?jr.range(s,o):jr.range(o,s))}}return new jr(t,e)}}function Hr(t,e){for(let n of t.ranges)if(n.to>e)throw new RangeError("Selection points outside of document")}let zr=0;class Qr{constructor(t,e,n,i,r){this.combine=t,this.compareInput=e,this.compare=n,this.isStatic=i,this.id=zr++,this.default=t([]),this.extensions="function"==typeof r?r(this):r}get reader(){return this}static define(t={}){return new Qr(t.combine||(t=>t),t.compareInput||((t,e)=>t===e),t.compare||(t.combine?(t,e)=>t===e:Wr),!!t.static,t.enables)}of(t){return new Xr([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Xr(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Xr(t,this,2,e)}from(t,e){return e||(e=t=>t),this.compute([t],n=>e(n.field(t)))}}function Wr(t,e){return t==e||t.length==e.length&&t.every((t,n)=>t===e[n])}class Xr{constructor(t,e,n,i){this.dependencies=t,this.facet=e,this.type=n,this.value=i,this.id=zr++}dynamicSlot(t){var e;let n=this.value,i=this.facet.compareInput,r=this.id,o=t[r]>>1,s=2==this.type,a=!1,l=!1,c=[];for(let n of this.dependencies)"doc"==n?a=!0:"selection"==n?l=!0:1&(null!==(e=t[n.id])&&void 0!==e?e:1)||c.push(t[n.id]);return{create:t=>(t.values[o]=n(t),1),update(t,e){if(a&&e.docChanged||l&&(e.docChanged||e.selection)||Gr(t,c)){let e=n(t);if(s?!Ur(e,t.values[o],i):!i(e,t.values[o]))return t.values[o]=e,1}return 0},reconfigure:(t,e)=>{let a,l=e.config.address[r];if(null!=l){let r=so(e,l);if(this.dependencies.every(n=>n instanceof Qr?e.facet(n)===t.facet(n):!(n instanceof Kr)||e.field(n,!1)==t.field(n,!1))||(s?Ur(a=n(t),r,i):i(a=n(t),r)))return t.values[o]=r,0}else a=n(t);return t.values[o]=a,1}}}}function Ur(t,e,n){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!n(t[i],e[i]))return!1;return!0}function Gr(t,e){let n=!1;for(let i of e)1&oo(t,i)&&(n=!0);return n}function Yr(t,e,n){let i=n.map(e=>t[e.id]),r=n.map(t=>t.type),o=i.filter(t=>!(1&t)),s=t[e.id]>>1;function a(t){let n=[];for(let e=0;e<i.length;e++){let o=so(t,i[e]);if(2==r[e])for(let t of o)n.push(t);else n.push(o)}return e.combine(n)}return{create(t){for(let e of i)oo(t,e);return t.values[s]=a(t),1},update(t,n){if(!Gr(t,o))return 0;let i=a(t);return e.compare(i,t.values[s])?0:(t.values[s]=i,1)},reconfigure(t,r){let o=Gr(t,i),l=r.config.facets[e.id],c=r.facet(e);if(l&&!o&&Wr(n,l))return t.values[s]=c,0;let h=a(t);return e.compare(h,c)?(t.values[s]=c,0):(t.values[s]=h,1)}}}const Zr=Qr.define({static:!0});class Kr{constructor(t,e,n,i,r){this.id=t,this.createF=e,this.updateF=n,this.compareF=i,this.spec=r,this.provides=void 0}static define(t){let e=new Kr(zr++,t.create,t.update,t.compare||((t,e)=>t===e),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(Zr).find(t=>t.field==this);return((null==e?void 0:e.create)||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:t=>(t.values[e]=this.create(t),1),update:(t,n)=>{let i=t.values[e],r=this.updateF(i,n);return this.compareF(i,r)?0:(t.values[e]=r,1)},reconfigure:(t,n)=>null!=n.config.address[this.id]?(t.values[e]=n.field(this),0):(t.values[e]=this.create(t),1)}}init(t){return[this,Zr.of({field:this,create:t})]}get extension(){return this}}function Jr(t){return e=>new eo(e,t)}const to={highest:Jr(0),high:Jr(1),default:Jr(2),low:Jr(3),lowest:Jr(4)};class eo{constructor(t,e){this.inner=t,this.prec=e}}class no{of(t){return new io(this,t)}reconfigure(t){return no.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class io{constructor(t,e){this.compartment=t,this.inner=e}}class ro{constructor(t,e,n,i,r,o){for(this.base=t,this.compartments=e,this.dynamicSlots=n,this.address=i,this.staticValues=r,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return null==e?t.default:this.staticValues[e>>1]}static resolve(t,e,n){let i=[],r=Object.create(null),o=new Map;for(let n of function(t,e,n){let i=[[],[],[],[],[]],r=new Map;return function t(o,s){let a=r.get(o);if(null!=a){if(a<=s)return;let t=i[a].indexOf(o);t>-1&&i[a].splice(t,1),o instanceof io&&n.delete(o.compartment)}if(r.set(o,s),Array.isArray(o))for(let e of o)t(e,s);else if(o instanceof io){if(n.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let i=e.get(o.compartment)||o.inner;n.set(o.compartment,i),t(i,s)}else if(o instanceof eo)t(o.inner,o.prec);else if(o instanceof Kr)i[s].push(o),o.provides&&t(o.provides,s);else if(o instanceof Xr)i[s].push(o),o.facet.extensions&&t(o.facet.extensions,2);else{let e=o.extension;if(!e)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);t(e,s)}}(t,2),i.reduce((t,e)=>t.concat(e))}(t,e,o))n instanceof Kr?i.push(n):(r[n.facet.id]||(r[n.facet.id]=[])).push(n);let s=Object.create(null),a=[],l=[];for(let t of i)s[t.id]=l.length<<1,l.push(e=>t.slot(e));let c=null==n?void 0:n.config.facets;for(let t in r){let e=r[t],i=e[0].facet,o=c&&c[t]||[];if(e.every(t=>0==t.type))if(s[i.id]=a.length<<1|1,Wr(o,e))a.push(n.facet(i));else{let t=i.combine(e.map(t=>t.value));a.push(n&&i.compare(t,n.facet(i))?n.facet(i):t)}else{for(let t of e)0==t.type?(s[t.id]=a.length<<1|1,a.push(t.value)):(s[t.id]=l.length<<1,l.push(e=>t.dynamicSlot(e)));s[i.id]=l.length<<1,l.push(t=>Yr(t,i,e))}}let h=l.map(t=>t(s));return new ro(t,o,h,s,a,r)}}function oo(t,e){if(1&e)return 2;let n=e>>1,i=t.status[n];if(4==i)throw new Error("Cyclic dependency between fields and/or facets");if(2&i)return i;t.status[n]=4;let r=t.computeSlot(t,t.config.dynamicSlots[n]);return t.status[n]=2|r}function so(t,e){return 1&e?t.config.staticValues[e>>1]:t.values[e>>1]}const ao=Qr.define(),lo=Qr.define({combine:t=>t.some(t=>t),static:!0}),co=Qr.define({combine:t=>t.length?t[0]:void 0,static:!0}),ho=Qr.define(),uo=Qr.define(),po=Qr.define(),fo=Qr.define({combine:t=>!!t.length&&t[0]});class go{constructor(t,e){this.type=t,this.value=e}static define(){return new mo}}class mo{of(t){return new go(this,t)}}class vo{constructor(t){this.map=t}of(t){return new yo(this,t)}}class yo{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return void 0===e?void 0:e==this.value?this:new yo(this.type,e)}is(t){return this.type==t}static define(t={}){return new vo(t.map||(t=>t))}static mapEffects(t,e){if(!t.length)return t;let n=[];for(let i of t){let t=i.map(e);t&&n.push(t)}return n}}yo.reconfigure=yo.define(),yo.appendConfig=yo.define();class bo{constructor(t,e,n,i,r,o){this.startState=t,this.changes=e,this.selection=n,this.effects=i,this.annotations=r,this.scrollIntoView=o,this._doc=null,this._state=null,n&&Hr(n,e.newLength),r.some(t=>t.type==bo.time)||(this.annotations=r.concat(bo.time.of(Date.now())))}static create(t,e,n,i,r,o){return new bo(t,e,n,i,r,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(bo.userEvent);return!(!e||!(e==t||e.length>t.length&&e.slice(0,t.length)==t&&"."==e[t.length]))}}function xo(t,e){let n=[];for(let i=0,r=0;;){let o,s;if(i<t.length&&(r==e.length||e[r]>=t[i]))o=t[i++],s=t[i++];else{if(!(r<e.length))return n;o=e[r++],s=e[r++]}!n.length||n[n.length-1]<o?n.push(o,s):n[n.length-1]<s&&(n[n.length-1]=s)}}function wo(t,e,n){var i;let r,o,s;return n?(r=e.changes,o=Dr.empty(e.changes.length),s=t.changes.compose(e.changes)):(r=e.changes.map(t.changes),o=t.changes.mapDesc(e.changes,!0),s=t.changes.compose(r)),{changes:s,selection:e.selection?e.selection.map(o):null===(i=t.selection)||void 0===i?void 0:i.map(r),effects:yo.mapEffects(t.effects,r).concat(yo.mapEffects(e.effects,o)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function _o(t,e,n){let i=e.selection,r=So(e.annotations);return e.userEvent&&(r=r.concat(bo.userEvent.of(e.userEvent))),{changes:e.changes instanceof Dr?e.changes:Dr.of(e.changes||[],n,t.facet(co)),selection:i&&(i instanceof jr?i:jr.single(i.anchor,i.head)),effects:So(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function Oo(t,e,n){let i=_o(t,e.length?e[0]:{},t.doc.length);e.length&&!1===e[0].filter&&(n=!1);for(let r=1;r<e.length;r++){!1===e[r].filter&&(n=!1);let o=!!e[r].sequential;i=wo(i,_o(t,e[r],o?i.changes.newLength:t.doc.length),o)}let r=bo.create(t,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return function(t){let e=t.startState,n=e.facet(po),i=t;for(let r=n.length-1;r>=0;r--){let o=n[r](t);o&&Object.keys(o).length&&(i=wo(i,_o(e,o,t.changes.newLength),!0))}return i==t?t:bo.create(e,t.changes,t.selection,i.effects,i.annotations,i.scrollIntoView)}(n?function(t){let e=t.startState,n=!0;for(let i of e.facet(ho)){let e=i(t);if(!1===e){n=!1;break}Array.isArray(e)&&(n=!0===n?e:xo(n,e))}if(!0!==n){let i,r;if(!1===n)r=t.changes.invertedDesc,i=Dr.empty(e.doc.length);else{let e=t.changes.filter(n);i=e.changes,r=e.filtered.mapDesc(e.changes).invertedDesc}t=bo.create(e,i,t.selection&&t.selection.map(r),yo.mapEffects(t.effects,r),t.annotations,t.scrollIntoView)}let i=e.facet(uo);for(let n=i.length-1;n>=0;n--){let r=i[n](t);t=r instanceof bo?r:Array.isArray(r)&&1==r.length&&r[0]instanceof bo?r[0]:Oo(e,So(r),!1)}return t}(r):r)}bo.time=go.define(),bo.userEvent=go.define(),bo.addToHistory=go.define(),bo.remote=go.define();const ko=[];function So(t){return null==t?ko:Array.isArray(t)?t:[t]}var Eo=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(Eo||(Eo={}));const Co=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Ao;try{Ao=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(Et){}class To{constructor(t,e,n,i,r,o){this.config=t,this.doc=e,this.selection=n,this.values=i,this.status=t.statusTemplate.slice(),this.computeSlot=r,o&&(o._state=this);for(let t=0;t<this.config.dynamicSlots.length;t++)oo(this,t<<1);this.computeSlot=null}field(t,e=!0){let n=this.config.address[t.id];if(null!=n)return oo(this,n),so(this,n);if(e)throw new RangeError("Field is not present in this state")}update(...t){return Oo(this,t,!0)}applyTransaction(t){let e,n=this.config,{base:i,compartments:r}=n;for(let e of t.effects)e.is(no.reconfigure)?(n&&(r=new Map,n.compartments.forEach((t,e)=>r.set(e,t)),n=null),r.set(e.value.compartment,e.value.extension)):e.is(yo.reconfigure)?(n=null,i=e.value):e.is(yo.appendConfig)&&(n=null,i=So(i).concat(e.value));n?e=t.startState.values.slice():(n=ro.resolve(i,r,this),e=new To(n,this.doc,this.selection,n.dynamicSlots.map(()=>null),(t,e)=>e.reconfigure(t,this),null).values);let o=t.startState.facet(lo)?t.newSelection:t.newSelection.asSingle();new To(n,t.newDoc,o,e,(e,n)=>n.update(e,t),t)}replaceSelection(t){return"string"==typeof t&&(t=this.toText(t)),this.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t},range:jr.cursor(e.from+t.length)}))}changeByRange(t){let e=this.selection,n=t(e.ranges[0]),i=this.changes(n.changes),r=[n.range],o=So(n.effects);for(let n=1;n<e.ranges.length;n++){let s=t(e.ranges[n]),a=this.changes(s.changes),l=a.map(i);for(let t=0;t<n;t++)r[t]=r[t].map(l);let c=i.mapDesc(a,!0);r.push(s.range.map(c)),i=i.compose(l),o=yo.mapEffects(o,l).concat(yo.mapEffects(So(s.effects),c))}return{changes:i,selection:jr.create(r,e.mainIndex),effects:o}}changes(t=[]){return t instanceof Dr?t:Dr.of(t,this.doc.length,this.facet(To.lineSeparator))}toText(t){return hr.of(t.split(this.facet(To.lineSeparator)||Mr))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return null==e?t.default:(oo(this,e),so(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let n in t){let i=t[n];i instanceof Kr&&null!=this.config.address[i.id]&&(e[n]=i.spec.toJSON(this.field(t[n]),this))}return e}static fromJSON(t,e={},n){if(!t||"string"!=typeof t.doc)throw new RangeError("Invalid JSON representation for EditorState");let i=[];if(n)for(let e in n)if(Object.prototype.hasOwnProperty.call(t,e)){let r=n[e],o=t[e];i.push(r.init(t=>r.spec.fromJSON(o,t)))}return To.create({doc:t.doc,selection:jr.fromJSON(t.selection),extensions:e.extensions?i.concat([e.extensions]):i})}static create(t={}){let e=ro.resolve(t.extensions||[],new Map),n=t.doc instanceof hr?t.doc:hr.of((t.doc||"").split(e.staticFacet(To.lineSeparator)||Mr)),i=t.selection?t.selection instanceof jr?t.selection:jr.single(t.selection.anchor,t.selection.head):jr.single(0);return Hr(i,n.length),e.staticFacet(lo)||(i=i.asSingle()),new To(e,n,i,e.dynamicSlots.map(()=>null),(t,e)=>e.create(t),null)}get tabSize(){return this.facet(To.tabSize)}get lineBreak(){return this.facet(To.lineSeparator)||"\n"}get readOnly(){return this.facet(fo)}phrase(t,...e){for(let e of this.facet(To.phrases))if(Object.prototype.hasOwnProperty.call(e,t)){t=e[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,(t,n)=>{if("$"==n)return"$";let i=+(n||1);return!i||i>e.length?t:e[i-1]})),t}languageDataAt(t,e,n=-1){let i=[];for(let r of this.facet(ao))for(let o of r(this,e,n))Object.prototype.hasOwnProperty.call(o,t)&&i.push(o[t]);return i}charCategorizer(t){return e=this.languageDataAt("wordChars",t).join(""),t=>{if(!/\S/.test(t))return Eo.Space;if(function(t){if(Ao)return Ao.test(t);for(let e=0;e<t.length;e++){let n=t[e];if(/\w/.test(n)||n>""&&(n.toUpperCase()!=n.toLowerCase()||Co.test(n)))return!0}return!1}(t))return Eo.Word;for(let n=0;n<e.length;n++)if(t.indexOf(e[n])>-1)return Eo.Word;return Eo.Other};var e}wordAt(t){let{text:e,from:n,length:i}=this.doc.lineAt(t),r=this.charCategorizer(t),o=t-n,s=t-n;for(;o>0;){let t=Or(e,o,!1);if(r(e.slice(t,o))!=Eo.Word)break;o=t}for(;s<i;){let t=Or(e,s);if(r(e.slice(s,t))!=Eo.Word)break;s=t}return o==s?null:jr.range(o+n,s+n)}}function Po(t,e,n={}){let i={};for(let e of t)for(let t of Object.keys(e)){let r=e[t],o=i[t];if(void 0===o)i[t]=r;else if(o===r||void 0===r);else{if(!Object.hasOwnProperty.call(n,t))throw new Error("Config merge conflict for field "+t);i[t]=n[t](o,r)}}for(let t in e)void 0===i[t]&&(i[t]=e[t]);return i}To.allowMultipleSelections=lo,To.tabSize=Qr.define({combine:t=>t.length?t[0]:4}),To.lineSeparator=co,To.readOnly=fo,To.phrases=Qr.define({compare(t,e){let n=Object.keys(t),i=Object.keys(e);return n.length==i.length&&n.every(n=>t[n]==e[n])}}),To.languageData=ao,To.changeFilter=ho,To.transactionFilter=uo,To.transactionExtender=po,no.reconfigure=yo.define();class Mo{eq(t){return this==t}range(t,e=t){return No.create(t,e,this)}}Mo.prototype.startSide=Mo.prototype.endSide=0,Mo.prototype.point=!1,Mo.prototype.mapMode=Nr.TrackDel;class No{constructor(t,e,n){this.from=t,this.to=e,this.value=n}static create(t,e,n){return new No(t,e,n)}}function Ro(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class Do{constructor(t,e,n,i){this.from=t,this.to=e,this.value=n,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(t,e,n,i=0){let r=n?this.to:this.from;for(let o=i,s=r.length;;){if(o==s)return o;let i=o+s>>1,a=r[i]-t||(n?this.value[i].endSide:this.value[i].startSide)-e;if(i==o)return a>=0?o:s;a>=0?s=i:o=i+1}}between(t,e,n,i){for(let r=this.findIndex(e,-1e9,!0),o=this.findIndex(n,1e9,!1,r);r<o;r++)if(!1===i(this.from[r]+t,this.to[r]+t,this.value[r]))return!1}map(t,e){let n=[],i=[],r=[],o=-1,s=-1;for(let a=0;a<this.value.length;a++){let l,c,h=this.value[a],u=this.from[a]+t,d=this.to[a]+t;if(u==d){let t=e.mapPos(u,h.startSide,h.mapMode);if(null==t)continue;if(l=c=t,h.startSide!=h.endSide&&(c=e.mapPos(u,h.endSide),c<l))continue}else if(l=e.mapPos(u,h.startSide),c=e.mapPos(d,h.endSide),l>c||l==c&&h.startSide>0&&h.endSide<=0)continue;(c-l||h.endSide-h.startSide)<0||(o<0&&(o=l),h.point&&(s=Math.max(s,c-l)),n.push(h),i.push(l-o),r.push(c-o))}return{mapped:n.length?new Do(i,r,n,s):null,pos:o}}}class Bo{constructor(t,e,n,i){this.chunkPos=t,this.chunk=e,this.nextLayer=n,this.maxPoint=i}static create(t,e,n,i){return new Bo(t,e,n,i)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:n=!1,filterFrom:i=0,filterTo:r=this.length}=t,o=t.filter;if(0==e.length&&!o)return this;if(n&&(e=e.slice().sort(Ro)),this.isEmpty)return e.length?Bo.of(e):this;let s=new Io(this,null,-1).goto(0),a=0,l=[],c=new $o;for(;s.value||a<e.length;)if(a<e.length&&(s.from-e[a].from||s.startSide-e[a].value.startSide)>=0){let t=e[a++];c.addInner(t.from,t.to,t.value)||l.push(t)}else 1==s.rangeIndex&&s.chunkIndex<this.chunk.length&&(a==e.length||this.chunkEnd(s.chunkIndex)<e[a].from)&&(!o||i>this.chunkEnd(s.chunkIndex)||r<this.chunkPos[s.chunkIndex])&&c.addChunk(this.chunkPos[s.chunkIndex],this.chunk[s.chunkIndex])?s.nextChunk():((!o||i>s.to||r<s.from||o(s.from,s.to,s.value))&&(c.addInner(s.from,s.to,s.value)||l.push(No.create(s.from,s.to,s.value))),s.next());return c.finishInner(this.nextLayer.isEmpty&&!l.length?Bo.empty:this.nextLayer.update({add:l,filter:o,filterFrom:i,filterTo:r}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],n=[],i=-1;for(let r=0;r<this.chunk.length;r++){let o=this.chunkPos[r],s=this.chunk[r],a=t.touchesRange(o,o+s.length);if(!1===a)i=Math.max(i,s.maxPoint),e.push(s),n.push(t.mapPos(o));else if(!0===a){let{mapped:r,pos:a}=s.map(o,t);r&&(i=Math.max(i,r.maxPoint),e.push(r),n.push(a))}}let r=this.nextLayer.map(t);return 0==e.length?r:new Bo(n,e,r||Bo.empty,i)}between(t,e,n){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let r=this.chunkPos[i],o=this.chunk[i];if(e>=r&&t<=r+o.length&&!1===o.between(r,t-r,e-r,n))return}this.nextLayer.between(t,e,n)}}iter(t=0){return qo.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return qo.from(t).goto(e)}static compare(t,e,n,i,r=-1){let o=t.filter(t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=r),s=e.filter(t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=r),a=Lo(o,s,n),l=new Vo(o,a,r),c=new Vo(s,a,r);n.iterGaps((t,e,n)=>jo(l,t,c,e,n,i)),n.empty&&0==n.length&&jo(l,0,c,0,0,i)}static eq(t,e,n=0,i){null==i&&(i=999999999);let r=t.filter(t=>!t.isEmpty&&e.indexOf(t)<0),o=e.filter(e=>!e.isEmpty&&t.indexOf(e)<0);if(r.length!=o.length)return!1;if(!r.length)return!0;let s=Lo(r,o),a=new Vo(r,s,0).goto(n),l=new Vo(o,s,0).goto(n);for(;;){if(a.to!=l.to||!Ho(a.active,l.active)||a.point&&(!l.point||!a.point.eq(l.point)))return!1;if(a.to>i)return!0;a.next(),l.next()}}static spans(t,e,n,i,r=-1){let o=new Vo(t,null,r).goto(e),s=e,a=o.openStart;for(;;){let t=Math.min(o.to,n);if(o.point){let n=o.activeForPoint(o.to),r=o.pointFrom<e?n.length+1:Math.min(n.length,a);i.point(s,t,o.point,n,r,o.pointRank),a=Math.min(o.openEnd(t),n.length)}else t>s&&(i.span(s,t,o.active,a),a=o.openEnd(t));if(o.to>n)return a+(o.point&&o.to>n?1:0);s=o.to,o.next()}}static of(t,e=!1){let n=new $o;for(let i of t instanceof No?[t]:e?function(t){if(t.length>1)for(let e=t[0],n=1;n<t.length;n++){let i=t[n];if(Ro(e,i)>0)return t.slice().sort(Ro);e=i}return t}(t):t)n.add(i.from,i.to,i.value);return n.finish()}static join(t){if(!t.length)return Bo.empty;let e=t[t.length-1];for(let n=t.length-2;n>=0;n--)for(let i=t[n];i!=Bo.empty;i=i.nextLayer)e=new Bo(i.chunkPos,i.chunk,e,Math.max(i.maxPoint,e.maxPoint));return e}}Bo.empty=new Bo([],[],null,-1),Bo.empty.nextLayer=Bo.empty;class $o{finishChunk(t){this.chunks.push(new Do(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,e,n){this.addInner(t,e,n)||(this.nextLayer||(this.nextLayer=new $o)).add(t,e,n)}addInner(t,e,n){let i=t-this.lastTo||n.startSide-this.last.endSide;if(i<=0&&(t-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(i<0||(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=n,this.lastFrom=t,this.lastTo=e,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),0))}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let n=e.value.length-1;return this.last=e.value[n],this.lastFrom=e.from[n]+t,this.lastTo=e.to[n]+t,!0}finish(){return this.finishInner(Bo.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return t;let e=Bo.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function Lo(t,e,n){let i=new Map;for(let e of t)for(let t=0;t<e.chunk.length;t++)e.chunk[t].maxPoint<=0&&i.set(e.chunk[t],e.chunkPos[t]);let r=new Set;for(let t of e)for(let e=0;e<t.chunk.length;e++){let o=i.get(t.chunk[e]);null==o||(n?n.mapPos(o):o)!=t.chunkPos[e]||(null==n?void 0:n.touchesRange(o,o+t.chunk[e].length))||r.add(t.chunk[e])}return r}class Io{constructor(t,e,n,i=0){this.layer=t,this.skip=e,this.minPoint=n,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,n){for(;this.chunkIndex<this.layer.chunk.length;){let e=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(e)||this.layer.chunkEnd(this.chunkIndex)<t||e.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!n||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],n=t+e.from[this.rangeIndex];if(this.from=n,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class qo{constructor(t){this.heap=t}static from(t,e=null,n=-1){let i=[];for(let r=0;r<t.length;r++)for(let o=t[r];!o.isEmpty;o=o.nextLayer)o.maxPoint>=n&&i.push(new Io(o,e,n,r));return 1==i.length?i[0]:new qo(i)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let n of this.heap)n.goto(t,e);for(let t=this.heap.length>>1;t>=0;t--)Fo(this.heap,t);return this.next(),this}forward(t,e){for(let n of this.heap)n.forward(t,e);for(let t=this.heap.length>>1;t>=0;t--)Fo(this.heap,t);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),Fo(this.heap,0)}}}function Fo(t,e){for(let n=t[e];;){let i=1+(e<<1);if(i>=t.length)break;let r=t[i];if(i+1<t.length&&r.compare(t[i+1])>=0&&(r=t[i+1],i++),n.compare(r)<0)break;t[i]=n,t[e]=r,e=i}}class Vo{constructor(t,e,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=qo.from(t,e,n)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){zo(this.active,t),zo(this.activeTo,t),zo(this.activeRank,t),this.minActive=Wo(this.active,this.activeTo)}addActive(t){let e=0,{value:n,to:i,rank:r}=this.cursor;for(;e<this.activeRank.length&&(r-this.activeRank[e]||i-this.activeTo[e])>0;)e++;Qo(this.active,e,n),Qo(this.activeTo,e,i),Qo(this.activeRank,e,r),t&&Qo(t,e,this.cursor.from),this.minActive=Wo(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let i=this.minActive;if(i>-1&&(this.activeTo[i]-this.cursor.from||this.active[i].endSide-this.cursor.startSide)<0){if(this.activeTo[i]>t){this.to=this.activeTo[i],this.endSide=this.active[i].endSide;break}this.removeActive(i),n&&zo(n,i)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let t=this.cursor.value;if(t.point){if(!(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=t,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=t.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(n),this.cursor.next()}}}if(n){this.openStart=0;for(let e=n.length-1;e>=0&&n[e]<t;e--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>t||this.activeTo[n]==t&&this.active[n].endSide>=this.point.endSide)&&e.push(this.active[n]);return e.reverse()}openEnd(t){let e=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>t;n--)e++;return e}}function jo(t,e,n,i,r,o){t.goto(e),n.goto(i);let s=i+r,a=i,l=i-e;for(;;){let e=t.to+l-n.to||t.endSide-n.endSide,i=e<0?t.to+l:n.to,r=Math.min(i,s);if(t.point||n.point?t.point&&n.point&&(t.point==n.point||t.point.eq(n.point))&&Ho(t.activeForPoint(t.to),n.activeForPoint(n.to))||o.comparePoint(a,r,t.point,n.point):r>a&&!Ho(t.active,n.active)&&o.compareRange(a,r,t.active,n.active),i>s)break;a=i,e<=0&&t.next(),e>=0&&n.next()}}function Ho(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!=e[n]&&!t[n].eq(e[n]))return!1;return!0}function zo(t,e){for(let n=e,i=t.length-1;n<i;n++)t[n]=t[n+1];t.pop()}function Qo(t,e,n){for(let n=t.length-1;n>=e;n--)t[n+1]=t[n];t[e]=n}function Wo(t,e){let n=-1,i=1e9;for(let r=0;r<e.length;r++)(e[r]-i||t[r].endSide-t[n].endSide)<0&&(n=r,i=e[r]);return n}function Xo(t,e,n=t.length){let i=0;for(let r=0;r<n;)9==t.charCodeAt(r)?(i+=e-i%e,r++):(i++,r=Or(t,r));return i}const Uo="undefined"==typeof Symbol?"__":Symbol.for(""),Go="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),Yo="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{};class Zo{constructor(t,e){this.rules=[];let{finish:n}=e||{};function i(t){return/^@/.test(t)?[t]:t.split(/,\s*/)}function r(t,e,o,s){let a=[],l=/^@(\w+)\b/.exec(t[0]),c=l&&"keyframes"==l[1];if(l&&null==e)return o.push(t[0]+";");for(let n in e){let s=e[n];if(/&/.test(n))r(n.split(/,\s*/).map(e=>t.map(t=>e.replace(/&/,t))).reduce((t,e)=>t.concat(e)),s,o);else if(s&&"object"==typeof s){if(!l)throw new RangeError("The value of a property ("+n+") should be a primitive value.");r(i(n),s,a,c)}else null!=s&&a.push(n.replace(/_.*/,"").replace(/[A-Z]/g,t=>"-"+t.toLowerCase())+": "+s+";")}(a.length||c)&&o.push((!n||l||s?t:t.map(n)).join(", ")+" {"+a.join(" ")+"}")}for(let e in t)r(i(e),t[e],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let t=Yo[Uo]||1;return Yo[Uo]=t+1,""+t.toString(36)}static mount(t,e,n){let i=t[Go],r=n&&n.nonce;i?r&&i.setNonce(r):i=new Jo(t,r),i.mount(Array.isArray(e)?e:[e])}}let Ko=new Map;class Jo{constructor(t,e){let n=t.ownerDocument||t,i=n.defaultView;if(!t.head&&t.adoptedStyleSheets&&i.CSSStyleSheet){let e=Ko.get(n);if(e)return t.adoptedStyleSheets=[e.sheet,...t.adoptedStyleSheets],t[Go]=e;this.sheet=new i.CSSStyleSheet,t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets],Ko.set(n,this)}else{this.styleTag=n.createElement("style"),e&&this.styleTag.setAttribute("nonce",e);let i=t.head||t;i.insertBefore(this.styleTag,i.firstChild)}this.modules=[],t[Go]=this}mount(t){let e=this.sheet,n=0,i=0;for(let r=0;r<t.length;r++){let o=t[r],s=this.modules.indexOf(o);if(s<i&&s>-1&&(this.modules.splice(s,1),i--,s=-1),-1==s){if(this.modules.splice(i++,0,o),e)for(let t=0;t<o.rules.length;t++)e.insertRule(o.rules[t],n++)}else{for(;i<s;)n+=this.modules[i++].rules.length;n+=o.rules.length,i++}}if(!e){let t="";for(let e=0;e<this.modules.length;e++)t+=this.modules[e].getRules()+"\n";this.styleTag.textContent=t}}setNonce(t){this.styleTag&&this.styleTag.getAttribute("nonce")!=t&&this.styleTag.setAttribute("nonce",t)}}for(var ts={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},es={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},ns="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),is="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),rs=0;rs<10;rs++)ts[48+rs]=ts[96+rs]=String(rs);for(rs=1;rs<=24;rs++)ts[rs+111]="F"+rs;for(rs=65;rs<=90;rs++)ts[rs]=String.fromCharCode(rs+32),es[rs]=String.fromCharCode(rs);for(var os in ts)es.hasOwnProperty(os)||(es[os]=ts[os]);function ss(t){let e;return e=11==t.nodeType?t.getSelection?t:t.ownerDocument:t,e.getSelection()}function as(t,e){return!!e&&(t==e||t.contains(1!=e.nodeType?e.parentNode:e))}function ls(t,e){if(!e.anchorNode)return!1;try{return as(t,e.anchorNode)}catch(t){return!1}}function cs(t){return 3==t.nodeType?ws(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function hs(t,e,n,i){return!!n&&(ds(t,e,n,i,-1)||ds(t,e,n,i,1))}function us(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function ds(t,e,n,i,r){for(;;){if(t==n&&e==i)return!0;if(e==(r<0?0:ps(t))){if("DIV"==t.nodeName)return!1;let n=t.parentNode;if(!n||1!=n.nodeType)return!1;e=us(t)+(r<0?0:1),t=n}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[e+(r<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;e=r<0?ps(t):0}}}function ps(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function fs(t,e){let n=e?t.left:t.right;return{left:n,right:n,top:t.top,bottom:t.bottom}}function gs(t){return{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function ms(t,e){let n=e.width/t.offsetWidth,i=e.height/t.offsetHeight;return(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.width-t.offsetWidth)<1)&&(n=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.height-t.offsetHeight)<1)&&(i=1),{scaleX:n,scaleY:i}}class vs{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:n}=t;this.set(e,Math.min(t.anchorOffset,e?ps(e):0),n,Math.min(t.focusOffset,n?ps(n):0))}set(t,e,n,i){this.anchorNode=t,this.anchorOffset=e,this.focusNode=n,this.focusOffset=i}}let ys,bs=null;function xs(t){if(t.setActive)return t.setActive();if(bs)return t.focus(bs);let e=[];for(let n=t;n&&(e.push(n,n.scrollTop,n.scrollLeft),n!=n.ownerDocument);n=n.parentNode);if(t.focus(null==bs?{get preventScroll(){return bs={preventScroll:!0},!0}}:void 0),!bs){bs=!1;for(let t=0;t<e.length;){let n=e[t++],i=e[t++],r=e[t++];n.scrollTop!=i&&(n.scrollTop=i),n.scrollLeft!=r&&(n.scrollLeft=r)}}}function ws(t,e,n=e){let i=ys||(ys=document.createRange());return i.setEnd(t,n),i.setStart(t,e),i}function _s(t,e,n){let i={key:e,code:e,keyCode:n,which:n,cancelable:!0},r=new KeyboardEvent("keydown",i);r.synthetic=!0,t.dispatchEvent(r);let o=new KeyboardEvent("keyup",i);return o.synthetic=!0,t.dispatchEvent(o),r.defaultPrevented||o.defaultPrevented}function Os(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function ks(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}class Ss{constructor(t,e,n=!0){this.node=t,this.offset=e,this.precise=n}static before(t,e){return new Ss(t.parentNode,us(t),e)}static after(t,e){return new Ss(t.parentNode,us(t)+1,e)}}const Es=[];class Cs{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let n of this.children){if(n==t)return e;e+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(2&this.flags){let n,i=this.dom,r=null;for(let o of this.children){if(7&o.flags){if(!o.dom&&(n=r?r.nextSibling:i.firstChild)){let t=Cs.get(n);(!t||!t.parent&&t.canReuseDOM(o))&&o.reuseDOM(n)}o.sync(t,e),o.flags&=-8}if(n=r?r.nextSibling:i.firstChild,e&&!e.written&&e.node==i&&n!=o.dom&&(e.written=!0),o.dom.parentNode==i)for(;n&&n!=o.dom;)n=As(n);else i.insertBefore(o.dom,n);r=o.dom}for(n=r?r.nextSibling:i.firstChild,n&&e&&e.node==i&&(e.written=!0);n;)n=As(n)}else if(1&this.flags)for(let n of this.children)7&n.flags&&(n.sync(t,e),n.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let n;if(t==this.dom)n=this.dom.childNodes[e];else{let i=0==ps(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==i&&e.firstChild!=e.lastChild&&(i=t==e.firstChild?-1:1),t=e}n=i<0?t:t.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!Cs.get(n);)n=n.nextSibling;if(!n)return this.length;for(let t=0,e=0;;t++){let i=this.children[t];if(i.dom==n)return e;e+=i.length+i.breakAfter}}domBoundsAround(t,e,n=0){let i=-1,r=-1,o=-1,s=-1;for(let a=0,l=n,c=n;a<this.children.length;a++){let n=this.children[a],h=l+n.length;if(l<t&&h>e)return n.domBoundsAround(t,e,l);if(h>=t&&-1==i&&(i=a,r=l),l>e&&n.dom.parentNode==this.dom){o=a,s=c;break}c=h,l=h+n.breakAfter}return{from:r,to:s<0?n+this.length:s,startDOM:(i?this.children[i-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),1&e.flags)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,7&this.flags&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,n=Es){this.markDirty();for(let i=t;i<e;i++){let t=this.children[i];t.parent==this&&n.indexOf(t)<0&&t.destroy()}this.children.splice(t,e-t,...n);for(let t=0;t<n.length;t++)n[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new Ts(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,n,i,r,o){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!(8&(this.flags|t.flags))}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}function As(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}Cs.prototype.breakAfter=0;class Ts{constructor(t,e,n){this.children=t,this.pos=e,this.i=n,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function Ps(t,e,n,i,r,o,s,a,l){let{children:c}=t,h=c.length?c[e]:null,u=o.length?o[o.length-1]:null,d=u?u.breakAfter:s;if(!(e==i&&h&&!s&&!d&&o.length<2&&h.merge(n,r,o.length?u:null,0==n,a,l))){if(i<c.length){let t=c[i];t&&(r<t.length||t.breakAfter&&(null==u?void 0:u.breakAfter))?(e==i&&(t=t.split(r),r=0),!d&&u&&t.merge(0,r,u,!0,0,l)?o[o.length-1]=t:((r||t.children.length&&!t.children[0].length)&&t.merge(0,r,null,!1,0,l),o.push(t))):(null==t?void 0:t.breakAfter)&&(u?u.breakAfter=1:s=1),i++}for(h&&(h.breakAfter=s,n>0&&(!s&&o.length&&h.merge(n,h.length,o[0],!1,a,0)?h.breakAfter=o.shift().breakAfter:(n<h.length||h.children.length&&0==h.children[h.children.length-1].length)&&h.merge(n,h.length,null,!1,a,0),e++));e<i&&o.length;)if(c[i-1].become(o[o.length-1]))i--,o.pop(),l=o.length?0:a;else{if(!c[e].become(o[0]))break;e++,o.shift(),a=o.length?0:l}!o.length&&e&&i<c.length&&!c[e-1].breakAfter&&c[i].merge(0,0,c[e-1],!1,a,l)&&e--,(e<i||o.length)&&t.replaceChildren(e,i,o)}}function Ms(t,e,n,i,r,o){let s=t.childCursor(),{i:a,off:l}=s.findPos(n,1),{i:c,off:h}=s.findPos(e,-1),u=e-n;for(let t of i)u+=t.length;t.length+=u,Ps(t,c,h,a,l,i,0,r,o)}let Ns="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},Rs="undefined"!=typeof document?document:{documentElement:{style:{}}};const Ds=/Edge\/(\d+)/.exec(Ns.userAgent),Bs=/MSIE \d/.test(Ns.userAgent),$s=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ns.userAgent),Ls=!!(Bs||$s||Ds),Is=!Ls&&/gecko\/(\d+)/i.test(Ns.userAgent),qs=!Ls&&/Chrome\/(\d+)/.exec(Ns.userAgent),Fs="webkitFontSmoothing"in Rs.documentElement.style,Vs=!Ls&&/Apple Computer/.test(Ns.vendor),js=Vs&&(/Mobile\/\w+/.test(Ns.userAgent)||Ns.maxTouchPoints>2);var Hs={mac:js||/Mac/.test(Ns.platform),windows:/Win/.test(Ns.platform),linux:/Linux|X11/.test(Ns.platform),ie:Ls,ie_version:Bs?Rs.documentMode||6:$s?+$s[1]:Ds?+Ds[1]:0,gecko:Is,gecko_version:Is?+(/Firefox\/(\d+)/.exec(Ns.userAgent)||[0,0])[1]:0,chrome:!!qs,chrome_version:qs?+qs[1]:0,ios:js,android:/Android\b/.test(Ns.userAgent),safari:Vs,webkit_version:Fs?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=Rs.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class zs extends Cs{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){3==t.nodeType&&this.createDOM(t)}merge(t,e,n){return!(8&this.flags||n&&(!(n instanceof zs)||this.length-(e-t)+n.length>256||8&n.flags)||(this.text=this.text.slice(0,t)+(n?n.text:"")+this.text.slice(e),this.markDirty(),0))}split(t){let e=new zs(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=8&this.flags,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new Ss(this.dom,t)}domBoundsAround(t,e,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return function(t,e,n){let i=t.nodeValue.length;e>i&&(e=i);let r=e,o=e,s=0;0==e&&n<0||e==i&&n>=0?Hs.chrome||Hs.gecko||(e?(r--,s=1):o<i&&(o++,s=-1)):n<0?r--:o<i&&o++;let a=ws(t,r,o).getClientRects();if(!a.length)return null;let l=a[(s?s<0:n>=0)?0:a.length-1];return Hs.safari&&!s&&0==l.width&&(l=Array.prototype.find.call(a,t=>t.width)||l),s?fs(l,s<0):l||null}(this.dom,t,e)}}class Qs extends Cs{constructor(t,e=[],n=0){super(),this.mark=t,this.children=e,this.length=n;for(let t of e)t.setParent(this)}setAttrs(t){if(Os(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!(8&(this.flags|t.flags))}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,n,i,r,o){return!(n&&(!(n instanceof Qs&&n.mark.eq(this.mark))||t&&r<=0||e<this.length&&o<=0)||(Ms(this,t,e,n?n.children.slice():[],r-1,o-1),this.markDirty(),0))}split(t){let e=[],n=0,i=-1,r=0;for(let o of this.children){let s=n+o.length;s>t&&e.push(n<t?o.split(t-n):o),i<0&&n>=t&&(i=r),n=s,r++}let o=this.length-t;return this.length=t,i>-1&&(this.children.length=i,this.markDirty()),new Qs(this.mark,e,o)}domAtPos(t){return Us(this,t)}coordsAt(t,e){return Ys(this,t,e)}}class Ws extends Cs{static create(t,e,n){return new Ws(t,e,n)}constructor(t,e,n){super(),this.widget=t,this.length=e,this.side=n,this.prevWidget=null}split(t){let e=Ws.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,n,i,r,o){return!(n&&(!(n instanceof Ws&&this.widget.compare(n.widget))||t>0&&r<=0||e<this.length&&o<=0)||(this.length=t+(n?n.length:0)+(this.length-e),0))}become(t){return t instanceof Ws&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return hr.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,n=e&&e.state.doc,i=this.posAtStart;return n?n.slice(i,i+this.length):hr.empty}domAtPos(t){return(this.length?0==t:this.side>0)?Ss.before(this.dom):Ss.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let n=this.widget.coordsAt(this.dom,t,e);if(n)return n;let i=this.dom.getClientRects(),r=null;if(!i.length)return null;let o=this.side?this.side<0:t>0;for(let e=o?i.length-1:0;r=i[e],!(t>0?0==e:e==i.length-1||r.top<r.bottom);e+=o?-1:1);return fs(r,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Xs extends Cs{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof Xs&&t.side==this.side}split(){return new Xs(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?Ss.before(this.dom):Ss.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return hr.empty}get isHidden(){return!0}}function Us(t,e){let n=t.dom,{children:i}=t,r=0;for(let t=0;r<i.length;r++){let o=i[r],s=t+o.length;if(!(s==t&&o.getSide()<=0)){if(e>t&&e<s&&o.dom.parentNode==n)return o.domAtPos(e-t);if(e<=t)break;t=s}}for(let t=r;t>0;t--){let e=i[t-1];if(e.dom.parentNode==n)return e.domAtPos(e.length)}for(let t=r;t<i.length;t++){let e=i[t];if(e.dom.parentNode==n)return e.domAtPos(0)}return new Ss(n,0)}function Gs(t,e,n){let i,{children:r}=t;n>0&&e instanceof Qs&&r.length&&(i=r[r.length-1])instanceof Qs&&i.mark.eq(e.mark)?Gs(i,e.children[0],n-1):(r.push(e),e.setParent(t)),t.length+=e.length}function Ys(t,e,n){let i=null,r=-1,o=null,s=-1;!function t(e,a){for(let l=0,c=0;l<e.children.length&&c<=a;l++){let h=e.children[l],u=c+h.length;u>=a&&(h.children.length?t(h,a-c):(!o||o.isHidden&&n>0)&&(u>a||c==u&&h.getSide()>0)?(o=h,s=a-c):(c<a||c==u&&h.getSide()<0&&!h.isHidden)&&(i=h,r=a-c)),c=u}}(t,e);let a=(n<0?i:o)||i||o;return a?a.coordsAt(Math.max(0,a==i?r:s),n):function(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let n=cs(e);return n[n.length-1]||null}(t)}function Zs(t,e){for(let n in t)"class"==n&&e.class?e.class+=" "+t.class:"style"==n&&e.style?e.style+=";"+t.style:e[n]=t[n];return e}zs.prototype.children=Ws.prototype.children=Xs.prototype.children=Es;const Ks=Object.create(null);function Js(t,e,n){if(t==e)return!0;t||(t=Ks),e||(e=Ks);let i=Object.keys(t),r=Object.keys(e);if(i.length-(n&&i.indexOf(n)>-1?1:0)!=r.length-(n&&r.indexOf(n)>-1?1:0))return!1;for(let o of i)if(o!=n&&(-1==r.indexOf(o)||t[o]!==e[o]))return!1;return!0}function ta(t,e,n){let i=!1;if(e)for(let r in e)n&&r in n||(i=!0,"style"==r?t.style.cssText="":t.removeAttribute(r));if(n)for(let r in n)e&&e[r]==n[r]||(i=!0,"style"==r?t.style.cssText=n[r]:t.setAttribute(r,n[r]));return i}function ea(t){let e=Object.create(null);for(let n=0;n<t.attributes.length;n++){let i=t.attributes[n];e[i.name]=i.value}return e}class na extends Cs{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,n,i,r,o){if(n){if(!(n instanceof na))return!1;this.dom||n.transferDOM(this)}return i&&this.setDeco(n?n.attrs:null),Ms(this,t,e,n?n.children.slice():[],r,o),!0}split(t){let e=new na;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:n,off:i}=this.childPos(t);i&&(e.append(this.children[n].split(i),0),this.children[n].merge(i,this.children[n].length,null,!1,0,0),n++);for(let t=n;t<this.children.length;t++)e.append(this.children[t],0);for(;n>0&&0==this.children[n-1].length;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){Js(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){Gs(this,t,e)}addLineDeco(t){let e=t.spec.attributes,n=t.spec.class;e&&(this.attrs=Zs(e,this.attrs||{})),n&&(this.attrs=Zs({class:n},this.attrs||{}))}domAtPos(t){return Us(this,t)}reuseDOM(t){"DIV"==t.nodeName&&(this.setDOM(t),this.flags|=6)}sync(t,e){var n;this.dom?4&this.flags&&(Os(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(ta(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let i=this.dom.lastChild;for(;i&&Cs.get(i)instanceof Qs;)i=i.lastChild;if(!(i&&this.length&&("BR"==i.nodeName||0!=(null===(n=Cs.get(i))||void 0===n?void 0:n.isEditable)||Hs.ios&&this.children.some(t=>t instanceof zs)))){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t,e=0;for(let n of this.children){if(!(n instanceof zs)||/[^ -~]/.test(n.text))return null;let i=cs(n.dom);if(1!=i.length)return null;e+=i[0].width,t=i[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(t,e){let n=Ys(this,t,e);if(!this.children.length&&n&&this.parent){let{heightOracle:t}=this.parent.view.viewState,e=n.bottom-n.top;if(Math.abs(e-t.lineHeight)<2&&t.textHeight<e){let i=(e-t.textHeight)/2;return{top:n.top+i,bottom:n.bottom-i,left:n.left,right:n.left}}}return n}become(t){return!1}covers(){return!0}static find(t,e){for(let n=0,i=0;n<t.children.length;n++){let r=t.children[n],o=i+r.length;if(o>=e){if(r instanceof na)return r;if(o>e)break}i=o+r.breakAfter}return null}}class ia extends Cs{constructor(t,e,n){super(),this.widget=t,this.length=e,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(t,e,n,i,r,o){return!(n&&(!(n instanceof ia&&this.widget.compare(n.widget))||t>0&&r<=0||e<this.length&&o<=0)||(this.length=t+(n?n.length:0)+(this.length-e),0))}domAtPos(t){return 0==t?Ss.before(this.dom):Ss.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let n=new ia(this.widget,e,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return Es}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):hr.empty}domBoundsAround(){return null}become(t){return t instanceof ia&&t.widget.constructor==this.widget.constructor&&(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){return this.widget.coordsAt(this.dom,t,e)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:n}=this.deco;return e!=n&&(t<0?e<0:n>0)}}class ra{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var oa=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(oa||(oa={}));class sa extends Mo{constructor(t,e,n,i){super(),this.startSide=t,this.endSide=e,this.widget=n,this.spec=i}get heightRelevant(){return!1}static mark(t){return new aa(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),n=!!t.block;return e+=n&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new ca(t,e,e,n,t.widget||null,!1)}static replace(t){let e,n,i=!!t.block;if(t.isBlockGap)e=-5e8,n=4e8;else{let{start:r,end:o}=ha(t,i);e=(r?i?-3e8:-1:5e8)-1,n=1+(o?i?2e8:1:-6e8)}return new ca(t,e,n,i,t.widget||null,!0)}static line(t){return new la(t)}static set(t,e=!1){return Bo.of(t,e)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}sa.none=Bo.empty;class aa extends sa{constructor(t){let{start:e,end:n}=ha(t);super(e?-1:5e8,n?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,n;return this==t||t instanceof aa&&this.tagName==t.tagName&&(this.class||(null===(e=this.attrs)||void 0===e?void 0:e.class))==(t.class||(null===(n=t.attrs)||void 0===n?void 0:n.class))&&Js(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}aa.prototype.point=!1;class la extends sa{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof la&&this.spec.class==t.spec.class&&Js(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}la.prototype.mapMode=Nr.TrackBefore,la.prototype.point=!0;class ca extends sa{constructor(t,e,n,i,r,o){super(e,n,r,t),this.block=i,this.isReplace=o,this.mapMode=i?e<=0?Nr.TrackBefore:Nr.TrackAfter:Nr.TrackDel}get type(){return this.startSide!=this.endSide?oa.WidgetRange:this.startSide<=0?oa.WidgetBefore:oa.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof ca&&function(t,e){return t==e||!!(t&&e&&t.compare(e))}(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}function ha(t,e=!1){let{inclusiveStart:n,inclusiveEnd:i}=t;return null==n&&(n=t.inclusive),null==i&&(i=t.inclusive),{start:null!=n?n:e,end:null!=i?i:e}}function ua(t,e,n,i=0){let r=n.length-1;r>=0&&n[r]+i>=t?n[r]=Math.max(n[r],e):n.push(t,e)}ca.prototype.point=!0;class da{constructor(t,e,n,i){this.doc=t,this.pos=e,this.end=n,this.disallowBlockEffectsFor=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof ia&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new na),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(pa(new Xs(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||t&&this.content.length&&this.content[this.content.length-1]instanceof ia||this.getLine()}buildText(t,e,n){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:n,done:i}=this.cursor.next(this.skip);if(this.skip=0,i)throw new Error("Ran out of text content when drawing inline views");if(n){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}this.text=e,this.textOff=0}let i=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-n)),this.getLine().append(pa(new zs(this.text.slice(this.textOff,this.textOff+i)),e),n),this.atCursorPos=!0,this.textOff+=i,t-=i,n=0}}span(t,e,n,i){this.buildText(e-t,n,i),this.pos=e,this.openStart<0&&(this.openStart=i)}point(t,e,n,i,r,o){if(this.disallowBlockEffectsFor[o]&&n instanceof ca){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let s=e-t;if(n instanceof ca)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new ia(n.widget||new fa("div"),s,n));else{let o=Ws.create(n.widget||new fa("span"),s,s?0:n.startSide),a=this.atCursorPos&&!o.isEditable&&r<=i.length&&(t<e||n.startSide>0),l=!o.isEditable&&(t<e||r>i.length||n.startSide<=0),c=this.getLine();2!=this.pendingBuffer||a||o.isEditable||(this.pendingBuffer=0),this.flushBuffer(i),a&&(c.append(pa(new Xs(1),i),r),r=i.length+Math.max(0,r-i.length)),c.append(pa(o,i),r),this.atCursorPos=l,this.pendingBuffer=l?t<e||r>i.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=i.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);s&&(this.textOff+s<=this.text.length?this.textOff+=s:(this.skip+=s-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=r)}static build(t,e,n,i,r){let o=new da(t,e,n,r);return o.openEnd=Bo.spans(i,e,n,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function pa(t,e){for(let n of e)t=new Qs(n,[t],t.length);return t}class fa extends ra{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}var ga=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(ga||(ga={}));const ma=ga.LTR,va=ga.RTL;function ya(t){let e=[];for(let n=0;n<t.length;n++)e.push(1<<+t[n]);return e}const ba=ya("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),xa=ya("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),wa=Object.create(null),_a=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),n=t.charCodeAt(1);wa[e]=n,wa[n]=-e}function Oa(t){return t<=247?ba[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?xa[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const ka=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Sa{get dir(){return this.level%2?va:ma}constructor(t,e,n){this.from=t,this.to=e,this.level=n}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,n,i){let r=-1;for(let o=0;o<t.length;o++){let s=t[o];if(s.from<=e&&s.to>=e){if(s.level==n)return o;(r<0||(0!=i?i<0?s.from<e:s.to>e:t[r].level>s.level))&&(r=o)}}if(r<0)throw new RangeError("Index out of range");return r}}function Ea(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++){let i=t[n],r=e[n];if(i.from!=r.from||i.to!=r.to||i.direction!=r.direction||!Ea(i.inner,r.inner))return!1}return!0}const Ca=[];function Aa(t,e,n,i,r,o,s){let a=i%2?2:1;if(i%2==r%2)for(let l=e,c=0;l<n;){let e=!0,h=!1;if(c==o.length||l<o[c].from){let t=Ca[l];t!=a&&(e=!1,h=16==t)}let u=e||1!=a?null:[],d=e?i:i+1,p=l;t:for(;;)if(c<o.length&&p==o[c].from){if(h)break t;let f=o[c];if(!e)for(let t=f.to,e=c+1;;){if(t==n)break t;if(!(e<o.length&&o[e].from==t)){if(Ca[t]==a)break t;break}t=o[e++].to}c++,u?u.push(f):(f.from>l&&s.push(new Sa(l,f.from,d)),Ta(t,f.direction==ma!=!(d%2)?i+1:i,r,f.inner,f.from,f.to,s),l=f.to),p=f.to}else{if(p==n||(e?Ca[p]!=a:Ca[p]==a))break;p++}u?Aa(t,l,p,i+1,r,u,s):l<p&&s.push(new Sa(l,p,d)),l=p}else for(let l=n,c=o.length;l>e;){let n=!0,h=!1;if(!c||l>o[c-1].to){let t=Ca[l-1];t!=a&&(n=!1,h=16==t)}let u=n||1!=a?null:[],d=n?i:i+1,p=l;t:for(;;)if(c&&p==o[c-1].to){if(h)break t;let f=o[--c];if(!n)for(let t=f.from,n=c;;){if(t==e)break t;if(!n||o[n-1].to!=t){if(Ca[t-1]==a)break t;break}t=o[--n].from}u?u.push(f):(f.to<l&&s.push(new Sa(f.to,l,d)),Ta(t,f.direction==ma!=!(d%2)?i+1:i,r,f.inner,f.from,f.to,s),l=f.from),p=f.from}else{if(p==e||(n?Ca[p-1]!=a:Ca[p-1]==a))break;p--}u?Aa(t,p,l,i+1,r,u,s):p<l&&s.push(new Sa(p,l,d)),l=p}}function Ta(t,e,n,i,r,o,s){let a=e%2?2:1;!function(t,e,n,i,r){for(let o=0;o<=i.length;o++){let s=o?i[o-1].to:e,a=o<i.length?i[o].from:n,l=o?256:r;for(let e=s,n=l,i=l;e<a;e++){let r=Oa(t.charCodeAt(e));512==r?r=n:8==r&&4==i&&(r=16),Ca[e]=4==r?2:r,7&r&&(i=r),n=r}for(let t=s,e=l,i=l;t<a;t++){let r=Ca[t];if(128==r)t<a-1&&e==Ca[t+1]&&24&e?r=Ca[t]=e:Ca[t]=256;else if(64==r){let r=t+1;for(;r<a&&64==Ca[r];)r++;let o=t&&8==e||r<n&&8==Ca[r]?1==i?1:8:256;for(let e=t;e<r;e++)Ca[e]=o;t=r-1}else 8==r&&1==i&&(Ca[t]=1);e=r,7&r&&(i=r)}}}(t,r,o,i,a),function(t,e,n,i,r){let o=1==r?2:1;for(let s=0,a=0,l=0;s<=i.length;s++){let c=s?i[s-1].to:e,h=s<i.length?i[s].from:n;for(let e,n,i,s=c;s<h;s++)if(n=wa[e=t.charCodeAt(s)])if(n<0){for(let t=a-3;t>=0;t-=3)if(_a[t+1]==-n){let e=_a[t+2],n=2&e?r:4&e?1&e?o:r:0;n&&(Ca[s]=Ca[_a[t]]=n),a=t;break}}else{if(189==_a.length)break;_a[a++]=s,_a[a++]=e,_a[a++]=l}else if(2==(i=Ca[s])||1==i){let t=i==r;l=t?0:1;for(let e=a-3;e>=0;e-=3){let n=_a[e+2];if(2&n)break;if(t)_a[e+2]|=2;else{if(4&n)break;_a[e+2]|=4}}}}}(t,r,o,i,a),function(t,e,n,i){for(let r=0,o=i;r<=n.length;r++){let s=r?n[r-1].to:t,a=r<n.length?n[r].from:e;for(let l=s;l<a;){let s=Ca[l];if(256==s){let s=l+1;for(;;)if(s==a){if(r==n.length)break;s=n[r++].to,a=r<n.length?n[r].from:e}else{if(256!=Ca[s])break;s++}let c=1==o,h=c==(1==(s<e?Ca[s]:i))?c?1:2:i;for(let e=s,i=r,o=i?n[i-1].to:t;e>l;)e==o&&(e=n[--i].from,o=i?n[i-1].to:t),Ca[--e]=h;l=s}else o=s,l++}}}(r,o,i,a),Aa(t,r,o,e,n,i,s)}function Pa(t){return[new Sa(0,t,0)]}let Ma="";function Na(t,e,n,i,r){var o;let s=i.head-t.from,a=Sa.find(e,s,null!==(o=i.bidiLevel)&&void 0!==o?o:-1,i.assoc),l=e[a],c=l.side(r,n);if(s==c){let t=a+=r?1:-1;if(t<0||t>=e.length)return null;l=e[a=t],s=l.side(!r,n),c=l.side(r,n)}let h=Or(t.text,s,l.forward(r,n));(h<l.from||h>l.to)&&(h=c),Ma=t.text.slice(Math.min(s,h),Math.max(s,h));let u=a==(r?e.length-1:0)?null:e[a+(r?1:-1)];return u&&h==c&&u.level+(r?0:1)<l.level?jr.cursor(u.side(!r,n)+t.from,u.forward(r,n)?1:-1,u.level):jr.cursor(h+t.from,l.forward(r,n)?-1:1,l.level)}function Ra(t,e,n){for(let i=e;i<n;i++){let e=Oa(t.charCodeAt(i));if(1==e)return ma;if(2==e||4==e)return va}return ma}const Da=Qr.define(),Ba=Qr.define(),$a=Qr.define(),La=Qr.define(),Ia=Qr.define(),qa=Qr.define(),Fa=Qr.define(),Va=Qr.define({combine:t=>t.some(t=>t)}),ja=Qr.define({combine:t=>t.some(t=>t)});class Ha{constructor(t,e="nearest",n="nearest",i=5,r=5,o=!1){this.range=t,this.y=e,this.x=n,this.yMargin=i,this.xMargin=r,this.isSnapshot=o}map(t){return t.empty?this:new Ha(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new Ha(jr.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const za=yo.define({map:(t,e)=>t.map(e)});function Qa(t,e,n){let i=t.facet(La);i.length?i[0](e):window.onerror?window.onerror(String(e),n,void 0,void 0,e):n?console.error(n+":",e):console.error(e)}const Wa=Qr.define({combine:t=>!t.length||t[0]});let Xa=0;const Ua=Qr.define();class Ga{constructor(t,e,n,i,r){this.id=t,this.create=e,this.domEventHandlers=n,this.domEventObservers=i,this.extension=r(this)}static define(t,e){const{eventHandlers:n,eventObservers:i,provide:r,decorations:o}=e||{};return new Ga(Xa++,t,n,i,t=>{let e=[Ua.of(t)];return o&&e.push(Ja.of(e=>{let n=e.plugin(t);return n?o(n):sa.none})),r&&e.push(r(t)),e})}static fromClass(t,e){return Ga.define(e=>new t(e),e)}}class Ya{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(e){if(Qa(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){Qa(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null===(e=this.value)||void 0===e?void 0:e.destroy)try{this.value.destroy()}catch(e){Qa(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Za=Qr.define(),Ka=Qr.define(),Ja=Qr.define(),tl=Qr.define(),el=Qr.define(),nl=Qr.define();function il(t,e){let n=t.state.facet(nl);if(!n.length)return n;let i=n.map(e=>e instanceof Function?e(t):e),r=[];return Bo.spans(i,e.from,e.to,{point(){},span(t,n,i,o){let s=t-e.from,a=n-e.from,l=r;for(let t=i.length-1;t>=0;t--,o--){let n,r=i[t].spec.bidiIsolate;if(null==r&&(r=Ra(e.text,s,a)),o>0&&l.length&&(n=l[l.length-1]).to==s&&n.direction==r)n.to=a,l=n.inner;else{let t={from:s,to:a,direction:r,inner:[]};l.push(t),l=t.inner}}}}),r}const rl=Qr.define();function ol(t){let e=0,n=0,i=0,r=0;for(let o of t.state.facet(rl)){let s=o(t);s&&(null!=s.left&&(e=Math.max(e,s.left)),null!=s.right&&(n=Math.max(n,s.right)),null!=s.top&&(i=Math.max(i,s.top)),null!=s.bottom&&(r=Math.max(r,s.bottom)))}return{left:e,right:n,top:i,bottom:r}}const sl=Qr.define();class al{constructor(t,e,n,i){this.fromA=t,this.toA=e,this.fromB=n,this.toB=i}join(t){return new al(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,n=this;for(;e>0;e--){let i=t[e-1];if(!(i.fromA>n.toA)){if(i.toA<n.fromA)break;n=n.join(i),t.splice(e-1,1)}}return t.splice(e,0,n),t}static extendWithRanges(t,e){if(0==e.length)return t;let n=[];for(let i=0,r=0,o=0,s=0;;i++){let a=i==t.length?null:t[i],l=o-s,c=a?a.fromB:1e9;for(;r<e.length&&e[r]<c;){let t=e[r],i=e[r+1],o=Math.max(s,t),a=Math.min(c,i);if(o<=a&&new al(o+l,a+l,o,a).addToSet(n),i>c)break;r+=2}if(!a)return n;new al(a.fromA,a.toA,a.fromB,a.toB).addToSet(n),o=a.toA,s=a.toB}}}class ll{constructor(t,e,n){this.view=t,this.state=e,this.transactions=n,this.flags=0,this.startState=t.state,this.changes=Dr.empty(this.startState.doc.length);for(let t of n)this.changes=this.changes.compose(t.changes);let i=[];this.changes.iterChangedRanges((t,e,n,r)=>i.push(new al(t,e,n,r))),this.changedRanges=i}static create(t,e,n){return new ll(t,e,n)}get viewportChanged(){return(4&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(10&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return 0==this.flags&&0==this.transactions.length}}class cl extends Cs{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new na],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new al(0,0,0,t.state.doc.length)],0,null)}update(t){var e;let n=t.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let i=-1;this.view.inputState.composing>=0&&((null===(e=this.domChanged)||void 0===e?void 0:e.newSel)?i=this.domChanged.newSel.head:function(t,e){let n=!1;return e&&t.iterChangedRanges((t,i)=>{t<e.to&&i>e.from&&(n=!0)}),n}(t.changes,this.hasComposition)||t.selectionSet||(i=t.state.selection.main.head));let r=i>-1?function(t,e,n){let i=ul(t,n);if(!i)return null;let{node:r,from:o,to:s}=i,a=r.nodeValue;if(/[\n\r]/.test(a))return null;if(t.state.doc.sliceString(i.from,i.to)!=a)return null;let l=e.invertedDesc,c=new al(l.mapPos(o),l.mapPos(s),o,s),h=[];for(let e=r.parentNode;;e=e.parentNode){let n=Cs.get(e);if(n instanceof Qs)h.push({node:e,deco:n.mark});else{if(n instanceof na||"DIV"==e.nodeName&&e.parentNode==t.contentDOM)return{range:c,text:r,marks:h,line:e};if(e==t.contentDOM)return null;h.push({node:e,deco:new aa({inclusive:!0,attributes:ea(e),tagName:e.tagName.toLowerCase()})})}}}(this.view,t.changes,i):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:e,to:i}=this.hasComposition;n=new al(e,i,t.changes.mapPos(e,-1),t.changes.mapPos(i,1)).addToSet(n.slice())}this.hasComposition=r?{from:r.range.fromB,to:r.range.toB}:null,(Hs.ie||Hs.chrome)&&!r&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let o=function(t,e,n){let i=new pl;return Bo.compare(t,e,n,i),i.changes}(this.decorations,this.updateDeco(),t.changes);return n=al.extendWithRanges(n,o),!!(7&this.flags||0!=n.length)&&(this.updateInner(n,t.startState.doc.length,r),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,n);let{observer:i}=this.view;i.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let t=Hs.chrome||Hs.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,t),this.flags&=-8,t&&(t.written||i.selectionRange.focusNode!=t.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(t=>t.flags&=-9);let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let t of this.children)t instanceof ia&&t.widget instanceof hl&&r.push(t.dom);i.updateGaps(r)}updateChildren(t,e,n){let i=n?n.range.addToSet(t.slice()):t,r=this.childCursor(e);for(let t=i.length-1;;t--){let e=t>=0?i[t]:null;if(!e)break;let o,s,a,l,{fromA:c,toA:h,fromB:u,toB:d}=e;if(n&&n.range.fromB<d&&n.range.toB>u){let t=da.build(this.view.state.doc,u,n.range.fromB,this.decorations,this.dynamicDecorationMap),e=da.build(this.view.state.doc,n.range.toB,d,this.decorations,this.dynamicDecorationMap);s=t.breakAtStart,a=t.openStart,l=e.openEnd;let i=this.compositionView(n);e.breakAtStart?i.breakAfter=1:e.content.length&&i.merge(i.length,i.length,e.content[0],!1,e.openStart,0)&&(i.breakAfter=e.content[0].breakAfter,e.content.shift()),t.content.length&&i.merge(0,0,t.content[t.content.length-1],!0,0,t.openEnd)&&t.content.pop(),o=t.content.concat(i).concat(e.content)}else({content:o,breakAtStart:s,openStart:a,openEnd:l}=da.build(this.view.state.doc,u,d,this.decorations,this.dynamicDecorationMap));let{i:p,off:f}=r.findPos(h,1),{i:g,off:m}=r.findPos(c,-1);Ps(this,g,m,p,f,o,s,a,l)}n&&this.fixCompositionDOM(n)}compositionView(t){let e=new zs(t.text.nodeValue);e.flags|=8;for(let{deco:n}of t.marks)e=new Qs(n,[e],e.length);let n=new na;return n.append(e,0),n}fixCompositionDOM(t){let e=(t,e)=>{e.flags|=8|(e.children.some(t=>7&t.flags)?1:0),this.markedForComposition.add(e);let n=Cs.get(t);n&&n!=e&&(n.dom=null),e.setDOM(t)},n=this.childPos(t.range.fromB,1),i=this.children[n.i];e(t.line,i);for(let r=t.marks.length-1;r>=-1;r--)n=i.childPos(n.off,1),i=i.children[n.i],e(r>=0?t.marks[r].node:t.text,i)}updateSelection(t=!1,e=!1){!t&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();let n=this.view.root.activeElement,i=n==this.dom,r=!i&&ls(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(i||e||r))return;let o=this.forceSelection;this.forceSelection=!1;let s=this.view.state.selection.main,a=this.moveToLine(this.domAtPos(s.anchor)),l=s.empty?a:this.moveToLine(this.domAtPos(s.head));if(Hs.gecko&&s.empty&&!this.hasComposition&&1==(c=a).node.nodeType&&c.node.firstChild&&(0==c.offset||"false"==c.node.childNodes[c.offset-1].contentEditable)&&(c.offset==c.node.childNodes.length||"false"==c.node.childNodes[c.offset].contentEditable)){let t=document.createTextNode("");this.view.observer.ignore(()=>a.node.insertBefore(t,a.node.childNodes[a.offset]||null)),a=l=new Ss(t,0),o=!0}var c;let h=this.view.observer.selectionRange;!o&&h.focusNode&&(hs(a.node,a.offset,h.anchorNode,h.anchorOffset)&&hs(l.node,l.offset,h.focusNode,h.focusOffset)||this.suppressWidgetCursorChange(h,s))||(this.view.observer.ignore(()=>{Hs.android&&Hs.chrome&&this.dom.contains(h.focusNode)&&function(t,e){for(let n=t;n&&n!=e;n=n.assignedSlot||n.parentNode)if(1==n.nodeType&&"false"==n.contentEditable)return!0;return!1}(h.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let t=ss(this.view.root);if(t)if(s.empty){if(Hs.gecko){let t=(e=a.node,i=a.offset,1!=e.nodeType?0:(i&&"false"==e.childNodes[i-1].contentEditable?1:0)|(i<e.childNodes.length&&"false"==e.childNodes[i].contentEditable?2:0));if(t&&3!=t){let e=dl(a.node,a.offset,1==t?1:-1);e&&(a=new Ss(e.node,e.offset))}}t.collapse(a.node,a.offset),null!=s.bidiLevel&&void 0!==t.caretBidiLevel&&(t.caretBidiLevel=s.bidiLevel)}else if(t.extend){t.collapse(a.node,a.offset);try{t.extend(l.node,l.offset)}catch(t){}}else{let e=document.createRange();s.anchor>s.head&&([a,l]=[l,a]),e.setEnd(l.node,l.offset),e.setStart(a.node,a.offset),t.removeAllRanges(),t.addRange(e)}var e,i;r&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(a,l)),this.impreciseAnchor=a.precise?null:new Ss(h.anchorNode,h.anchorOffset),this.impreciseHead=l.precise?null:new Ss(h.focusNode,h.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&hs(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,n=ss(t.root),{anchorNode:i,anchorOffset:r}=t.observer.selectionRange;if(!(n&&e.empty&&e.assoc&&n.modify))return;let o=na.find(this,e.head);if(!o)return;let s=o.posAtStart;if(e.head==s||e.head==s+o.length)return;let a=this.coordsAt(e.head,-1),l=this.coordsAt(e.head,1);if(!a||!l||a.bottom>l.top)return;let c=this.domAtPos(e.head+e.assoc);n.collapse(c.node,c.offset),n.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let h=t.observer.selectionRange;t.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=e.from&&n.collapse(i,r)}moveToLine(t){let e,n=this.dom;if(t.node!=n)return t;for(let i=t.offset;!e&&i<n.childNodes.length;i++){let t=Cs.get(n.childNodes[i]);t instanceof na&&(e=t.domAtPos(0))}for(let i=t.offset-1;!e&&i>=0;i--){let t=Cs.get(n.childNodes[i]);t instanceof na&&(e=t.domAtPos(t.length))}return e?new Ss(e.node,e.offset,!0):t}nearest(t){for(let e=t;e;){let t=Cs.get(e);if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let n=this.nearest(t);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(t,e)+n.posAtStart}domAtPos(t){let{i:e,off:n}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(n<t.length||t instanceof na)break;e++,n=0}return this.children[e].domAtPos(n)}coordsAt(t,e){let n=null,i=0;for(let r=this.length,o=this.children.length-1;o>=0;o--){let s=this.children[o],a=r-s.breakAfter,l=a-s.length;if(a<t)break;l<=t&&(l<t||s.covers(-1))&&(a>t||s.covers(1))&&(!n||s instanceof na&&!(n instanceof na&&e>=0))&&(n=s,i=l),r=l}return n?n.coordsAt(t-i,e):null}coordsForChar(t){let{i:e,off:n}=this.childPos(t,1),i=this.children[e];if(!(i instanceof na))return null;for(;i.children.length;){let{i:t,off:e}=i.childPos(n,1);for(;;t++){if(t==i.children.length)return null;if((i=i.children[t]).length)break}n=e}if(!(i instanceof zs))return null;let r=Or(i.text,n);if(r==n)return null;let o=ws(i.dom,n,r).getClientRects();for(let t=0;t<o.length;t++){let e=o[t];if(t==o.length-1||e.top<e.bottom&&e.left<e.right)return e}return null}measureVisibleLineHeights(t){let e=[],{from:n,to:i}=t,r=this.view.contentDOM.clientWidth,o=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,s=-1,a=this.view.textDirection==ga.LTR;for(let t=0,l=0;l<this.children.length;l++){let c=this.children[l],h=t+c.length;if(h>i)break;if(t>=n){let n=c.dom.getBoundingClientRect();if(e.push(n.height),o){let e=c.dom.lastChild,i=e?cs(e):[];if(i.length){let e=i[i.length-1],o=a?e.right-n.left:n.right-e.left;o>s&&(s=o,this.minWidth=r,this.minWidthFrom=t,this.minWidthTo=h)}}}t=h+c.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return"rtl"==getComputedStyle(this.children[e].dom).direction?ga.RTL:ga.LTR}measureTextSize(){for(let t of this.children)if(t instanceof na){let e=t.measureTextSize();if(e)return e}let t,e,n,i=document.createElement("div");return i.className="cm-line",i.style.width="99999px",i.style.position="absolute",i.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(i);let r=cs(i.firstChild)[0];t=i.getBoundingClientRect().height,e=r?r.width/27:7,n=r?r.height:t,i.remove()}),{lineHeight:t,charWidth:e,textHeight:n}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new Ts(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let n=0,i=0;;i++){let r=i==e.viewports.length?null:e.viewports[i],o=r?r.from-1:this.length;if(o>n){let i=(e.lineBlockAt(o).bottom-e.lineBlockAt(n).top)/this.view.scaleY;t.push(sa.replace({widget:new hl(i),block:!0,inclusive:!0,isBlockGap:!0}).range(n,o))}if(!r)break;n=r.to+1}return sa.set(t)}updateDeco(){let t=this.view.state.facet(Ja).map((t,e)=>(this.dynamicDecorationMap[e]="function"==typeof t)?t(this.view):t),e=!1,n=this.view.state.facet(tl).map((t,n)=>{let i="function"==typeof t;return i&&(e=!0),i?t(this.view):t});n.length&&(this.dynamicDecorationMap[t.length]=e,t.push(Bo.join(n)));for(let e=t.length;e<t.length+3;e++)this.dynamicDecorationMap[e]=!1;return this.decorations=[...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(t){if(t.isSnapshot){let e=this.view.viewState.lineBlockAt(t.range.head);return this.view.scrollDOM.scrollTop=e.top-t.yMargin,void(this.view.scrollDOM.scrollLeft=t.xMargin)}let e,{range:n}=t,i=this.coordsAt(n.head,n.empty?n.assoc:n.head>n.anchor?-1:1);if(!i)return;!n.empty&&(e=this.coordsAt(n.anchor,n.anchor>n.head?-1:1))&&(i={left:Math.min(i.left,e.left),top:Math.min(i.top,e.top),right:Math.max(i.right,e.right),bottom:Math.max(i.bottom,e.bottom)});let r=ol(this.view),o={left:i.left-r.left,top:i.top-r.top,right:i.right+r.right,bottom:i.bottom+r.bottom},{offsetWidth:s,offsetHeight:a}=this.view.scrollDOM;!function(t,e,n,i,r,o,s,a){let l=t.ownerDocument,c=l.defaultView||window;for(let h=t,u=!1;h&&!u;)if(1==h.nodeType){let t,d=h==l.body,p=1,f=1;if(d)t=gs(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(h).position)&&(u=!0),h.scrollHeight<=h.clientHeight&&h.scrollWidth<=h.clientWidth){h=h.assignedSlot||h.parentNode;continue}let e=h.getBoundingClientRect();({scaleX:p,scaleY:f}=ms(h,e)),t={left:e.left,right:e.left+h.clientWidth*p,top:e.top,bottom:e.top+h.clientHeight*f}}let g=0,m=0;if("nearest"==r)e.top<t.top?(m=-(t.top-e.top+s),n>0&&e.bottom>t.bottom+m&&(m=e.bottom-t.bottom+m+s)):e.bottom>t.bottom&&(m=e.bottom-t.bottom+s,n<0&&e.top-m<t.top&&(m=-(t.top+m-e.top+s)));else{let i=e.bottom-e.top,o=t.bottom-t.top;m=("center"==r&&i<=o?e.top+i/2-o/2:"start"==r||"center"==r&&n<0?e.top-s:e.bottom-o+s)-t.top}if("nearest"==i?e.left<t.left?(g=-(t.left-e.left+o),n>0&&e.right>t.right+g&&(g=e.right-t.right+g+o)):e.right>t.right&&(g=e.right-t.right+o,n<0&&e.left<t.left+g&&(g=-(t.left+g-e.left+o))):g=("center"==i?e.left+(e.right-e.left)/2-(t.right-t.left)/2:"start"==i==a?e.left-o:e.right-(t.right-t.left)+o)-t.left,g||m)if(d)c.scrollBy(g,m);else{let t=0,n=0;if(m){let t=h.scrollTop;h.scrollTop+=m/f,n=(h.scrollTop-t)*f}if(g){let e=h.scrollLeft;h.scrollLeft+=g/p,t=(h.scrollLeft-e)*p}e={left:e.left-t,top:e.top-n,right:e.right-t,bottom:e.bottom-n},t&&Math.abs(t-g)<1&&(i="nearest"),n&&Math.abs(n-m)<1&&(r="nearest")}if(d)break;h=h.assignedSlot||h.parentNode}else{if(11!=h.nodeType)break;h=h.host}}(this.view.scrollDOM,o,n.head<n.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,s),-s),Math.max(Math.min(t.yMargin,a),-a),this.view.textDirection==ga.LTR)}}class hl extends ra{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}}function ul(t,e){let n=t.observer.selectionRange,i=n.focusNode&&dl(n.focusNode,n.focusOffset,0);if(!i)return null;let r=e-i.offset;return{from:r,to:r+i.node.nodeValue.length,node:i.node}}function dl(t,e,n){if(n<=0)for(let n=t,i=e;;){if(3==n.nodeType)return{node:n,offset:i};if(!(1==n.nodeType&&i>0))break;n=n.childNodes[i-1],i=ps(n)}if(n>=0)for(let i=t,r=e;;){if(3==i.nodeType)return{node:i,offset:r};if(!(1==i.nodeType&&r<i.childNodes.length&&n>=0))break;i=i.childNodes[r],r=0}return null}let pl=class{constructor(){this.changes=[]}compareRange(t,e){ua(t,e,this.changes)}comparePoint(t,e){ua(t,e,this.changes)}};function fl(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function gl(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function ml(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function vl(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function yl(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function bl(t,e,n){let i,r,o,s,a,l,c,h,u=!1;for(let d=t.firstChild;d;d=d.nextSibling){let t=cs(d);for(let p=0;p<t.length;p++){let f=t[p];r&&ml(r,f)&&(f=vl(yl(f,r.bottom),r.top));let g=fl(e,f),m=gl(n,f);if(0==g&&0==m)return 3==d.nodeType?xl(d,e,n):bl(d,e,n);if(!i||s>m||s==m&&o>g){i=d,r=f,o=g,s=m;let a=m?n<f.top?-1:1:g?e<f.left?-1:1:0;u=!a||(a>0?p<t.length-1:p>0)}0==g?n>f.bottom&&(!c||c.bottom<f.bottom)?(a=d,c=f):n<f.top&&(!h||h.top>f.top)&&(l=d,h=f):c&&ml(c,f)?c=yl(c,f.bottom):h&&ml(h,f)&&(h=vl(h,f.top))}}if(c&&c.bottom>=n?(i=a,r=c):h&&h.top<=n&&(i=l,r=h),!i)return{node:t,offset:0};let d=Math.max(r.left,Math.min(r.right,e));return 3==i.nodeType?xl(i,d,n):u&&"false"!=i.contentEditable?bl(i,d,n):{node:t,offset:Array.prototype.indexOf.call(t.childNodes,i)+(e>=(r.left+r.right)/2?1:0)}}function xl(t,e,n){let i=t.nodeValue.length,r=-1,o=1e9,s=0;for(let a=0;a<i;a++){let i=ws(t,a,a+1).getClientRects();for(let l=0;l<i.length;l++){let c=i[l];if(c.top==c.bottom)continue;s||(s=e-c.left);let h=(c.top>n?c.top-n:n-c.bottom)-1;if(c.left-1<=e&&c.right+1>=e&&h<o){let n=e>=(c.left+c.right)/2,i=n;if((Hs.chrome||Hs.gecko)&&ws(t,a).getBoundingClientRect().left==c.right&&(i=!n),h<=0)return{node:t,offset:a+(i?1:0)};r=a+(i?1:0),o=h}}}return{node:t,offset:r>-1?r:s>0?t.nodeValue.length:0}}function wl(t,e,n,i=-1){var r,o;let s,a=t.contentDOM.getBoundingClientRect(),l=a.top+t.viewState.paddingTop,{docHeight:c}=t.viewState,{x:h,y:u}=e,d=u-l;if(d<0)return 0;if(d>c)return t.state.doc.length;for(let e=t.viewState.heightOracle.textHeight/2,r=!1;s=t.elementAtHeight(d),s.type!=oa.Text;)for(;d=i>0?s.bottom+e:s.top-e,!(d>=0&&d<=c);){if(r)return n?null:0;r=!0,i=-i}u=l+d;let p=s.from;if(p<t.viewport.from)return 0==t.viewport.from?0:n?null:_l(t,a,s,h,u);if(p>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:n?null:_l(t,a,s,h,u);let f=t.dom.ownerDocument,g=t.root.elementFromPoint?t.root:f,m=g.elementFromPoint(h,u);m&&!t.contentDOM.contains(m)&&(m=null),m||(h=Math.max(a.left+1,Math.min(a.right-1,h)),m=g.elementFromPoint(h,u),m&&!t.contentDOM.contains(m)&&(m=null));let v,y=-1;if(m&&0!=(null===(r=t.docView.nearest(m))||void 0===r?void 0:r.isEditable))if(f.caretPositionFromPoint){let t=f.caretPositionFromPoint(h,u);t&&({offsetNode:v,offset:y}=t)}else if(f.caretRangeFromPoint){let e=f.caretRangeFromPoint(h,u);e&&(({startContainer:v,startOffset:y}=e),(!t.contentDOM.contains(v)||Hs.safari&&function(t,e,n){let i;if(3!=t.nodeType||e!=(i=t.nodeValue.length))return!1;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return ws(t,i-1,i).getBoundingClientRect().left>n}(v,y,h)||Hs.chrome&&function(t,e,n){if(0!=e)return!1;for(let e=t;;){let t=e.parentNode;if(!t||1!=t.nodeType||t.firstChild!=e)return!1;if(t.classList.contains("cm-line"))break;e=t}return n-(1==t.nodeType?t.getBoundingClientRect():ws(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect()).left>5}(v,y,h))&&(v=void 0))}if(!v||!t.docView.dom.contains(v)){let e=na.find(t.docView,p);if(!e)return d>s.top+s.height/2?s.to:s.from;({node:v,offset:y}=bl(e.dom,h,u))}let b=t.docView.nearest(v);if(!b)return null;if(b.isWidget&&1==(null===(o=b.dom)||void 0===o?void 0:o.nodeType)){let t=b.dom.getBoundingClientRect();return e.y<t.top||e.y<=t.bottom&&e.x<=(t.left+t.right)/2?b.posAtStart:b.posAtEnd}return b.localPosFromDOM(v,y)+b.posAtStart}function _l(t,e,n,i,r){let o=Math.round((i-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&n.height>1.5*t.defaultLineHeight){let e=t.viewState.heightOracle.textHeight;o+=Math.floor((r-n.top-.5*(t.defaultLineHeight-e))/e)*t.viewState.heightOracle.lineLength}let s=t.state.sliceDoc(n.from,n.to);return n.from+function(t,e,n){for(let i=0,r=0;;){if(r>=e)return i;if(i==t.length)break;r+=9==t.charCodeAt(i)?n-r%n:1,i=Or(t,i)}return t.length}(s,o,t.state.tabSize)}function Ol(t,e,n,i){let r=t.state.doc.lineAt(e.head),o=t.bidiSpans(r),s=t.textDirectionAt(r.from);for(let a=e,l=null;;){let e=Na(r,o,s,a,n),c=Ma;if(!e){if(r.number==(n?t.state.doc.lines:1))return a;c="\n",r=t.state.doc.line(r.number+(n?1:-1)),o=t.bidiSpans(r),e=t.visualLineSide(r,!n)}if(l){if(!l(c))return a}else{if(!i)return e;l=i(c)}a=e}}function kl(t,e,n){for(;;){let i=0;for(let r of t)r.between(e-1,e+1,(t,r,o)=>{if(e>t&&e<r){let o=i||n||(e-t<r-e?-1:1);e=o<0?t:r,i=o}});if(!i)return e}}function Sl(t,e,n){let i=kl(t.state.facet(el).map(e=>e(t)),n.from,e.head>n.from?-1:1);return i==n.from?n:jr.cursor(i,i<n.from?1:-1)}class El{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,Hs.safari&&t.contentDOM.addEventListener("input",()=>null),Hs.gecko&&function(t){Jl.has(t)||(Jl.add(t),t.addEventListener("copy",()=>{}),t.addEventListener("cut",()=>{}))}(t.contentDOM.ownerDocument)}handleEvent(t){(function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n,i=e.target;i!=t.contentDOM;i=i.parentNode)if(!i||11==i.nodeType||(n=Cs.get(i))&&n.ignoreEvent(e))return!1;return!0})(this.view,t)&&!this.ignoreDuringComposition(t)&&("keydown"==t.type&&this.keydown(t)||this.runHandlers(t.type,t))}runHandlers(t,e){let n=this.handlers[t];if(n){for(let t of n.observers)t(this.view,e);for(let t of n.handlers){if(e.defaultPrevented)break;if(t(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=Al(t),n=this.handlers,i=this.view.contentDOM;for(let t in e)if("scroll"!=t){let r=!e[t].handlers.length,o=n[t];o&&r!=!o.handlers.length&&(i.removeEventListener(t,this.handleEvent),o=null),o||i.addEventListener(t,this.handleEvent,{passive:r})}for(let t in n)"scroll"==t||e[t]||i.removeEventListener(t,this.handleEvent);this.handlers=e}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),9==t.keyCode&&Date.now()<this.lastEscPress+2e3)return!0;if(27!=t.keyCode&&Ml.indexOf(t.keyCode)<0&&(this.view.inputState.lastEscPress=0),Hs.android&&Hs.chrome&&!t.synthetic&&(13==t.keyCode||8==t.keyCode))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return!Hs.ios||t.synthetic||t.altKey||t.metaKey||!((e=Tl.find(e=>e.keyCode==t.keyCode))&&!t.ctrlKey||Pl.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(229!=t.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=e||t,setTimeout(()=>this.flushIOSKey(),250),!0)}flushIOSKey(){let t=this.pendingIOSKey;return!!t&&(this.pendingIOSKey=void 0,_s(this.view.contentDOM,t.key,t.keyCode))}ignoreDuringComposition(t){return!!/^key/.test(t.type)&&(this.composing>0||!!(Hs.safari&&!Hs.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Cl(t,e){return(n,i)=>{try{return e.call(t,i,n)}catch(t){Qa(n.state,t)}}}function Al(t){let e=Object.create(null);function n(t){return e[t]||(e[t]={observers:[],handlers:[]})}for(let e of t){let t=e.spec;if(t&&t.domEventHandlers)for(let i in t.domEventHandlers){let r=t.domEventHandlers[i];r&&n(i).handlers.push(Cl(e.value,r))}if(t&&t.domEventObservers)for(let i in t.domEventObservers){let r=t.domEventObservers[i];r&&n(i).observers.push(Cl(e.value,r))}}for(let t in Dl)n(t).handlers.push(Dl[t]);for(let t in Bl)n(t).observers.push(Bl[t]);return e}const Tl=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Pl="dthko",Ml=[16,17,18,20,91,92,224,225];function Nl(t){return.7*Math.max(0,t)+8}class Rl{constructor(t,e,n,i){this.view=t,this.startEvent=e,this.style=n,this.mustSelect=i,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParent=function(t){let e=t.ownerDocument;for(let n=t.parentNode;n&&n!=e.body;)if(1==n.nodeType){if(n.scrollHeight>n.clientHeight||n.scrollWidth>n.clientWidth)return n;n=n.assignedSlot||n.parentNode}else{if(11!=n.nodeType)break;n=n.host}return null}(t.contentDOM),this.atoms=t.state.facet(el).map(e=>e(t));let r=t.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(To.allowMultipleSelections)&&function(t,e){let n=t.state.facet(Da);return n.length?n[0](e):Hs.mac?e.metaKey:e.ctrlKey}(t,e),this.dragging=!(!function(t,e){let{main:n}=t.state.selection;if(n.empty)return!1;let i=ss(t.root);if(!i||0==i.rangeCount)return!0;let r=i.getRangeAt(0).getClientRects();for(let t=0;t<r.length;t++){let n=r[t];if(n.left<=e.clientX&&n.right>=e.clientX&&n.top<=e.clientY&&n.bottom>=e.clientY)return!0}return!1}(t,e)||1!=Xl(e))&&null}start(t){!1===this.dragging&&this.select(t)}move(t){var e;if(0==t.buttons)return this.destroy();if(this.dragging||null==this.dragging&&function(t,e){return Math.max(Math.abs(t.clientX-e.clientX),Math.abs(t.clientY-e.clientY))}(this.startEvent,t)<10)return;this.select(this.lastEvent=t);let n=0,i=0,r=(null===(e=this.scrollParent)||void 0===e?void 0:e.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},o=ol(this.view);t.clientX-o.left<=r.left+6?n=-Nl(r.left-t.clientX):t.clientX+o.right>=r.right-6&&(n=Nl(t.clientX-r.right)),t.clientY-o.top<=r.top+6?i=-Nl(r.top-t.clientY):t.clientY+o.bottom>=r.bottom-6&&(i=Nl(t.clientY-r.bottom)),this.setScrollSpeed(n,i)}up(t){null==this.dragging&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let n=0;n<t.ranges.length;n++){let i=t.ranges[n],r=null;if(i.empty){let t=kl(this.atoms,i.from,0);t!=i.from&&(r=jr.cursor(t,-1))}else{let t=kl(this.atoms,i.from,-1),e=kl(this.atoms,i.to,1);t==i.from&&e==i.to||(r=jr.range(i.from==i.anchor?t:e,i.from==i.head?t:e))}r&&(e||(e=t.ranges.slice()),e[n]=r)}return e?jr.create(e,t.mainIndex):t}select(t){let{view:e}=this,n=this.skipAtoms(this.style.get(t,this.extend,this.multiple));!this.mustSelect&&n.eq(e.state.selection,!1===this.dragging)||this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}const Dl=Object.create(null),Bl=Object.create(null),$l=Hs.ie&&Hs.ie_version<15||Hs.ios&&Hs.webkit_version<604;function Ll(t,e){let n,{state:i}=t,r=1,o=i.toText(e),s=o.lines==i.selection.ranges.length,a=null!=Gl&&i.selection.ranges.every(t=>t.empty)&&Gl==o.toString();if(a){let t=-1;n=i.changeByRange(n=>{let a=i.doc.lineAt(n.from);if(a.from==t)return{range:n};t=a.from;let l=i.toText((s?o.line(r++).text:e)+i.lineBreak);return{changes:{from:a.from,insert:l},range:jr.cursor(n.from+l.length)}})}else n=s?i.changeByRange(t=>{let e=o.line(r++);return{changes:{from:t.from,to:t.to,insert:e.text},range:jr.cursor(t.from+e.length)}}):i.replaceSelection(o);t.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}function Il(t,e,n,i){if(1==i)return jr.cursor(e,n);if(2==i)return function(t,e,n=1){let i=t.charCategorizer(e),r=t.doc.lineAt(e),o=e-r.from;if(0==r.length)return jr.cursor(e);0==o?n=1:o==r.length&&(n=-1);let s=o,a=o;n<0?s=Or(r.text,o,!1):a=Or(r.text,o);let l=i(r.text.slice(s,a));for(;s>0;){let t=Or(r.text,s,!1);if(i(r.text.slice(t,s))!=l)break;s=t}for(;a<r.length;){let t=Or(r.text,a);if(i(r.text.slice(a,t))!=l)break;a=t}return jr.range(s+r.from,a+r.from)}(t.state,e,n);{let n=na.find(t.docView,e),i=t.state.doc.lineAt(n?n.posAtEnd:e),r=n?n.posAtStart:i.from,o=n?n.posAtEnd:i.to;return o<t.state.doc.length&&o==i.to&&o++,jr.range(r,o)}}Bl.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft},Dl.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),27==e.keyCode&&(t.inputState.lastEscPress=Date.now()),!1),Bl.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},Bl.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")},Dl.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let n=null;for(let i of t.state.facet($a))if(n=i(t,e),n)break;if(n||0!=e.button||(n=function(t,e){let n=jl(t,e),i=Xl(e),r=t.state.selection;return{update(t){t.docChanged&&(n.pos=t.changes.mapPos(n.pos),r=r.map(t.changes))},get(e,o,s){let a,l=jl(t,e),c=Il(t,l.pos,l.bias,i);if(n.pos!=l.pos&&!o){let e=Il(t,n.pos,n.bias,i),r=Math.min(e.from,c.from),o=Math.max(e.to,c.to);c=r<c.from?jr.range(r,o):jr.range(o,r)}return o?r.replaceRange(r.main.extend(c.from,c.to)):s&&1==i&&r.ranges.length>1&&(a=function(t,e){for(let n=0;n<t.ranges.length;n++){let{from:i,to:r}=t.ranges[n];if(i<=e&&r>=e)return jr.create(t.ranges.slice(0,n).concat(t.ranges.slice(n+1)),t.mainIndex==n?0:t.mainIndex-(t.mainIndex>n?1:0))}return null}(r,l.pos))?a:s?r.addRange(c):jr.create([c])}}}(t,e)),n){let i=!t.hasFocus;t.inputState.startMouseSelection(new Rl(t,e,n,i)),i&&t.observer.ignore(()=>xs(t.contentDOM));let r=t.inputState.mouseSelection;if(r)return r.start(e),!1===r.dragging}return!1};let ql=(t,e)=>t>=e.top&&t<=e.bottom,Fl=(t,e,n)=>ql(e,n)&&t>=n.left&&t<=n.right;function Vl(t,e,n,i){let r=na.find(t.docView,e);if(!r)return 1;let o=e-r.posAtStart;if(0==o)return 1;if(o==r.length)return-1;let s=r.coordsAt(o,-1);if(s&&Fl(n,i,s))return-1;let a=r.coordsAt(o,1);return a&&Fl(n,i,a)?1:s&&ql(i,s)?-1:1}function jl(t,e){let n=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:n,bias:Vl(t,n,e.clientX,e.clientY)}}const Hl=Hs.ie&&Hs.ie_version<=11;let zl=null,Ql=0,Wl=0;function Xl(t){if(!Hl)return t.detail;let e=zl,n=Wl;return zl=t,Wl=Date.now(),Ql=!e||n>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(Ql+1)%3:1}function Ul(t,e,n,i){if(!n)return;let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:o}=t.inputState,s=i&&o&&function(t,e){let n=t.state.facet(Ba);return n.length?n[0](e):Hs.mac?!e.altKey:!e.ctrlKey}(t,e)?{from:o.from,to:o.to}:null,a={from:r,insert:n},l=t.state.changes(s?[s,a]:a);t.focus(),t.dispatch({changes:l,selection:{anchor:l.mapPos(r,-1),head:l.mapPos(r,1)},userEvent:s?"move.drop":"input.drop"}),t.inputState.draggedContent=null}Dl.dragstart=(t,e)=>{let{selection:{main:n}}=t.state;if(e.target.draggable){let i=t.docView.nearest(e.target);if(i&&i.isWidget){let t=i.posAtStart,e=t+i.length;(t>=n.to||e<=n.from)&&(n=jr.range(t,e))}}let{inputState:i}=t;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=n,e.dataTransfer&&(e.dataTransfer.setData("Text",t.state.sliceDoc(n.from,n.to)),e.dataTransfer.effectAllowed="copyMove"),!1},Dl.dragend=t=>(t.inputState.draggedContent=null,!1),Dl.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let n=e.dataTransfer.files;if(n&&n.length){let i=Array(n.length),r=0,o=()=>{++r==n.length&&Ul(t,e,i.filter(t=>null!=t).join(t.state.lineBreak),!1)};for(let t=0;t<n.length;t++){let e=new FileReader;e.onerror=o,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(i[t]=e.result),o()},e.readAsText(n[t])}return!0}{let n=e.dataTransfer.getData("Text");if(n)return Ul(t,e,n,!0),!0}return!1},Dl.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let n=$l?null:e.clipboardData;return n?(Ll(t,n.getData("text/plain")||n.getData("text/uri-text")),!0):(function(t){let e=t.dom.parentNode;if(!e)return;let n=e.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout(()=>{t.focus(),n.remove(),Ll(t,n.value)},50)}(t),!1)};let Gl=null;Dl.copy=Dl.cut=(t,e)=>{let{text:n,ranges:i,linewise:r}=function(t){let e=[],n=[],i=!1;for(let i of t.selection.ranges)i.empty||(e.push(t.sliceDoc(i.from,i.to)),n.push(i));if(!e.length){let r=-1;for(let{from:i}of t.selection.ranges){let o=t.doc.lineAt(i);o.number>r&&(e.push(o.text),n.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),r=o.number}i=!0}return{text:e.join(t.lineBreak),ranges:n,linewise:i}}(t.state);if(!n&&!r)return!1;Gl=r?n:null,"cut"!=e.type||t.state.readOnly||t.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let o=$l?null:e.clipboardData;return o?(o.clearData(),o.setData("text/plain",n),!0):(function(t,e){let n=t.dom.parentNode;if(!n)return;let i=n.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),t.focus()},50)}(t,n),!1)};const Yl=go.define();function Zl(t,e){let n=[];for(let i of t.facet(Fa)){let r=i(t,e);r&&n.push(r)}return n?t.update({effects:n,annotations:Yl.of(!0)}):null}function Kl(t){setTimeout(()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let n=Zl(t.state,e);n?t.dispatch(n):t.update([])}},10)}Bl.focus=t=>{t.inputState.lastFocusTime=Date.now(),t.scrollDOM.scrollTop||!t.inputState.lastScrollTop&&!t.inputState.lastScrollLeft||(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),Kl(t)},Bl.blur=t=>{t.observer.clearSelectionRange(),Kl(t)},Bl.compositionstart=Bl.compositionupdate=t=>{null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0)},Bl.compositionend=t=>{t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,Hs.chrome&&Hs.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then(()=>t.observer.flush()):setTimeout(()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])},50)},Bl.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()},Dl.beforeinput=(t,e)=>{var n;let i;if(Hs.chrome&&Hs.android&&(i=Tl.find(t=>t.inputType==e.inputType))&&(t.observer.delayAndroidKey(i.key,i.keyCode),"Backspace"==i.key||"Delete"==i.key)){let e=(null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0;setTimeout(()=>{var n;((null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0)>e+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())},100)}return!1};const Jl=new Set,tc=["pre-wrap","normal","pre-line","break-spaces"];class ec{constructor(t){this.lineWrapping=t,this.doc=hr.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(t,e){let n=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((e-t-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return tc.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let n=0;n<t.length;n++){let i=t[n];i<0?n++:this.heightSamples[Math.floor(10*i)]||(e=!0,this.heightSamples[Math.floor(10*i)]=!0)}return e}refresh(t,e,n,i,r,o){let s=tc.indexOf(t)>-1,a=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=s;if(this.lineWrapping=s,this.lineHeight=e,this.charWidth=n,this.textHeight=i,this.lineLength=r,a){this.heightSamples={};for(let t=0;t<o.length;t++){let e=o[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return a}}class nc{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class ic{constructor(t,e,n,i,r){this.from=t,this.length=e,this.top=n,this.height=i,this._content=r}get type(){return"number"==typeof this._content?oa.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof ca?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new ic(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var rc=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(rc||(rc={}));const oc=.001;class sc{constructor(t,e,n=2){this.length=t,this.height=e,this.flags=n}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t,e){this.height!=e&&(Math.abs(this.height-e)>oc&&(t.heightChanged=!0),this.height=e)}replace(t,e,n){return sc.of(n)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,n,i){let r=this,o=n.doc;for(let s=i.length-1;s>=0;s--){let{fromA:a,toA:l,fromB:c,toB:h}=i[s],u=r.lineAt(a,rc.ByPosNoHeight,n.setDoc(e),0,0),d=u.to>=l?u:r.lineAt(l,rc.ByPosNoHeight,n,0,0);for(h+=d.to-l,l=d.to;s>0&&u.from<=i[s-1].toA;)a=i[s-1].fromA,c=i[s-1].fromB,s--,a<u.from&&(u=r.lineAt(a,rc.ByPosNoHeight,n,0,0));c+=u.from-a,a=u.from;let p=dc.build(n.setDoc(o),t,c,h);r=r.replace(a,l,p)}return r.updateHeight(n,0)}static empty(){return new lc(0,0)}static of(t){if(1==t.length)return t[0];let e=0,n=t.length,i=0,r=0;for(;;)if(e==n)if(i>2*r){let r=t[e-1];r.break?t.splice(--e,1,r.left,null,r.right):t.splice(--e,1,r.left,r.right),n+=1+r.break,i-=r.size}else{if(!(r>2*i))break;{let e=t[n];e.break?t.splice(n,1,e.left,null,e.right):t.splice(n,1,e.left,e.right),n+=2+e.break,r-=e.size}}else if(i<r){let n=t[e++];n&&(i+=n.size)}else{let e=t[--n];e&&(r+=e.size)}let o=0;return null==t[e-1]?(o=1,e--):null==t[e]&&(o=1,n++),new hc(sc.of(t.slice(0,e)),o,sc.of(t.slice(n)))}}sc.prototype.size=1;class ac extends sc{constructor(t,e,n){super(t,e),this.deco=n}blockAt(t,e,n,i){return new ic(i,this.length,n,this.height,this.deco||0)}lineAt(t,e,n,i,r){return this.blockAt(0,n,i,r)}forEachLine(t,e,n,i,r,o){t<=r+this.length&&e>=r&&o(this.blockAt(0,n,i,r))}updateHeight(t,e=0,n=!1,i){return i&&i.from<=e&&i.more&&this.setHeight(t,i.heights[i.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class lc extends ac{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,n,i){return new ic(i,this.length,n,this.height,this.breaks)}replace(t,e,n){let i=n[0];return 1==n.length&&(i instanceof lc||i instanceof cc&&4&i.flags)&&Math.abs(this.length-i.length)<10?(i instanceof cc?i=new lc(i.length,this.height):i.height=this.height,this.outdated||(i.outdated=!1),i):sc.of(n)}updateHeight(t,e=0,n=!1,i){return i&&i.from<=e&&i.more?this.setHeight(t,i.heights[i.index++]):(n||this.outdated)&&this.setHeight(t,Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class cc extends sc{constructor(t){super(t,0)}heightMetrics(t,e){let n,i=t.doc.lineAt(e).number,r=t.doc.lineAt(e+this.length).number,o=r-i+1,s=0;if(t.lineWrapping){let e=Math.min(this.height,t.lineHeight*o);n=e/o,this.length>o+1&&(s=(this.height-e)/(this.length-o-1))}else n=this.height/o;return{firstLine:i,lastLine:r,perLine:n,perChar:s}}blockAt(t,e,n,i){let{firstLine:r,lastLine:o,perLine:s,perChar:a}=this.heightMetrics(e,i);if(e.lineWrapping){let r=i+Math.round(Math.max(0,Math.min(1,(t-n)/this.height))*this.length),o=e.doc.lineAt(r),l=s+o.length*a,c=Math.max(n,t-l/2);return new ic(o.from,o.length,c,l,0)}{let i=Math.max(0,Math.min(o-r,Math.floor((t-n)/s))),{from:a,length:l}=e.doc.line(r+i);return new ic(a,l,n+s*i,s,0)}}lineAt(t,e,n,i,r){if(e==rc.ByHeight)return this.blockAt(t,n,i,r);if(e==rc.ByPosNoHeight){let{from:e,to:i}=n.doc.lineAt(t);return new ic(e,i-e,0,0,0)}let{firstLine:o,perLine:s,perChar:a}=this.heightMetrics(n,r),l=n.doc.lineAt(t),c=s+l.length*a,h=l.number-o,u=i+s*h+a*(l.from-r-h);return new ic(l.from,l.length,Math.max(i,Math.min(u,i+this.height-c)),c,0)}forEachLine(t,e,n,i,r,o){t=Math.max(t,r),e=Math.min(e,r+this.length);let{firstLine:s,perLine:a,perChar:l}=this.heightMetrics(n,r);for(let c=t,h=i;c<=e;){let e=n.doc.lineAt(c);if(c==t){let n=e.number-s;h+=a*n+l*(t-r-n)}let i=a+l*e.length;o(new ic(e.from,e.length,h,i,0)),h+=i,c=e.to+1}}replace(t,e,n){let i=this.length-e;if(i>0){let t=n[n.length-1];t instanceof cc?n[n.length-1]=new cc(t.length+i):n.push(null,new cc(i-1))}if(t>0){let e=n[0];e instanceof cc?n[0]=new cc(t+e.length):n.unshift(new cc(t-1),null)}return sc.of(n)}decomposeLeft(t,e){e.push(new cc(t-1),null)}decomposeRight(t,e){e.push(null,new cc(this.length-t-1))}updateHeight(t,e=0,n=!1,i){let r=e+this.length;if(i&&i.from<=e+this.length&&i.more){let n=[],o=Math.max(e,i.from),s=-1;for(i.from>e&&n.push(new cc(i.from-e-1).updateHeight(t,e));o<=r&&i.more;){let e=t.doc.lineAt(o).length;n.length&&n.push(null);let r=i.heights[i.index++];-1==s?s=r:Math.abs(r-s)>=oc&&(s=-2);let a=new lc(e,r);a.outdated=!1,n.push(a),o+=e+1}o<=r&&n.push(null,new cc(r-o).updateHeight(t,o));let a=sc.of(n);return(s<0||Math.abs(a.height-this.height)>=oc||Math.abs(s-this.heightMetrics(t,e).perLine)>=oc)&&(t.heightChanged=!0),a}return(n||this.outdated)&&(this.setHeight(t,t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class hc extends sc{constructor(t,e,n){super(t.length+e+n.length,t.height+n.height,e|(t.outdated||n.outdated?2:0)),this.left=t,this.right=n,this.size=t.size+n.size}get break(){return 1&this.flags}blockAt(t,e,n,i){let r=n+this.left.height;return t<r?this.left.blockAt(t,e,n,i):this.right.blockAt(t,e,r,i+this.left.length+this.break)}lineAt(t,e,n,i,r){let o=i+this.left.height,s=r+this.left.length+this.break,a=e==rc.ByHeight?t<o:t<s,l=a?this.left.lineAt(t,e,n,i,r):this.right.lineAt(t,e,n,o,s);if(this.break||(a?l.to<s:l.from>s))return l;let c=e==rc.ByPosNoHeight?rc.ByPosNoHeight:rc.ByPos;return a?l.join(this.right.lineAt(s,c,n,o,s)):this.left.lineAt(s,c,n,i,r).join(l)}forEachLine(t,e,n,i,r,o){let s=i+this.left.height,a=r+this.left.length+this.break;if(this.break)t<a&&this.left.forEachLine(t,e,n,i,r,o),e>=a&&this.right.forEachLine(t,e,n,s,a,o);else{let l=this.lineAt(a,rc.ByPos,n,i,r);t<l.from&&this.left.forEachLine(t,l.from-1,n,i,r,o),l.to>=t&&l.from<=e&&o(l),e>l.to&&this.right.forEachLine(l.to+1,e,n,s,a,o)}}replace(t,e,n){let i=this.left.length+this.break;if(e<i)return this.balanced(this.left.replace(t,e,n),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-i,e-i,n));let r=[];t>0&&this.decomposeLeft(t,r);let o=r.length;for(let t of n)r.push(t);if(t>0&&uc(r,o-1),e<this.length){let t=r.length;this.decomposeRight(e,r),uc(r,t)}return sc.of(r)}decomposeLeft(t,e){let n=this.left.length;if(t<=n)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(n++,t>=n&&e.push(null)),t>n&&this.right.decomposeLeft(t-n,e)}decomposeRight(t,e){let n=this.left.length,i=n+this.break;if(t>=i)return this.right.decomposeRight(t-i,e);t<n&&this.left.decomposeRight(t,e),this.break&&t<i&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?sc.of(this.break?[t,null,e]:[t,e]):(this.left=t,this.right=e,this.height=t.height+e.height,this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,n=!1,i){let{left:r,right:o}=this,s=e+r.length+this.break,a=null;return i&&i.from<=e+r.length&&i.more?a=r=r.updateHeight(t,e,n,i):r.updateHeight(t,e,n),i&&i.from<=s+o.length&&i.more?a=o=o.updateHeight(t,s,n,i):o.updateHeight(t,s,n),a?this.balanced(r,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function uc(t,e){let n,i;null==t[e]&&(n=t[e-1])instanceof cc&&(i=t[e+1])instanceof cc&&t.splice(e-1,3,new cc(n.length+1+i.length))}class dc{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof lc?n.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new lc(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,n){if(t<e||n.heightRelevant){let i=n.widget?n.widget.estimatedHeight:0,r=n.widget?n.widget.lineBreaks:0;i<0&&(i=this.oracle.lineHeight);let o=e-t;n.block?this.addBlock(new ac(o,i,n)):(o||r||i>=5)&&this.addLineDeco(i,r,o)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new lc(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let n=new cc(e-t);return this.oracle.doc.lineAt(t).to==e&&(n.flags|=4),n}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof lc)return t;let e=new lc(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,n){let i=this.ensureLine();i.length+=n,i.collapsed+=n,i.widgetHeight=Math.max(i.widgetHeight,t),i.breaks+=e,this.writtenTo=this.pos=this.pos+n}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof lc||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new lc(0,-1));let n=t;for(let t of this.nodes)t instanceof lc&&t.updateHeight(this.oracle,n),n+=t?t.length:1;return this.nodes}static build(t,e,n,i){let r=new dc(n,t);return Bo.spans(e,n,i,r,0),r.finish(n)}}class pc{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,n,i){(t<e||n&&n.heightRelevant||i&&i.heightRelevant)&&ua(t,e,this.changes,5)}}function fc(t,e){let n=t.getBoundingClientRect(),i=t.ownerDocument,r=i.defaultView||window,o=Math.max(0,n.left),s=Math.min(r.innerWidth,n.right),a=Math.max(0,n.top),l=Math.min(r.innerHeight,n.bottom);for(let e=t.parentNode;e&&e!=i.body;)if(1==e.nodeType){let n=e,i=window.getComputedStyle(n);if((n.scrollHeight>n.clientHeight||n.scrollWidth>n.clientWidth)&&"visible"!=i.overflow){let i=n.getBoundingClientRect();o=Math.max(o,i.left),s=Math.min(s,i.right),a=Math.max(a,i.top),l=e==t.parentNode?i.bottom:Math.min(l,i.bottom)}e="absolute"==i.position||"fixed"==i.position?n.offsetParent:n.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{left:o-n.left,right:Math.max(o,s)-n.left,top:a-(n.top+e),bottom:Math.max(a,l)-(n.top+e)}}function gc(t,e){let n=t.getBoundingClientRect();return{left:0,right:n.right-n.left,top:e,bottom:n.bottom-(n.top+e)}}class mc{constructor(t,e,n){this.from=t,this.to=e,this.size=n}static same(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++){let i=t[n],r=e[n];if(i.from!=r.from||i.to!=r.to||i.size!=r.size)return!1}return!0}draw(t,e){return sa.replace({widget:new vc(this.size*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class vc extends ra{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class yc{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Oc,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=ga.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(Ka).some(t=>"function"!=typeof t&&"cm-lineWrapping"==t.class);this.heightOracle=new ec(e),this.stateDeco=t.facet(Ja).filter(t=>"function"!=typeof t),this.heightMap=sc.empty().applyChanges(this.stateDeco,hr.empty,this.heightOracle.setDoc(t.doc),[new al(0,0,0,t.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=sa.set(this.lineGaps.map(t=>t.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let n=0;n<=1;n++){let i=n?e.head:e.anchor;if(!t.some(({from:t,to:e})=>i>=t&&i<=e)){let{from:e,to:n}=this.lineBlockAt(i);t.push(new bc(e,n))}}this.viewports=t.sort((t,e)=>t.from-e.from),this.scaler=this.heightMap.height<=7e6?Oc:new kc(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push(1==this.scaler.scale?t:Sc(t,this.scaler))})}update(t,e=null){this.state=t.state;let n=this.stateDeco;this.stateDeco=this.state.facet(Ja).filter(t=>"function"!=typeof t);let i=t.changedRanges,r=al.extendWithRanges(i,function(t,e,n){let i=new pc;return Bo.compare(t,e,n,i,0),i.changes}(n,this.stateDeco,t?t.changes:Dr.empty(this.state.doc.length))),o=this.heightMap.height,s=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),r),this.heightMap.height!=o&&(t.flags|=2),s?(this.scrollAnchorPos=t.changes.mapPos(s.from,-1),this.scrollAnchorHeight=s.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let a=r.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<a.from||e.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,e));let l=!t.changes.empty||2&t.flags||a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,this.updateForViewport(),l&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(ja)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,n=window.getComputedStyle(e),i=this.heightOracle,r=n.whiteSpace;this.defaultTextDirection="rtl"==n.direction?ga.RTL:ga.LTR;let o=this.heightOracle.mustRefreshForWrapping(r),s=e.getBoundingClientRect(),a=o||this.mustMeasureContent||this.contentDOMHeight!=s.height;this.contentDOMHeight=s.height,this.mustMeasureContent=!1;let l=0,c=0;if(s.width&&s.height){let{scaleX:t,scaleY:n}=ms(e,s);this.scaleX==t&&this.scaleY==n||(this.scaleX=t,this.scaleY=n,l|=8,o=a=!0)}let h=(parseInt(n.paddingTop)||0)*this.scaleY,u=(parseInt(n.paddingBottom)||0)*this.scaleY;this.paddingTop==h&&this.paddingBottom==u||(this.paddingTop=h,this.paddingBottom=u,l|=10),this.editorWidth!=t.scrollDOM.clientWidth&&(i.lineWrapping&&(a=!0),this.editorWidth=t.scrollDOM.clientWidth,l|=8);let d=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=d&&(this.scrollAnchorHeight=-1,this.scrollTop=d),this.scrolledToBottom=ks(t.scrollDOM);let p=(this.printing?gc:fc)(e,this.paddingTop),f=p.top-this.pixelViewport.top,g=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let m=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(m!=this.inView&&(this.inView=m,m&&(a=!0)),!this.inView&&!this.scrollTarget)return 0;let v=s.width;if(this.contentDOMWidth==v&&this.editorHeight==t.scrollDOM.clientHeight||(this.contentDOMWidth=s.width,this.editorHeight=t.scrollDOM.clientHeight,l|=8),a){let e=t.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(e)&&(o=!0),o||i.lineWrapping&&Math.abs(v-this.contentDOMWidth)>i.charWidth){let{lineHeight:n,charWidth:s,textHeight:a}=t.docView.measureTextSize();o=n>0&&i.refresh(r,n,s,a,v/s,e),o&&(t.docView.minWidth=0,l|=8)}f>0&&g>0?c=Math.max(f,g):f<0&&g<0&&(c=Math.min(f,g)),i.heightChanged=!1;for(let n of this.viewports){let r=n.from==this.viewport.from?e:t.docView.measureVisibleLineHeights(n);this.heightMap=(o?sc.empty().applyChanges(this.stateDeco,hr.empty,this.heightOracle,[new al(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(i,0,o,new nc(n.from,r))}i.heightChanged&&(l|=2)}let y=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return y&&(this.viewport=this.getViewport(c,this.scrollTarget)),this.updateForViewport(),(2&l||y)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,t)),l|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),l}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let n=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),i=this.heightMap,r=this.heightOracle,{visibleTop:o,visibleBottom:s}=this,a=new bc(i.lineAt(o-1e3*n,rc.ByHeight,r,0,0).from,i.lineAt(s+1e3*(1-n),rc.ByHeight,r,0,0).to);if(e){let{head:t}=e.range;if(t<a.from||t>a.to){let n,o=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),s=i.lineAt(t,rc.ByPos,r,0,0);n="center"==e.y?(s.top+s.bottom)/2-o/2:"start"==e.y||"nearest"==e.y&&t<a.from?s.top:s.bottom-o,a=new bc(i.lineAt(n-500,rc.ByHeight,r,0,0).from,i.lineAt(n+o+500,rc.ByHeight,r,0,0).to)}}return a}mapViewport(t,e){let n=e.mapPos(t.from,-1),i=e.mapPos(t.to,1);return new bc(this.heightMap.lineAt(n,rc.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(i,rc.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},n=0){if(!this.inView)return!0;let{top:i}=this.heightMap.lineAt(t,rc.ByPos,this.heightOracle,0,0),{bottom:r}=this.heightMap.lineAt(e,rc.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:s}=this;return(0==t||i<=o-Math.max(10,Math.min(-n,250)))&&(e==this.state.doc.length||r>=s+Math.max(10,Math.min(n,250)))&&i>o-2e3&&r<s+2e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let n=[];for(let i of t)e.touchesRange(i.from,i.to)||n.push(new mc(e.mapPos(i.from),e.mapPos(i.to),i.size));return n}ensureLineGaps(t,e){let n=this.heightOracle.lineWrapping,i=n?1e4:2e3,r=i>>1,o=i<<1;if(this.defaultTextDirection!=ga.LTR&&!n)return[];let s=[],a=(i,o,l,c)=>{if(o-i<r)return;let h=this.state.selection.main,u=[h.from];h.empty||u.push(h.to);for(let t of u)if(t>i&&t<o)return a(i,t-10,l,c),void a(t+10,o,l,c);let d=function(t,e){for(let n of t)if(e(n))return n}(t,t=>t.from>=l.from&&t.to<=l.to&&Math.abs(t.from-i)<r&&Math.abs(t.to-o)<r&&!u.some(e=>t.from<e&&t.to>e));if(!d){if(o<l.to&&e&&n&&e.visibleRanges.some(t=>t.from<=o&&t.to>=o)){let t=e.moveToLineBoundary(jr.cursor(o),!1,!0).head;t>i&&(o=t)}d=new mc(i,o,this.gapSize(l,i,o,c))}s.push(d)};for(let t of this.viewportLines){if(t.length<o)continue;let e=xc(t.from,t.to,this.stateDeco);if(e.total<o)continue;let r,s,l=this.scrollTarget?this.scrollTarget.range.head:null;if(n){let n,o,a=i/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=l){let i=_c(e,l),r=((this.visibleBottom-this.visibleTop)/2+a)/t.height;n=i-r,o=i+r}else n=(this.visibleTop-t.top-a)/t.height,o=(this.visibleBottom-t.top+a)/t.height;r=wc(e,n),s=wc(e,o)}else{let t,n,o=e.total*this.heightOracle.charWidth,a=i*this.heightOracle.charWidth;if(null!=l){let i=_c(e,l),r=((this.pixelViewport.right-this.pixelViewport.left)/2+a)/o;t=i-r,n=i+r}else t=(this.pixelViewport.left-a)/o,n=(this.pixelViewport.right+a)/o;r=wc(e,t),s=wc(e,n)}r>t.from&&a(t.from,r,t,e),s<t.to&&a(s,t.to,t,e)}return s}gapSize(t,e,n,i){let r=_c(i,n)-_c(i,e);return this.heightOracle.lineWrapping?t.height*r:i.total*this.heightOracle.charWidth*r}updateLineGaps(t){mc.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=sa.set(t.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let e=[];Bo.spans(t,this.viewport.from,this.viewport.to,{span(t,n){e.push({from:t,to:n})},point(){}},20);let n=e.length!=this.visibleRanges.length||this.visibleRanges.some((t,n)=>t.from!=e[n].from||t.to!=e[n].to);return this.visibleRanges=e,n?4:0}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(e=>e.from<=t&&e.to>=t)||Sc(this.heightMap.lineAt(t,rc.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return Sc(this.heightMap.lineAt(this.scaler.fromDOM(t),rc.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return Sc(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class bc{constructor(t,e){this.from=t,this.to=e}}function xc(t,e,n){let i=[],r=t,o=0;return Bo.spans(n,t,e,{span(){},point(t,e){t>r&&(i.push({from:r,to:t}),o+=t-r),r=e}},20),r<e&&(i.push({from:r,to:e}),o+=e-r),{total:o,ranges:i}}function wc({total:t,ranges:e},n){if(n<=0)return e[0].from;if(n>=1)return e[e.length-1].to;let i=Math.floor(t*n);for(let t=0;;t++){let{from:n,to:r}=e[t],o=r-n;if(i<=o)return n+i;i-=o}}function _c(t,e){let n=0;for(let{from:i,to:r}of t.ranges){if(e<=r){n+=e-i;break}n+=r-i}return n/t.total}const Oc={toDOM:t=>t,fromDOM:t=>t,scale:1};class kc{constructor(t,e,n){let i=0,r=0,o=0;this.viewports=n.map(({from:n,to:r})=>{let o=e.lineAt(n,rc.ByPos,t,0,0).top,s=e.lineAt(r,rc.ByPos,t,0,0).bottom;return i+=s-o,{from:n,to:r,top:o,bottom:s,domTop:0,domBottom:0}}),this.scale=(7e6-i)/(e.height-i);for(let t of this.viewports)t.domTop=o+(t.top-r)*this.scale,o=t.domBottom=t.domTop+(t.bottom-t.top),r=t.bottom}toDOM(t){for(let e=0,n=0,i=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.top)return i+(t-n)*this.scale;if(t<=r.bottom)return r.domTop+(t-r.top);n=r.bottom,i=r.domBottom}}fromDOM(t){for(let e=0,n=0,i=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.domTop)return n+(t-i)/this.scale;if(t<=r.domBottom)return r.top+(t-r.domTop);n=r.bottom,i=r.domBottom}}}function Sc(t,e){if(1==e.scale)return t;let n=e.toDOM(t.top),i=e.toDOM(t.bottom);return new ic(t.from,t.length,n,i-n,Array.isArray(t._content)?t._content.map(t=>Sc(t,e)):t._content)}const Ec=Qr.define({combine:t=>t.join(" ")}),Cc=Qr.define({combine:t=>t.indexOf(!0)>-1}),Ac=Zo.newName(),Tc=Zo.newName(),Pc=Zo.newName(),Mc={"&light":"."+Tc,"&dark":"."+Pc};function Nc(t,e,n){return new Zo(e,{finish:e=>/&/.test(e)?e.replace(/&\w*/,e=>{if("&"==e)return t;if(!n||!n[e])throw new RangeError(`Unsupported selector: ${e}`);return n[e]}):t+" "+e})}const Rc=Nc("."+Ac,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Mc),Dc="";class Bc{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(To.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Dc}readRange(t,e){if(!t)return this;let n=t.parentNode;for(let i=t;;){this.findPointBefore(n,i);let t=this.text.length;this.readNode(i);let r=i.nextSibling;if(r==e)break;let o=Cs.get(i),s=Cs.get(r);(o&&s?o.breakAfter:(o?o.breakAfter:Lc(i))||Lc(r)&&("BR"!=i.nodeName||i.cmIgnore)&&this.text.length>t)&&this.lineBreak(),i=r}return this.findPointBefore(n,e),this}readTextNode(t){let e=t.nodeValue;for(let n of this.points)n.node==t&&(n.pos=this.text.length+Math.min(n.offset,e.length));for(let n=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let r,o=-1,s=1;if(this.lineSeparator?(o=e.indexOf(this.lineSeparator,n),s=this.lineSeparator.length):(r=i.exec(e))&&(o=r.index,s=r[0].length),this.append(e.slice(n,o<0?e.length:o)),o<0)break;if(this.lineBreak(),s>1)for(let e of this.points)e.node==t&&e.pos>this.text.length&&(e.pos-=s-1);n=o+s}}readNode(t){if(t.cmIgnore)return;let e=Cs.get(t),n=e&&e.overrideDOMText;if(null!=n){this.findPointInside(t,n.length);for(let t=n.iter();!t.next().done;)t.lineBreak?this.lineBreak():this.append(t.value)}else 3==t.nodeType?this.readTextNode(t):"BR"==t.nodeName?t.nextSibling&&this.lineBreak():1==t.nodeType&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let n of this.points)n.node==t&&t.childNodes[n.offset]==e&&(n.pos=this.text.length)}findPointInside(t,e){for(let n of this.points)(3==t.nodeType?n.node==t:t.contains(n.node))&&(n.pos=this.text.length+($c(t,n.node,n.offset)?e:0))}}function $c(t,e,n){for(;;){if(!e||n<ps(e))return!1;if(e==t)return!0;n=us(e)+1,e=e.parentNode}}function Lc(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}class Ic{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class qc{constructor(t,e,n,i){this.typeOver=i,this.bounds=null,this.text="";let{impreciseHead:r,impreciseAnchor:o}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,n,0))){let e=r||o?[]:function(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:o}=t.observer.selectionRange;return n&&(e.push(new Ic(n,i)),r==n&&o==i||e.push(new Ic(r,o))),e}(t),n=new Bc(e,t.state);n.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=n.text,this.newSel=function(t,e){if(0==t.length)return null;let n=t[0].pos,i=2==t.length?t[1].pos:n;return n>-1&&i>-1?jr.single(n+e,i+e):null}(e,this.bounds.from)}else{let e=t.observer.selectionRange,n=r&&r.node==e.focusNode&&r.offset==e.focusOffset||!as(t.contentDOM,e.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),i=o&&o.node==e.anchorNode&&o.offset==e.anchorOffset||!as(t.contentDOM,e.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(e.anchorNode,e.anchorOffset),s=t.viewport;if(Hs.ios&&t.state.selection.main.empty&&n!=i&&(s.from>0||s.to<t.state.doc.length)){let e=s.from-Math.min(n,i),r=s.to-Math.max(n,i);0!=e&&1!=e||0!=r&&-1!=r||(n=0,i=t.state.doc.length)}this.newSel=jr.single(i,n)}}}function Fc(t,e){let n,{newSel:i}=e,r=t.state.selection.main,o=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:i,to:s}=e.bounds,a=r.from,l=null;(8===o||Hs.android&&e.text.length<s-i)&&(a=r.to,l="end");let c=function(t,e,n,i){let r=Math.min(t.length,e.length),o=0;for(;o<r&&t.charCodeAt(o)==e.charCodeAt(o);)o++;if(o==r&&t.length==e.length)return null;let s=t.length,a=e.length;for(;s>0&&a>0&&t.charCodeAt(s-1)==e.charCodeAt(a-1);)s--,a--;return"end"==i&&(n-=s+Math.max(0,o-Math.min(s,a))-o),s<o&&t.length<e.length?(o-=n<=o&&n>=s?o-n:0,a=o+(a-s),s=o):a<o&&(o-=n<=o&&n>=a?o-n:0,s=o+(s-a),a=o),{from:o,toA:s,toB:a}}(t.state.doc.sliceString(i,s,Dc),e.text,a-i,l);c&&(Hs.chrome&&13==o&&c.toB==c.from+2&&e.text.slice(c.from,c.toB)==Dc+Dc&&c.toB--,n={from:i+c.from,to:i+c.toA,insert:hr.of(e.text.slice(c.from,c.toB).split(Dc))})}else i&&(!t.hasFocus&&t.state.facet(Wa)||i.main.eq(r))&&(i=null);if(!n&&!i)return!1;if(!n&&e.typeOver&&!r.empty&&i&&i.main.empty?n={from:r.from,to:r.to,insert:t.state.doc.slice(r.from,r.to)}:n&&n.from>=r.from&&n.to<=r.to&&(n.from!=r.from||n.to!=r.to)&&r.to-r.from-(n.to-n.from)<=4?n={from:r.from,to:r.to,insert:t.state.doc.slice(r.from,n.from).append(n.insert).append(t.state.doc.slice(n.to,r.to))}:(Hs.mac||Hs.android)&&n&&n.from==n.to&&n.from==r.head-1&&/^\. ?$/.test(n.insert.toString())&&"off"==t.contentDOM.getAttribute("autocorrect")?(i&&2==n.insert.length&&(i=jr.single(i.main.anchor-1,i.main.head-1)),n={from:r.from,to:r.to,insert:hr.of([" "])}):Hs.chrome&&n&&n.from==n.to&&n.from==r.head&&"\n "==n.insert.toString()&&t.lineWrapping&&(i&&(i=jr.single(i.main.anchor-1,i.main.head-1)),n={from:r.from,to:r.to,insert:hr.of([" "])}),n){if(Hs.ios&&t.inputState.flushIOSKey())return!0;if(Hs.android&&(n.from==r.from&&n.to==r.to&&1==n.insert.length&&2==n.insert.lines&&_s(t.contentDOM,"Enter",13)||(n.from==r.from-1&&n.to==r.to&&0==n.insert.length||8==o&&n.insert.length<n.to-n.from&&n.to>r.head)&&_s(t.contentDOM,"Backspace",8)||n.from==r.from&&n.to==r.to+1&&0==n.insert.length&&_s(t.contentDOM,"Delete",46)))return!0;let e,s=n.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let a=()=>e||(e=function(t,e,n){let i,r=t.state,o=r.selection.main;if(e.from>=o.from&&e.to<=o.to&&e.to-e.from>=(o.to-o.from)/3&&(!n||n.main.empty&&n.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let n=o.from<e.from?r.sliceDoc(o.from,e.from):"",s=o.to>e.to?r.sliceDoc(e.to,o.to):"";i=r.replaceSelection(t.state.toText(n+e.insert.sliceString(0,void 0,t.state.lineBreak)+s))}else{let s=r.changes(e),a=n&&n.main.to<=s.newLength?n.main:void 0;if(r.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=o.to&&e.to>=o.to-10){let l,c=t.state.sliceDoc(e.from,e.to),h=n&&ul(t,n.main.head);if(h){let t=e.insert.length-(e.to-e.from);l={from:h.from,to:h.to-t}}else l=t.state.doc.lineAt(o.head);let u=o.to-e.to,d=o.to-o.from;i=r.changeByRange(n=>{if(n.from==o.from&&n.to==o.to)return{changes:s,range:a||n.map(s)};let i=n.to-u,h=i-c.length;if(n.to-n.from!=d||t.state.sliceDoc(h,i)!=c||n.to>=l.from&&n.from<=l.to)return{range:n};let p=r.changes({from:h,to:i,insert:e.insert}),f=n.to-o.to;return{changes:p,range:a?jr.range(Math.max(0,a.anchor+f),Math.max(0,a.head+f)):n.map(p)}})}else i={changes:s,selection:a&&r.selection.replaceRange(a)}}let s="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,s+=".compose",t.inputState.compositionFirstChange&&(s+=".start",t.inputState.compositionFirstChange=!1)),r.update(i,{userEvent:s,scrollIntoView:!0})}(t,n,i));return t.state.facet(qa).some(e=>e(t,n.from,n.to,s,a))||t.dispatch(a()),!0}if(i&&!i.main.eq(r)){let e=!1,n="select";return t.inputState.lastSelectionTime>Date.now()-50&&("select"==t.inputState.lastSelectionOrigin&&(e=!0),n=t.inputState.lastSelectionOrigin),t.dispatch({selection:i,scrollIntoView:e,userEvent:n}),!0}return!1}const Vc={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},jc=Hs.ie&&Hs.ie_version<=11;class Hc{constructor(t){this.view=t,this.active=!1,this.selectionRange=new vs,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(e=>{for(let t of e)this.queue.push(t);(Hs.ie&&Hs.ie_version<=11||Hs.ios&&t.composing)&&e.some(t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length)?this.flushSoon():this.flush()}),jc&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver(()=>{var t;(null===(t=this.view.docView)||void 0===t?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((e,n)=>e!=t[n]))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,i=this.selectionRange;if(n.state.facet(Wa)?n.root.activeElement!=this.dom:!ls(n.dom,i))return;let r=i.anchorNode&&n.docView.nearest(i.anchorNode);r&&r.ignoreEvent(t)?e||(this.selectionChanged=!1):(Hs.ie&&Hs.ie_version<=11||Hs.android&&Hs.chrome)&&!n.state.selection.main.empty&&i.focusNode&&hs(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=Hs.safari&&11==t.root.nodeType&&function(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}(this.dom.ownerDocument)==this.dom&&function(t){let e=null;function n(t){t.preventDefault(),t.stopImmediatePropagation(),e=t.getTargetRanges()[0]}if(t.contentDOM.addEventListener("beforeinput",n,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",n,!0),!e)return null;let i=e.startContainer,r=e.startOffset,o=e.endContainer,s=e.endOffset,a=t.docView.domAtPos(t.state.selection.main.anchor);return hs(a.node,a.offset,o,s)&&([i,r,o,s]=[o,s,i,r]),{anchorNode:i,anchorOffset:r,focusNode:o,focusOffset:s}}(this.view)||ss(t.root);if(!e||this.selectionRange.eq(e))return!1;let n=ls(this.dom,e);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&function(t,e){let n=e.focusNode,i=e.focusOffset;if(!n||e.anchorNode!=n||e.anchorOffset!=i)return!1;for(i=Math.min(i,ps(n));;)if(i){if(1!=n.nodeType)return!1;let t=n.childNodes[i-1];"false"==t.contentEditable?i--:(n=t,i=ps(n))}else{if(n==t)return!0;i=us(n),n=n.parentNode}}(this.dom,e)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(e),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let n=this.dom;n;)if(1==n.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==n?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(n),n=n.assignedSlot||n.parentNode;else{if(11!=n.nodeType)break;n=n.host}if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Vc),jc&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),jc&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var n;if(!this.delayedAndroidKey){let t=()=>{let t=this.delayedAndroidKey;t&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=t.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&t.force&&_s(this.dom,t.key,t.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(t)}this.delayedAndroidKey&&"Enter"!=t||(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(null===(n=this.delayedAndroidKey)||void 0===n?void 0:n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,n=-1,i=!1;for(let r of t){let t=this.readMutation(r);t&&(t.typeOver&&(i=!0),-1==e?({from:e,to:n}=t):(e=Math.min(t.from,e),n=Math.max(t.to,n)))}return{from:e,to:n,typeOver:i}}readChange(){let{from:t,to:e,typeOver:n}=this.processRecords(),i=this.selectionChanged&&ls(this.dom,this.selectionRange);if(t<0&&!i)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let r=new qc(this.view,t,e,n);return this.view.docView.domChanged={newSel:r.newSel?r.newSel.main:null},r}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let n=this.view.state,i=Fc(this.view,e);return this.view.state==n&&this.view.update([]),i}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty("attributes"==t.type),"attributes"==t.type&&(e.flags|=4),"childList"==t.type){let n=zc(e,t.previousSibling||t.target.previousSibling,-1),i=zc(e,t.nextSibling||t.target.nextSibling,1);return{from:n?e.posAfter(n):e.posAtStart,to:i?e.posBefore(i):e.posAtEnd,typeOver:!1}}return"characterData"==t.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var t,e,n;this.stop(),null===(t=this.intersection)||void 0===t||t.disconnect(),null===(e=this.gapIntersection)||void 0===e||e.disconnect(),null===(n=this.resizeScroll)||void 0===n||n.disconnect();for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function zc(t,e,n){for(;e;){let i=Cs.get(e);if(i&&i.parent==t)return i;let r=e.parentNode;e=r!=t.dom?r:n>0?e.nextSibling:e.previousSibling}return null}class Qc{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:e}=t;this.dispatchTransactions=t.dispatchTransactions||e&&(t=>t.forEach(t=>e(t,this)))||(t=>this.update(t)),this.dispatch=this.dispatch.bind(this),this._root=t.root||function(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}(t.parent)||document,this.viewState=new yc(t.state||To.create(t)),t.scrollTo&&t.scrollTo.is(za)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Ua).map(t=>new Ya(t));for(let t of this.plugins)t.update(this);this.observer=new Hc(this),this.inputState=new El(this),this.inputState.ensureHandlers(this.plugins),this.docView=new cl(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure()}dispatch(...t){let e=1==t.length&&t[0]instanceof bo?t:1==t.length&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e,n=!1,i=!1,r=this.state;for(let e of t){if(e.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=e.state}if(this.destroyed)return void(this.viewState.state=r);let o=this.hasFocus,s=0,a=null;t.some(t=>t.annotation(Yl))?(this.inputState.notifiedFocused=o,s=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,a=Zl(r,o),a||(s=1));let l=this.observer.delayedAndroidKey,c=null;if(l?(this.observer.clearDelayedAndroidKey(),c=this.observer.readChange(),(c&&!this.state.doc.eq(r.doc)||!this.state.selection.eq(r.selection))&&(c=null)):this.observer.clear(),r.facet(To.phrases)!=this.state.facet(To.phrases))return this.setState(r);e=ll.create(this,r,t),e.flags|=s;let h=this.viewState.scrollTarget;try{this.updateState=2;for(let e of t){if(h&&(h=h.map(e.changes)),e.scrollIntoView){let{main:t}=e.state.selection;h=new Ha(t.empty?t:jr.cursor(t.head,t.head>t.anchor?-1:1))}for(let t of e.effects)t.is(za)&&(h=t.value.clip(this.state))}this.viewState.update(e,h),this.bidiCache=Uc.update(this.bidiCache,e.changes),e.empty||(this.updatePlugins(e),this.inputState.update(e)),n=this.docView.update(e),this.state.facet(sl)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(n,t.some(t=>t.isUserEvent("select.pointer")))}finally{this.updateState=0}if(e.startState.facet(Ec)!=e.state.facet(Ec)&&(this.viewState.mustMeasureContent=!0),(n||i||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!e.empty)for(let t of this.state.facet(Ia))try{t(e)}catch(t){Qa(this.state,t,"update listener")}(a||c)&&Promise.resolve().then(()=>{a&&this.state==a.startState&&this.dispatch(a),c&&!Fc(this,c)&&l.force&&_s(this.contentDOM,l.key,l.keyCode)})}setState(t){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=t);this.updateState=2;let e=this.hasFocus;try{for(let t of this.plugins)t.destroy(this);this.viewState=new yc(t),this.plugins=t.facet(Ua).map(t=>new Ya(t)),this.pluginMap.clear();for(let t of this.plugins)t.update(this);this.docView.destroy(),this.docView=new cl(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(Ua),n=t.state.facet(Ua);if(e!=n){let i=[];for(let r of n){let n=e.indexOf(r);if(n<0)i.push(new Ya(r));else{let e=this.plugins[n];e.mustUpdate=t,i.push(e)}}for(let e of this.plugins)e.mustUpdate!=t&&e.destroy(this);this.plugins=i,this.pluginMap.clear()}else for(let e of this.plugins)e.mustUpdate=t;for(let t=0;t<this.plugins.length;t++)this.plugins[t].update(this);e!=n&&this.inputState.ensureHandlers(this.plugins)}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)return this.measureScheduled=-1,void this.requestMeasure();this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,n=this.scrollDOM,i=n.scrollTop*this.scaleY,{scrollAnchorPos:r,scrollAnchorHeight:o}=this.viewState;Math.abs(i-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let t=0;;t++){if(o<0)if(ks(n))r=-1,o=this.viewState.heightMap.height;else{let t=this.viewState.scrollAnchorAt(i);r=t.from,o=t.top}this.updateState=1;let s=this.viewState.measure(this);if(!s&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(t>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let a=[];4&s||([this.measureRequests,a]=[a,this.measureRequests]);let l=a.map(t=>{try{return t.read(this)}catch(t){return Qa(this.state,t),Xc}}),c=ll.create(this,this.state,[]),h=!1;c.flags|=s,e?e.flags|=s:e=c,this.updateState=2,c.empty||(this.updatePlugins(c),this.inputState.update(c),this.updateAttrs(),h=this.docView.update(c));for(let t=0;t<a.length;t++)if(l[t]!=Xc)try{let e=a[t];e.write&&e.write(l[t],this)}catch(t){Qa(this.state,t)}if(h&&this.docView.updateSelection(!0),!c.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}{let t=(r<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(r).top)-o;if(t>1||t<-1){i+=t,n.scrollTop=i/this.scaleY,o=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let t of this.state.facet(Ia))t(e)}get themeClasses(){return Ac+" "+(this.state.facet(Cc)?Pc:Tc)+" "+this.state.facet(Ec)}updateAttrs(){let t=Gc(this,Za,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Wa)?"true":"false",class:"cm-content",style:`${Hs.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),Gc(this,Ka,e);let n=this.observer.ignore(()=>{let n=ta(this.contentDOM,this.contentAttrs,e),i=ta(this.dom,this.editorAttrs,t);return n||i});return this.editorAttrs=t,this.contentAttrs=e,n}showAnnouncements(t){let e=!0;for(let n of t)for(let t of n.effects)t.is(Qc.announce)&&(e&&(this.announceDOM.textContent=""),e=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value)}mountStyles(){this.styleModules=this.state.facet(sl);let t=this.state.facet(Qc.cspNonce);Zo.mount(this.root,this.styleModules.concat(Rc).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(null!=t.key)for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key)return void(this.measureRequests[e]=t);this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find(e=>e.spec==t)||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,n){return Sl(this,t,Ol(this,t,e,n))}moveByGroup(t,e){return Sl(this,t,Ol(this,t,e,e=>function(t,e,n){let i=t.state.charCategorizer(e),r=i(n);return t=>{let e=i(t);return r==Eo.Space&&(r=e),r==e}}(this,t.head,e)))}visualLineSide(t,e){let n=this.bidiSpans(t),i=this.textDirectionAt(t.from),r=n[e?n.length-1:0];return jr.cursor(r.side(e,i)+t.from,r.forward(!e,i)?1:-1)}moveToLineBoundary(t,e,n=!0){return function(t,e,n,i){let r=function(t,e){let n=t.lineBlockAt(e);if(Array.isArray(n.type))for(let t of n.type)if(t.to>e||t.to==e&&(t.to==n.to||t.type==oa.Text))return t;return n}(t,e.head),o=i&&r.type==oa.Text&&(t.lineWrapping||r.widgetLineBreaks)?t.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head):null;if(o){let e=t.dom.getBoundingClientRect(),i=t.textDirectionAt(r.from),s=t.posAtCoords({x:n==(i==ga.LTR)?e.right-1:e.left+1,y:(o.top+o.bottom)/2});if(null!=s)return jr.cursor(s,n?-1:1)}return jr.cursor(n?r.to:r.from,n?-1:1)}(this,t,e,n)}moveVertically(t,e,n){return Sl(this,t,function(t,e,n,i){let r=e.head,o=n?1:-1;if(r==(n?t.state.doc.length:0))return jr.cursor(r,e.assoc);let s,a=e.goalColumn,l=t.contentDOM.getBoundingClientRect(),c=t.coordsAtPos(r,e.assoc||-1),h=t.documentTop;if(c)null==a&&(a=c.left-l.left),s=o<0?c.top:c.bottom;else{let e=t.viewState.lineBlockAt(r);null==a&&(a=Math.min(l.right-l.left,t.defaultCharacterWidth*(r-e.from))),s=(o<0?e.top:e.bottom)+h}let u=l.left+a,d=null!=i?i:t.viewState.heightOracle.textHeight>>1;for(let e=0;;e+=10){let n=s+(d+e)*o,i=wl(t,{x:u,y:n},!1,o);if(n<l.top||n>l.bottom||(o<0?i<r:i>r)){let e=t.docView.coordsForChar(i),r=!e||n<e.top?-1:1;return jr.cursor(i,r,void 0,a)}}}(this,t,e,n))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),wl(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let n=this.docView.coordsAt(t,e);if(!n||n.left==n.right)return n;let i=this.state.doc.lineAt(t),r=this.bidiSpans(i);return fs(n,r[Sa.find(r,t-i.from,-1,e)].dir==ga.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(Va)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>Wc)return Pa(t.length);let e,n=this.textDirectionAt(t.from);for(let i of this.bidiCache)if(i.from==t.from&&i.dir==n&&(i.fresh||Ea(i.isolates,e=il(this,t))))return i.order;e||(e=il(this,t));let i=function(t,e,n){if(!t)return[new Sa(0,0,e==va?1:0)];if(e==ma&&!n.length&&!ka.test(t))return Pa(t.length);if(n.length)for(;t.length>Ca.length;)Ca[Ca.length]=256;let i=[],r=e==ma?0:1;return Ta(t,r,r,n,0,t.length,i),i}(t.text,n,e);return this.bidiCache.push(new Uc(t.from,t.to,n,e,!0,i)),i}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||Hs.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{xs(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((9==t.nodeType?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return za.of(new Ha("number"==typeof t?jr.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,n=this.viewState.scrollAnchorAt(t);return za.of(new Ha(jr.cursor(n.from),"start","start",n.top-t,e,!0))}static domEventHandlers(t){return Ga.define(()=>({}),{eventHandlers:t})}static domEventObservers(t){return Ga.define(()=>({}),{eventObservers:t})}static theme(t,e){let n=Zo.newName(),i=[Ec.of(n),sl.of(Nc(`.${n}`,t))];return e&&e.dark&&i.push(Cc.of(!0)),i}static baseTheme(t){return to.lowest(sl.of(Nc("."+Ac,t,Mc)))}static findFromDOM(t){var e;let n=t.querySelector(".cm-content"),i=n&&Cs.get(n)||Cs.get(t);return(null===(e=null==i?void 0:i.rootView)||void 0===e?void 0:e.view)||null}}Qc.styleModule=sl,Qc.inputHandler=qa,Qc.focusChangeEffect=Fa,Qc.perLineTextDirection=Va,Qc.exceptionSink=La,Qc.updateListener=Ia,Qc.editable=Wa,Qc.mouseSelectionStyle=$a,Qc.dragMovesSelection=Ba,Qc.clickAddsSelectionRange=Da,Qc.decorations=Ja,Qc.outerDecorations=tl,Qc.atomicRanges=el,Qc.bidiIsolatedRanges=nl,Qc.scrollMargins=rl,Qc.darkTheme=Cc,Qc.cspNonce=Qr.define({combine:t=>t.length?t[0]:""}),Qc.contentAttributes=Ka,Qc.editorAttributes=Za,Qc.lineWrapping=Qc.contentAttributes.of({class:"cm-lineWrapping"}),Qc.announce=yo.define();const Wc=4096,Xc={};class Uc{constructor(t,e,n,i,r,o){this.from=t,this.to=e,this.dir=n,this.isolates=i,this.fresh=r,this.order=o}static update(t,e){if(e.empty&&!t.some(t=>t.fresh))return t;let n=[],i=t.length?t[t.length-1].dir:ga.LTR;for(let r=Math.max(0,t.length-10);r<t.length;r++){let o=t[r];o.dir!=i||e.touchesRange(o.from,o.to)||n.push(new Uc(e.mapPos(o.from,1),e.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return n}}function Gc(t,e,n){for(let i=t.state.facet(e),r=i.length-1;r>=0;r--){let e=i[r],o="function"==typeof e?e(t):e;o&&Zs(o,n)}return n}const Yc=Hs.mac?"mac":Hs.windows?"win":Hs.linux?"linux":"key";function Zc(t,e,n){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),!1!==n&&e.shiftKey&&(t="Shift-"+t),t}const Kc=to.default(Qc.domEventHandlers({keydown:(t,e)=>function(t,e,n,i){let r=function(t){var e=!(ns&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||is&&t.shiftKey&&t.key&&1==t.key.length||"Unidentified"==t.key)&&t.key||(t.shiftKey?es:ts)[t.keyCode]||t.key||"Unidentified";return"Esc"==e&&(e="Escape"),"Del"==e&&(e="Delete"),"Left"==e&&(e="ArrowLeft"),"Up"==e&&(e="ArrowUp"),"Right"==e&&(e="ArrowRight"),"Down"==e&&(e="ArrowDown"),e}(e),o=Pr(Ar(r,0))==r.length&&" "!=r,s="",a=!1,l=!1,c=!1;eh&&eh.view==n&&eh.scope==i&&(s=eh.prefix+" ",Ml.indexOf(e.keyCode)<0&&(l=!0,eh=null));let h,u,d=new Set,p=t=>{if(t){for(let i of t.run)if(!d.has(i)&&(d.add(i),i(n,e)))return t.stopPropagation&&(c=!0),!0;t.preventDefault&&(t.stopPropagation&&(c=!0),l=!0)}return!1},f=t[i];return f&&(p(f[s+Zc(r,e,!o)])?a=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Hs.windows&&e.ctrlKey&&e.altKey)&&(h=ts[e.keyCode])&&h!=r?(p(f[s+Zc(h,e,!0)])||e.shiftKey&&(u=es[e.keyCode])!=r&&u!=h&&p(f[s+Zc(u,e,!1)]))&&(a=!0):o&&e.shiftKey&&p(f[s+Zc(r,e,!0)])&&(a=!0),!a&&p(f._any)&&(a=!0)),l&&(a=!0),a&&c&&e.stopPropagation(),a}(function(t){let e=t.facet(Jc),n=th.get(e);return n||th.set(e,n=function(t,e=Yc){let n=Object.create(null),i=Object.create(null),r=(t,e)=>{let n=i[t];if(null==n)i[t]=e;else if(n!=e)throw new Error("Key binding "+t+" is used both as a regular binding and as a multi-stroke prefix")},o=(t,i,o,s,a)=>{var l,c;let h=n[t]||(n[t]=Object.create(null)),u=i.split(/ (?!$)/).map(t=>function(t,e){const n=t.split(/-(?!$)/);let i,r,o,s,a=n[n.length-1];"Space"==a&&(a=" ");for(let t=0;t<n.length-1;++t){const a=n[t];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))i=!0;else if(/^(c|ctrl|control)$/i.test(a))r=!0;else if(/^s(hift)?$/i.test(a))o=!0;else{if(!/^mod$/i.test(a))throw new Error("Unrecognized modifier name: "+a);"mac"==e?s=!0:r=!0}}return i&&(a="Alt-"+a),r&&(a="Ctrl-"+a),s&&(a="Meta-"+a),o&&(a="Shift-"+a),a}(t,e));for(let e=1;e<u.length;e++){let n=u.slice(0,e).join(" ");r(n,!0),h[n]||(h[n]={preventDefault:!0,stopPropagation:!1,run:[e=>{let i=eh={view:e,prefix:n,scope:t};return setTimeout(()=>{eh==i&&(eh=null)},4e3),!0}]})}let d=u.join(" ");r(d,!1);let p=h[d]||(h[d]={preventDefault:!1,stopPropagation:!1,run:(null===(c=null===(l=h._any)||void 0===l?void 0:l.run)||void 0===c?void 0:c.slice())||[]});o&&p.run.push(o),s&&(p.preventDefault=!0),a&&(p.stopPropagation=!0)};for(let i of t){let t=i.scope?i.scope.split(" "):["editor"];if(i.any)for(let e of t){let t=n[e]||(n[e]=Object.create(null));t._any||(t._any={preventDefault:!1,stopPropagation:!1,run:[]});for(let e in t)t[e].run.push(i.any)}let r=i[e]||i.key;if(r)for(let e of t)o(e,r,i.run,i.preventDefault,i.stopPropagation),i.shift&&o(e,"Shift-"+r,i.shift,i.preventDefault,i.stopPropagation)}return n}(e.reduce((t,e)=>t.concat(e),[]))),n}(e.state),t,e,"editor")})),Jc=Qr.define({enables:Kc}),th=new WeakMap;let eh=null;const nh={".cm-line":{}};!Hs.ios&&(nh[".cm-line"].caretColor="transparent !important",nh[".cm-content"]={caretColor:"transparent !important"});const ih="-10000px";class rh{constructor(t,e,n){this.facet=e,this.createTooltipView=n,this.input=t.state.facet(e),this.tooltips=this.input.filter(t=>t),this.tooltipViews=this.tooltips.map(n)}update(t,e){var n;let i=t.state.facet(this.facet),r=i.filter(t=>t);if(i===this.input){for(let e of this.tooltipViews)e.update&&e.update(t);return!1}let o=[],s=e?[]:null;for(let n=0;n<r.length;n++){let i=r[n],a=-1;if(i){for(let t=0;t<this.tooltips.length;t++){let e=this.tooltips[t];e&&e.create==i.create&&(a=t)}if(a<0)o[n]=this.createTooltipView(i),s&&(s[n]=!!i.above);else{let i=o[n]=this.tooltipViews[a];s&&(s[n]=e[a]),i.update&&i.update(t)}}}for(let t of this.tooltipViews)o.indexOf(t)<0&&(t.dom.remove(),null===(n=t.destroy)||void 0===n||n.call(t));return e&&(s.forEach((t,n)=>e[n]=t),e.length=s.length),this.input=i,this.tooltips=r,this.tooltipViews=o,!0}}function oh(t={}){return ah.of(t)}function sh(t){let{win:e}=t;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const ah=Qr.define({combine:t=>{var e,n,i;return{position:Hs.ios?"absolute":(null===(e=t.find(t=>t.position))||void 0===e?void 0:e.position)||"fixed",parent:(null===(n=t.find(t=>t.parent))||void 0===n?void 0:n.parent)||null,tooltipSpace:(null===(i=t.find(t=>t.tooltipSpace))||void 0===i?void 0:i.tooltipSpace)||sh}}}),lh=new WeakMap,ch=Ga.fromClass(class{constructor(t){this.view=t,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=t.state.facet(ah);this.position=e.position,this.parent=e.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new rh(t,dh,t=>this.createTooltip(t)),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t,this.above);e&&this.observeIntersection();let n=e||t.geometryChanged,i=t.state.facet(ah);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let t of this.manager.tooltipViews)t.dom.style.position=this.position;n=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let t of this.manager.tooltipViews)this.container.appendChild(t.dom);n=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);n&&this.maybeMeasure()}createTooltip(t){let e=t.create(this.view);if(e.dom.classList.add("cm-tooltip"),t.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=ih,e.dom.style.left="0px",this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var t,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let e of this.manager.tooltipViews)e.dom.remove(),null===(t=e.destroy)||void 0===t||t.call(e);this.parent&&this.container.remove(),null===(e=this.intersectionObserver)||void 0===e||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=this.view.dom.getBoundingClientRect(),e=1,n=1,i=!1;if("fixed"==this.position&&this.manager.tooltipViews.length){let{dom:t}=this.manager.tooltipViews[0];if(Hs.gecko)i=t.offsetParent!=this.container.ownerDocument.body;else if(t.style.top==ih&&"0px"==t.style.left){let e=t.getBoundingClientRect();i=Math.abs(e.top+1e4)>1||Math.abs(e.left)>1}}if(i||"absolute"==this.position)if(this.parent){let t=this.parent.getBoundingClientRect();t.width&&t.height&&(e=t.width/this.parent.offsetWidth,n=t.height/this.parent.offsetHeight)}else({scaleX:e,scaleY:n}=this.view.viewState);return{editor:t,parent:this.parent?this.container.getBoundingClientRect():t,pos:this.manager.tooltips.map((t,e)=>{let n=this.manager.tooltipViews[e];return n.getCoords?n.getCoords(t.pos):this.view.coordsAtPos(t.pos)}),size:this.manager.tooltipViews.map(({dom:t})=>t.getBoundingClientRect()),space:this.view.state.facet(ah).tooltipSpace(this.view),scaleX:e,scaleY:n,makeAbsolute:i}}writeMeasure(t){var e;if(t.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let t of this.manager.tooltipViews)t.dom.style.position="absolute"}let{editor:n,space:i,scaleX:r,scaleY:o}=t,s=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],c=this.manager.tooltipViews[a],{dom:h}=c,u=t.pos[a],d=t.size[a];if(!u||u.bottom<=Math.max(n.top,i.top)||u.top>=Math.min(n.bottom,i.bottom)||u.right<Math.max(n.left,i.left)-.1||u.left>Math.min(n.right,i.right)+.1){h.style.top=ih;continue}let p=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,f=p?7:0,g=d.right-d.left,m=null!==(e=lh.get(c))&&void 0!==e?e:d.bottom-d.top,v=c.offset||uh,y=this.view.textDirection==ga.LTR,b=d.width>i.right-i.left?y?i.left:i.right-d.width:y?Math.min(u.left-(p?14:0)+v.x,i.right-g):Math.max(i.left,u.left-g+(p?14:0)-v.x),x=this.above[a];!l.strictSide&&(x?u.top-(d.bottom-d.top)-v.y<i.top:u.bottom+(d.bottom-d.top)+v.y>i.bottom)&&x==i.bottom-u.bottom>u.top-i.top&&(x=this.above[a]=!x);let w=(x?u.top-i.top:i.bottom-u.bottom)-f;if(w<m&&!1!==c.resize){if(w<this.view.defaultLineHeight){h.style.top=ih;continue}lh.set(c,m),h.style.height=(m=w)/o+"px"}else h.style.height&&(h.style.height="");let _=x?u.top-m-f-v.y:u.bottom+f+v.y,O=b+g;if(!0!==c.overlap)for(let t of s)t.left<O&&t.right>b&&t.top<_+m&&t.bottom>_&&(_=x?t.top-m-2-f:t.bottom+f+2);if("absolute"==this.position?(h.style.top=(_-t.parent.top)/o+"px",h.style.left=(b-t.parent.left)/r+"px"):(h.style.top=_/o+"px",h.style.left=b/r+"px"),p){let t=u.left+(y?v.x:-v.x)-(b+14-7);p.style.left=t/r+"px"}!0!==c.overlap&&s.push({left:b,top:_,right:O,bottom:_+m}),h.classList.toggle("cm-tooltip-above",x),h.classList.toggle("cm-tooltip-below",!x),c.positioned&&c.positioned(t.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=ih}},{eventObservers:{scroll(){this.maybeMeasure()}}}),hh=Qc.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),uh={x:0,y:0},dh=Qr.define({enables:[ch,hh]}),ph=Qr.define();class fh{static create(t){return new fh(t)}constructor(t){this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new rh(t,ph,t=>this.createHostedView(t))}createHostedView(t){let e=t.create(this.view);return e.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(e.dom),this.mounted&&e.mount&&e.mount(this.view),e}mount(t){for(let e of this.manager.tooltipViews)e.mount&&e.mount(t);this.mounted=!0}positioned(t){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned(t)}update(t){this.manager.update(t)}destroy(){var t;for(let e of this.manager.tooltipViews)null===(t=e.destroy)||void 0===t||t.call(e)}passProp(t){let e;for(let n of this.manager.tooltipViews){let i=n[t];if(void 0!==i)if(void 0===e)e=i;else if(e!==i)return}return e}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const gh=dh.compute([ph],t=>{let e=t.facet(ph).filter(t=>t);return 0===e.length?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var e;return null!==(e=t.end)&&void 0!==e?e:t.pos})),create:fh.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class mh{constructor(t,e,n,i,r){this.view=t,this.source=e,this.field=n,this.setHover=i,this.hoverTime=r,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let t=Date.now()-this.lastMove.time;t<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-t):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:t,lastMove:e}=this,n=t.docView.nearest(e.target);if(!n)return;let i,r=1;if(n instanceof Ws)i=n.posAtStart;else{if(i=t.posAtCoords(e),null==i)return;let n=t.coordsAtPos(i);if(!n||e.y<n.top||e.y>n.bottom||e.x<n.left-t.defaultCharacterWidth||e.x>n.right+t.defaultCharacterWidth)return;let o=t.bidiSpans(t.state.doc.lineAt(i)).find(t=>t.from<=i&&t.to>=i),s=o&&o.dir==ga.RTL?-1:1;r=e.x<n.left?-s:s}let o=this.source(t,i,r);if(null==o?void 0:o.then){let e=this.pending={pos:i};o.then(n=>{this.pending==e&&(this.pending=null,n&&t.dispatch({effects:this.setHover.of(n)}))},e=>Qa(t.state,e,"hover tooltip"))}else o&&t.dispatch({effects:this.setHover.of(o)})}get tooltip(){let t=this.view.plugin(ch),e=t?t.manager.tooltips.findIndex(t=>t.create==fh.create):-1;return e>-1?t.manager.tooltipViews[e]:null}mousemove(t){var e;this.lastMove={x:t.clientX,y:t.clientY,target:t.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:n,tooltip:i}=this;if(n&&i&&!function(t,e){let n=t.getBoundingClientRect();return e.clientX>=n.left-4&&e.clientX<=n.right+4&&e.clientY>=n.top-4&&e.clientY<=n.bottom+4}(i.dom,t)||this.pending){let{pos:i}=n||this.pending,r=null!==(e=null==n?void 0:n.end)&&void 0!==e?e:i;(i==r?this.view.posAtCoords(this.lastMove)==i:function(t,e,n,i,r){let o=t.scrollDOM.getBoundingClientRect(),s=t.documentTop+t.documentPadding.top+t.contentHeight;if(o.left>i||o.right<i||o.top>r||Math.min(o.bottom,s)<r)return!1;let a=t.posAtCoords({x:i,y:r},!1);return a>=e&&a<=n}(this.view,i,r,t.clientX,t.clientY))||(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(t){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:e}=this;if(e){let{tooltip:e}=this;e&&e.dom.contains(t.relatedTarget)?this.watchTooltipLeave(e.dom):this.view.dispatch({effects:this.setHover.of(null)})}}watchTooltipLeave(t){let e=n=>{t.removeEventListener("mouseleave",e),this.active&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})};t.addEventListener("mouseleave",e)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function vh(t,e={}){let n=yo.define(),i=Kr.define({create:()=>null,update(t,i){if(t&&(e.hideOnChange&&(i.docChanged||i.selection)||e.hideOn&&e.hideOn(i,t)))return null;if(t&&i.docChanged){let e=i.changes.mapPos(t.pos,-1,Nr.TrackDel);if(null==e)return null;let n=Object.assign(Object.create(null),t);n.pos=e,null!=t.end&&(n.end=i.changes.mapPos(t.end)),t=n}for(let e of i.effects)e.is(n)&&(t=e.value),e.is(bh)&&(t=null);return t},provide:t=>ph.from(t)});return[i,Ga.define(r=>new mh(r,t,i,n,e.hoverTime||300)),gh]}function yh(t,e){let n=t.plugin(ch);if(!n)return null;let i=n.manager.tooltips.indexOf(e);return i<0?null:n.manager.tooltipViews[i]}const bh=yo.define(),xh=Qr.define({combine(t){let e,n;for(let i of t)e=e||i.topContainer,n=n||i.bottomContainer;return{topContainer:e,bottomContainer:n}}}),wh=Ga.fromClass(class{constructor(t){this.input=t.state.facet(kh),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(e=>e(t));let e=t.state.facet(xh);this.top=new _h(t,!0,e.topContainer),this.bottom=new _h(t,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(t){let e=t.state.facet(xh);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new _h(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new _h(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let n=t.state.facet(kh);if(n!=this.input){let e=n.filter(t=>t),i=[],r=[],o=[],s=[];for(let n of e){let e,a=this.specs.indexOf(n);a<0?(e=n(t.view),s.push(e)):(e=this.panels[a],e.update&&e.update(t)),i.push(e),(e.top?r:o).push(e)}this.specs=e,this.panels=i,this.top.sync(r),this.bottom.sync(o);for(let t of s)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}else for(let e of this.panels)e.update&&e.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>Qc.scrollMargins.of(e=>{let n=e.plugin(t);return n&&{top:n.top.scrollMargin(),bottom:n.bottom.scrollMargin()}})});class _h{constructor(t,e,n){this.view=t,this.top=e,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let e of this.panels)e.destroy&&t.indexOf(e)<0&&e.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(0==this.panels.length)return void(this.dom&&(this.dom.remove(),this.dom=void 0));if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=Oh(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=Oh(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function Oh(t){let e=t.nextSibling;return t.remove(),e}const kh=Qr.define({enables:wh});class Sh extends Mo{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}Sh.prototype.elementClass="",Sh.prototype.toDOM=void 0,Sh.prototype.mapMode=Nr.TrackBefore,Sh.prototype.startSide=Sh.prototype.endSide=-1,Sh.prototype.point=!0;const Eh=Qr.define(),Ch=Qr.define(),Ah=Qr.define({combine:t=>t.some(t=>t)}),Th=Ga.fromClass(class{constructor(t){this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=t.state.facet(Ch).map(e=>new Rh(t,e));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!t.state.facet(Ah),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}update(t){if(this.updateGutters(t)){let e=this.prevViewport,n=t.view.viewport,i=Math.min(e.to,n.to)-Math.max(e.from,n.from);this.syncGutters(i<.8*(n.to-n.from))}t.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(Ah)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&this.dom.remove();let n=Bo.iter(this.view.state.facet(Eh),this.view.viewport.from),i=[],r=this.gutters.map(t=>new Nh(t,this.view.viewport,-this.view.documentPadding.top));for(let t of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(t.type)){let e=!0;for(let o of t.type)if(o.type==oa.Text&&e){Mh(n,i,o.from);for(let t of r)t.line(this.view,o,i);e=!1}else if(o.widget)for(let t of r)t.widget(this.view,o)}else if(t.type==oa.Text){Mh(n,i,t.from);for(let e of r)e.line(this.view,t,i)}else if(t.widget)for(let e of r)e.widget(this.view,t);for(let t of r)t.finish();t&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(t){let e=t.startState.facet(Ch),n=t.state.facet(Ch),i=t.docChanged||t.heightChanged||t.viewportChanged||!Bo.eq(t.startState.facet(Eh),t.state.facet(Eh),t.view.viewport.from,t.view.viewport.to);if(e==n)for(let e of this.gutters)e.update(t)&&(i=!0);else{i=!0;let r=[];for(let i of n){let n=e.indexOf(i);n<0?r.push(new Rh(this.view,i)):(this.gutters[n].update(t),r.push(this.gutters[n]))}for(let t of this.gutters)t.dom.remove(),r.indexOf(t)<0&&t.destroy();for(let t of r)this.dom.appendChild(t.dom);this.gutters=r}return i}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove()}},{provide:t=>Qc.scrollMargins.of(e=>{let n=e.plugin(t);return n&&0!=n.gutters.length&&n.fixed?e.textDirection==ga.LTR?{left:n.dom.offsetWidth*e.scaleX}:{right:n.dom.offsetWidth*e.scaleX}:null})});function Ph(t){return Array.isArray(t)?t:[t]}function Mh(t,e,n){for(;t.value&&t.from<=n;)t.from==n&&e.push(t.value),t.next()}class Nh{constructor(t,e,n){this.gutter=t,this.height=n,this.i=0,this.cursor=Bo.iter(t.markers,e.from)}addElement(t,e,n){let{gutter:i}=this,r=(e.top-this.height)/t.scaleY,o=e.height/t.scaleY;if(this.i==i.elements.length){let e=new Dh(t,o,r,n);i.elements.push(e),i.dom.appendChild(e.dom)}else i.elements[this.i].update(t,o,r,n);this.height=e.bottom,this.i++}line(t,e,n){let i=[];Mh(this.cursor,i,e.from),n.length&&(i=i.concat(n));let r=this.gutter.config.lineMarker(t,e,i);r&&i.unshift(r);let o=this.gutter;(0!=i.length||o.config.renderEmptyElements)&&this.addElement(t,e,i)}widget(t,e){let n=this.gutter.config.widgetMarker(t,e.widget,e);n&&this.addElement(t,e,[n])}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let e=t.elements.pop();t.dom.removeChild(e.dom),e.destroy()}}}class Rh{constructor(t,e){this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in e.domEventHandlers)this.dom.addEventListener(n,i=>{let r,o=i.target;if(o!=this.dom&&this.dom.contains(o)){for(;o.parentNode!=this.dom;)o=o.parentNode;let t=o.getBoundingClientRect();r=(t.top+t.bottom)/2}else r=i.clientY;let s=t.lineBlockAtHeight(r-t.documentTop);e.domEventHandlers[n](t,s,i)&&i.preventDefault()});this.markers=Ph(e.markers(t)),e.initialSpacer&&(this.spacer=new Dh(t,0,0,[e.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let e=this.markers;if(this.markers=Ph(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let e=this.config.updateSpacer(this.spacer.markers[0],t);e!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[e])}let n=t.view.viewport;return!Bo.eq(this.markers,e,n.from,n.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(t)}destroy(){for(let t of this.elements)t.destroy()}}class Dh{constructor(t,e,n,i){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,e,n,i)}update(t,e,n,i){this.height!=e&&(this.height=e,this.dom.style.height=e+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),function(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].compare(e[n]))return!1;return!0}(this.markers,i)||this.setMarkers(t,i)}setMarkers(t,e){let n="cm-gutterElement",i=this.dom.firstChild;for(let r=0,o=0;;){let s=o,a=r<e.length?e[r++]:null,l=!1;if(a){let t=a.elementClass;t&&(n+=" "+t);for(let t=o;t<this.markers.length;t++)if(this.markers[t].compare(a)){s=t,l=!0;break}}else s=this.markers.length;for(;o<s;){let t=this.markers[o++];if(t.toDOM){t.destroy(i);let e=i.nextSibling;i.remove(),i=e}}if(!a)break;a.toDOM&&(l?i=i.nextSibling:this.dom.insertBefore(a.toDOM(t),i)),l&&o++}this.dom.className=n,this.markers=e}destroy(){this.setMarkers(null,[])}}const Bh=Qr.define(),$h=Qr.define({combine:t=>Po(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,e){let n=Object.assign({},t);for(let t in e){let i=n[t],r=e[t];n[t]=i?(t,e,n)=>i(t,e,n)||r(t,e,n):r}return n}})});class Lh extends Sh{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function Ih(t,e){return t.state.facet($h).formatNumber(e,t.state)}const qh=Ch.compute([$h],t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers:t=>t.state.facet(Bh),lineMarker:(t,e,n)=>n.some(t=>t.toDOM)?null:new Lh(Ih(t,t.state.doc.lineAt(e.from).number)),widgetMarker:()=>null,lineMarkerChange:t=>t.startState.facet($h)!=t.state.facet($h),initialSpacer:t=>new Lh(Ih(t,Vh(t.state.doc.lines))),updateSpacer(t,e){let n=Ih(e.view,Vh(e.view.state.doc.lines));return n==t.number?t:new Lh(n)},domEventHandlers:t.facet($h).domEventHandlers}));function Fh(t={}){return[$h.of(t),[Th],qh]}function Vh(t){let e=9;for(;e<t;)e=10*e+9;return e}var jh;const Hh=new ke,zh=new ke;class Qh{constructor(t,e,n=[],i=""){this.data=t,this.name=i,To.prototype.hasOwnProperty("tree")||Object.defineProperty(To.prototype,"tree",{get(){return Uh(this)}}),this.parser=e,this.extension=[iu.of(this),To.languageData.of((t,e,n)=>{let i=Wh(t,e,n),r=i.type.prop(Hh);if(!r)return[];let o=t.facet(r),s=i.type.prop(zh);if(s){let r=i.resolve(e-i.from,n);for(let e of s)if(e.test(r,t)){let n=t.facet(e.facet);return"replace"==e.type?n:n.concat(o)}}return o})].concat(n)}isActiveAt(t,e,n=-1){return Wh(t,e,n).type.prop(Hh)==this.data}findRegions(t){let e=t.facet(iu);if((null==e?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let n=[],i=(t,e)=>{if(t.prop(Hh)==this.data)return void n.push({from:e,to:e+t.length});let r=t.prop(ke.mounted);if(r){if(r.tree.prop(Hh)==this.data){if(r.overlay)for(let t of r.overlay)n.push({from:t.from+e,to:t.to+e});else n.push({from:e,to:e+t.length});return}if(r.overlay){let t=n.length;if(i(r.tree,r.overlay[0].from+e),n.length>t)return}}for(let n=0;n<t.children.length;n++){let r=t.children[n];r instanceof Ne&&i(r,t.positions[n]+e)}};return i(Uh(t),0),n}get allowsNesting(){return!0}}function Wh(t,e,n){let i=t.facet(iu),r=Uh(t).topNode;if(!i||i.allowsNesting)for(let t=r;t;t=t.enter(e,n,Me.ExcludeBuffers))t.type.isTop&&(r=t);return r}Qh.setState=yo.define();class Xh extends Qh{constructor(t,e,n){super(t,e,[],n),this.parser=e}static define(t){let e=(n=t.languageData,Qr.define({combine:n?t=>t.concat(n):void 0}));var n;return new Xh(e,t.parser.configure({props:[Hh.add(t=>t.isTop?e:void 0)]}),t.name)}configure(t,e){return new Xh(this.data,this.parser.configure(t),e||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Uh(t){let e=t.field(Qh.state,!1);return e?e.tree:Ne.empty}class Gh{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let n=this.cursorPos-this.string.length;return t<n||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-n,e-n)}}let Yh=null;class Zh{constructor(t,e,n=[],i,r,o,s,a){this.parser=t,this.state=e,this.fragments=n,this.tree=i,this.treeLen=r,this.viewport=o,this.skipped=s,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(t,e,n){return new Zh(t,e,[],Ne.empty,0,n,[],null)}startParse(){return this.parser.startParse(new Gh(this.state.doc),this.fragments)}work(t,e){return null!=e&&e>=this.state.doc.length&&(e=void 0),this.tree!=Ne.empty&&this.isDone(null!=e?e:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if("number"==typeof t){let e=Date.now()+t;t=()=>Date.now()>e}for(this.parse||(this.parse=this.startParse()),null!=e&&(null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let i=this.parse.advance();if(i){if(this.fragments=this.withoutTempSkipped(Ye.addTree(i,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(n=this.parse.stoppedAt)&&void 0!==n?n:this.state.doc.length,this.tree=i,this.parse=null,!(this.treeLen<(null!=e?e:this.state.doc.length)))return!0;this.parse=this.startParse()}if(t())return!1}})}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(e=this.parse.advance()););}),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(Ye.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=Yh;Yh=this;try{return t()}finally{Yh=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=Kh(t,e.from,e.to);return t}changes(t,e){let{fragments:n,tree:i,treeLen:r,viewport:o,skipped:s}=this;if(this.takeTree(),!t.empty){let e=[];if(t.iterChangedRanges((t,n,i,r)=>e.push({fromA:t,toA:n,fromB:i,toB:r})),n=Ye.applyChanges(n,e),i=Ne.empty,r=0,o={from:t.mapPos(o.from,-1),to:t.mapPos(o.to,1)},this.skipped.length){s=[];for(let e of this.skipped){let n=t.mapPos(e.from,1),i=t.mapPos(e.to,-1);n<i&&s.push({from:n,to:i})}}}return new Zh(this.parser,e,n,i,r,o,s,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let e=0;e<this.skipped.length;e++){let{from:n,to:i}=this.skipped[e];n<t.to&&i>t.from&&(this.fragments=Kh(this.fragments,n,i),this.skipped.splice(e--,1))}return!(this.skipped.length>=e||(this.reset(),0))}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends Ze{createParse(e,n,i){let r=i[0].from,o=i[i.length-1].to,s={parsedPos:r,advance(){let e=Yh;if(e){for(let t of i)e.tempSkipped.push(t);t&&(e.scheduleOn=e.scheduleOn?Promise.all([e.scheduleOn,t]):t)}return this.parsedPos=o,new Ne(Ce.none,[],[],o-r)},stoppedAt:null,stopAt(){}};return s}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&0==e[0].from&&e[0].to>=t}static get(){return Yh}}function Kh(t,e,n){return Ye.applyChanges(t,[{fromA:e,toA:n,fromB:e,toB:n}])}class Jh{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),n=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,n)||e.takeTree(),new Jh(e)}static init(t){let e=Math.min(3e3,t.doc.length),n=Zh.create(t.facet(iu).parser,t,{from:0,to:e});return n.work(20,e)||n.takeTree(),new Jh(n)}}Qh.state=Kr.define({create:Jh.init,update(t,e){for(let t of e.effects)if(t.is(Qh.setState))return t.value;return e.startState.facet(iu)!=e.state.facet(iu)?Jh.init(e.state):t.apply(e)}});let tu=t=>{let e=setTimeout(()=>t(),500);return()=>clearTimeout(e)};"undefined"!=typeof requestIdleCallback&&(tu=t=>{let e=-1,n=setTimeout(()=>{e=requestIdleCallback(t,{timeout:400})},100);return()=>e<0?clearTimeout(n):cancelIdleCallback(e)});const eu="undefined"!=typeof navigator&&(null===(jh=navigator.scheduling)||void 0===jh?void 0:jh.isInputPending)?()=>navigator.scheduling.isInputPending():null,nu=Ga.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(Qh.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),(t.docChanged||t.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(Qh.state);e.tree==e.context.tree&&e.context.isDone(t.doc.length)||(this.working=tu(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,r=n.field(Qh.state);if(r.tree==r.context.tree&&r.context.isDone(i+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,t&&!eu?Math.max(25,t.timeRemaining()-5):1e9),s=r.context.treeLen<i&&n.doc.length>i+1e3,a=r.context.work(()=>eu&&eu()||Date.now()>o,i+(s?0:1e5));this.chunkBudget-=Date.now()-e,(a||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:Qh.setState.of(new Jh(r.context))})),this.chunkBudget>0&&(!a||s)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Qa(this.view.state,t)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),iu=Qr.define({combine:t=>t.length?t[0]:null,enables:t=>[Qh.state,nu,Qc.contentAttributes.compute([t],e=>{let n=e.facet(t);return n&&n.name?{"data-language":n.name}:{}})]});class ru{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}}const ou=Qr.define(),su=Qr.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function au(t){let e=t.facet(su);return 9==e.charCodeAt(0)?t.tabSize*e.length:e.length}function lu(t,e){let n="",i=t.tabSize,r=t.facet(su)[0];if("\t"==r){for(;e>=i;)n+="\t",e-=i;r=" "}for(let t=0;t<e;t++)n+=r;return n}function cu(t,e){t instanceof To&&(t=new hu(t));for(let n of t.state.facet(ou)){let i=n(t,e);if(void 0!==i)return i}let n=Uh(t.state);return n.length>=e?function(t,e,n){let i=e.resolveStack(n),r=i.node.enterUnfinishedNodesBefore(n);if(r!=i.node){let t=[];for(let e=r;e!=i.node;e=e.parent)t.push(e);for(let e=t.length-1;e>=0;e--)i={node:t[e],next:i}}return du(i,t,n)}(t,n,e):null}class hu{constructor(t,e={}){this.state=t,this.options=e,this.unit=au(t)}lineAt(t,e=1){let n=this.state.doc.lineAt(t),{simulateBreak:i,simulateDoubleBreak:r}=this.options;return null!=i&&i>=n.from&&i<=n.to?r&&i==t?{text:"",from:t}:(e<0?i<t:i<=t)?{text:n.text.slice(i-n.from),from:i}:{text:n.text.slice(0,i-n.from),from:n.from}:n}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:n,from:i}=this.lineAt(t,e);return n.slice(t-i,Math.min(n.length,t+100-i))}column(t,e=1){let{text:n,from:i}=this.lineAt(t,e),r=this.countColumn(n,t-i),o=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return o>-1&&(r+=o-this.countColumn(n,n.search(/\S|$/))),r}countColumn(t,e=t.length){return Xo(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:n,from:i}=this.lineAt(t,e),r=this.options.overrideIndentation;if(r){let t=r(i);if(t>-1)return t}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const uu=new ke;function du(t,e,n){for(let i=t;i;i=i.next){let t=pu(i.node);if(t)return t(gu.create(e,n,i))}return 0}function pu(t){let e=t.type.prop(uu);if(e)return e;let n,i=t.firstChild;if(i&&(n=i.type.prop(ke.closedBy))){let e=t.lastChild,i=e&&n.indexOf(e.name)>-1;return t=>yu(t,!0,1,void 0,i&&!function(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}(t)?e.from:void 0)}return null==t.parent?fu:null}function fu(){return 0}class gu extends hu{constructor(t,e,n){super(t.state,t.options),this.base=t,this.pos=e,this.context=n}get node(){return this.context.node}static create(t,e,n){return new gu(t,e,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(t){let e=this.state.doc.lineAt(t.from);for(;;){let n=t.resolve(e.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(mu(n,t))break;e=this.state.doc.lineAt(n.from)}return this.lineIndent(e.from)}continue(){return du(this.context.next,this.base,this.pos)}}function mu(t,e){for(let n=e;n;n=n.parent)if(t==n)return!0;return!1}function vu({closing:t,align:e=!0,units:n=1}){return i=>yu(i,e,n,t)}function yu(t,e,n,i,r){let o=t.textAfter,s=o.match(/^\s*/)[0].length,a=i&&o.slice(s,s+i.length)==i||r==t.pos+s,l=e?function(t){let e=t.node,n=e.childAfter(e.from),i=e.lastChild;if(!n)return null;let r=t.options.simulateBreak,o=t.state.doc.lineAt(n.from),s=null==r||r<=o.from?o.to:Math.min(o.to,r);for(let t=n.to;;){let r=e.childAfter(t);if(!r||r==i)return null;if(!r.type.isSkipped)return r.from<s?n:null;t=r.to}}(t):null;return l?a?t.column(l.from):t.column(l.to):t.baseIndent+(a?0:t.unit*n)}function bu({except:t,units:e=1}={}){return n=>{let i=t&&t.test(n.textAfter);return n.baseIndent+(i?0:e*n.unit)}}function xu(){return To.transactionFilter.of(t=>{if(!t.docChanged||!t.isUserEvent("input.type")&&!t.isUserEvent("input.complete"))return t;let e=t.startState.languageDataAt("indentOnInput",t.startState.selection.main.head);if(!e.length)return t;let n=t.newDoc,{head:i}=t.newSelection.main,r=n.lineAt(i);if(i>r.from+200)return t;let o=n.sliceString(r.from,i);if(!e.some(t=>t.test(o)))return t;let{state:s}=t,a=-1,l=[];for(let{head:t}of s.selection.ranges){let e=s.doc.lineAt(t);if(e.from==a)continue;a=e.from;let n=cu(s,e.from);if(null==n)continue;let i=/^\s*/.exec(e.text)[0],r=lu(s,n);i!=r&&l.push({from:e.from,to:e.from+i.length,insert:r})}return l.length?[t,{changes:l,sequential:!0}]:t})}const wu=new ke;function _u(t){let e=t.firstChild,n=t.lastChild;return e&&e.to<n.from?{from:e.to,to:n.type.isError?t.to:n.from}:null}class Ou{constructor(t,e){let n;function i(t){let e=Zo.newName();return(n||(n=Object.create(null)))["."+e]=t,e}this.specs=t;const r="string"==typeof e.all?e.all:e.all?i(e.all):void 0,o=e.scope;this.scope=o instanceof Qh?t=>t.prop(Hh)==o.data:o?t=>t==o:void 0,this.style=Qn(t.map(t=>({tag:t.tag,class:t.class||i(Object.assign({},t,{tag:null}))})),{all:r}).style,this.module=n?new Zo(n):null,this.themeType=e.themeType}static define(t,e){return new Ou(t,e||{})}}const ku=Qr.define(),Su=Qr.define({combine:t=>t.length?[t[0]]:null});function Eu(t){let e=t.facet(ku);return e.length?e:t.facet(Su)}function Cu(t,e){let n,i=[Tu];return t instanceof Ou&&(t.module&&i.push(Qc.styleModule.of(t.module)),n=t.themeType),n?i.push(ku.computeN([Qc.darkTheme],e=>e.facet(Qc.darkTheme)==("dark"==n)?[t]:[])):i.push(ku.of(t)),i}class Au{constructor(t){this.markCache=Object.create(null),this.tree=Uh(t.state),this.decorations=this.buildDeco(t,Eu(t.state))}update(t){let e=Uh(t.state),n=Eu(t.state),i=n!=Eu(t.startState);e.length<t.view.viewport.to&&!i&&e.type==this.tree.type?this.decorations=this.decorations.map(t.changes):(e!=this.tree||t.viewportChanged||i)&&(this.tree=e,this.decorations=this.buildDeco(t.view,n))}buildDeco(t,e){if(!e||!this.tree.length)return sa.none;let n=new $o;for(let{from:i,to:r}of t.visibleRanges)Wn(this.tree,e,(t,e,i)=>{n.add(t,e,this.markCache[i]||(this.markCache[i]=sa.mark({class:i})))},i,r);return n.finish()}}const Tu=to.high(Ga.fromClass(Au,{decorations:t=>t.decorations})),Pu=Qc.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Mu="()[]{}",Nu=Qr.define({combine:t=>Po(t,{afterCursor:!0,brackets:Mu,maxScanDistance:1e4,renderMatch:Bu})}),Ru=sa.mark({class:"cm-matchingBracket"}),Du=sa.mark({class:"cm-nonmatchingBracket"});function Bu(t){let e=[],n=t.matched?Ru:Du;return e.push(n.range(t.start.from,t.start.to)),t.end&&e.push(n.range(t.end.from,t.end.to)),e}const $u=Kr.define({create:()=>sa.none,update(t,e){if(!e.docChanged&&!e.selection)return t;let n=[],i=e.state.facet(Nu);for(let t of e.state.selection.ranges){if(!t.empty)continue;let r=ju(e.state,t.head,-1,i)||t.head>0&&ju(e.state,t.head-1,1,i)||i.afterCursor&&(ju(e.state,t.head,1,i)||t.head<e.state.doc.length&&ju(e.state,t.head+1,-1,i));r&&(n=n.concat(i.renderMatch(r,e.state)))}return sa.set(n,!0)},provide:t=>Qc.decorations.from(t)}),Lu=[$u,Pu];function Iu(t={}){return[Nu.of(t),Lu]}const qu=new ke;function Fu(t,e,n){let i=t.prop(e<0?ke.openedBy:ke.closedBy);if(i)return i;if(1==t.name.length){let i=n.indexOf(t.name);if(i>-1&&i%2==(e<0?1:0))return[n[i+e]]}return null}function Vu(t){let e=t.type.prop(qu);return e?e(t.node):t}function ju(t,e,n,i={}){let r=i.maxScanDistance||1e4,o=i.brackets||Mu,s=Uh(t),a=s.resolveInner(e,n);for(let t=a;t;t=t.parent){let i=Fu(t.type,n,o);if(i&&t.from<t.to){let r=Vu(t);if(r&&(n>0?e>=r.from&&e<r.to:e>r.from&&e<=r.to))return Hu(0,0,n,t,r,i,o)}}return function(t,e,n,i,r,o,s){let a=n<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),l=s.indexOf(a);if(l<0||l%2==0!=n>0)return null;let c={from:n<0?e-1:e,to:n>0?e+1:e},h=t.doc.iterRange(e,n>0?t.doc.length:0),u=0;for(let t=0;!h.next().done&&t<=o;){let o=h.value;n<0&&(t+=o.length);let a=e+t*n;for(let t=n>0?0:o.length-1,e=n>0?o.length:-1;t!=e;t+=n){let e=s.indexOf(o[t]);if(!(e<0||i.resolveInner(a+t,1).type!=r))if(e%2==0==n>0)u++;else{if(1==u)return{start:c,end:{from:a+t,to:a+t+1},matched:e>>1==l>>1};u--}}n>0&&(t+=o.length)}return h.done?{start:c,matched:!1}:null}(t,e,n,s,a.type,r,o)}function Hu(t,e,n,i,r,o,s){let a=i.parent,l={from:r.from,to:r.to},c=0,h=null==a?void 0:a.cursor();if(h&&(n<0?h.childBefore(i.from):h.childAfter(i.to)))do{if(n<0?h.to<=i.from:h.from>=i.to){if(0==c&&o.indexOf(h.type.name)>-1&&h.from<h.to){let t=Vu(h);return{start:l,end:t?{from:t.from,to:t.to}:void 0,matched:!0}}if(Fu(h.type,n,s))c++;else if(Fu(h.type,-n,s)){if(0==c){let t=Vu(h);return{start:l,end:t&&t.from<t.to?{from:t.from,to:t.to}:void 0,matched:!1}}c--}}}while(n<0?h.prevSibling():h.nextSibling());return{start:l,matched:!1}}const zu=Object.create(null),Qu=[Ce.none],Wu=[],Xu=Object.create(null),Uu=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Uu[t]=Yu(zu,e);function Gu(t,e){Wu.indexOf(t)>-1||(Wu.push(t),console.warn(e))}function Yu(t,e){let n=[];for(let i of e.split(" ")){let e=[];for(let n of i.split(".")){let i=t[n]||ci[n];i?"function"==typeof i?e.length?e=e.map(i):Gu(n,`Modifier ${n} used at start of tag`):e.length?Gu(n,`Tag ${n} used as modifier`):e=Array.isArray(i)?i:[i]:Gu(n,`Unknown highlighting tag ${n}`)}for(let t of e)n.push(t)}if(!n.length)return 0;let i=e.replace(/ /g,"_"),r=i+" "+n.map(t=>t.id),o=Xu[r];if(o)return o.id;let s=Xu[r]=Ce.define({id:Qu.length,name:i,props:[jn({[i]:n})]});return Qu.push(s),s.id}ga.RTL,ga.LTR;class Zu{constructor(t,e,n){this.state=t,this.pos=e,this.explicit=n,this.abortListeners=[]}tokenBefore(t){let e=Uh(this.state).resolveInner(this.pos,-1);for(;e&&t.indexOf(e.name)<0;)e=e.parent;return e?{from:e.from,to:this.pos,text:this.state.sliceDoc(e.from,this.pos),type:e.type}:null}matchBefore(t){let e=this.state.doc.lineAt(this.pos),n=Math.max(e.from,this.pos-250),i=e.text.slice(n-e.from,this.pos-e.from),r=i.search(nd(t,!1));return r<0?null:{from:n+r,to:this.pos,text:i.slice(r)}}get aborted(){return null==this.abortListeners}addEventListener(t,e){"abort"==t&&this.abortListeners&&this.abortListeners.push(e)}}function Ku(t){let e=Object.keys(t).join(""),n=/\w/.test(e);return n&&(e=e.replace(/\w/g,"")),`[${n?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Ju(t){let e=t.map(t=>"string"==typeof t?{label:t}:t),[n,i]=e.every(t=>/^\w+$/.test(t.label))?[/\w*$/,/\w+$/]:function(t){let e=Object.create(null),n=Object.create(null);for(let{label:i}of t){e[i[0]]=!0;for(let t=1;t<i.length;t++)n[i[t]]=!0}let i=Ku(e)+Ku(n)+"*$";return[new RegExp("^"+i),new RegExp(i)]}(e);return t=>{let r=t.matchBefore(i);return r||t.explicit?{from:r?r.from:t.pos,options:e,validFor:n}:null}}class td{constructor(t,e,n,i){this.completion=t,this.source=e,this.match=n,this.score=i}}function ed(t){return t.selection.main.from}function nd(t,e){var n;let{source:i}=t,r=e&&"^"!=i[0],o="$"!=i[i.length-1];return r||o?new RegExp(`${r?"^":""}(?:${i})${o?"$":""}`,null!==(n=t.flags)&&void 0!==n?n:t.ignoreCase?"i":""):t}const id=go.define(),rd=new WeakMap;function od(t){if(!Array.isArray(t))return t;let e=rd.get(t);return e||rd.set(t,e=Ju(t)),e}const sd=yo.define(),ad=yo.define();class ld{constructor(t){this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let e=0;e<t.length;){let n=Ar(t,e),i=Pr(n);this.chars.push(n);let r=t.slice(e,e+i),o=r.toUpperCase();this.folded.push(Ar(o==r?r.toLowerCase():o,0)),e+=i}this.astral=t.length!=this.chars.length}ret(t,e){return this.score=t,this.matched=e,this}match(t){if(0==this.pattern.length)return this.ret(-100,[]);if(t.length<this.pattern.length)return null;let{chars:e,folded:n,any:i,precise:r,byWord:o}=this;if(1==e.length){let i=Ar(t,0),r=Pr(i),o=r==t.length?0:-100;if(i==e[0]);else{if(i!=n[0])return null;o+=-200}return this.ret(o,[0,r])}let s=t.indexOf(this.pattern);if(0==s)return this.ret(t.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=e.length,l=0;if(s<0){for(let r=0,o=Math.min(t.length,200);r<o&&l<a;){let o=Ar(t,r);o!=e[l]&&o!=n[l]||(i[l++]=r),r+=Pr(o)}if(l<a)return null}let c=0,h=0,u=!1,d=0,p=-1,f=-1,g=/[a-z]/.test(t),m=!0;for(let i=0,l=Math.min(t.length,200),v=0;i<l&&h<a;){let l=Ar(t,i);s<0&&(c<a&&l==e[c]&&(r[c++]=i),d<a&&(l==e[d]||l==n[d]?(0==d&&(p=i),f=i+1,d++):d=0));let y,b=l<255?l>=48&&l<=57||l>=97&&l<=122?2:l>=65&&l<=90?1:0:(y=Tr(l))!=y.toLowerCase()?1:y!=y.toUpperCase()?2:0;(!i||1==b&&g||0==v&&0!=b)&&(e[h]==l||n[h]==l&&(u=!0)?o[h++]=i:o.length&&(m=!1)),v=b,i+=Pr(l)}return h==a&&0==o[0]&&m?this.result((u?-200:0)-100,o,t):d==a&&0==p?this.ret(-200-t.length+(f==t.length?0:-100),[0,f]):s>-1?this.ret(-700-t.length,[s,s+this.pattern.length]):d==a?this.ret(-900-t.length,[p,f]):h==a?this.result((u?-200:0)-100-700+(m?0:-1100),o,t):2==e.length?null:this.result((i[0]?-700:0)-200-1100,i,t)}result(t,e,n){let i=[],r=0;for(let t of e){let e=t+(this.astral?Pr(Ar(n,t)):1);r&&i[r-1]==t?i[r-1]=e:(i[r++]=t,i[r++]=e)}return this.ret(t-n.length,i)}}class cd{constructor(t){this.pattern=t,this.matched=[],this.score=0,this.folded=t.toLowerCase()}match(t){if(t.length<this.pattern.length)return null;let e=t.slice(0,this.pattern.length),n=e==this.pattern?0:e.toLowerCase()==this.folded?-200:null;return null==n?null:(this.matched=[0,e.length],this.score=n+(t.length==this.pattern.length?0:-100),this)}}const hd=Qr.define({combine:t=>Po(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:dd,filterStrict:!1,compareCompletions:(t,e)=>t.label.localeCompare(e.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(t,e)=>t&&e,closeOnBlur:(t,e)=>t&&e,icons:(t,e)=>t&&e,tooltipClass:(t,e)=>n=>ud(t(n),e(n)),optionClass:(t,e)=>n=>ud(t(n),e(n)),addToOptions:(t,e)=>t.concat(e),filterStrict:(t,e)=>t||e})});function ud(t,e){return t?e?t+" "+e:t:e}function dd(t,e,n,i,r,o){let s,a,l=t.textDirection==ga.RTL,c=l,h=!1,u="top",d=e.left-r.left,p=r.right-e.right,f=i.right-i.left,g=i.bottom-i.top;if(c&&d<Math.min(f,p)?c=!1:!c&&p<Math.min(f,d)&&(c=!0),f<=(c?d:p))s=Math.max(r.top,Math.min(n.top,r.bottom-g))-e.top,a=Math.min(400,c?d:p);else{h=!0,a=Math.min(400,(l?e.right:r.right-e.left)-30);let t=r.bottom-e.bottom;t>=g||t>e.top?s=n.bottom-e.top:(u="bottom",s=e.bottom-n.top)}return{style:`${u}: ${s/((e.bottom-e.top)/o.offsetHeight)}px; max-width: ${a/((e.right-e.left)/o.offsetWidth)}px`,class:"cm-completionInfo-"+(h?l?"left-narrow":"right-narrow":c?"left":"right")}}function pd(t,e,n){if(t<=n)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let t=Math.floor(e/n);return{from:t*n,to:(t+1)*n}}let i=Math.floor((t-e)/n);return{from:t-(i+1)*n,to:t-i*n}}class fd{constructor(t,e,n){this.view=t,this.stateField=e,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:t=>this.placeInfo(t),key:this},this.space=null,this.currentClass="";let i=t.state.field(e),{options:r,selected:o}=i.open,s=t.state.facet(hd);this.optionContent=function(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(t){let e=document.createElement("div");return e.classList.add("cm-completionIcon"),t.type&&e.classList.add(...t.type.split(/\s+/g).map(t=>"cm-completionIcon-"+t)),e.setAttribute("aria-hidden","true"),e},position:20}),e.push({render(t,e,n,i){let r=document.createElement("span");r.className="cm-completionLabel";let o=t.displayLabel||t.label,s=0;for(let t=0;t<i.length;){let e=i[t++],n=i[t++];e>s&&r.appendChild(document.createTextNode(o.slice(s,e)));let a=r.appendChild(document.createElement("span"));a.appendChild(document.createTextNode(o.slice(e,n))),a.className="cm-completionMatchedText",s=n}return s<o.length&&r.appendChild(document.createTextNode(o.slice(s))),r},position:50},{render(t){if(!t.detail)return null;let e=document.createElement("span");return e.className="cm-completionDetail",e.textContent=t.detail,e},position:80}),e.sort((t,e)=>t.position-e.position).map(t=>t.render)}(s),this.optionClass=s.optionClass,this.tooltipClass=s.tooltipClass,this.range=pd(r.length,o,s.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(t.state),this.dom.addEventListener("mousedown",n=>{let{options:i}=t.state.field(e).open;for(let e,r=n.target;r&&r!=this.dom;r=r.parentNode)if("LI"==r.nodeName&&(e=/-(\d+)$/.exec(r.id))&&+e[1]<i.length)return this.applyCompletion(t,i[+e[1]]),void n.preventDefault()}),this.dom.addEventListener("focusout",e=>{let n=t.state.field(this.stateField,!1);n&&n.tooltip&&t.state.facet(hd).closeOnBlur&&e.relatedTarget!=t.contentDOM&&t.dispatch({effects:ad.of(null)})}),this.showOptions(r,i.id)}mount(){this.updateSel()}showOptions(t,e){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t,e,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(t){var e;let n=t.state.field(this.stateField),i=t.startState.field(this.stateField);if(this.updateTooltipClass(t.state),n!=i){let{options:r,selected:o,disabled:s}=n.open;i.open&&i.open.options==r||(this.range=pd(r.length,o,t.state.facet(hd).maxRenderedOptions),this.showOptions(r,n.id)),this.updateSel(),s!=(null===(e=i.open)||void 0===e?void 0:e.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!s)}}updateTooltipClass(t){let e=this.tooltipClass(t);if(e!=this.currentClass){for(let t of this.currentClass.split(" "))t&&this.dom.classList.remove(t);for(let t of e.split(" "))t&&this.dom.classList.add(t);this.currentClass=e}}positioned(t){this.space=t,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let t=this.view.state.field(this.stateField),e=t.open;if((e.selected>-1&&e.selected<this.range.from||e.selected>=this.range.to)&&(this.range=pd(e.options.length,e.selected,this.view.state.facet(hd).maxRenderedOptions),this.showOptions(e.options,t.id)),this.updateSelectedOption(e.selected)){this.destroyInfo();let{completion:n}=e.options[e.selected],{info:i}=n;if(!i)return;let r="string"==typeof i?document.createTextNode(i):i(n);if(!r)return;"then"in r?r.then(e=>{e&&this.view.state.field(this.stateField,!1)==t&&this.addInfoPane(e,n)}).catch(t=>Qa(this.view.state,t,"completion info")):this.addInfoPane(r,n)}}addInfoPane(t,e){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",null!=t.nodeType)n.appendChild(t),this.infoDestroy=null;else{let{dom:e,destroy:i}=t;n.appendChild(e),this.infoDestroy=i||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(t){let e=null;for(let n=this.list.firstChild,i=this.range.from;n;n=n.nextSibling,i++)"LI"==n.nodeName&&n.id?i==t?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),e=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected"):i--;return e&&function(t,e){let n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),r=n.height/t.offsetHeight;i.top<n.top?t.scrollTop-=(n.top-i.top)/r:i.bottom>n.bottom&&(t.scrollTop+=(i.bottom-n.bottom)/r)}(this.list,e),e}measureInfo(){let t=this.dom.querySelector("[aria-selected]");if(!t||!this.info)return null;let e=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),i=t.getBoundingClientRect(),r=this.space;if(!r){let t=this.dom.ownerDocument.defaultView||window;r={left:0,top:0,right:t.innerWidth,bottom:t.innerHeight}}return i.top>Math.min(r.bottom,e.bottom)-10||i.bottom<Math.max(r.top,e.top)+10?null:this.view.state.facet(hd).positionInfo(this.view,e,i,n,r,this.dom)}placeInfo(t){this.info&&(t?(t.style&&(this.info.style.cssText=t.style),this.info.className="cm-tooltip cm-completionInfo "+(t.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(t,e,n){const i=document.createElement("ul");i.id=e,i.setAttribute("role","listbox"),i.setAttribute("aria-expanded","true"),i.setAttribute("aria-label",this.view.state.phrase("Completions"));let r=null;for(let o=n.from;o<n.to;o++){let{completion:s,match:a}=t[o],{section:l}=s;if(l){let t="string"==typeof l?l:l.name;t!=r&&(o>n.from||0==n.from)&&(r=t,"string"!=typeof l&&l.header?i.appendChild(l.header(l)):i.appendChild(document.createElement("completion-section")).textContent=t)}const c=i.appendChild(document.createElement("li"));c.id=e+"-"+o,c.setAttribute("role","option");let h=this.optionClass(s);h&&(c.className=h);for(let t of this.optionContent){let e=t(s,this.view.state,this.view,a);e&&c.appendChild(e)}}return n.from&&i.classList.add("cm-completionListIncompleteTop"),n.to<t.length&&i.classList.add("cm-completionListIncompleteBottom"),i}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function gd(t,e){return n=>new fd(n,t,e)}function md(t){return 100*(t.boost||0)+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}class vd{constructor(t,e,n,i,r,o){this.options=t,this.attrs=e,this.tooltip=n,this.timestamp=i,this.selected=r,this.disabled=o}setSelected(t,e){return t==this.selected||t>=this.options.length?this:new vd(this.options,xd(e,t),this.tooltip,this.timestamp,t,this.disabled)}static build(t,e,n,i,r){let o=function(t,e){let n=[],i=null,r=t=>{n.push(t);let{section:e}=t.completion;if(e){i||(i=[]);let t="string"==typeof e?e:e.name;i.some(e=>e.name==t)||i.push("string"==typeof e?{name:t}:e)}},o=e.facet(hd);for(let i of t)if(i.hasResult()){let t=i.result.getMatch;if(!1===i.result.filter)for(let e of i.result.options)r(new td(e,i.source,t?t(e):[],1e9-n.length));else{let n,s=e.sliceDoc(i.from,i.to),a=o.filterStrict?new cd(s):new ld(s);for(let e of i.result.options)if(n=a.match(e.label)){let o=e.displayLabel?t?t(e,n.matched):[]:n.matched;r(new td(e,i.source,o,n.score+(e.boost||0)))}}}if(i){let t=Object.create(null),e=0,r=(t,e)=>{var n,i;return(null!==(n=t.rank)&&void 0!==n?n:1e9)-(null!==(i=e.rank)&&void 0!==i?i:1e9)||(t.name<e.name?-1:1)};for(let n of i.sort(r))e-=1e5,t[n.name]=e;for(let e of n){let{section:n}=e.completion;n&&(e.score+=t["string"==typeof n?n:n.name])}}let s=[],a=null,l=o.compareCompletions;for(let t of n.sort((t,e)=>e.score-t.score||l(t.completion,e.completion))){let e=t.completion;!a||a.label!=e.label||a.detail!=e.detail||null!=a.type&&null!=e.type&&a.type!=e.type||a.apply!=e.apply||a.boost!=e.boost?s.push(t):md(t.completion)>md(a)&&(s[s.length-1]=t),a=t.completion}return s}(t,e);if(!o.length)return i&&t.some(t=>1==t.state)?new vd(i.options,i.attrs,i.tooltip,i.timestamp,i.selected,!0):null;let s=e.facet(hd).selectOnOpen?0:-1;if(i&&i.selected!=s&&-1!=i.selected){let t=i.options[i.selected].completion;for(let e=0;e<o.length;e++)if(o[e].completion==t){s=e;break}}return new vd(o,xd(n,s),{pos:t.reduce((t,e)=>e.hasResult()?Math.min(t,e.from):t,1e8),create:Td,above:r.aboveCursor},i?i.timestamp:Date.now(),s,!1)}map(t){return new vd(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:t.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class yd{constructor(t,e,n){this.active=t,this.id=e,this.open=n}static start(){return new yd(wd,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(t){let{state:e}=t,n=e.facet(hd),i=(n.override||e.languageDataAt("autocomplete",ed(e)).map(od)).map(e=>{let i=this.active.find(t=>t.source==e)||new Od(e,this.active.some(t=>0!=t.state)?1:0);return i.update(t,n)});i.length==this.active.length&&i.every((t,e)=>t==this.active[e])&&(i=this.active);let r=this.open;r&&t.docChanged&&(r=r.map(t.changes)),t.selection||i.some(e=>e.hasResult()&&t.changes.touchesRange(e.from,e.to))||!function(t,e){if(t==e)return!0;for(let n=0,i=0;;){for(;n<t.length&&!t[n].hasResult;)n++;for(;i<e.length&&!e[i].hasResult;)i++;let r=n==t.length,o=i==e.length;if(r||o)return r==o;if(t[n++].result!=e[i++].result)return!1}}(i,this.active)?r=vd.build(i,e,this.id,r,n):r&&r.disabled&&!i.some(t=>1==t.state)&&(r=null),!r&&i.every(t=>1!=t.state)&&i.some(t=>t.hasResult())&&(i=i.map(t=>t.hasResult()?new Od(t.source,0):t));for(let e of t.effects)e.is(Ed)&&(r=r&&r.setSelected(e.value,this.id));return i==this.active&&r==this.open?this:new yd(i,this.id,r)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:bd}}const bd={"aria-autocomplete":"list"};function xd(t,e){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(n["aria-activedescendant"]=t+"-"+e),n}const wd=[];function _d(t,e){if(t.isUserEvent("input.complete")){let n=t.annotation(id);if(n&&e.activateOnCompletion(n))return"input"}return t.isUserEvent("input.type")?"input":t.isUserEvent("delete.backward")?"delete":null}class Od{constructor(t,e,n=-1){this.source=t,this.state=e,this.explicitPos=n}hasResult(){return!1}update(t,e){let n=_d(t,e),i=this;n?i=i.handleUserEvent(t,n,e):t.docChanged?i=i.handleChange(t):t.selection&&0!=i.state&&(i=new Od(i.source,0));for(let e of t.effects)if(e.is(sd))i=new Od(i.source,1,e.value?ed(t.state):-1);else if(e.is(ad))i=new Od(i.source,0);else if(e.is(Sd))for(let t of e.value)t.source==i.source&&(i=t);return i}handleUserEvent(t,e,n){return"delete"!=e&&n.activateOnTyping?new Od(this.source,1):this.map(t.changes)}handleChange(t){return t.changes.touchesRange(ed(t.startState))?new Od(this.source,0):this.map(t.changes)}map(t){return t.empty||this.explicitPos<0?this:new Od(this.source,this.state,t.mapPos(this.explicitPos))}}class kd extends Od{constructor(t,e,n,i,r){super(t,2,e),this.result=n,this.from=i,this.to=r}hasResult(){return!0}handleUserEvent(t,e,n){var i;let r=this.result;r.map&&!t.changes.empty&&(r=r.map(r,t.changes));let o=t.changes.mapPos(this.from),s=t.changes.mapPos(this.to,1),a=ed(t.state);if((this.explicitPos<0?a<=o:a<this.from)||a>s||!r||"delete"==e&&ed(t.startState)==this.from)return new Od(this.source,"input"==e&&n.activateOnTyping?1:0);let l=this.explicitPos<0?-1:t.changes.mapPos(this.explicitPos);return function(t,e,n,i){if(!t)return!1;let r=e.sliceDoc(n,i);return"function"==typeof t?t(r,n,i,e):nd(t,!0).test(r)}(r.validFor,t.state,o,s)?new kd(this.source,l,r,o,s):r.update&&(r=r.update(r,o,s,new Zu(t.state,a,l>=0)))?new kd(this.source,l,r,r.from,null!==(i=r.to)&&void 0!==i?i:ed(t.state)):new Od(this.source,1,l)}handleChange(t){return t.changes.touchesRange(this.from,this.to)?new Od(this.source,0):this.map(t.changes)}map(t){return t.empty?this:(this.result.map?this.result.map(this.result,t):this.result)?new kd(this.source,this.explicitPos<0?-1:t.mapPos(this.explicitPos),this.result,t.mapPos(this.from),t.mapPos(this.to,1)):new Od(this.source,0)}}const Sd=yo.define({map:(t,e)=>t.map(t=>t.map(e))}),Ed=yo.define(),Cd=Kr.define({create:()=>yd.start(),update:(t,e)=>t.update(e),provide:t=>[dh.from(t,t=>t.tooltip),Qc.contentAttributes.from(t,t=>t.attrs)]});function Ad(t,e){const n=e.completion.apply||e.completion.label;let i=t.state.field(Cd).active.find(t=>t.source==e.source);return i instanceof kd&&("string"==typeof n?t.dispatch(Object.assign(Object.assign({},function(t,e,n,i){let{main:r}=t.selection,o=n-r.from,s=i-r.from;return Object.assign(Object.assign({},t.changeByRange(a=>a!=r&&n!=i&&t.sliceDoc(a.from+o,a.from+s)!=t.sliceDoc(n,i)?{range:a}:{changes:{from:a.from+o,to:i==r.from?a.to:a.from+s,insert:e},range:jr.cursor(a.from+o+e.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}(t.state,n,i.from,i.to)),{annotations:id.of(e.completion)})):n(t,e.completion,i.from,i.to),!0)}const Td=gd(Cd,Ad);function Pd(t,e="option"){return n=>{let i=n.state.field(Cd,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<n.state.facet(hd).interactionDelay)return!1;let r,o=1;"page"==e&&(r=yh(n,i.open.tooltip))&&(o=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1));let{length:s}=i.open.options,a=i.open.selected>-1?i.open.selected+o*(t?1:-1):t?0:s-1;return a<0?a="page"==e?0:s-1:a>=s&&(a="page"==e?s-1:0),n.dispatch({effects:Ed.of(a)}),!0}}class Md{constructor(t,e){this.active=t,this.context=e,this.time=Date.now(),this.updates=[],this.done=void 0}}const Nd=Ga.fromClass(class{constructor(t){this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of t.state.field(Cd).active)1==e.state&&this.startQuery(e)}update(t){let e=t.state.field(Cd),n=t.state.facet(hd);if(!t.selectionSet&&!t.docChanged&&t.startState.field(Cd)==e)return;let i=t.transactions.some(t=>(t.selection||t.docChanged)&&!_d(t,n));for(let e=0;e<this.running.length;e++){let n=this.running[e];if(i||n.updates.length+t.transactions.length>50&&Date.now()-n.time>1e3){for(let t of n.context.abortListeners)try{t()}catch(t){Qa(this.view.state,t)}n.context.abortListeners=null,this.running.splice(e--,1)}else n.updates.push(...t.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),t.transactions.some(t=>t.effects.some(t=>t.is(sd)))&&(this.pendingStart=!0);let r=this.pendingStart?50:n.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(t=>1==t.state&&!this.running.some(e=>e.active.source==t.source))?setTimeout(()=>this.startUpdate(),r):-1,0!=this.composing)for(let e of t.transactions)"input"==_d(e,n)?this.composing=2:2==this.composing&&e.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:t}=this.view,e=t.field(Cd);for(let t of e.active)1!=t.state||this.running.some(e=>e.active.source==t.source)||this.startQuery(t)}startQuery(t){let{state:e}=this.view,n=ed(e),i=new Zu(e,n,t.explicitPos==n),r=new Md(t,i);this.running.push(r),Promise.resolve(t.source(i)).then(t=>{r.context.aborted||(r.done=t||null,this.scheduleAccept())},t=>{this.view.dispatch({effects:ad.of(null)}),Qa(this.view.state,t)})}scheduleAccept(){this.running.every(t=>void 0!==t.done)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(hd).updateSyncTime))}accept(){var t;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],n=this.view.state.facet(hd);for(let i=0;i<this.running.length;i++){let r=this.running[i];if(void 0===r.done)continue;if(this.running.splice(i--,1),r.done){let i=new kd(r.active.source,r.active.explicitPos,r.done,r.done.from,null!==(t=r.done.to)&&void 0!==t?t:ed(r.updates.length?r.updates[0].startState:this.view.state));for(let t of r.updates)i=i.update(t,n);if(i.hasResult()){e.push(i);continue}}let o=this.view.state.field(Cd).active.find(t=>t.source==r.active.source);if(o&&1==o.state)if(null==r.done){let t=new Od(r.active.source,0);for(let e of r.updates)t=t.update(e,n);1!=t.state&&e.push(t)}else this.startQuery(o)}e.length&&this.view.dispatch({effects:Sd.of(e)})}},{eventHandlers:{blur(t){let e=this.view.state.field(Cd,!1);if(e&&e.tooltip&&this.view.state.facet(hd).closeOnBlur){let n=e.open&&yh(this.view,e.open.tooltip);n&&n.dom.contains(t.relatedTarget)||setTimeout(()=>this.view.dispatch({effects:ad.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout(()=>this.view.dispatch({effects:sd.of(!1)}),20),this.composing=0}}}),Rd="object"==typeof navigator&&/Win/.test(navigator.platform),Dd=to.highest(Qc.domEventHandlers({keydown(t,e){let n=e.state.field(Cd,!1);if(!n||!n.open||n.open.disabled||n.open.selected<0||t.key.length>1||t.ctrlKey&&(!Rd||!t.altKey)||t.metaKey)return!1;let i=n.open.options[n.open.selected],r=n.active.find(t=>t.source==i.source),o=i.completion.commitCharacters||r.result.commitCharacters;return o&&o.indexOf(t.key)>-1&&Ad(e,i),!1}})),Bd=Qc.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class $d{constructor(t,e,n,i){this.field=t,this.line=e,this.from=n,this.to=i}}class Ld{constructor(t,e,n){this.field=t,this.from=e,this.to=n}map(t){let e=t.mapPos(this.from,-1,Nr.TrackDel),n=t.mapPos(this.to,1,Nr.TrackDel);return null==e||null==n?null:new Ld(this.field,e,n)}}class Id{constructor(t,e){this.lines=t,this.fieldPositions=e}instantiate(t,e){let n=[],i=[e],r=t.doc.lineAt(e),o=/^\s*/.exec(r.text)[0];for(let r of this.lines){if(n.length){let n=o,s=/^\t*/.exec(r)[0].length;for(let e=0;e<s;e++)n+=t.facet(su);i.push(e+n.length-s),r=n+r.slice(s)}n.push(r),e+=r.length+1}let s=this.fieldPositions.map(t=>new Ld(t.field,i[t.line]+t.from,i[t.line]+t.to));return{text:n,ranges:s}}static parse(t){let e,n=[],i=[],r=[];for(let o of t.split(/\r\n?|\n/)){for(;e=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(o);){let t=e[1]?+e[1]:null,s=e[2]||e[3]||"",a=-1;for(let e=0;e<n.length;e++)(null!=t?n[e].seq==t:s&&n[e].name==s)&&(a=e);if(a<0){let e=0;for(;e<n.length&&(null==t||null!=n[e].seq&&n[e].seq<t);)e++;n.splice(e,0,{seq:t,name:s}),a=e;for(let t of r)t.field>=a&&t.field++}r.push(new $d(a,i.length,e.index,e.index+s.length)),o=o.slice(0,e.index)+s+o.slice(e.index+e[0].length)}for(let t;t=/\\([{}])/.exec(o);){o=o.slice(0,t.index)+t[1]+o.slice(t.index+t[0].length);for(let e of r)e.line==i.length&&e.from>t.index&&(e.from--,e.to--)}i.push(o)}return new Id(i,r)}}let qd=sa.widget({widget:new class extends ra{toDOM(){let t=document.createElement("span");return t.className="cm-snippetFieldPosition",t}ignoreEvent(){return!1}}}),Fd=sa.mark({class:"cm-snippetField"});class Vd{constructor(t,e){this.ranges=t,this.active=e,this.deco=sa.set(t.map(t=>(t.from==t.to?qd:Fd).range(t.from,t.to)))}map(t){let e=[];for(let n of this.ranges){let i=n.map(t);if(!i)return null;e.push(i)}return new Vd(e,this.active)}selectionInsideField(t){return t.ranges.every(t=>this.ranges.some(e=>e.field==this.active&&e.from<=t.from&&e.to>=t.to))}}const jd=yo.define({map:(t,e)=>t&&t.map(e)}),Hd=yo.define(),zd=Kr.define({create:()=>null,update(t,e){for(let n of e.effects){if(n.is(jd))return n.value;if(n.is(Hd)&&t)return new Vd(t.ranges,n.value)}return t&&e.docChanged&&(t=t.map(e.changes)),t&&e.selection&&!t.selectionInsideField(e.selection)&&(t=null),t},provide:t=>Qc.decorations.from(t,t=>t?t.deco:sa.none)});function Qd(t,e){return jr.create(t.filter(t=>t.field==e).map(t=>jr.range(t.from,t.to)))}function Wd(t){let e=Id.parse(t);return(t,n,i,r)=>{let{text:o,ranges:s}=e.instantiate(t.state,i),a={changes:{from:i,to:r,insert:hr.of(o)},scrollIntoView:!0,annotations:n?[id.of(n),bo.userEvent.of("input.complete")]:void 0};if(s.length&&(a.selection=Qd(s,0)),s.some(t=>t.field>0)){let e=new Vd(s,0),n=a.effects=[jd.of(e)];void 0===t.state.field(zd,!1)&&n.push(yo.appendConfig.of([zd,Yd,Kd,Bd]))}t.dispatch(t.state.update(a))}}function Xd(t){return({state:e,dispatch:n})=>{let i=e.field(zd,!1);if(!i||t<0&&0==i.active)return!1;let r=i.active+t,o=t>0&&!i.ranges.some(e=>e.field==r+t);return n(e.update({selection:Qd(i.ranges,r),effects:jd.of(o?null:new Vd(i.ranges,r)),scrollIntoView:!0})),!0}}const Ud=[{key:"Tab",run:Xd(1),shift:Xd(-1)},{key:"Escape",run:({state:t,dispatch:e})=>!!t.field(zd,!1)&&(e(t.update({effects:jd.of(null)})),!0)}],Gd=Qr.define({combine:t=>t.length?t[0]:Ud}),Yd=to.highest(Jc.compute([Gd],t=>t.facet(Gd)));function Zd(t,e){return Object.assign(Object.assign({},e),{apply:Wd(t)})}const Kd=Qc.domEventHandlers({mousedown(t,e){let n,i=e.state.field(zd,!1);if(!i||null==(n=e.posAtCoords({x:t.clientX,y:t.clientY})))return!1;let r=i.ranges.find(t=>t.from<=n&&t.to>=n);return!(!r||r.field==i.active||(e.dispatch({selection:Qd(i.ranges,r.field),effects:jd.of(i.ranges.some(t=>t.field>r.field)?new Vd(i.ranges,r.field):null),scrollIntoView:!0}),0))}}),Jd={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},tp=yo.define({map(t,e){let n=e.mapPos(t,-1,Nr.TrackAfter);return null==n?void 0:n}}),ep=new class extends Mo{};ep.startSide=1,ep.endSide=-1;const np=Kr.define({create:()=>Bo.empty,update(t,e){if(t=t.map(e.changes),e.selection){let n=e.state.doc.lineAt(e.selection.main.head);t=t.update({filter:t=>t>=n.from&&t<=n.to})}for(let n of e.effects)n.is(tp)&&(t=t.update({add:[ep.range(n.value,n.value+1)]}));return t}});function ip(){return[ap,np]}const rp="()[]{}<>";function op(t){for(let e=0;e<8;e+=2)if(rp.charCodeAt(e)==t)return rp.charAt(e+1);return Tr(t<128?t:t+1)}const sp="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),ap=Qc.inputHandler.of((t,e,n,i)=>{if((sp?t.composing:t.compositionStarted)||t.state.readOnly)return!1;let r=t.state.selection.main;if(i.length>2||2==i.length&&1==Pr(Ar(i,0))||e!=r.from||n!=r.to)return!1;let o=function(t,e){let n=function(t,e){return t.languageDataAt("closeBrackets",e)[0]||Jd}(t,t.selection.main.head),i=n.brackets||Jd.brackets;for(let r of i){let o=op(Ar(r,0));if(e==r)return o==r?dp(t,r,i.indexOf(r+r+r)>-1,n):hp(t,r,o,n.before||Jd.before);if(e==o&&lp(t,t.selection.main.from))return up(t,0,o)}return null}(t.state,i);return!!o&&(t.dispatch(o),!0)});function lp(t,e){let n=!1;return t.field(np).between(0,t.doc.length,t=>{t==e&&(n=!0)}),n}function cp(t,e){let n=t.sliceString(e,e+2);return n.slice(0,Pr(Ar(n,0)))}function hp(t,e,n,i){let r=null,o=t.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:n,from:o.to}],effects:tp.of(o.to+e.length),range:jr.range(o.anchor+e.length,o.head+e.length)};let s=cp(t.doc,o.head);return!s||/\s/.test(s)||i.indexOf(s)>-1?{changes:{insert:e+n,from:o.head},effects:tp.of(o.head+e.length),range:jr.cursor(o.head+e.length)}:{range:r=o}});return r?null:t.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function up(t,e,n){let i=null,r=t.changeByRange(e=>e.empty&&cp(t.doc,e.head)==n?{changes:{from:e.head,to:e.head+n.length,insert:n},range:jr.cursor(e.head+n.length)}:i={range:e});return i?null:t.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function dp(t,e,n,i){let r=i.stringPrefixes||Jd.stringPrefixes,o=null,s=t.changeByRange(i=>{if(!i.empty)return{changes:[{insert:e,from:i.from},{insert:e,from:i.to}],effects:tp.of(i.to+e.length),range:jr.range(i.anchor+e.length,i.head+e.length)};let s,a=i.head,l=cp(t.doc,a);if(l==e){if(pp(t,a))return{changes:{insert:e+e,from:a},effects:tp.of(a+e.length),range:jr.cursor(a+e.length)};if(lp(t,a)){let i=n&&t.sliceDoc(a,a+3*e.length)==e+e+e?e+e+e:e;return{changes:{from:a,to:a+i.length,insert:i},range:jr.cursor(a+i.length)}}}else{if(n&&t.sliceDoc(a-2*e.length,a)==e+e&&(s=fp(t,a-2*e.length,r))>-1&&pp(t,s))return{changes:{insert:e+e+e+e,from:a},effects:tp.of(a+e.length),range:jr.cursor(a+e.length)};if(t.charCategorizer(a)(l)!=Eo.Word&&fp(t,a,r)>-1&&!function(t,e,n,i){let r=Uh(t).resolveInner(e,-1),o=i.reduce((t,e)=>Math.max(t,e.length),0);for(let s=0;s<5;s++){let s=t.sliceDoc(r.from,Math.min(r.to,r.from+n.length+o)),a=s.indexOf(n);if(!a||a>-1&&i.indexOf(s.slice(0,a))>-1){let e=r.firstChild;for(;e&&e.from==r.from&&e.to-e.from>n.length+a;){if(t.sliceDoc(e.to-n.length,e.to)==n)return!1;e=e.firstChild}return!0}let l=r.to==e&&r.parent;if(!l)break;r=l}return!1}(t,a,e,r))return{changes:{insert:e+e,from:a},effects:tp.of(a+e.length),range:jr.cursor(a+e.length)}}return{range:o=i}});return o?null:t.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function pp(t,e){let n=Uh(t).resolveInner(e+1);return n.parent&&n.from==e}function fp(t,e,n){let i=t.charCategorizer(e);if(i(t.sliceDoc(e-1,e))!=Eo.Word)return e;for(let r of n){let n=e-r.length;if(t.sliceDoc(n,e)==r&&i(t.sliceDoc(n-1,n))!=Eo.Word)return n}return-1}function gp(t={}){return[Dd,Cd,hd.of(t),Nd,vp,Bd]}const mp=[{key:"Ctrl-Space",run:t=>!!t.state.field(Cd,!1)&&(t.dispatch({effects:sd.of(!0)}),!0)},{key:"Escape",run:t=>{let e=t.state.field(Cd,!1);return!(!e||!e.active.some(t=>0!=t.state)||(t.dispatch({effects:ad.of(null)}),0))}},{key:"ArrowDown",run:Pd(!0)},{key:"ArrowUp",run:Pd(!1)},{key:"PageDown",run:Pd(!0,"page")},{key:"PageUp",run:Pd(!1,"page")},{key:"Enter",run:t=>{let e=t.state.field(Cd,!1);return!(t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(hd).interactionDelay)&&Ad(t,e.open.options[e.open.selected])}}],vp=to.highest(Jc.computeN([hd],t=>t.facet(hd).defaultKeymap?[mp]:[]));function yp(t,e){return({state:n,dispatch:i})=>{if(n.readOnly)return!1;let r=t(e,n);return!!r&&(i(n.update(r)),!0)}}const bp=yp(kp,0),xp=yp(Op,0),wp=yp((t,e)=>Op(t,e,function(t){let e=[];for(let n of t.selection.ranges){let i=t.doc.lineAt(n.from),r=n.to<=i.to?i:t.doc.lineAt(n.to),o=e.length-1;o>=0&&e[o].to>i.from?e[o].to=r.to:e.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:r.to})}return e}(e)),0);function _p(t,e){let n=t.languageDataAt("commentTokens",e);return n.length?n[0]:{}}function Op(t,e,n=e.selection.ranges){let i=n.map(t=>_p(e,t.from).block);if(!i.every(t=>t))return null;let r=n.map((t,n)=>function(t,{open:e,close:n},i,r){let o,s,a=t.sliceDoc(i-50,i),l=t.sliceDoc(r,r+50),c=/\s*$/.exec(a)[0].length,h=/^\s*/.exec(l)[0].length,u=a.length-c;if(a.slice(u-e.length,u)==e&&l.slice(h,h+n.length)==n)return{open:{pos:i-c,margin:c&&1},close:{pos:r+h,margin:h&&1}};r-i<=100?o=s=t.sliceDoc(i,r):(o=t.sliceDoc(i,i+50),s=t.sliceDoc(r-50,r));let d=/^\s*/.exec(o)[0].length,p=/\s*$/.exec(s)[0].length,f=s.length-p-n.length;return o.slice(d,d+e.length)==e&&s.slice(f,f+n.length)==n?{open:{pos:i+d+e.length,margin:/\s/.test(o.charAt(d+e.length))?1:0},close:{pos:r-p-n.length,margin:/\s/.test(s.charAt(f-1))?1:0}}:null}(e,i[n],t.from,t.to));if(2!=t&&!r.every(t=>t))return{changes:e.changes(n.map((t,e)=>r[e]?[]:[{from:t.from,insert:i[e].open+" "},{from:t.to,insert:" "+i[e].close}]))};if(1!=t&&r.some(t=>t)){let t=[];for(let e,n=0;n<r.length;n++)if(e=r[n]){let r=i[n],{open:o,close:s}=e;t.push({from:o.pos-r.open.length,to:o.pos+o.margin},{from:s.pos-s.margin,to:s.pos+r.close.length})}return{changes:t}}return null}function kp(t,e,n=e.selection.ranges){let i=[],r=-1;for(let{from:t,to:o}of n){let n=i.length,s=1e9,a=_p(e,t).line;if(a){for(let n=t;n<=o;){let l=e.doc.lineAt(n);if(l.from>r&&(t==o||o>l.from)){r=l.from;let t=/^\s*/.exec(l.text)[0].length,e=t==l.length,n=l.text.slice(t,t+a.length)==a?t:-1;t<l.text.length&&t<s&&(s=t),i.push({line:l,comment:n,token:a,indent:t,empty:e,single:!1})}n=l.to+1}if(s<1e9)for(let t=n;t<i.length;t++)i[t].indent<i[t].line.text.length&&(i[t].indent=s);i.length==n+1&&(i[n].single=!0)}}if(2!=t&&i.some(t=>t.comment<0&&(!t.empty||t.single))){let t=[];for(let{line:e,token:n,indent:r,empty:o,single:s}of i)!s&&o||t.push({from:e.from+r,insert:n+" "});let n=e.changes(t);return{changes:n,selection:e.selection.map(n,1)}}if(1!=t&&i.some(t=>t.comment>=0)){let t=[];for(let{line:e,comment:n,token:r}of i)if(n>=0){let i=e.from+n,o=i+r.length;" "==e.text[o-e.from]&&o++,t.push({from:i,to:o})}return{changes:t}}return null}function Sp(t,e){return jr.create(t.ranges.map(e),t.mainIndex)}function Ep(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Cp({state:t,dispatch:e},n){let i=Sp(t.selection,n);return!i.eq(t.selection,!0)&&(e(Ep(t,i)),!0)}function Ap(t,e){return jr.cursor(e?t.to:t.from)}function Tp(t,e){return Cp(t,n=>n.empty?t.moveByChar(n,e):Ap(n,e))}function Pp(t){return t.textDirectionAt(t.state.selection.main.head)==ga.LTR}const Mp=t=>Tp(t,!Pp(t)),Np=t=>Tp(t,Pp(t));function Rp(t,e){return Cp(t,n=>n.empty?t.moveByGroup(n,e):Ap(n,e))}function Dp(t,e,n){if(e.type.prop(n))return!0;let i=e.to-e.from;return i&&(i>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function Bp(t,e,n){let i,r,o=Uh(t).resolveInner(e.head),s=n?ke.closedBy:ke.openedBy;for(let i=e.head;;){let e=n?o.childAfter(i):o.childBefore(i);if(!e)break;Dp(t,e,s)?o=e:i=n?e.to:e.from}return r=o.type.prop(s)&&(i=n?ju(t,o.from,1):ju(t,o.to,-1))&&i.matched?n?i.end.to:i.end.from:n?o.to:o.from,jr.cursor(r,n?-1:1)}function $p(t,e){return Cp(t,n=>{if(!n.empty)return Ap(n,e);let i=t.moveVertically(n,e);return i.head!=n.head?i:t.moveToLineBoundary(n,e)})}const Lp=t=>$p(t,!1),Ip=t=>$p(t,!0);function qp(t){let e,n=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,i=0,r=0;if(n){for(let e of t.state.facet(Qc.scrollMargins)){let n=e(t);(null==n?void 0:n.top)&&(i=Math.max(null==n?void 0:n.top,i)),(null==n?void 0:n.bottom)&&(r=Math.max(null==n?void 0:n.bottom,r))}e=t.scrollDOM.clientHeight-i-r}else e=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:i,marginBottom:r,selfScroll:n,height:Math.max(t.defaultLineHeight,e-5)}}function Fp(t,e){let n,i=qp(t),{state:r}=t,o=Sp(r.selection,n=>n.empty?t.moveVertically(n,e,i.height):Ap(n,e));if(o.eq(r.selection))return!1;if(i.selfScroll){let e=t.coordsAtPos(r.selection.main.head),s=t.scrollDOM.getBoundingClientRect(),a=s.top+i.marginTop,l=s.bottom-i.marginBottom;e&&e.top>a&&e.bottom<l&&(n=Qc.scrollIntoView(o.main.head,{y:"start",yMargin:e.top-a}))}return t.dispatch(Ep(r,o),{effects:n}),!0}const Vp=t=>Fp(t,!1),jp=t=>Fp(t,!0);function Hp(t,e,n){let i=t.lineBlockAt(e.head),r=t.moveToLineBoundary(e,n);if(r.head==e.head&&r.head!=(n?i.to:i.from)&&(r=t.moveToLineBoundary(e,n,!1)),!n&&r.head==i.from&&i.length){let n=/^\s*/.exec(t.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;n&&e.head!=i.from+n&&(r=jr.cursor(i.from+n))}return r}function zp(t,e){let n=Sp(t.state.selection,t=>{let n=e(t);return jr.range(t.anchor,n.head,n.goalColumn,n.bidiLevel||void 0)});return!n.eq(t.state.selection)&&(t.dispatch(Ep(t.state,n)),!0)}function Qp(t,e){return zp(t,n=>t.moveByChar(n,e))}const Wp=t=>Qp(t,!Pp(t)),Xp=t=>Qp(t,Pp(t));function Up(t,e){return zp(t,n=>t.moveByGroup(n,e))}function Gp(t,e){return zp(t,n=>t.moveVertically(n,e))}const Yp=t=>Gp(t,!1),Zp=t=>Gp(t,!0);function Kp(t,e){return zp(t,n=>t.moveVertically(n,e,qp(t).height))}const Jp=t=>Kp(t,!1),tf=t=>Kp(t,!0),ef=({state:t,dispatch:e})=>(e(Ep(t,{anchor:0})),!0),nf=({state:t,dispatch:e})=>(e(Ep(t,{anchor:t.doc.length})),!0),rf=({state:t,dispatch:e})=>(e(Ep(t,{anchor:t.selection.main.anchor,head:0})),!0),of=({state:t,dispatch:e})=>(e(Ep(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0);function sf(t,e){if(t.state.readOnly)return!1;let n="delete.selection",{state:i}=t,r=i.changeByRange(i=>{let{from:r,to:o}=i;if(r==o){let s=e(i);s<r?(n="delete.backward",s=af(t,s,!1)):s>r&&(n="delete.forward",s=af(t,s,!0)),r=Math.min(r,s),o=Math.max(o,s)}else r=af(t,r,!1),o=af(t,o,!0);return r==o?{range:i}:{changes:{from:r,to:o},range:jr.cursor(r,r<i.head?-1:1)}});return!r.changes.empty&&(t.dispatch(i.update(r,{scrollIntoView:!0,userEvent:n,effects:"delete.selection"==n?Qc.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function af(t,e,n){if(t instanceof Qc)for(let i of t.state.facet(Qc.atomicRanges).map(e=>e(t)))i.between(e,e,(t,i)=>{t<e&&i>e&&(e=n?i:t)});return e}const lf=(t,e)=>sf(t,n=>{let i,r,o=n.from,{state:s}=t,a=s.doc.lineAt(o);if(!e&&o>a.from&&o<a.from+200&&!/[^ \t]/.test(i=a.text.slice(0,o-a.from))){if("\t"==i[i.length-1])return o-1;let t=Xo(i,s.tabSize)%au(s)||au(s);for(let e=0;e<t&&" "==i[i.length-1-e];e++)o--;r=o}else r=Or(a.text,o-a.from,e,e)+a.from,r==o&&a.number!=(e?s.doc.lines:1)?r+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(a.text.slice(r-a.from,o-a.from))&&(r=Or(a.text,r-a.from,!1,!1)+a.from);return r}),cf=t=>lf(t,!1),hf=t=>lf(t,!0),uf=(t,e)=>sf(t,n=>{let i=n.head,{state:r}=t,o=r.doc.lineAt(i),s=r.charCategorizer(i);for(let t=null;;){if(i==(e?o.to:o.from)){i==n.head&&o.number!=(e?r.doc.lines:1)&&(i+=e?1:-1);break}let a=Or(o.text,i-o.from,e)+o.from,l=o.text.slice(Math.min(i,a)-o.from,Math.max(i,a)-o.from),c=s(l);if(null!=t&&c!=t)break;" "==l&&i==n.head||(t=c),i=a}return i}),df=t=>uf(t,!1);function pf(t){let e=[],n=-1;for(let i of t.selection.ranges){let r=t.doc.lineAt(i.from),o=t.doc.lineAt(i.to);if(i.empty||i.to!=o.from||(o=t.doc.lineAt(i.to-1)),n>=r.number){let t=e[e.length-1];t.to=o.to,t.ranges.push(i)}else e.push({from:r.from,to:o.to,ranges:[i]});n=o.number+1}return e}function ff(t,e,n){if(t.readOnly)return!1;let i=[],r=[];for(let e of pf(t)){if(n?e.to==t.doc.length:0==e.from)continue;let o=t.doc.lineAt(n?e.to+1:e.from-1),s=o.length+1;if(n){i.push({from:e.to,to:o.to},{from:e.from,insert:o.text+t.lineBreak});for(let n of e.ranges)r.push(jr.range(Math.min(t.doc.length,n.anchor+s),Math.min(t.doc.length,n.head+s)))}else{i.push({from:o.from,to:e.from},{from:e.to,insert:t.lineBreak+o.text});for(let t of e.ranges)r.push(jr.range(t.anchor-s,t.head-s))}}return!!i.length&&(e(t.update({changes:i,scrollIntoView:!0,selection:jr.create(r,t.selection.mainIndex),userEvent:"move.line"})),!0)}function gf(t,e,n){if(t.readOnly)return!1;let i=[];for(let e of pf(t))n?i.push({from:e.from,insert:t.doc.slice(e.from,e.to)+t.lineBreak}):i.push({from:e.to,insert:t.lineBreak+t.doc.slice(e.from,e.to)});return e(t.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const mf=yf(!1),vf=yf(!0);function yf(t){return({state:e,dispatch:n})=>{if(e.readOnly)return!1;let i=e.changeByRange(n=>{let{from:i,to:r}=n,o=e.doc.lineAt(i),s=!t&&i==r&&function(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let n,i=Uh(t).resolveInner(e),r=i.childBefore(e),o=i.childAfter(e);return r&&o&&r.to<=e&&o.from>=e&&(n=r.type.prop(ke.closedBy))&&n.indexOf(o.name)>-1&&t.doc.lineAt(r.to).from==t.doc.lineAt(o.from).from&&!/\S/.test(t.sliceDoc(r.to,o.from))?{from:r.to,to:o.from}:null}(e,i);t&&(i=r=(r<=o.to?o:e.doc.lineAt(r)).to);let a=new hu(e,{simulateBreak:i,simulateDoubleBreak:!!s}),l=cu(a,i);for(null==l&&(l=Xo(/^\s*/.exec(e.doc.lineAt(i).text)[0],e.tabSize));r<o.to&&/\s/.test(o.text[r-o.from]);)r++;s?({from:i,to:r}=s):i>o.from&&i<o.from+100&&!/\S/.test(o.text.slice(0,i))&&(i=o.from);let c=["",lu(e,l)];return s&&c.push(lu(e,a.lineIndent(o.from,-1))),{changes:{from:i,to:r,insert:hr.of(c)},range:jr.cursor(i+1+c[1].length)}});return n(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function bf(t,e){let n=-1;return t.changeByRange(i=>{let r=[];for(let o=i.from;o<=i.to;){let s=t.doc.lineAt(o);s.number>n&&(i.empty||i.to>s.from)&&(e(s,r,i),n=s.number),o=s.to+1}let o=t.changes(r);return{changes:r,range:jr.range(o.mapPos(i.anchor,1),o.mapPos(i.head,1))}})}const xf=[{key:"Ctrl-b",run:Mp,shift:Wp,preventDefault:!0},{key:"Ctrl-f",run:Np,shift:Xp},{key:"Ctrl-p",run:Lp,shift:Yp},{key:"Ctrl-n",run:Ip,shift:Zp},{key:"Ctrl-a",run:t=>Cp(t,e=>jr.cursor(t.lineBlockAt(e.head).from,1)),shift:t=>zp(t,e=>jr.cursor(t.lineBlockAt(e.head).from))},{key:"Ctrl-e",run:t=>Cp(t,e=>jr.cursor(t.lineBlockAt(e.head).to,-1)),shift:t=>zp(t,e=>jr.cursor(t.lineBlockAt(e.head).to))},{key:"Ctrl-d",run:hf},{key:"Ctrl-h",run:cf},{key:"Ctrl-k",run:t=>sf(t,e=>{let n=t.lineBlockAt(e.head).to;return e.head<n?n:Math.min(t.state.doc.length,e.head+1)})},{key:"Ctrl-Alt-h",run:df},{key:"Ctrl-o",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:hr.of(["",""])},range:jr.cursor(t.from)}));return e(t.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(e=>{if(!e.empty||0==e.from||e.from==t.doc.length)return{range:e};let n=e.from,i=t.doc.lineAt(n),r=n==i.from?n-1:Or(i.text,n-i.from,!1)+i.from,o=n==i.to?n+1:Or(i.text,n-i.from,!0)+i.from;return{changes:{from:r,to:o,insert:t.doc.slice(n,o).append(t.doc.slice(r,n))},range:jr.cursor(o)}});return!n.changes.empty&&(e(t.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:jp}],wf=[{key:"ArrowLeft",run:Mp,shift:Wp,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:t=>Rp(t,!Pp(t)),shift:t=>Up(t,!Pp(t)),preventDefault:!0},{mac:"Cmd-ArrowLeft",run:t=>Cp(t,e=>Hp(t,e,!Pp(t))),shift:t=>zp(t,e=>Hp(t,e,!Pp(t))),preventDefault:!0},{key:"ArrowRight",run:Np,shift:Xp,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:t=>Rp(t,Pp(t)),shift:t=>Up(t,Pp(t)),preventDefault:!0},{mac:"Cmd-ArrowRight",run:t=>Cp(t,e=>Hp(t,e,Pp(t))),shift:t=>zp(t,e=>Hp(t,e,Pp(t))),preventDefault:!0},{key:"ArrowUp",run:Lp,shift:Yp,preventDefault:!0},{mac:"Cmd-ArrowUp",run:ef,shift:rf},{mac:"Ctrl-ArrowUp",run:Vp,shift:Jp},{key:"ArrowDown",run:Ip,shift:Zp,preventDefault:!0},{mac:"Cmd-ArrowDown",run:nf,shift:of},{mac:"Ctrl-ArrowDown",run:jp,shift:tf},{key:"PageUp",run:Vp,shift:Jp},{key:"PageDown",run:jp,shift:tf},{key:"Home",run:t=>Cp(t,e=>Hp(t,e,!1)),shift:t=>zp(t,e=>Hp(t,e,!1)),preventDefault:!0},{key:"Mod-Home",run:ef,shift:rf},{key:"End",run:t=>Cp(t,e=>Hp(t,e,!0)),shift:t=>zp(t,e=>Hp(t,e,!0)),preventDefault:!0},{key:"Mod-End",run:nf,shift:of},{key:"Enter",run:mf},{key:"Mod-a",run:({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:cf,shift:cf},{key:"Delete",run:hf},{key:"Mod-Backspace",mac:"Alt-Backspace",run:df},{key:"Mod-Delete",mac:"Alt-Delete",run:t=>uf(t,!0)},{mac:"Mod-Backspace",run:t=>sf(t,e=>{let n=t.moveToLineBoundary(e,!1).head;return e.head>n?n:Math.max(0,e.head-1)})},{mac:"Mod-Delete",run:t=>sf(t,e=>{let n=t.moveToLineBoundary(e,!0).head;return e.head<n?n:Math.min(t.state.doc.length,e.head+1)})}].concat(xf.map(t=>({mac:t.key,run:t.run,shift:t.shift}))),_f=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:t=>Cp(t,e=>Bp(t.state,e,!Pp(t))),shift:t=>zp(t,e=>Bp(t.state,e,!Pp(t)))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:t=>Cp(t,e=>Bp(t.state,e,Pp(t))),shift:t=>zp(t,e=>Bp(t.state,e,Pp(t)))},{key:"Alt-ArrowUp",run:({state:t,dispatch:e})=>ff(t,e,!1)},{key:"Shift-Alt-ArrowUp",run:({state:t,dispatch:e})=>gf(t,e,!1)},{key:"Alt-ArrowDown",run:({state:t,dispatch:e})=>ff(t,e,!0)},{key:"Shift-Alt-ArrowDown",run:({state:t,dispatch:e})=>gf(t,e,!0)},{key:"Escape",run:({state:t,dispatch:e})=>{let n=t.selection,i=null;return n.ranges.length>1?i=jr.create([n.main]):n.main.empty||(i=jr.create([jr.cursor(n.main.head)])),!!i&&(e(Ep(t,i)),!0)}},{key:"Mod-Enter",run:vf},{key:"Alt-l",mac:"Ctrl-l",run:({state:t,dispatch:e})=>{let n=pf(t).map(({from:e,to:n})=>jr.range(e,Math.min(n+1,t.doc.length)));return e(t.update({selection:jr.create(n),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:t,dispatch:e})=>{let n=Sp(t.selection,e=>{var n;for(let i=Uh(t).resolveStack(e.from,1);i;i=i.next){let{node:t}=i;if((t.from<e.from&&t.to>=e.to||t.to>e.to&&t.from<=e.from)&&(null===(n=t.parent)||void 0===n?void 0:n.parent))return jr.range(t.to,t.from)}return e});return e(Ep(t,n)),!0},preventDefault:!0},{key:"Mod-[",run:({state:t,dispatch:e})=>!t.readOnly&&(e(t.update(bf(t,(e,n)=>{let i=/^\s*/.exec(e.text)[0];if(!i)return;let r=Xo(i,t.tabSize),o=0,s=lu(t,Math.max(0,r-au(t)));for(;o<i.length&&o<s.length&&i.charCodeAt(o)==s.charCodeAt(o);)o++;n.push({from:e.from+o,to:e.from+i.length,insert:s.slice(o)})}),{userEvent:"delete.dedent"})),!0)},{key:"Mod-]",run:({state:t,dispatch:e})=>!t.readOnly&&(e(t.update(bf(t,(e,n)=>{n.push({from:e.from,insert:t.facet(su)})}),{userEvent:"input.indent"})),!0)},{key:"Mod-Alt-\\",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=Object.create(null),i=new hu(t,{overrideIndentation:t=>{let e=n[t];return null==e?-1:e}}),r=bf(t,(e,r,o)=>{let s=cu(i,e.from);if(null==s)return;/\S/.test(e.text)||(s=0);let a=/^\s*/.exec(e.text)[0],l=lu(t,s);(a!=l||o.from<e.from+a.length)&&(n[e.from]=s,r.push({from:e.from,to:e.from+a.length,insert:l}))});return r.changes.empty||e(t.update(r,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:t=>{if(t.state.readOnly)return!1;let{state:e}=t,n=e.changes(pf(e).map(({from:t,to:n})=>(t>0?t--:n<e.doc.length&&n++,{from:t,to:n}))),i=Sp(e.selection,e=>t.moveVertically(e,!0)).map(n);return t.dispatch({changes:n,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:({state:t,dispatch:e})=>function(t,e){let n=!1,i=Sp(t.selection,e=>{let i=ju(t,e.head,-1)||ju(t,e.head,1)||e.head>0&&ju(t,e.head-1,1)||e.head<t.doc.length&&ju(t,e.head+1,-1);if(!i||!i.end)return e;n=!0;let r=i.start.from==e.head?i.end.to:i.end.from;return jr.cursor(r)});return!!n&&(e(Ep(t,i)),!0)}(t,e)},{key:"Mod-/",run:t=>{let{state:e}=t,n=e.doc.lineAt(e.selection.main.from),i=_p(t.state,n.from);return i.line?bp(t):!!i.block&&wp(t)}},{key:"Alt-A",run:xp}].concat(wf);function Of(){var t=arguments[0];"string"==typeof t&&(t=document.createElement(t));var e=1,n=arguments[1];if(n&&"object"==typeof n&&null==n.nodeType&&!Array.isArray(n)){for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){var r=n[i];"string"==typeof r?t.setAttribute(i,r):null!=r&&(t[i]=r)}e++}for(;e<arguments.length;e++)kf(t,arguments[e]);return t}function kf(t,e){if("string"==typeof e)t.appendChild(document.createTextNode(e));else if(null==e);else if(null!=e.nodeType)t.appendChild(e);else{if(!Array.isArray(e))throw new RangeError("Unsupported child node: "+e);for(var n=0;n<e.length;n++)kf(t,e[n])}}class Sf{constructor(t,e,n){this.from=t,this.to=e,this.diagnostic=n}}class Ef{constructor(t,e,n){this.diagnostics=t,this.panel=e,this.selected=n}static init(t,e,n){let i=t,r=n.facet(If).markerFilter;r&&(i=r(i));let o=sa.set(i.map(t=>t.from==t.to||t.from==t.to-1&&n.doc.lineAt(t.from).to==t.from?sa.widget({widget:new jf(t),diagnostic:t}).range(t.from):sa.mark({attributes:{class:"cm-lintRange cm-lintRange-"+t.severity+(t.markClass?" "+t.markClass:"")},diagnostic:t}).range(t.from,t.to)),!0);return new Ef(o,e,Cf(o))}}function Cf(t,e=null,n=0){let i=null;return t.between(n,1e9,(t,n,{spec:r})=>{if(!e||r.diagnostic==e)return i=new Sf(t,n,r.diagnostic),!1}),i}function Af(t,e){return t.field(Nf,!1)?e:e.concat(yo.appendConfig.of(Xf))}const Tf=yo.define(),Pf=yo.define(),Mf=yo.define(),Nf=Kr.define({create:()=>new Ef(sa.none,null,null),update(t,e){if(e.docChanged){let n=t.diagnostics.map(e.changes),i=null;if(t.selected){let r=e.changes.mapPos(t.selected.from,1);i=Cf(n,t.selected.diagnostic,r)||Cf(n,null,r)}t=new Ef(n,t.panel,i)}for(let n of e.effects)n.is(Tf)?t=Ef.init(n.value,t.panel,e.state):n.is(Pf)?t=new Ef(t.diagnostics,n.value?zf.open:null,t.selected):n.is(Mf)&&(t=new Ef(t.diagnostics,t.panel,n.value));return t},provide:t=>[kh.from(t,t=>t.panel),Qc.decorations.from(t,t=>t.diagnostics)]}),Rf=sa.mark({class:"cm-lintRange cm-lintRange-active"});function Df(t,e,n){let{diagnostics:i}=t.state.field(Nf),r=[],o=2e8,s=0;i.between(e-(n<0?1:0),e+(n>0?1:0),(t,i,{spec:a})=>{e>=t&&e<=i&&(t==i||(e>t||n>0)&&(e<i||n<0))&&(r.push(a.diagnostic),o=Math.min(t,o),s=Math.max(i,s))});let a=t.state.facet(If).tooltipFilter;return a&&(r=a(r)),r.length?{pos:o,end:s,above:t.state.doc.lineAt(o).to<s,create:()=>({dom:Bf(t,r)})}:null}function Bf(t,e){return Of("ul",{class:"cm-tooltip-lint"},e.map(e=>Vf(t,e,!1)))}const $f=t=>{let e=t.state.field(Nf,!1);return!(!e||!e.panel||(t.dispatch({effects:Pf.of(!1)}),0))},Lf=Ga.fromClass(class{constructor(t){this.view=t,this.timeout=-1,this.set=!0;let{delay:e}=t.state.facet(If);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){let t=Date.now();if(t<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-t);else{this.set=!1;let{state:t}=this.view,{sources:e}=t.facet(If);Promise.all(e.map(t=>Promise.resolve(t(this.view)))).then(e=>{let n=e.reduce((t,e)=>t.concat(e));this.view.state.doc==t.doc&&this.view.dispatch(function(t,e){return{effects:Af(t,[Tf.of(e)])}}(this.view.state,n))},t=>{Qa(this.view.state,t)})}}update(t){let e=t.state.facet(If);(t.docChanged||e!=t.startState.facet(If)||e.needsRefresh&&e.needsRefresh(t))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),If=Qr.define({combine:t=>Object.assign({sources:t.map(t=>t.source)},Po(t.map(t=>t.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(t,e)=>t?e?n=>t(n)||e(n):t:e}))});function qf(t,e={}){return[If.of({source:t,config:e}),Lf,Xf]}function Ff(t){let e=[];if(t)t:for(let{name:n}of t){for(let t=0;t<n.length;t++){let i=n[t];if(/[a-zA-Z]/.test(i)&&!e.some(t=>t.toLowerCase()==i.toLowerCase())){e.push(i);continue t}}e.push("")}return e}function Vf(t,e,n){var i;let r=n?Ff(e.actions):[];return Of("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Of("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage():e.message),null===(i=e.actions)||void 0===i?void 0:i.map((n,i)=>{let o=!1,s=i=>{if(i.preventDefault(),o)return;o=!0;let r=Cf(t.state.field(Nf).diagnostics,e);r&&n.apply(t,r.from,r.to)},{name:a}=n,l=r[i]?a.indexOf(r[i]):-1,c=l<0?a:[a.slice(0,l),Of("u",a.slice(l,l+1)),a.slice(l+1)];return Of("button",{type:"button",class:"cm-diagnosticAction",onclick:s,onmousedown:s,"aria-label":` Action: ${a}${l<0?"":` (access key "${r[i]})"`}.`},c)}),e.source&&Of("div",{class:"cm-diagnosticSource"},e.source))}class jf extends ra{constructor(t){super(),this.diagnostic=t}eq(t){return t.diagnostic==this.diagnostic}toDOM(){return Of("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Hf{constructor(t,e){this.diagnostic=e,this.id="item_"+Math.floor(4294967295*Math.random()).toString(16),this.dom=Vf(t,e,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class zf{constructor(t){this.view=t,this.items=[],this.list=Of("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:e=>{if(27==e.keyCode)$f(this.view),this.view.focus();else if(38==e.keyCode||33==e.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==e.keyCode||34==e.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==e.keyCode)this.moveSelection(0);else if(35==e.keyCode)this.moveSelection(this.items.length-1);else if(13==e.keyCode)this.view.focus();else{if(!(e.keyCode>=65&&e.keyCode<=90&&this.selectedIndex>=0))return;{let{diagnostic:n}=this.items[this.selectedIndex],i=Ff(n.actions);for(let r=0;r<i.length;r++)if(i[r].toUpperCase().charCodeAt(0)==e.keyCode){let e=Cf(this.view.state.field(Nf).diagnostics,n);e&&n.actions[r].apply(t,e.from,e.to)}}}e.preventDefault()},onclick:t=>{for(let e=0;e<this.items.length;e++)this.items[e].dom.contains(t.target)&&this.moveSelection(e)}}),this.dom=Of("div",{class:"cm-panel-lint"},this.list,Of("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>$f(this.view)},"")),this.update()}get selectedIndex(){let t=this.view.state.field(Nf).selected;if(!t)return-1;for(let e=0;e<this.items.length;e++)if(this.items[e].diagnostic==t.diagnostic)return e;return-1}update(){let{diagnostics:t,selected:e}=this.view.state.field(Nf),n=0,i=!1,r=null;for(t.between(0,this.view.state.doc.length,(t,o,{spec:s})=>{let a,l=-1;for(let t=n;t<this.items.length;t++)if(this.items[t].diagnostic==s.diagnostic){l=t;break}l<0?(a=new Hf(this.view,s.diagnostic),this.items.splice(n,0,a),i=!0):(a=this.items[l],l>n&&(this.items.splice(n,l-n),i=!0)),e&&a.diagnostic==e.diagnostic?a.dom.hasAttribute("aria-selected")||(a.dom.setAttribute("aria-selected","true"),r=a):a.dom.hasAttribute("aria-selected")&&a.dom.removeAttribute("aria-selected"),n++});n<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)i=!0,this.items.pop();0==this.items.length&&(this.items.push(new Hf(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),i=!0),r?(this.list.setAttribute("aria-activedescendant",r.id),this.view.requestMeasure({key:this,read:()=>({sel:r.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:t,panel:e})=>{let n=e.height/this.list.offsetHeight;t.top<e.top?this.list.scrollTop-=(e.top-t.top)/n:t.bottom>e.bottom&&(this.list.scrollTop+=(t.bottom-e.bottom)/n)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),i&&this.sync()}sync(){let t=this.list.firstChild;function e(){let e=t;t=e.nextSibling,e.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;t!=n.dom;)e();t=n.dom.nextSibling}else this.list.insertBefore(n.dom,t);for(;t;)e()}moveSelection(t){if(this.selectedIndex<0)return;let e=Cf(this.view.state.field(Nf).diagnostics,this.items[t].diagnostic);e&&this.view.dispatch({selection:{anchor:e.from,head:e.to},scrollIntoView:!0,effects:Mf.of(e)})}static open(t){return new zf(t)}}function Qf(t){return function(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const Wf=Qc.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Qf("#d11")},".cm-lintRange-warning":{backgroundImage:Qf("orange")},".cm-lintRange-info":{backgroundImage:Qf("#999")},".cm-lintRange-hint":{backgroundImage:Qf("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),Xf=[Nf,Qc.decorations.compute([Nf],t=>{let{selected:e,panel:n}=t.field(Nf);return e&&n&&e.from!=e.to?sa.set([Rf.range(e.from,e.to)]):sa.none}),vh(Df,{hideOn:function(t,e){let n=t.startState.doc.lineAt(e.pos);return!(!t.effects.some(t=>t.is(Tf))&&!t.changes.touchesRange(n.from,n.to))}}),Wf];class Uf{static create(t,e,n,i,r){return new Uf(t,e,n,i+(i<<8)+t+(e<<4)|0,r,[],[])}constructor(t,e,n,i,r,o,s){this.type=t,this.value=e,this.from=n,this.hash=i,this.end=r,this.children=o,this.positions=s,this.hashProp=[[ke.contextHash,i]]}addChild(t,e){t.prop(ke.contextHash)!=this.hash&&(t=new Ne(t.type,t.children,t.positions,t.length,this.hashProp)),this.children.push(t),this.positions.push(e)}toTree(t,e=this.end){let n=this.children.length-1;return n>=0&&(e=Math.max(e,this.positions[n]+this.children[n].length+this.from)),new Ne(t.types[this.type],this.children,this.positions,e-this.from).balance({makeTree:(t,e,n)=>new Ne(Ce.none,t,e,n,this.hashProp)})}}var Gf;!function(t){t[t.Document=1]="Document",t[t.CodeBlock=2]="CodeBlock",t[t.FencedCode=3]="FencedCode",t[t.Blockquote=4]="Blockquote",t[t.HorizontalRule=5]="HorizontalRule",t[t.BulletList=6]="BulletList",t[t.OrderedList=7]="OrderedList",t[t.ListItem=8]="ListItem",t[t.ATXHeading1=9]="ATXHeading1",t[t.ATXHeading2=10]="ATXHeading2",t[t.ATXHeading3=11]="ATXHeading3",t[t.ATXHeading4=12]="ATXHeading4",t[t.ATXHeading5=13]="ATXHeading5",t[t.ATXHeading6=14]="ATXHeading6",t[t.SetextHeading1=15]="SetextHeading1",t[t.SetextHeading2=16]="SetextHeading2",t[t.HTMLBlock=17]="HTMLBlock",t[t.LinkReference=18]="LinkReference",t[t.Paragraph=19]="Paragraph",t[t.CommentBlock=20]="CommentBlock",t[t.ProcessingInstructionBlock=21]="ProcessingInstructionBlock",t[t.Escape=22]="Escape",t[t.Entity=23]="Entity",t[t.HardBreak=24]="HardBreak",t[t.Emphasis=25]="Emphasis",t[t.StrongEmphasis=26]="StrongEmphasis",t[t.Link=27]="Link",t[t.Image=28]="Image",t[t.InlineCode=29]="InlineCode",t[t.HTMLTag=30]="HTMLTag",t[t.Comment=31]="Comment",t[t.ProcessingInstruction=32]="ProcessingInstruction",t[t.Autolink=33]="Autolink",t[t.HeaderMark=34]="HeaderMark",t[t.QuoteMark=35]="QuoteMark",t[t.ListMark=36]="ListMark",t[t.LinkMark=37]="LinkMark",t[t.EmphasisMark=38]="EmphasisMark",t[t.CodeMark=39]="CodeMark",t[t.CodeText=40]="CodeText",t[t.CodeInfo=41]="CodeInfo",t[t.LinkTitle=42]="LinkTitle",t[t.LinkLabel=43]="LinkLabel",t[t.URL=44]="URL"}(Gf||(Gf={}));class Yf{constructor(t,e){this.start=t,this.content=e,this.marks=[],this.parsers=[]}}class Zf{constructor(){this.text="",this.baseIndent=0,this.basePos=0,this.depth=0,this.markers=[],this.pos=0,this.indent=0,this.next=-1}forward(){this.basePos>this.pos&&this.forwardInner()}forwardInner(){let t=this.skipSpace(this.basePos);this.indent=this.countIndent(t,this.pos,this.indent),this.pos=t,this.next=t==this.text.length?-1:this.text.charCodeAt(t)}skipSpace(t){return eg(this.text,t)}reset(t){for(this.text=t,this.baseIndent=this.basePos=this.pos=this.indent=0,this.forwardInner(),this.depth=1;this.markers.length;)this.markers.pop()}moveBase(t){this.basePos=t,this.baseIndent=this.countIndent(t,this.pos,this.indent)}moveBaseColumn(t){this.baseIndent=t,this.basePos=this.findColumn(t)}addMarker(t){this.markers.push(t)}countIndent(t,e=0,n=0){for(let i=e;i<t;i++)n+=9==this.text.charCodeAt(i)?4-n%4:1;return n}findColumn(t){let e=0;for(let n=0;e<this.text.length&&n<t;e++)n+=9==this.text.charCodeAt(e)?4-n%4:1;return e}scrub(){if(!this.baseIndent)return this.text;let t="";for(let e=0;e<this.basePos;e++)t+=" ";return t+this.text.slice(this.basePos)}}function Kf(t,e,n){if(n.pos==n.text.length||t!=e.block&&n.indent>=e.stack[n.depth+1].value+n.baseIndent)return!0;if(n.indent>=n.baseIndent+4)return!1;let i=(t.type==Gf.OrderedList?lg:ag)(n,e,!1);return i>0&&(t.type!=Gf.BulletList||og(n,e,!1)<0)&&n.text.charCodeAt(n.pos+i-1)==t.value}const Jf={[Gf.Blockquote]:(t,e,n)=>62==n.next&&(n.markers.push($g(Gf.QuoteMark,e.lineStart+n.pos,e.lineStart+n.pos+1)),n.moveBase(n.pos+(tg(n.text.charCodeAt(n.pos+1))?2:1)),t.end=e.lineStart+n.text.length,!0),[Gf.ListItem]:(t,e,n)=>!(n.indent<n.baseIndent+t.value&&n.next>-1||(n.moveBaseColumn(n.baseIndent+t.value),0)),[Gf.OrderedList]:Kf,[Gf.BulletList]:Kf,[Gf.Document]:()=>!0};function tg(t){return 32==t||9==t||10==t||13==t}function eg(t,e=0){for(;e<t.length&&tg(t.charCodeAt(e));)e++;return e}function ng(t,e,n){for(;e>n&&tg(t.charCodeAt(e-1));)e--;return e}function ig(t){if(96!=t.next&&126!=t.next)return-1;let e=t.pos+1;for(;e<t.text.length&&t.text.charCodeAt(e)==t.next;)e++;if(e<t.pos+3)return-1;if(96==t.next)for(let n=e;n<t.text.length;n++)if(96==t.text.charCodeAt(n))return-1;return e}function rg(t){return 62!=t.next?-1:32==t.text.charCodeAt(t.pos+1)?2:1}function og(t,e,n){if(42!=t.next&&45!=t.next&&95!=t.next)return-1;let i=1;for(let e=t.pos+1;e<t.text.length;e++){let n=t.text.charCodeAt(e);if(n==t.next)i++;else if(!tg(n))return-1}return n&&45==t.next&&hg(t)>-1&&t.depth==e.stack.length||i<3?-1:1}function sg(t,e){for(let n=t.stack.length-1;n>=0;n--)if(t.stack[n].type==e)return!0;return!1}function ag(t,e,n){return 45!=t.next&&43!=t.next&&42!=t.next||t.pos!=t.text.length-1&&!tg(t.text.charCodeAt(t.pos+1))||!(!n||sg(e,Gf.BulletList)||t.skipSpace(t.pos+2)<t.text.length)?-1:1}function lg(t,e,n){let i=t.pos,r=t.next;for(;r>=48&&r<=57;){if(i++,i==t.text.length)return-1;r=t.text.charCodeAt(i)}return i==t.pos||i>t.pos+9||46!=r&&41!=r||i<t.text.length-1&&!tg(t.text.charCodeAt(i+1))||n&&!sg(e,Gf.OrderedList)&&(t.skipSpace(i+1)==t.text.length||i>t.pos+1||49!=t.next)?-1:i+1-t.pos}function cg(t){if(35!=t.next)return-1;let e=t.pos+1;for(;e<t.text.length&&35==t.text.charCodeAt(e);)e++;if(e<t.text.length&&32!=t.text.charCodeAt(e))return-1;let n=e-t.pos;return n>6?-1:n}function hg(t){if(45!=t.next&&61!=t.next||t.indent>=t.baseIndent+4)return-1;let e=t.pos+1;for(;e<t.text.length&&t.text.charCodeAt(e)==t.next;)e++;let n=e;for(;e<t.text.length&&tg(t.text.charCodeAt(e));)e++;return e==t.text.length?n:-1}const ug=/^[ \t]*$/,dg=/-->/,pg=/\?>/,fg=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,dg],[/^\s*<\?/,pg],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,ug],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,ug]];function gg(t,e,n){if(60!=t.next)return-1;let i=t.text.slice(t.pos);for(let t=0,e=fg.length-(n?1:0);t<e;t++)if(fg[t][0].test(i))return t;return-1}function mg(t,e){let n=t.countIndent(e,t.pos,t.indent),i=t.countIndent(t.skipSpace(e),e,n);return i>=n+5?n+1:i}function vg(t,e,n){let i=t.length-1;i>=0&&t[i].to==e&&t[i].type==Gf.CodeText?t[i].to=n:t.push($g(Gf.CodeText,e,n))}const yg={LinkReference:void 0,IndentedCode(t,e){let n=e.baseIndent+4;if(e.indent<n)return!1;let i=e.findColumn(n),r=t.lineStart+i,o=t.lineStart+e.text.length,s=[],a=[];for(vg(s,r,o);t.nextLine()&&e.depth>=t.stack.length;)if(e.pos==e.text.length){vg(a,t.lineStart-1,t.lineStart);for(let t of e.markers)a.push(t)}else{if(e.indent<n)break;{if(a.length){for(let t of a)t.type==Gf.CodeText?vg(s,t.from,t.to):s.push(t);a=[]}vg(s,t.lineStart-1,t.lineStart);for(let t of e.markers)s.push(t);o=t.lineStart+e.text.length;let n=t.lineStart+e.findColumn(e.baseIndent+4);n<o&&vg(s,n,o)}}return a.length&&(a=a.filter(t=>t.type!=Gf.CodeText),a.length&&(e.markers=a.concat(e.markers))),t.addNode(t.buffer.writeElements(s,-r).finish(Gf.CodeBlock,o-r),r),!0},FencedCode(t,e){let n=ig(e);if(n<0)return!1;let i=t.lineStart+e.pos,r=e.next,o=n-e.pos,s=e.skipSpace(n),a=ng(e.text,e.text.length,s),l=[$g(Gf.CodeMark,i,i+o)];s<a&&l.push($g(Gf.CodeInfo,t.lineStart+s,t.lineStart+a));for(let n=!0;t.nextLine()&&e.depth>=t.stack.length;n=!1){let i=e.pos;if(e.indent-e.baseIndent<4)for(;i<e.text.length&&e.text.charCodeAt(i)==r;)i++;if(i-e.pos>=o&&e.skipSpace(i)==e.text.length){for(let t of e.markers)l.push(t);l.push($g(Gf.CodeMark,t.lineStart+e.pos,t.lineStart+i)),t.nextLine();break}{n||vg(l,t.lineStart-1,t.lineStart);for(let t of e.markers)l.push(t);let i=t.lineStart+e.basePos,r=t.lineStart+e.text.length;i<r&&vg(l,i,r)}}return t.addNode(t.buffer.writeElements(l,-i).finish(Gf.FencedCode,t.prevLineEnd()-i),i),!0},Blockquote(t,e){let n=rg(e);return!(n<0)&&(t.startContext(Gf.Blockquote,e.pos),t.addNode(Gf.QuoteMark,t.lineStart+e.pos,t.lineStart+e.pos+1),e.moveBase(e.pos+n),null)},HorizontalRule(t,e){if(og(e,t,!1)<0)return!1;let n=t.lineStart+e.pos;return t.nextLine(),t.addNode(Gf.HorizontalRule,n),!0},BulletList(t,e){let n=ag(e,t,!1);if(n<0)return!1;t.block.type!=Gf.BulletList&&t.startContext(Gf.BulletList,e.basePos,e.next);let i=mg(e,e.pos+1);return t.startContext(Gf.ListItem,e.basePos,i-e.baseIndent),t.addNode(Gf.ListMark,t.lineStart+e.pos,t.lineStart+e.pos+n),e.moveBaseColumn(i),null},OrderedList(t,e){let n=lg(e,t,!1);if(n<0)return!1;t.block.type!=Gf.OrderedList&&t.startContext(Gf.OrderedList,e.basePos,e.text.charCodeAt(e.pos+n-1));let i=mg(e,e.pos+n);return t.startContext(Gf.ListItem,e.basePos,i-e.baseIndent),t.addNode(Gf.ListMark,t.lineStart+e.pos,t.lineStart+e.pos+n),e.moveBaseColumn(i),null},ATXHeading(t,e){let n=cg(e);if(n<0)return!1;let i=e.pos,r=t.lineStart+i,o=ng(e.text,e.text.length,i),s=o;for(;s>i&&e.text.charCodeAt(s-1)==e.next;)s--;s!=o&&s!=i&&tg(e.text.charCodeAt(s-1))||(s=e.text.length);let a=t.buffer.write(Gf.HeaderMark,0,n).writeElements(t.parser.parseInline(e.text.slice(i+n+1,s),r+n+1),-r);s<e.text.length&&a.write(Gf.HeaderMark,s-i,o-i);let l=a.finish(Gf.ATXHeading1-1+n,e.text.length-i);return t.nextLine(),t.addNode(l,r),!0},HTMLBlock(t,e){let n=gg(e,0,!1);if(n<0)return!1;let i=t.lineStart+e.pos,r=fg[n][1],o=[],s=r!=ug;for(;!r.test(e.text)&&t.nextLine();){if(e.depth<t.stack.length){s=!1;break}for(let t of e.markers)o.push(t)}s&&t.nextLine();let a=r==dg?Gf.CommentBlock:r==pg?Gf.ProcessingInstructionBlock:Gf.HTMLBlock,l=t.prevLineEnd();return t.addNode(t.buffer.writeElements(o,-i).finish(a,l-i),i),!0},SetextHeading:void 0};class bg{constructor(t){this.stage=0,this.elts=[],this.pos=0,this.start=t.start,this.advance(t.content)}nextLine(t,e,n){if(-1==this.stage)return!1;let i=n.content+"\n"+e.scrub(),r=this.advance(i);return r>-1&&r<i.length&&this.complete(t,n,r)}finish(t,e){return(2==this.stage||3==this.stage)&&eg(e.content,this.pos)==e.content.length&&this.complete(t,e,e.content.length)}complete(t,e,n){return t.addLeafElement(e,$g(Gf.LinkReference,this.start,this.start+n,this.elts)),!0}nextStage(t){return t?(this.pos=t.to-this.start,this.elts.push(t),this.stage++,!0):(!1===t&&(this.stage=-1),!1)}advance(t){for(;;){if(-1==this.stage)return-1;if(0==this.stage){if(!this.nextStage(Xg(t,this.pos,this.start,!0)))return-1;if(58!=t.charCodeAt(this.pos))return this.stage=-1;this.elts.push($g(Gf.LinkMark,this.pos+this.start,this.pos+this.start+1)),this.pos++}else{if(1!=this.stage){if(2==this.stage){let e=eg(t,this.pos),n=0;if(e>this.pos){let i=Wg(t,e,this.start);if(i){let e=xg(t,i.to-this.start);e>0&&(this.nextStage(i),n=e)}}return n||(n=xg(t,this.pos)),n>0&&n<t.length?n:-1}return xg(t,this.pos)}if(!this.nextStage(Qg(t,eg(t,this.pos),this.start)))return-1}}}}function xg(t,e){for(;e<t.length;e++){let n=t.charCodeAt(e);if(10==n)break;if(!tg(n))return-1}return e}class wg{nextLine(t,e,n){let i=e.depth<t.stack.length?-1:hg(e),r=e.next;if(i<0)return!1;let o=$g(Gf.HeaderMark,t.lineStart+e.pos,t.lineStart+i);return t.nextLine(),t.addLeafElement(n,$g(61==r?Gf.SetextHeading1:Gf.SetextHeading2,n.start,t.prevLineEnd(),[...t.parser.parseInline(n.content,n.start),o])),!0}finish(){return!1}}const _g={LinkReference:(t,e)=>91==e.content.charCodeAt(0)?new bg(e):null,SetextHeading:()=>new wg},Og=[(t,e)=>cg(e)>=0,(t,e)=>ig(e)>=0,(t,e)=>rg(e)>=0,(t,e)=>ag(e,t,!0)>=0,(t,e)=>lg(e,t,!0)>=0,(t,e)=>og(e,t,!0)>=0,(t,e)=>gg(e,0,!0)>=0],kg={text:"",end:0};class Sg{constructor(t,e,n,i){this.parser=t,this.input=e,this.ranges=i,this.line=new Zf,this.atEnd=!1,this.reusePlaceholders=new Map,this.stoppedAt=null,this.rangeI=0,this.to=i[i.length-1].to,this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=i[0].from,this.block=Uf.create(Gf.Document,0,this.lineStart,0,0),this.stack=[this.block],this.fragments=n.length?new Zg(n,e):null,this.readLine()}get parsedPos(){return this.absoluteLineStart}advance(){if(null!=this.stoppedAt&&this.absoluteLineStart>this.stoppedAt)return this.finish();let{line:t}=this;for(;;){for(let e=0;;){let n=t.depth<this.stack.length?this.stack[this.stack.length-1]:null;for(;e<t.markers.length&&(!n||t.markers[e].from<n.end);){let n=t.markers[e++];this.addNode(n.type,n.from,n.to)}if(!n)break;this.finishContext()}if(t.pos<t.text.length)break;if(!this.nextLine())return this.finish()}if(this.fragments&&this.reuseFragment(t.basePos))return null;t:for(;;){for(let e of this.parser.blockParsers)if(e){let n=e(this,t);if(0!=n){if(1==n)return null;t.forward();continue t}}break}let e=new Yf(this.lineStart+t.pos,t.text.slice(t.pos));for(let t of this.parser.leafBlockParsers)if(t){let n=t(this,e);n&&e.parsers.push(n)}t:for(;this.nextLine()&&t.pos!=t.text.length;){if(t.indent<t.baseIndent+4)for(let n of this.parser.endLeafBlock)if(n(this,t,e))break t;for(let n of e.parsers)if(n.nextLine(this,t,e))return null;e.content+="\n"+t.scrub();for(let n of t.markers)e.marks.push(n)}return this.finishLeaf(e),null}stopAt(t){if(null!=this.stoppedAt&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}reuseFragment(t){if(!this.fragments.moveTo(this.absoluteLineStart+t,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return!1;let e=this.fragments.takeNodes(this);return!!e&&(this.absoluteLineStart+=e,this.lineStart=Kg(this.absoluteLineStart,this.ranges),this.moveRangeI(),this.absoluteLineStart<this.to?(this.lineStart++,this.absoluteLineStart++,this.readLine()):(this.atEnd=!0,this.readLine()),!0)}get depth(){return this.stack.length}parentType(t=this.depth-1){return this.parser.nodeSet.types[this.stack[t].type]}nextLine(){return this.lineStart+=this.line.text.length,this.absoluteLineEnd>=this.to?(this.absoluteLineStart=this.absoluteLineEnd,this.atEnd=!0,this.readLine(),!1):(this.lineStart++,this.absoluteLineStart=this.absoluteLineEnd+1,this.moveRangeI(),this.readLine(),!0)}moveRangeI(){for(;this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to;)this.rangeI++,this.absoluteLineStart=Math.max(this.absoluteLineStart,this.ranges[this.rangeI].from)}scanLine(t){let e=kg;if(e.end=t,t>=this.to)e.text="";else if(e.text=this.lineChunkAt(t),e.end+=e.text.length,this.ranges.length>1){let t=this.absoluteLineStart,n=this.rangeI;for(;this.ranges[n].to<e.end;){n++;let i=this.ranges[n].from,r=this.lineChunkAt(i);e.end=i+r.length,e.text=e.text.slice(0,this.ranges[n-1].to-t)+r,t=e.end-e.text.length}}return e}readLine(){let{line:t}=this,{text:e,end:n}=this.scanLine(this.absoluteLineStart);for(this.absoluteLineEnd=n,t.reset(e);t.depth<this.stack.length;t.depth++){let e=this.stack[t.depth],n=this.parser.skipContextMarkup[e.type];if(!n)throw new Error("Unhandled block context "+Gf[e.type]);if(!n(e,this,t))break;t.forward()}}lineChunkAt(t){let e,n=this.input.chunk(t);if(this.input.lineChunks)e="\n"==n?"":n;else{let t=n.indexOf("\n");e=t<0?n:n.slice(0,t)}return t+e.length>this.to?e.slice(0,this.to-t):e}prevLineEnd(){return this.atEnd?this.lineStart:this.lineStart-1}startContext(t,e,n=0){this.block=Uf.create(t,n,this.lineStart+e,this.block.hash,this.lineStart+this.line.text.length),this.stack.push(this.block)}startComposite(t,e,n=0){this.startContext(this.parser.getNodeType(t),e,n)}addNode(t,e,n){"number"==typeof t&&(t=new Ne(this.parser.nodeSet.types[t],Ng,Ng,(null!=n?n:this.prevLineEnd())-e)),this.block.addChild(t,e-this.block.from)}addElement(t){this.block.addChild(t.toTree(this.parser.nodeSet),t.from-this.block.from)}addLeafElement(t,e){this.addNode(this.buffer.writeElements(Gg(e.children,t.marks),-e.from).finish(e.type,e.to-e.from),e.from)}finishContext(){let t=this.stack.pop(),e=this.stack[this.stack.length-1];e.addChild(t.toTree(this.parser.nodeSet),t.from-e.from),this.block=e}finish(){for(;this.stack.length>1;)this.finishContext();return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart))}addGaps(t){return this.ranges.length>1?Eg(this.ranges,0,t.topNode,this.ranges[0].from,this.reusePlaceholders):t}finishLeaf(t){for(let e of t.parsers)if(e.finish(this,t))return;let e=Gg(this.parser.parseInline(t.content,t.start),t.marks);this.addNode(this.buffer.writeElements(e,-t.start).finish(Gf.Paragraph,t.content.length),t.start)}elt(t,e,n,i){return"string"==typeof t?$g(this.parser.getNodeType(t),e,n,i):new Bg(t,e)}get buffer(){return new Rg(this.parser.nodeSet)}}function Eg(t,e,n,i,r){let o=t[e].to,s=[],a=[],l=n.from+i;function c(n,r){for(;r?n>=o:n>o;){let r=t[e+1].from-o;i+=r,n+=r,e++,o=t[e].to}}for(let h=n.firstChild;h;h=h.nextSibling){c(h.from+i,!0);let n,u=h.from+i,d=r.get(h.tree);d?n=d:h.to+i>o?(n=Eg(t,e,h,i,r),c(h.to+i,!1)):n=h.toTree(),s.push(n),a.push(u-l)}return c(n.to+i,!1),new Ne(n.type,s,a,n.to+i-l,n.tree?n.tree.propValues:void 0)}class Cg extends Ze{constructor(t,e,n,i,r,o,s,a,l){super(),this.nodeSet=t,this.blockParsers=e,this.leafBlockParsers=n,this.blockNames=i,this.endLeafBlock=r,this.skipContextMarkup=o,this.inlineParsers=s,this.inlineNames=a,this.wrappers=l,this.nodeTypes=Object.create(null);for(let e of t.types)this.nodeTypes[e.name]=e.id}createParse(t,e,n){let i=new Sg(this,t,e,n);for(let r of this.wrappers)i=r(i,t,e,n);return i}configure(t){let e=Tg(t);if(!e)return this;let{nodeSet:n,skipContextMarkup:i}=this,r=this.blockParsers.slice(),o=this.leafBlockParsers.slice(),s=this.blockNames.slice(),a=this.inlineParsers.slice(),l=this.inlineNames.slice(),c=this.endLeafBlock.slice(),h=this.wrappers;if(Ag(e.defineNodes)){i=Object.assign({},i);let t,r=n.types.slice();for(let n of e.defineNodes){let{name:e,block:o,composite:s,style:a}="string"==typeof n?{name:n}:n;if(r.some(t=>t.name==e))continue;s&&(i[r.length]=(t,e,n)=>s(e,n,t.value));let l=r.length,c=s?["Block","BlockContext"]:o?l>=Gf.ATXHeading1&&l<=Gf.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"]:void 0;r.push(Ce.define({id:l,name:e,props:c&&[[ke.group,c]]})),a&&(t||(t={}),Array.isArray(a)||a instanceof qn?t[e]=a:Object.assign(t,a))}n=new Ae(r),t&&(n=n.extend(jn(t)))}if(Ag(e.props)&&(n=n.extend(...e.props)),Ag(e.remove))for(let t of e.remove){let e=this.blockNames.indexOf(t),n=this.inlineNames.indexOf(t);e>-1&&(r[e]=o[e]=void 0),n>-1&&(a[n]=void 0)}if(Ag(e.parseBlock))for(let t of e.parseBlock){let e=s.indexOf(t.name);if(e>-1)r[e]=t.parse,o[e]=t.leaf;else{let e=t.before?Pg(s,t.before):t.after?Pg(s,t.after)+1:s.length-1;r.splice(e,0,t.parse),o.splice(e,0,t.leaf),s.splice(e,0,t.name)}t.endLeaf&&c.push(t.endLeaf)}if(Ag(e.parseInline))for(let t of e.parseInline){let e=l.indexOf(t.name);if(e>-1)a[e]=t.parse;else{let e=t.before?Pg(l,t.before):t.after?Pg(l,t.after)+1:l.length-1;a.splice(e,0,t.parse),l.splice(e,0,t.name)}}return e.wrap&&(h=h.concat(e.wrap)),new Cg(n,r,o,s,c,i,a,l,h)}getNodeType(t){let e=this.nodeTypes[t];if(null==e)throw new RangeError(`Unknown node type '${t}'`);return e}parseInline(t,e){let n=new Ug(this,t,e);t:for(let t=e;t<n.end;){let e=n.char(t);for(let i of this.inlineParsers)if(i){let r=i(n,e,t);if(r>=0){t=r;continue t}}t++}return n.resolveMarkers(0)}}function Ag(t){return null!=t&&t.length>0}function Tg(t){if(!Array.isArray(t))return t;if(0==t.length)return null;let e=Tg(t[0]);if(1==t.length)return e;let n=Tg(t.slice(1));if(!n||!e)return e||n;let i=(t,e)=>(t||Ng).concat(e||Ng),r=e.wrap,o=n.wrap;return{props:i(e.props,n.props),defineNodes:i(e.defineNodes,n.defineNodes),parseBlock:i(e.parseBlock,n.parseBlock),parseInline:i(e.parseInline,n.parseInline),remove:i(e.remove,n.remove),wrap:r?o?(t,e,n,i)=>r(o(t,e,n,i),e,n,i):r:o}}function Pg(t,e){let n=t.indexOf(e);if(n<0)throw new RangeError(`Position specified relative to unknown parser ${e}`);return n}let Mg=[Ce.none];for(let t,e=1;t=Gf[e];e++)Mg[e]=Ce.define({id:e,name:t,props:e>=Gf.Escape?[]:[[ke.group,e in Jf?["Block","BlockContext"]:["Block","LeafBlock"]]],top:"Document"==t});const Ng=[];class Rg{constructor(t){this.nodeSet=t,this.content=[],this.nodes=[]}write(t,e,n,i=0){return this.content.push(t,e,n,4+4*i),this}writeElements(t,e=0){for(let n of t)n.writeTo(this,e);return this}finish(t,e){return Ne.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:t,length:e})}}let Dg=class{constructor(t,e,n,i=Ng){this.type=t,this.from=e,this.to=n,this.children=i}writeTo(t,e){let n=t.content.length;t.writeElements(this.children,e),t.content.push(this.type,this.from+e,this.to+e,t.content.length+4-n)}toTree(t){return new Rg(t).writeElements(this.children,-this.from).finish(this.type,this.to-this.from)}};class Bg{constructor(t,e){this.tree=t,this.from=e}get to(){return this.from+this.tree.length}get type(){return this.tree.type.id}get children(){return Ng}writeTo(t,e){t.nodes.push(this.tree),t.content.push(t.nodes.length-1,this.from+e,this.to+e,-1)}toTree(){return this.tree}}function $g(t,e,n,i){return new Dg(t,e,n,i)}const Lg={resolve:"Emphasis",mark:"EmphasisMark"},Ig={resolve:"Emphasis",mark:"EmphasisMark"},qg={},Fg={};class Vg{constructor(t,e,n,i){this.type=t,this.from=e,this.to=n,this.side=i}}let jg=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{jg=new RegExp("[\\p{Pc}|\\p{Pd}|\\p{Pe}|\\p{Pf}|\\p{Pi}|\\p{Po}|\\p{Ps}]","u")}catch(Et){}const Hg={Escape(t,e,n){if(92!=e||n==t.end-1)return-1;let i=t.char(n+1);for(let e=0;e<32;e++)if("!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~".charCodeAt(e)==i)return t.append($g(Gf.Escape,n,n+2));return-1},Entity(t,e,n){if(38!=e)return-1;let i=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(t.slice(n+1,n+31));return i?t.append($g(Gf.Entity,n,n+1+i[0].length)):-1},InlineCode(t,e,n){if(96!=e||n&&96==t.char(n-1))return-1;let i=n+1;for(;i<t.end&&96==t.char(i);)i++;let r=i-n,o=0;for(;i<t.end;i++)if(96==t.char(i)){if(o++,o==r&&96!=t.char(i+1))return t.append($g(Gf.InlineCode,n,i+1,[$g(Gf.CodeMark,n,n+r),$g(Gf.CodeMark,i+1-r,i+1)]))}else o=0;return-1},HTMLTag(t,e,n){if(60!=e||n==t.end-1)return-1;let i=t.slice(n+1,t.end),r=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(i);if(r)return t.append($g(Gf.Autolink,n,n+1+r[0].length,[$g(Gf.LinkMark,n,n+1),$g(Gf.URL,n+1,n+r[0].length),$g(Gf.LinkMark,n+r[0].length,n+1+r[0].length)]));let o=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(i);if(o)return t.append($g(Gf.Comment,n,n+1+o[0].length));let s=/^\?[^]*?\?>/.exec(i);if(s)return t.append($g(Gf.ProcessingInstruction,n,n+1+s[0].length));let a=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(i);return a?t.append($g(Gf.HTMLTag,n,n+1+a[0].length)):-1},Emphasis(t,e,n){if(95!=e&&42!=e)return-1;let i=n+1;for(;t.char(i)==e;)i++;let r=t.slice(n-1,n),o=t.slice(i,i+1),s=jg.test(r),a=jg.test(o),l=/\s|^$/.test(r),c=/\s|^$/.test(o),h=!c&&(!a||l||s),u=!l&&(!s||c||a),d=h&&(42==e||!u||s),p=u&&(42==e||!h||a);return t.append(new Vg(95==e?Lg:Ig,n,i,(d?1:0)|(p?2:0)))},HardBreak(t,e,n){if(92==e&&10==t.char(n+1))return t.append($g(Gf.HardBreak,n,n+2));if(32==e){let e=n+1;for(;32==t.char(e);)e++;if(10==t.char(e)&&e>=n+2)return t.append($g(Gf.HardBreak,n,e+1))}return-1},Link:(t,e,n)=>91==e?t.append(new Vg(qg,n,n+1,1)):-1,Image:(t,e,n)=>33==e&&91==t.char(n+1)?t.append(new Vg(Fg,n,n+2,1)):-1,LinkEnd(t,e,n){if(93!=e)return-1;for(let e=t.parts.length-1;e>=0;e--){let i=t.parts[e];if(i instanceof Vg&&(i.type==qg||i.type==Fg)){if(!i.side||t.skipSpace(i.to)==n&&!/[(\[]/.test(t.slice(n+1,n+2)))return t.parts[e]=null,-1;let r=t.takeContent(e),o=t.parts[e]=zg(t,r,i.type==qg?Gf.Link:Gf.Image,i.from,n+1);if(i.type==qg)for(let n=0;n<e;n++){let e=t.parts[n];e instanceof Vg&&e.type==qg&&(e.side=0)}return o.to}}return-1}};function zg(t,e,n,i,r){let{text:o}=t,s=t.char(r),a=r;if(e.unshift($g(Gf.LinkMark,i,i+(n==Gf.Image?2:1))),e.push($g(Gf.LinkMark,r-1,r)),40==s){let n,i=t.skipSpace(r+1),s=Qg(o,i-t.offset,t.offset);s&&(i=t.skipSpace(s.to),i!=s.to&&(n=Wg(o,i-t.offset,t.offset),n&&(i=t.skipSpace(n.to)))),41==t.char(i)&&(e.push($g(Gf.LinkMark,r,r+1)),a=i+1,s&&e.push(s),n&&e.push(n),e.push($g(Gf.LinkMark,i,a)))}else if(91==s){let n=Xg(o,r-t.offset,t.offset,!1);n&&(e.push(n),a=n.to)}return $g(n,i,a,e)}function Qg(t,e,n){if(60==t.charCodeAt(e)){for(let i=e+1;i<t.length;i++){let r=t.charCodeAt(i);if(62==r)return $g(Gf.URL,e+n,i+1+n);if(60==r||10==r)return!1}return null}{let i=0,r=e;for(let e=!1;r<t.length;r++){let n=t.charCodeAt(r);if(tg(n))break;if(e)e=!1;else if(40==n)i++;else if(41==n){if(!i)break;i--}else 92==n&&(e=!0)}return r>e?$g(Gf.URL,e+n,r+n):r==t.length&&null}}function Wg(t,e,n){let i=t.charCodeAt(e);if(39!=i&&34!=i&&40!=i)return!1;let r=40==i?41:i;for(let i=e+1,o=!1;i<t.length;i++){let s=t.charCodeAt(i);if(o)o=!1;else{if(s==r)return $g(Gf.LinkTitle,e+n,i+1+n);92==s&&(o=!0)}}return null}function Xg(t,e,n,i){for(let r=!1,o=e+1,s=Math.min(t.length,o+999);o<s;o++){let s=t.charCodeAt(o);if(r)r=!1;else{if(93==s)return!i&&$g(Gf.LinkLabel,e+n,o+1+n);if(i&&!tg(s)&&(i=!1),91==s)return!1;92==s&&(r=!0)}}return null}class Ug{constructor(t,e,n){this.parser=t,this.text=e,this.offset=n,this.parts=[]}char(t){return t>=this.end?-1:this.text.charCodeAt(t-this.offset)}get end(){return this.offset+this.text.length}slice(t,e){return this.text.slice(t-this.offset,e-this.offset)}append(t){return this.parts.push(t),t.to}addDelimiter(t,e,n,i,r){return this.append(new Vg(t,e,n,(i?1:0)|(r?2:0)))}get hasOpenLink(){for(let t=this.parts.length-1;t>=0;t--){let e=this.parts[t];if(e instanceof Vg&&(e.type==qg||e.type==Fg))return!0}return!1}addElement(t){return this.append(t)}resolveMarkers(t){for(let e=t;e<this.parts.length;e++){let n=this.parts[e];if(!(n instanceof Vg&&n.type.resolve&&2&n.side))continue;let i,r=n.type==Lg||n.type==Ig,o=n.to-n.from,s=e-1;for(;s>=t;s--){let t=this.parts[s];if(t instanceof Vg&&1&t.side&&t.type==n.type&&!(r&&(1&n.side||2&t.side)&&(t.to-t.from+o)%3==0&&((t.to-t.from)%3||o%3))){i=t;break}}if(!i)continue;let a=n.type.resolve,l=[],c=i.from,h=n.to;if(r){let t=Math.min(2,i.to-i.from,o);c=i.to-t,h=n.from+t,a=1==t?"Emphasis":"StrongEmphasis"}i.type.mark&&l.push(this.elt(i.type.mark,c,i.to));for(let t=s+1;t<e;t++)this.parts[t]instanceof Dg&&l.push(this.parts[t]),this.parts[t]=null;n.type.mark&&l.push(this.elt(n.type.mark,n.from,h));let u=this.elt(a,c,h,l);this.parts[s]=r&&i.from!=c?new Vg(i.type,i.from,c,i.side):null,(this.parts[e]=r&&n.to!=h?new Vg(n.type,h,n.to,n.side):null)?this.parts.splice(e,0,u):this.parts[e]=u}let e=[];for(let n=t;n<this.parts.length;n++){let t=this.parts[n];t instanceof Dg&&e.push(t)}return e}findOpeningDelimiter(t){for(let e=this.parts.length-1;e>=0;e--){let n=this.parts[e];if(n instanceof Vg&&n.type==t)return e}return null}takeContent(t){let e=this.resolveMarkers(t);return this.parts.length=t,e}skipSpace(t){return eg(this.text,t-this.offset)+this.offset}elt(t,e,n,i){return"string"==typeof t?$g(this.parser.getNodeType(t),e,n,i):new Bg(t,e)}}function Gg(t,e){if(!e.length)return t;if(!t.length)return e;let n=t.slice(),i=0;for(let t of e){for(;i<n.length&&n[i].to<t.to;)i++;if(i<n.length&&n[i].from<t.from){let e=n[i];e instanceof Dg&&(n[i]=new Dg(e.type,e.from,e.to,Gg(e.children,[t])))}else n.splice(i++,0,t)}return n}const Yg=[Gf.CodeBlock,Gf.ListItem,Gf.OrderedList,Gf.BulletList];class Zg{constructor(t,e){this.fragments=t,this.input=e,this.i=0,this.fragment=null,this.fragmentEnd=-1,this.cursor=null,t.length&&(this.fragment=t[this.i++])}nextFragment(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null,this.cursor=null,this.fragmentEnd=-1}moveTo(t,e){for(;this.fragment&&this.fragment.to<=t;)this.nextFragment();if(!this.fragment||this.fragment.from>(t?t-1:0))return!1;if(this.fragmentEnd<0){let t=this.fragment.to;for(;t>0&&"\n"!=this.input.read(t-1,t);)t--;this.fragmentEnd=t?t-1:0}let n=this.cursor;n||(n=this.cursor=this.fragment.tree.cursor(),n.firstChild());let i=t+this.fragment.offset;for(;n.to<=i;)if(!n.parent())return!1;for(;;){if(n.from>=i)return this.fragment.from<=e;if(!n.childAfter(i))return!1}}matches(t){let e=this.cursor.tree;return e&&e.prop(ke.contextHash)==t}takeNodes(t){let e=this.cursor,n=this.fragment.offset,i=this.fragmentEnd-(this.fragment.openEnd?1:0),r=t.absoluteLineStart,o=r,s=t.block.children.length,a=o,l=s;for(;;){if(e.to-n>i){if(e.type.isAnonymous&&e.firstChild())continue;break}let r=Kg(e.from-n,t.ranges);if(e.to-n<=t.ranges[t.rangeI].to)t.addNode(e.tree,r);else{let n=new Ne(t.parser.nodeSet.types[Gf.Paragraph],[],[],0,t.block.hashProp);t.reusePlaceholders.set(n,e.tree),t.addNode(n,r)}if(e.type.is("Block")&&(Yg.indexOf(e.type.id)<0?(o=e.to-n,s=t.block.children.length):(o=a,s=l,a=e.to-n,l=t.block.children.length)),!e.nextSibling())break}for(;t.block.children.length>s;)t.block.children.pop(),t.block.positions.pop();return o-r}}function Kg(t,e){let n=t;for(let i=1;i<e.length;i++){let r=e[i-1].to,o=e[i].from;r<t&&(n-=o-r)}return n}const Jg=jn({"Blockquote/...":ci.quote,HorizontalRule:ci.contentSeparator,"ATXHeading1/... SetextHeading1/...":ci.heading1,"ATXHeading2/... SetextHeading2/...":ci.heading2,"ATXHeading3/...":ci.heading3,"ATXHeading4/...":ci.heading4,"ATXHeading5/...":ci.heading5,"ATXHeading6/...":ci.heading6,"Comment CommentBlock":ci.comment,Escape:ci.escape,Entity:ci.character,"Emphasis/...":ci.emphasis,"StrongEmphasis/...":ci.strong,"Link/... Image/...":ci.link,"OrderedList/... BulletList/...":ci.list,"BlockQuote/...":ci.quote,"InlineCode CodeText":ci.monospace,"URL Autolink":ci.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":ci.processingInstruction,"CodeInfo LinkLabel":ci.labelName,LinkTitle:ci.string,Paragraph:ci.content}),tm=new Cg(new Ae(Mg).extend(Jg),Object.keys(yg).map(t=>yg[t]),Object.keys(yg).map(t=>_g[t]),Object.keys(yg),Og,Jf,Object.keys(Hg).map(t=>Hg[t]),Object.keys(Hg),[]);function em(t){const e=[];return t.iterate({enter:t=>{const n=t.node;if(!n.type.isError)return;const i=n.parent,r=nm(n),o={from:n.from,to:n.to,severity:"error",type:"Syntax Error"};if(n.from!==n.to)o.message=`Unrecognized token in <${i.name}>`;else if(r)o.message=`Unrecognized token <${r.name}> in <${i.name}>`,o.to=r.to;else{const t=i.enterUnfinishedNodesBefore(n.to);o.message=`Incomplete <${(t||i).name}>`}e.push(o)}}),e}function nm(t){return t?t.nextSibling||nm(t.parent):null}ci.special(ci.content),ci.processingInstruction,ci.special(ci.content),ci.processingInstruction;const im=()=>t=>0===t.state.doc.length?[]:function(t){return[...em(t)]}(Uh(t.state)).map(t=>({...t,source:t.type})),rm=Cu(Ou.define([{tag:ci.strong,fontWeight:"bold"},{tag:ci.emphasis,fontStyle:"italic"}]));var om=[Qc.theme({"& .cm-lintRange":{position:"relative"},"& .cm-lintRange::after":{content:'""',width:"100%",position:"absolute",left:"0px",bottom:"-2px",height:"3px",backgroundRepeat:"repeat-x"},"& .cm-lintRange.cm-lintRange-warning, & .cm-lintRange.cm-lintRange-error":{backgroundImage:"none"},"& .cm-lintPoint::after":{bottom:"-2px"}}),rm];const sm=t=>`%23${t.slice(1)}`,am={black:"#1f2b36",darkGrey:"#2f3d58",grey:"#404a5c",midGrey:"#576071",offWhite:"#d9e0f5",snowWhite:"#eaf1ff",white:"#ffffff",mossGreen:"#7ab6aa",iceBlue:"#6cbfd8",waterBlue:"#065aaa",brightBlue:"#0a56b9",deepBlue:"#355472",red:"#9f1c15",orangeBrown:"#b4502f",yellow:"#debd71",lila:"#9a4890",purple:"#5b2c83"},lm={lightBackground:am.white,darkBackground:am.snowWhite,selection:am.snowWhite,tooltipBackground:am.offWhite,error:am.red,warning:am.yellow,invalid:"#b40000"};var cm=[Qc.theme({"&":{color:am.black,backgroundColor:lm.lightBackground},".cm-content":{caretColor:am.darkGrey},".cm-cursor, .cm-dropCursor":{borderLeftColor:am.darkGrey},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:lm.selection},".cm-panels":{backgroundColor:lm.darkBackground,color:am.grey},".cm-panels.cm-panels-top":{borderBottom:`2px solid ${am.black}`},".cm-panels.cm-panels-bottom":{borderTop:`2px solid ${am.black}`},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:`1px solid ${am.midGrey}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:am.offWhite},".cm-activeLine":{backgroundColor:lm.selection},".cm-selectionMatch":{backgroundColor:am.offWhite},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${am.grey}`},"&.cm-focused .cm-matchingBracket":{backgroundColor:am.snowWhite},".cm-gutters":{backgroundColor:"#f3f7fe",color:"#52668d",border:"none",padding:"0 5px"},".cm-activeLineGutter":{backgroundColor:lm.selection},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:lm.tooltipBackground},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:lm.tooltipBackground,borderBottomColor:lm.tooltipBackground},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:lm.darkBackground,color:am.midGrey}},"& .cm-lintRange.cm-lintRange-warning::after":{backgroundImage:`url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='6' height='3'><path d='m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0' stroke='${sm(lm.warning)}' fill='none' stroke-width='1.2'/></svg>")`},"& .cm-lintRange.cm-lintRange-error::after":{backgroundImage:`url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='6' height='3'><path d='m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0' stroke='${sm(lm.error)}' fill='none' stroke-width='1.2'/></svg>")`},"& .cm-diagnostic-warning":{border:`1px solid ${lm.warning}`,borderLeft:`5px solid ${lm.warning}`,background:lm.lightBackground},"& .cm-diagnostic-error":{border:`1px solid ${lm.error}`,borderLeft:`5px solid ${lm.error}`,background:lm.lightBackground},"& .cm-diagnostic":{padding:"3px 8px"}},{dark:!1}),Cu(Ou.define([{tag:[ci.macroName,ci.variableName],color:am.waterBlue},{tag:[ci.special(ci.bracket)],color:am.waterBlue,fontWeight:"bold"},{tag:[ci.color,ci.name,ci.definition(ci.name),ci.constant(ci.name),ci.standard(ci.name),ci.propertyName],color:am.deepBlue},{tag:[ci.definition(ci.variableName),ci.function(ci.variableName),ci.function(ci.propertyName)],color:am.brightBlue},{tag:[ci.labelName],color:am.orangeBrown},{tag:[ci.annotation],color:lm.invalid},{tag:[ci.number,ci.changed,ci.annotation,ci.modifier,ci.self,ci.namespace,ci.atom,ci.bool,ci.special(ci.variableName)],color:am.red},{tag:[ci.typeName,ci.className,ci.attributeName],color:am.lila},{tag:[ci.operator,ci.operatorKeyword,ci.tagName,ci.keyword],color:am.purple},{tag:[ci.angleBracket,ci.squareBracket,ci.brace,ci.separator,ci.punctuation],color:am.midGrey},{tag:[ci.regexp],color:am.deepBlue},{tag:[ci.quote],color:am.darkGrey},{tag:[ci.string,ci.character,ci.deleted],color:am.orangeBrown},{tag:ci.link,color:am.mossGreen,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[ci.url,ci.escape,ci.special(ci.string)],color:am.red},{tag:[ci.meta],color:am.iceBlue},{tag:[ci.comment],color:am.midGrey,fontStyle:"italic"},{tag:ci.strong,fontWeight:"bold",color:am.deepBlue},{tag:ci.emphasis,fontStyle:"italic",color:am.deepBlue},{tag:ci.strikethrough,textDecoration:"line-through"},{tag:ci.heading,fontWeight:"bold",color:am.midGray},{tag:ci.special(ci.heading1),fontWeight:"bold",color:am.darkGrey},{tag:[ci.heading1,ci.heading2,ci.heading3,ci.heading4],fontWeight:"bold",color:am.midGrey},{tag:[ci.heading5,ci.heading6,ci.processingInstruction,ci.inserted],color:am.grey},{tag:[ci.contentSeparator],color:am.yellow},{tag:ci.invalid,color:am.midGrey,borderBottom:`1px dotted ${lm.invalid}`}]))];const hm="#f07178",um="#fffce1",dm="#ec9e6f",pm="rgba(0, 0, 0, 0.5)",fm="#353a42",gm="#ffcc00",mm="fff890";var vm=[Qc.theme({"&":{color:"#ffffff",backgroundColor:"#292d3e"},".cm-content":{caretColor:gm},"&.cm-focused .cm-cursor":{borderLeftColor:gm},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:"rgba(128, 203, 196, 0.2)"},".cm-panels":{backgroundColor:"#21252b",color:"#ffffff"},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:pm},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847",outline:"1px solid #515a6b"},".cm-gutters":{background:"#292d3e",color:"#676e95",border:"none",padding:"0 5px"},".cm-activeLineGutter":{backgroundColor:pm},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:fm},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:fm,borderBottomColor:fm},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:pm,color:"#abb2bf"}},"& .cm-lintRange.cm-lintRange-warning::after":{backgroundImage:`url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='6' height='3'><path d='m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0' stroke='${"%23"+mm}' fill='none' stroke-width='1.2'/></svg>")`},"& .cm-lintRange.cm-lintRange-error::after":{backgroundImage:"url(\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='6' height='3'><path d='m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0' stroke='red' fill='none' stroke-width='1.2'/></svg>\")"},"& .cm-diagnostic-warning":{borderLeft:`5px solid #${mm}`,background:"#281e16"},"& .cm-diagnostic-error":{borderLeft:"5px solid red",background:"#281616"},"& .cm-diagnostic":{borderRadius:"2px",padding:"3px 8px"}},{dark:!0}),Cu(Ou.define([{tag:ci.heading1,color:um},{tag:ci.heading2,color:um},{tag:ci.heading3,color:um},{tag:ci.heading4,color:um},{tag:ci.heading5,color:um},{tag:ci.heading6,color:um},{tag:ci.special(ci.bracket),color:dm,fontWeight:"bold"},{tag:ci.keyword,color:"#c792ea"},{tag:ci.operator,color:"#89ddff"},{tag:ci.special(ci.variableName),color:"#eeffff"},{tag:ci.typeName,color:"#f07178"},{tag:ci.atom,color:"#f78c6c"},{tag:ci.number,color:"#ff5370"},{tag:ci.bool,color:"#ff5370"},{tag:ci.definition(ci.variableName),color:"#82aaff"},{tag:ci.string,color:"#c3e88d"},{tag:ci.comment,color:"#7d8799"},{tag:ci.tagName,color:"#ff5370"},{tag:ci.bracket,color:"#a2a1a4"},{tag:ci.meta,color:"#ffcb6b"},{tag:ci.special(ci.string),color:hm},{tag:ci.propertyName,color:dm},{tag:ci.variableName,color:dm},{tag:ci.attributeName,color:hm},{tag:ci.className,color:hm},{tag:ci.invalid,color:"#ffffff"}]))];const ym=[...om,...cm],bm=[...om,...vm],xm=(t,e=0)=>{const n=125===t.peek(e),i=125===t.peek(e+1);return n&&i||-1===t.peek(e)},wm=new _n((t,e)=>{let n=0;for(;!xm(t,n);)n++;n>0&&(t.advance(n),t.acceptToken(2))}),_m=(t,e=0)=>{const n=123===t.peek(e),i=123===t.peek(e+1);return n&&i||-1===t.peek(e)},Om=new _n((t,e)=>{let n=0;for(;!_m(t,n);)n++;n>0&&(t.advance(n),t.acceptToken(3))}),km=new _n((t,e)=>{let n=0;for(;-1!==t.peek(n);)n++;n>0&&(t.advance(n),t.acceptToken(1))}),Sm=jn({ConditionalSpanner:ci.special(ci.bracket),ConditionalSpannerClose:ci.special(ci.bracket),ConditionalSpannerCloseNl:ci.special(ci.bracket),LoopSpanner:ci.special(ci.bracket),LoopSpannerClose:ci.special(ci.bracket),LoopSpannerCloseNl:ci.special(ci.bracket),EmptyInsert:ci.special(ci.bracket),Insert:ci.special(ci.bracket)}),Em=Bn.deserialize({version:14,states:"$bOQOaOOOfOXO'#CbOOO`'#Cm'#CmOqOWO'#CcOvOWO'#CfOOO`'#Cp'#CpOOO`'#Ci'#CiO{OaO'#ClO!jOSOOQOOOOOO!oOPO,58{O!tOXO,58|OOO`,58|,58|O!|OQO,58}O#ROQO,59QOOO`-E6g-E6gOOO`1G.g1G.gO#WOPO1G.gOOO`1G.h1G.hO#]OaO1G.iO#qOaO1G.lOOO`7+$R7+$RO$VOPO7+$TO$_OPO7+$WOOO`<<Go<<GoOOO`<<Gr<<Gr",stateData:"$g~ORUO_WObPOeROgSO^`P~OQYO_ZOc[O~OQ]O~OQ^O~ORUObPOeROgSO^`XW`XX`XZ`X[`X~OPXO~Oc`O~OQaOcbO~OfcO~OfdO~OceO~ORUObPOeROgSOW`PX`P~ORUObPOeROgSOZ`P[`P~OWhOXhO~OZiO[iO~O",goto:"!ZePPPPPfflPPlPPrPPz!TPP!TXQOVcdXTOVcdUVOcdR_VQXOQfcRgdXUOVcd",nodeNames:" Feel FeelBlock SimpleTextBlock Feelers Insert EmptyInsert ConditionalSpanner ConditionalSpannerClose ConditionalSpannerCloseNl LoopSpanner LoopSpannerClose LoopSpannerCloseNl",maxTerm:23,propSources:[Sm],skippedNodes:[0],repeatNodeCount:1,tokenData:"%X~RR!_!`[#o#pa#q#r$r~aO_~~dP#o#pg~lQb~str!P!Q!{~uQ#]#^{#`#a!^~!OP#Y#Z!R~!UPpq!X~!^Oe~~!aP#c#d!d~!gP#c#d!j~!mP#d#e!p~!sPpq!v~!{Og~~#OQ#]#^#U#`#a#u~#XP#Y#Z#[~#_P#q#r#b~#eP#q#r#h~#mPW~YZ#p~#uOX~~#xP#c#d#{~$OP#c#d$R~$UP#d#e$X~$[P#q#r$_~$bP#q#r$e~$jPZ~YZ$m~$rO[~R$uP#q#r$xR%PPcPfQYZ%SQ%XOfQ",tokenizers:[0,1,km,wm,Om],topRules:{Feelers:[0,4]},tokenPrec:0}),Cm={ConditionalSpanner:_u,LoopSpanner:_u};function Am(t){const e=[];return t.iterate({enter:t=>{"EmptyInsert"===t.type.name&&e.push({from:t.from,to:t.to,severity:"warning",message:"this insert is empty and will be ignored",type:"emptyInsert"})}}),e}var Tm=qf(function(){const t=im();return e=>{const n=t(e);return 0===e.state.doc.length?[]:[...n,...function(t){return[...Am(t)]}(Uh(e.state)).map(t=>({...t,source:"feelers linter"}))]}}());function Pm({container:t,tooltipContainer:e,hostLanguage:n,hostLanguageParser:i,onChange:r=()=>{},onKeyDown:o=()=>{},onLint:s=()=>{},contentAttributes:a={},readOnly:l=!1,value:c="",enableGutters:h=!1,singleLine:u=!1,darkMode:d=!1}){const p=Qc.updateListener.of(t=>{t.docChanged&&r(t.state.doc.toString())}),f=Qc.updateListener.of(t=>{const e=t.transactions.flatMap(t=>t.effects).filter(t=>t.is(Tf));if(!e.length)return;const n=e.flatMap(t=>t.value);s(n)}),g=Qc.contentAttributes.of(a),m=Qc.domEventHandlers({keydown:o});"string"==typeof e&&(e=document.querySelector(e));const v=e?oh({tooltipSpace:function(){return e.getBoundingClientRect()}}):[],y=(t=>new ru(function(t=null){const e=Em.configure({wrap:(n=e=>"Feel"==e.name||"FeelBlock"==e.name?{parser:cr}:t&&"SimpleTextBlock"==e.name?{parser:t}:null,(t,e,i,r)=>new rn(t,n,e,i,r)),props:[wu.add(Cm)]});var n;return Xh.define({parser:e})}(t),[]))(i||n&&(t=>"markdown"===t?tm:null)(n)),b=[Iu(),p,g,ip(),xu(),m,Jc.of([..._f]),y,Tm,f,v,d?bm:ym,...h?[Fh()]:[],...u?[To.transactionFilter.of(t=>t.newDoc.lines>1?[]:t)]:[]];return l&&b.push(Qc.editable.of(!1)),u&&c&&(c=c.toString().split("\n")[0]),this._cmEditor=new Qc({state:To.create({doc:c,extensions:b}),parent:t}),this}Pm.prototype.setValue=function(t){this._cmEditor.dispatch({changes:{from:0,to:this._cmEditor.state.doc.length,insert:t}})},Pm.prototype.focus=function(t){const e=this._cmEditor;if(e.contentDOM.focus(),e.focus(),"number"==typeof t){const n=e.state.doc.length;e.dispatch({selection:{anchor:t<=n?t:n}})}},Pm.prototype.getSelection=function(){return this._cmEditor.state.selection};const Mm=[Zd("function(${params}) ${body}",{label:"function",detail:"definition",type:"keyword"}),Zd("for ${var} in ${collection} return ${value}",{label:"for",detail:"expression",type:"keyword"}),Zd("every ${var} in ${collection} satisfies ${condition}",{label:"every",detail:"quantified expression",type:"keyword"}),Zd("some ${var} in ${collection} satisfies ${condition}",{label:"some",detail:"quantified expression",type:"keyword"}),Zd("if ${condition} then ${value} else ${other value}",{label:"if",detail:"block",type:"keyword"}),Zd("{ ${key}: ${value} }",{label:"context",detail:"block",type:"keyword"})];function Nm(t){const{context:e,after:n,before:i,keyword:r}=t;return function(t,e){const{nodes:n,before:i,after:r,keyword:o}=t;return t=>{const{state:s,pos:a}=t,l=function(t,e){for(Array.isArray(e)||(e=[e]);t;t=t.parent){if(e.includes(t.name))return t;if(t.type.isTop)break}return null}(Uh(s).resolveInner(a,-1),n);return l?Dm(l,a,[o,i])||function(t,e,n){return Bm(t,e,n,1)}(l,a,[o,r])||r&&!Dm(l,a,[r])?null:e(t):null}}({nodes:e,before:i,after:n,keyword:r},Ju([{label:r,type:"keyword",boost:10}]))}const Rm=[Nm({context:"InExpression",keyword:"in"}),Nm({context:"IfExpression",keyword:"then",after:"if",before:"else"}),Nm({context:"IfExpression",keyword:"else",after:"then"}),Nm({context:"QuantifiedExpression",keyword:"satisfies"}),Nm({context:"ForExpression",after:"InExpressions",keyword:"return"})];function Dm(t,e,n){return Bm(t,e,n,-1)}function Bm(t,e,n,i){let r=t[i>0?"childAfter":"childBefore"](e);for(;r;){if(n.includes(r.name))return r;if(r.type.isError&&r.firstChild&&n.includes(r.firstChild.name))return r.firstChild;r=r[i>0?"nextSibling":"prevSibling"]}return null}const $m=Xh.define({parser:cr.configure({props:[uu.add({Context:vu({closing:"}"}),"List FilterExpression":vu({closing:"]"}),"ParenthesizedExpression FunctionInvocation":bu({except:/^\s*\)/}),"ForExpression QuantifiedExpression IfExpression":bu({except:/^\s*(then|else|return|satisfies)\b/}),FunctionDefinition:bu({except:/^\s*(\(|\))/})}),wu.add({Context:_u,List:_u,ParenthesizedExpression:_u,FunctionDefinition(t){const e=t.getChild(")");return e?{from:e.to,to:t.to}:null}})]}),languageData:{indentOnInput:/^\s*(\)|\}|\]|then|else|return|satisfies)$/,commentTokens:{line:"//",block:{open:"/*",close:"*/"}}}});function Lm(t){return t.from===t.to}function Im(t){return!!t&&("PathExpression"===t.name||Im(t.parent))}$m.configure({top:"UnaryTests"}),$m.configure({top:"Expression"});const qm=[{name:"not(negand)",description:'<p>Returns the logical negation of the given value.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">not(negand: boolean): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">not(true)\n// false\n\nnot(null)\n// null\n</code></pre>\n'},{name:"is defined(value)",description:'<p><em>Camunda Extension</em></p>\n<p>Checks if a given value is not <code>null</code>. If the value is <code>null</code> then the function returns <code>false</code>.\nOtherwise, the function returns <code>true</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">is defined(value: Any): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">is defined(1)\n// true\n\nis defined(null)\n// false\n\nis defined(x)\n// false - if no variable &quot;x&quot; exists\n\nis defined(x.y)\n// false - if no variable &quot;x&quot; exists or it doesn&#39;t have a property &quot;y&quot;\n</code></pre>\n<p>:::caution Breaking change</p>\n<p>This function worked differently in previous versions. It returned <code>true</code> if the value was <code>null</code>.\nSince this version, the function returns <code>false</code> if the value is <code>null</code>.</p>\n<p>:::</p>\n'},{name:"get or else(value, default)",description:'<p><em>Camunda Extension</em></p>\n<p>Return the provided value parameter if not <code>null</code>, otherwise return the default parameter</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">get or else(value: Any, default: Any): Any\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">get or else(&quot;this&quot;, &quot;default&quot;)\n// &quot;this&quot;\n\nget or else(null, &quot;default&quot;)\n// &quot;default&quot;\n\nget or else(null, null)\n// null\n</code></pre>\n'},{name:"assert(value, condition)",description:'<p><em>Camunda Extension</em></p>\n<p>Verify that the given condition is met. If the condition is <code>true</code>, the function returns the value.\nOtherwise, the evaluation fails with an error.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">assert(value: Any, condition: Any)\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">assert(x, x != null)\n// &quot;value&quot; - if x is &quot;value&quot;\n// error - if x is null or doesn&#39;t exist\n\nassert(x, x &gt;= 0)\n// 4 - if x is 4\n// error - if x is less than zero\n</code></pre>\n'},{name:"assert(value, condition, cause)",description:'<p><em>Camunda Extension</em></p>\n<p>Verify that the given condition is met. If the condition is <code>true</code>, the function returns the value.\nOtherwise, the evaluation fails with an error containing the given message.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">assert(value: Any, condition: Any, cause: String)\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">assert(x, x != null, &quot;&#39;x&#39; should not be null&quot;)\n// &quot;value&quot; - if x is &quot;value&quot;\n// error(&#39;x&#39; should not be null) - if x is null or doesn&#39;t exist\n\nassert(x, x &gt;= 0, &quot;&#39;x&#39; should be positive&quot;)\n// 4 - if x is 4\n// error(&#39;x&#39; should be positive) - if x is less than zero\n</code></pre>\n'},{name:"get value(context, key)",description:'<p>Returns the value of the context entry with the given key.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">get value(context: context, key: string): Any\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">get value({foo: 123}, &quot;foo&quot;)\n// 123\n\nget value({a: 1}, &quot;b&quot;)\n// null\n</code></pre>\n'},{name:"get value(context, keys)",description:'<p><em>Camunda Extension</em></p>\n<p>Returns the value of the context entry for a context path defined by the given keys.</p>\n<p>If <code>keys</code> contains the keys <code>[k1, k2]</code> then it returns the value at the nested entry <code>k1.k2</code> of the context.</p>\n<p>If <code>keys</code> are empty or the nested entry defined by the keys doesn&#39;t exist in the context, it returns <code>null</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">get value(context: context, keys: list&lt;string&gt;): Any\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">get value({x:1, y: {z:0}}, [&quot;y&quot;, &quot;z&quot;])\n// 0\n\nget value({x: {y: {z:0}}}, [&quot;x&quot;, &quot;y&quot;])\n// {z:0}\n\nget value({a: {b: 3}}, [&quot;b&quot;])\n// null\n</code></pre>\n'},{name:"get entries(context)",description:'<p>Returns the entries of the context as a list of key-value-pairs.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">get entries(context: context): list&lt;context&gt;\n</code></pre>\n<p>The return value is a list of contexts. Each context contains two entries for &quot;key&quot; and &quot;value&quot;.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">get entries({foo: 123})\n// [{key: &quot;foo&quot;, value: 123}]\n</code></pre>\n'},{name:"context put(context, key, value)",description:'<p>Adds a new entry with the given key and value to the context. Returns a new context that includes the entry.</p>\n<p>If an entry for the same key already exists in the context, it overrides the value.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">context put(context: context, key: string, value: Any): context\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">context put({x:1}, &quot;y&quot;, 2)\n// {x:1, y:2}\n</code></pre>\n<p>:::info\nThe function <code>context put()</code> replaced the previous function <code>put()</code> (Camunda Extension). The\nprevious function is deprecated and should not be used anymore.\n:::</p>\n'},{name:"context put(context, keys, value)",description:'<p>Adds a new entry with the given value to the context. The path of the entry is defined by the keys. Returns a new context that includes the entry.</p>\n<p>If <code>keys</code> contains the keys <code>[k1, k2]</code> then it adds the nested entry <code>k1.k2 = value</code> to the context.</p>\n<p>If an entry for the same keys already exists in the context, it overrides the value.</p>\n<p>If <code>keys</code> are empty, it returns <code>null</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">context put(context: context, keys: list&lt;string&gt;, value: Any): context\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">context put({x:1}, [&quot;y&quot;], 2)\n// {x:1, y:2}\n\ncontext put({x:1, y: {z:0}}, [&quot;y&quot;, &quot;z&quot;], 2)\n// {x:1, y: {z:2}}\n\ncontext put({x:1}, [&quot;y&quot;, &quot;z&quot;], 2)\n// {x:1, y: {z:2}}\n</code></pre>\n'},{name:"context merge(contexts)",description:'<p>Union the given contexts. Returns a new context that includes all entries of the given contexts.</p>\n<p>If an entry for the same key already exists in a context, it overrides the value. The entries are overridden in the same order as in the list of contexts.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">context merge(contexts: list&lt;context&gt;): context\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">context merge([{x:1}, {y:2}])\n// {x:1, y:2}\n\ncontext merge([{x:1, y: 0}, {y:2}])\n// {x:1, y:2}\n</code></pre>\n<p>:::info\nThe function <code>context merge()</code> replaced the previous function <code>put all()</code> (Camunda Extension). The\nprevious function is deprecated and should not be used anymore.\n:::</p>\n'},{name:"string(from)",description:'<p>Returns the given value as a string representation.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">string(from: Any): string\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">string(1.1)\n// &quot;1.1&quot;\n\nstring(date(&quot;2012-12-25&quot;))\n// &quot;2012-12-25&quot;\n</code></pre>\n'},{name:"number(from)",description:'<p>Parses the given string to a number.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">number(from: string): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">number(&quot;1500.5&quot;)\n// 1500.5\n</code></pre>\n'},{name:"context(entries)",description:'<p>Constructs a context of the given list of key-value pairs. It is the reverse function to <a href="feel-built-in-functions-context.md#get-entriescontext">get entries()</a>.</p>\n<p>Each key-value pair must be a context with two entries: <code>key</code> and <code>value</code>. The entry with name <code>key</code> must have a value of the type <code>string</code>.</p>\n<p>It might override context entries if the keys are equal. The entries are overridden in the same order as the contexts in the given list.</p>\n<p>Returns <code>null</code> if one of the entries is not a context or if a context doesn&#39;t contain the required entries.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">context(entries: list&lt;context&gt;): context\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">context([{&quot;key&quot;:&quot;a&quot;, &quot;value&quot;:1}, {&quot;key&quot;:&quot;b&quot;, &quot;value&quot;:2}])\n// {a:1, b:2}\n</code></pre>\n'},{name:"date(from)",description:'<p>Returns a date from the given value.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">date(from: string): date\n</code></pre>\n<p>Parses the given string into a date.</p>\n<pre><code class="language-feel">date(from: date and time): date\n</code></pre>\n<p>Extracts the date component from the given date and time.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">date(&quot;2018-04-29&quot;)\n// date(&quot;2018-04-29&quot;)\n\ndate(date and time(&quot;2012-12-25T11:00:00&quot;))\n// date(&quot;2012-12-25&quot;)\n</code></pre>\n'},{name:"date(year, month, day)",description:'<p>Returns a date from the given components.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">date(year: number, month: number, day: number): date\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">date(2012, 12, 25)\n// date(&quot;2012-12-25&quot;)\n</code></pre>\n'},{name:"time(from)",description:'<p>Returns a time from the given value.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">time(from: string): time\n</code></pre>\n<p>Parses the given string into a time.</p>\n<pre><code class="language-feel">time(from: date and time): time\n</code></pre>\n<p>Extracts the time component from the given date and time.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">time(&quot;12:00:00&quot;)\n// time(&quot;12:00:00&quot;)\n\ntime(date and time(&quot;2012-12-25T11:00:00&quot;))\n// time(&quot;11:00:00&quot;)\n</code></pre>\n'},{name:"time(hour, minute, second)",description:'<p>Returns a time from the given components.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">time(hour: number, minute: number, second: number): time\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">time(23, 59, 0)\n// time(&quot;23:59:00&quot;)\n</code></pre>\n'},{name:"time(hour, minute, second, offset)",description:'<p>Returns a time from the given components, including a timezone offset.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">time(hour: number, minute: number, second: number, offset: days and time duration): time\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">time(14, 30, 0, duration(&quot;PT1H&quot;))\n// time(&quot;14:30:00+01:00&quot;)\n</code></pre>\n'},{name:"date and time(from)",description:'<p>Parses the given string into a date and time.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">date and time(from: string): date and time\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">date and time(&quot;2018-04-29T009:30:00&quot;)\n// date and time(&quot;2018-04-29T009:30:00&quot;)\n</code></pre>\n'},{name:"date and time(date, time)",description:'<p>Returns a date and time from the given components.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">date and time(date: date, time: time): date and time\n</code></pre>\n<pre><code class="language-feel">date and time(date: date and time, time: time): date and time\n</code></pre>\n<p>Returns a date and time value that consists of the date component of <code>date</code> combined with <code>time</code>.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">date and time(date(&quot;2012-12-24&quot;),time(&quot;T23:59:00&quot;))\n// date and time(&quot;2012-12-24T23:59:00&quot;)\n\ndate and time(date and time(&quot;2012-12-25T11:00:00&quot;),time(&quot;T23:59:00&quot;))\n// date and time(&quot;2012-12-25T23:59:00&quot;)\n</code></pre>\n'},{name:"date and time(date, timezone)",description:'<p><em>Camunda Extension</em></p>\n<p>Returns the given date and time value at the given timezone.</p>\n<p>If <code>date</code> has a different timezone than <code>timezone</code> then it adjusts the time to match the local time of <code>timezone</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">date and time(date: date and time, timezone: string): date and time\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">date and time(@&quot;2020-07-31T14:27:30@Europe/Berlin&quot;, &quot;America/Los_Angeles&quot;)\n// date and time(&quot;2020-07-31T05:27:30@America/Los_Angeles&quot;)\n\ndate and time(@&quot;2020-07-31T14:27:30&quot;, &quot;Z&quot;)\n// date and time(&quot;2020-07-31T12:27:30Z&quot;)\n</code></pre>\n'},{name:"duration(from)",description:'<p>Parses the given string into a duration. The duration is either a days and time duration or a years and months duration.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">duration(from: string): days and time duration\n</code></pre>\n<pre><code class="language-feel">duration(from: string): years and months duration\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">duration(&quot;P5D&quot;)\n// duration(&quot;P5D&quot;)\n\nduration(&quot;P32Y&quot;)\n// duration(&quot;P32Y&quot;)\n</code></pre>\n'},{name:"years and months duration(from, to)",description:'<p>Returns the years and months duration between <code>from</code> and <code>to</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">years and months duration(from: date, to: date): years and months duration\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">years and months duration(date(&quot;2011-12-22&quot;), date(&quot;2013-08-24&quot;))\n// duration(&quot;P1Y8M&quot;)\n</code></pre>\n'},{name:"list contains(list, element)",description:'<p>Returns <code>true</code> if the given list contains the element. Otherwise, returns <code>false</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">list contains(list: list, element: Any): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">list contains([1,2,3], 2)\n// true\n</code></pre>\n'},{name:"count(list)",description:'<p>Returns the number of elements of the given list.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">count(list: list): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">count([1,2,3])\n// 3\n</code></pre>\n'},{name:"min(list)",description:'<p>Returns the minimum of the given list.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">min(list: list): Any\n</code></pre>\n<p>All elements in <code>list</code> should have the same type and be comparable.</p>\n<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">min([1,2,3])\n// 1\n\nmin(1,2,3)\n// 1\n</code></pre>\n'},{name:"max(list)",description:'<p>Returns the maximum of the given list.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">max(list: list): Any\n</code></pre>\n<p>All elements in <code>list</code> should have the same type and be comparable.</p>\n<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">max([1,2,3])\n// 3\n\nmax(1,2,3)\n// 3\n</code></pre>\n'},{name:"sum(list)",description:'<p>Returns the sum of the given list of numbers.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">sum(list: list&lt;number&gt;): number\n</code></pre>\n<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">sum([1,2,3])\n// 6\n\nsum(1,2,3)\n// 6\n</code></pre>\n'},{name:"product(list)",description:'<p>Returns the product of the given list of numbers.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">product(list: list&lt;number&gt;): number\n</code></pre>\n<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">product([2, 3, 4])\n// 24\n\nproduct(2, 3, 4)\n// 24\n</code></pre>\n'},{name:"mean(list)",description:'<p>Returns the arithmetic mean (i.e. average) of the given list of numbers.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">mean(list: list&lt;number&gt;): number\n</code></pre>\n<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">mean([1,2,3])\n// 2\n\nmean(1,2,3)\n// 2\n</code></pre>\n'},{name:"median(list)",description:'<p>Returns the median element of the given list of numbers.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">median(list: list&lt;number&gt;): number\n</code></pre>\n<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">median(8, 2, 5, 3, 4)\n// 4\n\nmedian([6, 1, 2, 3])\n// 2.5\n</code></pre>\n'},{name:"stddev(list)",description:'<p>Returns the standard deviation of the given list of numbers.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">stddev(list: list&lt;number&gt;): number\n</code></pre>\n<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">stddev(2, 4, 7, 5)\n// 2.0816659994661326\n\nstddev([2, 4, 7, 5])\n// 2.0816659994661326\n</code></pre>\n'},{name:"mode(list)",description:'<p>Returns the mode of the given list of numbers.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">mode(list: list&lt;number&gt;): number\n</code></pre>\n<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">mode(6, 3, 9, 6, 6)\n// [6]\n\nmode([6, 1, 9, 6, 1])\n// [1, 6]\n</code></pre>\n'},{name:"all(list)",description:'<p>Returns <code>false</code> if any element of the given list is <code>false</code>. Otherwise, returns <code>true</code>.</p>\n<p>If the given list is empty, it returns <code>true</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">all(list: list&lt;boolean&gt;): boolean\n</code></pre>\n<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">all([true,false])\n// false\n\nall(false,null,true)\n// false\n</code></pre>\n<p>:::info\nThe function <code>all()</code> replaced the previous function <code>and()</code>. The previous function is deprecated and\nshould not be used anymore.\n:::</p>\n'},{name:"any(list)",description:'<p>Returns <code>true</code> if any element of the given list is <code>true</code>. Otherwise, returns <code>false</code>.</p>\n<p>If the given list is empty, it returns <code>false</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">any(list: list&lt;boolean&gt;): boolean\n</code></pre>\n<p>The parameter <code>list</code> can be passed as a list or as a sequence of elements.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">any([false,true])\n// true\n\nany(false,null,true)\n// true\n</code></pre>\n<p>:::info\nThe function <code>any()</code> replaced the previous function <code>or()</code>. The previous function is deprecated and\nshould not be used anymore.\n:::</p>\n'},{name:"sublist(list, start position)",description:'<p>Returns a partial list of the given value starting at <code>start position</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">sublist(list: list, start position: number): list\n</code></pre>\n<p>The <code>start position</code> starts at the index <code>1</code>. The last position is <code>-1</code>.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">sublist([1,2,3], 2)\n// [2,3]\n</code></pre>\n'},{name:"sublist(list, start position, length)",description:'<p>Returns a partial list of the given value starting at <code>start position</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">sublist(list: list, start position: number, length: number): list\n</code></pre>\n<p>The <code>start position</code> starts at the index <code>1</code>. The last position is <code>-1</code>.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">sublist([1,2,3], 1, 2)\n// [1,2]\n</code></pre>\n'},{name:"append(list, items)",description:'<p>Returns the given list with all <code>items</code> appended.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">append(list: list, items: Any): list\n</code></pre>\n<p>The parameter <code>items</code> can be a single element or a sequence of elements.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">append([1], 2, 3)\n// [1,2,3]\n</code></pre>\n'},{name:"concatenate(lists)",description:'<p>Returns a list that includes all elements of the given lists.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">concatenate(lists: list): list\n</code></pre>\n<p>The parameter <code>lists</code> is a sequence of lists.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">concatenate([1,2],[3])\n// [1,2,3]\n\nconcatenate([1],[2],[3])\n// [1,2,3]\n</code></pre>\n'},{name:"insert before(list, position, newItem)",description:'<p>Returns the given list with <code>newItem</code> inserted at <code>position</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">insert before(list: list, position: number, newItem: Any): list\n</code></pre>\n<p>The <code>position</code> starts at the index <code>1</code>. The last position is <code>-1</code>.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">insert before([1,3],1,2)\n// [2,1,3]\n</code></pre>\n'},{name:"remove(list, position)",description:'<p>Returns the given list without the element at <code>position</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">remove(list: list, position: number): list\n</code></pre>\n<p>The <code>position</code> starts at the index <code>1</code>. The last position is <code>-1</code>.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">remove([1,2,3], 2)\n// [1,3]\n</code></pre>\n'},{name:"reverse(list)",description:'<p>Returns the given list in revered order.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">reverse(list: list): list\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">reverse([1,2,3])\n// [3,2,1]\n</code></pre>\n'},{name:"index of(list, match)",description:'<p>Returns an ascending list of positions containing <code>match</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">index of(list: list, match: Any): list&lt;number&gt;\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">index of([1,2,3,2],2)\n// [2,4]\n</code></pre>\n'},{name:"union(list)",description:'<p>Returns a list that includes all elements of the given lists without duplicates.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">union(list: list): list\n</code></pre>\n<p>The parameter <code>list</code> is a sequence of lists.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">union([1,2],[2,3])\n// [1,2,3]\n</code></pre>\n'},{name:"distinct values(list)",description:'<p>Returns the given list without duplicates.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">distinct values(list: list): list\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">distinct values([1,2,3,2,1])\n// [1,2,3]\n</code></pre>\n'},{name:"duplicate values(list)",description:'<p><em>Camunda Extension</em></p>\n<p>Returns all duplicate values of the given list.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">duplicate values(list: list): list\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">duplicate values([1,2,3,2,1])\n// [1,2]\n</code></pre>\n'},{name:"flatten(list)",description:'<p>Returns a list that includes all elements of the given list without nested lists.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">flatten(list: list): list\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">flatten([[1,2],[[3]], 4])\n// [1,2,3,4]\n</code></pre>\n'},{name:"sort(list, precedes)",description:'<p>Returns the given list sorted by the <code>precedes</code> function.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">sort(list: list, precedes: function&lt;(Any, Any) -&gt; boolean&gt;): list\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">sort(list: [3,1,4,5,2], precedes: function(x,y) x &lt; y)\n// [1,2,3,4,5]\n</code></pre>\n'},{name:"string join(list)",description:'<p>Joins a list of strings into a single string. This is similar to\nJava&#39;s <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/stream/Collectors.html#joining(java.lang.CharSequence,java.lang.CharSequence,java.lang.CharSequence)">joining</a>\nfunction.</p>\n<p>If an item of the list is <code>null</code>, the item is ignored for the result string. If an item is\nneither a string nor <code>null</code>, the function returns <code>null</code> instead of a string.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">string join(list: list&lt;string&gt;): string\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">string join([&quot;a&quot;,&quot;b&quot;,&quot;c&quot;])\n// &quot;abc&quot;\n\nstring join([&quot;a&quot;,null,&quot;c&quot;])\n// &quot;ac&quot;\n\nstring join([])\n// &quot;&quot;\n</code></pre>\n'},{name:"string join(list, delimiter)",description:'<p>Joins a list of strings into a single string. This is similar to\nJava&#39;s <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/stream/Collectors.html#joining(java.lang.CharSequence,java.lang.CharSequence,java.lang.CharSequence)">joining</a>\nfunction.</p>\n<p>If an item of the list is <code>null</code>, the item is ignored for the result string. If an item is\nneither a string nor <code>null</code>, the function returns <code>null</code> instead of a string.</p>\n<p>The resulting string contains a <code>delimiter</code> between each element.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">string join(list: list&lt;string&gt;, delimiter: string): string\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">string join([&quot;a&quot;], &quot;X&quot;)\n// &quot;a&quot;\n\nstring join([&quot;a&quot;,&quot;b&quot;,&quot;c&quot;], &quot;, &quot;)\n// &quot;a, b, c&quot;\n</code></pre>\n'},{name:"string join(list, delimiter, prefix, suffix)",description:'<p><em>Camunda Extension</em></p>\n<p>Joins a list of strings into a single string. This is similar to\nJava&#39;s <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/stream/Collectors.html#joining(java.lang.CharSequence,java.lang.CharSequence,java.lang.CharSequence)">joining</a>\nfunction.</p>\n<p>If an item of the list is <code>null</code>, the item is ignored for the result string. If an item is\nneither a string nor <code>null</code>, the function returns <code>null</code> instead of a string.</p>\n<p>The resulting string starts with <code>prefix</code>, contains a <code>delimiter</code> between each element, and ends\nwith <code>suffix</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">string join(list: list&lt;string&gt;, delimiter: string, prefix: string, suffix: string): string\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">string join([&quot;a&quot;,&quot;b&quot;,&quot;c&quot;], &quot;, &quot;, &quot;[&quot;, &quot;]&quot;)\n// &quot;[a, b, c]&quot;\n</code></pre>\n'},{name:"decimal(n, scale)",description:'<p>Rounds the given value at the given scale.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">decimal(n: number, scale: number): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">decimal(1/3, 2)\n// .33\n\ndecimal(1.5, 0)\n// 2\n</code></pre>\n'},{name:"floor(n)",description:'<p>Rounds the given value with rounding mode flooring.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">floor(n: number): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">floor(1.5)\n// 1\n\nfloor(-1.5)\n// -2\n</code></pre>\n'},{name:"floor(n, scale)",description:'<p>Rounds the given value with rounding mode flooring at the given scale.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">floor(n: number, scale: number): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">floor(-1.56, 1)\n// -1.6\n</code></pre>\n'},{name:"ceiling(n)",description:'<p>Rounds the given value with rounding mode ceiling.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">ceiling(n: number): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">ceiling(1.5)\n// 2\n\nceiling(-1.5)\n// -1\n</code></pre>\n'},{name:"ceiling(n, scale)",description:'<p>Rounds the given value with rounding mode ceiling at the given scale.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">ceiling(n: number, scale: number): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">ceiling(-1.56, 1)\n// -1.5\n</code></pre>\n'},{name:"round up(n, scale)",description:'<p>Rounds the given value with the rounding mode round-up at the given scale.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">round up(n: number, scale: number): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">round up(5.5)\n// 6\n\nround up(-5.5)\n// -6\n\nround up(1.121, 2)\n// 1.13\n\nround up(-1.126, 2)\n// -1.13\n</code></pre>\n'},{name:"round down(n, scale)",description:'<p>Rounds the given value with the rounding mode round-down at the given scale.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">round down(n: number, scale: number): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">round down(5.5, 0)\n// 5\n\nround down (-5.5, 0)\n// -5\n\nround down (1.121, 2)\n// 1.12\n\nround down (-1.126, 2)\n// -1.12\n</code></pre>\n'},{name:"round half up(n, scale)",description:'<p>Rounds the given value with the rounding mode round-half-up at the given scale.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">round half up(n: number, scale: number): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">round half up(5.5, 0)\n// 6\n\nround half up(-5.5, 0)\n// -6\n\nround half up(1.121, 2)\n// 1.12\n\nround half up(-1.126, 2)\n// -1.13\n</code></pre>\n'},{name:"round half down(n, scale)",description:'<p>Rounds the given value with the rounding mode round-half-down at the given scale.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">round half down(n: number, scale: number): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">round half down (5.5, 0)\n// 5\n\nround half down (-5.5, 0)\n// -5\n\nround half down (1.121, 2)\n// 1.12\n\nround half down (-1.126, 2)\n// -1.13\n</code></pre>\n'},{name:"abs(number)",description:'<p>Returns the absolute value of the given numeric value.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">abs(number: number): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">abs(10)\n// 10\n\nabs(-10)\n// 10\n</code></pre>\n'},{name:"modulo(dividend, divisor)",description:'<p>Returns the remainder of the division of dividend by divisor.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">modulo(dividend: number, divisor: number): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">modulo(12, 5)\n// 2\n</code></pre>\n'},{name:"sqrt(number)",description:'<p>Returns the square root of the given value.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">sqrt(number: number): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">sqrt(16)\n// 4\n</code></pre>\n'},{name:"log(number)",description:'<p>Returns the natural logarithm (base e) of the given value.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">log(number: number): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">log(10)\n// 2.302585092994046\n</code></pre>\n'},{name:"exp(number)",description:'<p>Returns the Eulers number e raised to the power of the given number .</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">exp(number: number): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">exp(5)\n// 148.4131591025766\n</code></pre>\n'},{name:"odd(number)",description:'<p>Returns <code>true</code> if the given value is odd. Otherwise, returns <code>false</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">odd(number: number): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">odd(5)\n// true\n\nodd(2)\n// false\n</code></pre>\n'},{name:"even(number)",description:'<p>Returns <code>true</code> if the given is even. Otherwise, returns <code>false</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">even(number: number): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">even(5)\n// false\n\neven(2)\n// true\n</code></pre>\n'},{name:"random number()",description:'<p><em>Camunda Extension</em></p>\n<p>Returns a random number between <code>0</code> and <code>1</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">random number(): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">random number()\n// 0.9701618132579795\n</code></pre>\n'},{name:"before(point1, point2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">before(point1: Any, point2: Any): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">before(1, 10)\n// true\n\nbefore(10, 1)\n// false\n</code></pre>\n'},{name:"before(range, point)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">before(range: range, point: Any): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">before([1..5], 10)\n// true\n</code></pre>\n'},{name:"before(point, range)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">before(point: Any, range: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">before(1, [2..5])\n// true\n</code></pre>\n'},{name:"before(range1, range2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">before(range1: range, range2: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">before([1..5], [6..10])\n// true\n\nbefore([1..5),[5..10])\n// true\n</code></pre>\n'},{name:"after(point1, point2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">after(point1: Any, point2: Any): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">after(10, 1)\n// true\n\nafter(1, 10)\n// false\n</code></pre>\n'},{name:"after(range, point)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">after(range: range, point: Any): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">after([1..5], 10)\n// false\n</code></pre>\n'},{name:"after(point, range)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">after(point: Any, range: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">after(12, [2..5])\n// true\n</code></pre>\n'},{name:"after(range1, range2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">after(range1: range, range2: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">after([6..10], [1..5])\n// true\n\nafter([5..10], [1..5))\n// true\n</code></pre>\n'},{name:"meets(range1, range2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">meets(range1: range, range2: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">meets([1..5], [5..10])\n// true\n\nmeets([1..3], [4..6])\n// false\n\nmeets([1..3], [3..5])\n// true\n\nmeets([1..5], (5..8])\n// false\n</code></pre>\n'},{name:"met by(range1, range2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">met by(range1: range, range2: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">met by([5..10], [1..5])\n// true\n\nmet by([3..4], [1..2])\n// false\n\nmet by([3..5], [1..3])\n// true\n\nmet by((5..8], [1..5))\n// false\n\nmet by([5..10], [1..5))\n// false\n</code></pre>\n'},{name:"overlaps(range1, range2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">overlaps(range1: range, range2: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">overlaps([5..10], [1..6])\n// true\n\noverlaps((3..7], [1..4])\n// true\n\noverlaps([1..3], (3..6])\n// false\n\noverlaps((5..8], [1..5))\n// false\n\noverlaps([4..10], [1..5))\n// true\n</code></pre>\n'},{name:"overlaps before(range1, range2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">overlaps before(range1: range, range2: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">overlaps before([1..5], [4..10])\n// true\n\noverlaps before([3..4], [1..2])\n// false\n\noverlaps before([1..3], (3..5])\n// false\n\noverlaps before([1..5), (3..8])\n// true\n\noverlaps before([1..5), [5..10])\n// false\n</code></pre>\n'},{name:"overlaps after(range1, range2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">overlaps after(range1: range, range2: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">overlaps after([4..10], [1..5])\n// true\n\noverlaps after([3..4], [1..2])\n// false\n\noverlaps after([3..5], [1..3))\n// false\n\noverlaps after((5..8], [1..5))\n// false\n\noverlaps after([4..10], [1..5))\n// true\n</code></pre>\n'},{name:"finishes(point, range)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">finishes(point: Any, range: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">finishes(5, [1..5])\n// true\n\nfinishes(10, [1..7])\n// false\n</code></pre>\n'},{name:"finishes(range1, range2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">finishes(range1: range, range2: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">finishes([3..5], [1..5])\n// true\n\nfinishes((1..5], [1..5))\n// false\n\nfinishes([5..10], [1..10))\n// false\n</code></pre>\n'},{name:"finished by(range, point)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">finished by(range: range, point: Any): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">finished by([5..10], 10)\n// true\n\nfinished by([3..4], 2)\n// false\n</code></pre>\n'},{name:"finished by(range1, range2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">finished by(range1: range, range2: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">finished by([1..5], [3..5])\n// true\n\nfinished by((5..8], [1..5))\n// false\n\nfinished by([5..10], (1..10))\n// false\n</code></pre>\n'},{name:"includes(range, point)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">includes(range: range, point: Any): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">includes([5..10], 6)\n// true\n\nincludes([3..4], 5)\n// false\n</code></pre>\n'},{name:"includes(range1, range2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">includes(range1: range, range2: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">includes([1..10], [4..6])\n// true\n\nincludes((5..8], [1..5))\n// false\n\nincludes([1..10], [1..5))\n// true\n</code></pre>\n'},{name:"during(point, range)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">during(point: Any, range: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">during(5, [1..10])\n// true\n\nduring(12, [1..10])\n// false\n\nduring(1, (1..10])\n// false\n</code></pre>\n'},{name:"during(range1, range2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">during(range1: range, range2: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">during([4..6], [1..10))\n// true\n\nduring((1..5], (1..10])\n// true\n</code></pre>\n'},{name:"starts(point, range)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">starts(point: Any, range: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">starts(1, [1..5])\n// true\n\nstarts(1, (1..8])\n// false\n</code></pre>\n'},{name:"starts(range1, range2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">starts(range1: range, range2: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">starts((1..5], [1..5])\n// false\n\nstarts([1..10], [1..5])\n// false\n\nstarts((1..5), (1..10))\n// true\n</code></pre>\n'},{name:"started by(range, point)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">started by(range: range, point: Any): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">started by([1..10], 1)\n// true\n\nstarted by((1..10], 1)\n// false\n</code></pre>\n'},{name:"started by(range1, range2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">started by(range1: range, range2: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">started by([1..10], [1..5])\n// true\n\nstarted by((1..10], [1..5))\n// false\n\nstarted by([1..10], [1..10))\n// true\n</code></pre>\n'},{name:"coincides(point1, point2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">coincides(point1: Any, point2: Any): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">coincides(5, 5)\n// true\n\ncoincides(3, 4)\n// false\n</code></pre>\n'},{name:"coincides(range1, range2)",description:'<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">coincides(range1: range, range2: range): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">coincides([1..5], [1..5])\n// true\n\ncoincides((1..5], [1..5))\n// false\n\ncoincides([1..5], [2..6])\n// false\n</code></pre>\n'},{name:"substring(string, start position)",description:'<p>Returns a substring of the given value starting at <code>start position</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">substring(string: string, start position: number): string\n</code></pre>\n<p>The <code>start position</code> starts at the index <code>1</code>. The last position is <code>-1</code>.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">substring(&quot;foobar&quot;, 3)\n// &quot;obar&quot;\n</code></pre>\n'},{name:"substring(string, start position, length)",description:'<p>Returns a substring of the given value starting at <code>start position</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">substring(string: string, start position: number, length: number): string\n</code></pre>\n<p>The <code>start position</code> starts at the index <code>1</code>. The last position is <code>-1</code>.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">substring(&quot;foobar&quot;, 3, 3)\n// &quot;oba&quot;\n</code></pre>\n'},{name:"string length(string)",description:'<p>Returns the number of characters in the given value.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">string length(string: string): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">string length(&quot;foo&quot;)\n// 3\n</code></pre>\n'},{name:"upper case(string)",description:'<p>Returns the given value with all characters are uppercase.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">upper case(string: string): string\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">upper case(&quot;aBc4&quot;)\n// &quot;ABC4&quot;\n</code></pre>\n'},{name:"lower case(string)",description:'<p>Returns the given value with all characters are lowercase.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">lower case(string: string): string\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">lower case(&quot;aBc4&quot;)\n// &quot;abc4&quot;\n</code></pre>\n'},{name:"substring before(string, match)",description:'<p>Returns a substring of the given value that contains all characters before <code>match</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">substring before(string: string, match: string): string\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">substring before(&quot;foobar&quot;, &quot;bar&quot;)\n// &quot;foo&quot;\n</code></pre>\n'},{name:"substring after(string, match)",description:'<p>Returns a substring of the given value that contains all characters after <code>match</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">substring after(string: string, match: string): string\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">substring after(&quot;foobar&quot;, &quot;ob&quot;)\n// &quot;ar&quot;\n</code></pre>\n'},{name:"contains(string, match)",description:'<p>Returns <code>true</code> if the given value contains the substring <code>match</code>. Otherwise, returns <code>false</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">contains(string: string, match: string): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">contains(&quot;foobar&quot;, &quot;of&quot;)\n// false\n</code></pre>\n'},{name:"starts with(string, match)",description:'<p>Returns <code>true</code> if the given value starts with the substring <code>match</code>. Otherwise, returns <code>false</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">starts with(string: string, match: string): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">starts with(&quot;foobar&quot;, &quot;fo&quot;)\n// true\n</code></pre>\n'},{name:"ends with(string, match)",description:'<p>Returns <code>true</code> if the given value ends with the substring <code>match</code>. Otherwise, returns <code>false</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">ends with(string: string, match: string): boolean\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">ends with(&quot;foobar&quot;, &quot;r&quot;)\n// true\n</code></pre>\n'},{name:"matches(input, pattern)",description:'<p>Returns <code>true</code> if the given value matches the <code>pattern</code>. Otherwise, returns <code>false</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">matches(input: string, pattern: string): boolean\n</code></pre>\n<p>The <code>pattern</code> is a string that contains a regular expression.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">matches(&quot;foobar&quot;, &quot;^fo*bar&quot;)\n// true\n</code></pre>\n'},{name:"matches(input, pattern, flags)",description:'<p>Returns <code>true</code> if the given value matches the <code>pattern</code>. Otherwise, returns <code>false</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">matches(input: string, pattern: string, flags: string): boolean\n</code></pre>\n<p>The <code>pattern</code> is a string that contains a regular expression.</p>\n<p>The <code>flags</code> can contain one or more of the following characters:</p>\n<ul>\n<li><code>s</code> (dot-all)</li>\n<li><code>m</code> (multi-line)</li>\n<li><code>i</code> (case insensitive)</li>\n<li><code>x</code> (comments)</li>\n</ul>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">matches(&quot;FooBar&quot;, &quot;foo&quot;, &quot;i&quot;)\n// true\n</code></pre>\n'},{name:"replace(input, pattern, replacement)",description:'<p>Returns the resulting string after replacing all occurrences of <code>pattern</code> with <code>replacement</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">replace(input: string, pattern: string, replacement: string): string\n</code></pre>\n<p>The <code>pattern</code> is a string that contains a regular expression.</p>\n<p>The <code>replacement</code> can access the match groups by using <code>$</code> and the number of the group, for example,\n<code>$1</code> to access the first group.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">replace(&quot;abcd&quot;, &quot;(ab)|(a)&quot;, &quot;[1=$1][2=$2]&quot;)\n// &quot;[1=ab][2=]cd&quot;\n\nreplace(&quot;0123456789&quot;, &quot;(\\d{3})(\\d{3})(\\d{4})&quot;, &quot;($1) $2-$3&quot;)\n// &quot;(012) 345-6789&quot;\n</code></pre>\n'},{name:"replace(input, pattern, replacement, flags)",description:'<p>Returns the resulting string after replacing all occurrences of <code>pattern</code> with <code>replacement</code>.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">replace(input: string, pattern: string, replacement: string, flags: string): string\n</code></pre>\n<p>The <code>pattern</code> is a string that contains a regular expression.</p>\n<p>The <code>replacement</code> can access the match groups by using <code>$</code> and the number of the group, for example,\n<code>$1</code> to access the first group.</p>\n<p>The <code>flags</code> can contain one or more of the following characters:</p>\n<ul>\n<li><code>s</code> (dot-all)</li>\n<li><code>m</code> (multi-line)</li>\n<li><code>i</code> (case insensitive)</li>\n<li><code>x</code> (comments)</li>\n</ul>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">replace(&quot;How do you feel?&quot;, &quot;Feel&quot;, &quot;FEEL&quot;, &quot;i&quot;)\n// &quot;How do you FEEL?&quot;\n</code></pre>\n'},{name:"split(string, delimiter)",description:'<p>Splits the given value into a list of substrings, breaking at each occurrence of the <code>delimiter</code> pattern.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">split(string: string, delimiter: string): list&lt;string&gt;\n</code></pre>\n<p>The <code>delimiter</code> is a string that contains a regular expression.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">split(&quot;John Doe&quot;, &quot;\\s&quot; )\n// [&quot;John&quot;, &quot;Doe&quot;]\n\nsplit(&quot;a;b;c;;&quot;, &quot;;&quot;)\n// [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;&quot;, &quot;&quot;]\n</code></pre>\n'},{name:"extract(string, pattern)",description:'<p><em>Camunda Extension</em></p>\n<p>Returns all matches of the pattern in the given string. Returns an empty list if the pattern doesn&#39;t\nmatch.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">extract(string: string, pattern: string): list&lt;string&gt;\n</code></pre>\n<p>The <code>pattern</code> is a string that contains a regular expression.</p>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">extract(&quot;references are 1234, 1256, 1378&quot;, &quot;12[0-9]*&quot;)\n// [&quot;1234&quot;,&quot;1256&quot;]\n</code></pre>\n'},{name:"now()",description:'<p>Returns the current date and time including the timezone.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">now(): date and time\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">now()\n// date and time(&quot;2020-07-31T14:27:30@Europe/Berlin&quot;)\n</code></pre>\n'},{name:"today()",description:'<p>Returns the current date.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">today(): date\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">today()\n// date(&quot;2020-07-31&quot;)\n</code></pre>\n'},{name:"day of week(date)",description:'<p>Returns the day of the week according to the Gregorian calendar. Note that it always returns the English name of the day.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">day of week(date: date): string\n</code></pre>\n<pre><code class="language-feel">day of week(date: date and time): string\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">day of week(date(&quot;2019-09-17&quot;))\n// &quot;Tuesday&quot;\n\nday of week(date and time(&quot;2019-09-17T12:00:00&quot;))\n// &quot;Tuesday&quot;\n</code></pre>\n'},{name:"day of year(date)",description:'<p>Returns the Gregorian number of the day within the year.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">day of year(date: date): number\n</code></pre>\n<pre><code class="language-feel">day of year(date: date and time): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">day of year(date(&quot;2019-09-17&quot;))\n// 260\n\nday of year(date and time(&quot;2019-09-17T12:00:00&quot;))\n// 260\n</code></pre>\n'},{name:"week of year(date)",description:'<p>Returns the Gregorian number of the week within the year, according to ISO 8601.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">week of year(date: date): number\n</code></pre>\n<pre><code class="language-feel">week of year(date: date and time): number\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">week of year(date(&quot;2019-09-17&quot;))\n// 38\n\nweek of year(date and time(&quot;2019-09-17T12:00:00&quot;))\n// 38\n</code></pre>\n'},{name:"month of year(date)",description:'<p>Returns the month of the year according to the Gregorian calendar. Note that it always returns the English name of the month.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">month of year(date: date): string\n</code></pre>\n<pre><code class="language-feel">month of year(date: date and time): string\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">month of year(date(&quot;2019-09-17&quot;))\n// &quot;September&quot;\n\nmonth of year(date and time(&quot;2019-09-17T12:00:00&quot;))\n// &quot;September&quot;\n</code></pre>\n'},{name:"abs(n)",description:'<p>Returns the absolute value of a given duration.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">abs(n: days and time duration): days and time duration\n</code></pre>\n<pre><code class="language-feel">abs(n: years and months duration): years and months duration\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">abs(duration(&quot;-PT5H&quot;))\n// &quot;duration(&quot;PT5H&quot;)&quot;\n\nabs(duration(&quot;PT5H&quot;))\n// &quot;duration(&quot;PT5H&quot;)&quot;\n\nabs(duration(&quot;-P2M&quot;))\n// duration(&quot;P2M&quot;)\n</code></pre>\n'},{name:"last day of month(date)",description:'<p><em>Camunda Extension</em></p>\n<p>Takes the month of the given date or date-time value and returns the last day of this month.</p>\n<p><strong>Function signature</strong></p>\n<pre><code class="language-feel">last day of month(date: date): date\n</code></pre>\n<pre><code class="language-feel">last day of month(date: date and time): date\n</code></pre>\n<p><strong>Examples</strong></p>\n<pre><code class="language-feel">last day of month(date(&quot;2022-10-01&quot;))\n// date(&quot;2022-10-31&quot;))\n\nlast day of month(date and time(&quot;2022-10-16T12:00:00&quot;))\n// date(&quot;2022-10-31&quot;))\n</code></pre>\n'}].map(t=>{const e=t.name.match(/^([\w\s]+)\((.*)\)$/);return Zd(`${e[1]}(${e[2].split(", ").map(t=>`\${${t}}`).join(", ")})`,{label:t.name,type:"function",info:()=>E(`<div class="description">${t.description}<div>`),boost:-1})});var Fm=t=>{let e=Uh(t.state).resolve(t.pos,-1),n=e.nextSibling;return Lm(e)||n&&n.from===t.pos&&Lm(n)?t.explicit?{from:t.pos,options:qm}:null:e.parent&&"VariableName"!==e.parent.name||Im(e)?null:{from:e.from,options:qm}};const Vm=Qr.define();var jm=t=>{const e=t.state.facet(Vm)[0],n=Uh(t.state).resolve(t.pos,-1);if(!Im(n))return;const i=function(t){for(;t;){if("PathExpression"===t.name)return t;t=t.parent}}(n),r=n===i?t.pos:n.from,o=Hm(i,t);let s=e;for(var a=0;a<o.length-1;a++){var l=s.find(t=>t.name===o[a].name);if(!l)return null;if("optional"!==l.isList&&!!l.isList!==o[a].isList)return;s=l.entries}return s?(s=s.map(t=>({label:t.name,type:"variable",info:t.info,detail:t.detail})),{from:r,options:s}):void 0};function Hm(t,e){let n=[];for(let i=t.firstChild;i;i=i.nextSibling)"PathExpression"===i.name?n.push(...Hm(i,e)):"FilterExpression"===i.name?n.push(...zm(i,e)):n.push({name:Qm(i,e),isList:!1});return n}function zm(t,e){const n=t.firstChild;if("PathExpression"===n.name){const t=Hm(n,e);return t[t.length-1].isList=!0,t}return[{name:Qm(n,e),isList:!0}]}function Qm(t,e){return e.state.sliceDoc(t.from,t.to)}var Wm=t=>{const e=t.state.facet(Vm)[0].map(t=>({label:t.name,type:"variable",info:t.info,detail:t.detail}));let n=Uh(t.state).resolve(t.pos,-1),i=n.nextSibling;if(Lm(n)||i&&i.from===t.pos&&Lm(i))return t.explicit?{from:t.pos,options:e}:null;const r={from:n.from,options:e};return n.parent&&"VariableName"!==n.parent.name||Im(n)?null:r};function Xm(){return[gp({override:[Wm,Fm,Ju(Mm.map(t=>({...t,boost:-1}))),jm,...Rm]})]}var Um=[qf(im())],Gm=[Qc.theme({"& .cm-content":{padding:"0px"},"& .cm-line":{padding:"0px"},"&.cm-editor.cm-focused":{outline:"none"},"& .cm-completionInfo":{whiteSpace:"pre-wrap",overflow:"hidden",textOverflow:"ellipsis"},"& .cm-completionInfo > *":{whiteSpace:"normal"},"& .cm-completionInfo ul":{margin:0,paddingLeft:"15px"},"& .cm-completionInfo pre":{marginBottom:0,whiteSpace:"pre-wrap"},"& .cm-completionInfo p":{marginTop:0},"& .cm-completionInfo p:not(:last-of-type)":{marginBottom:0}}),Qc.baseTheme({"& .variableName":{color:"#10f"},"& .number":{color:"#164"},"& .string":{color:"#a11"},"& .bool":{color:"#219"},"& .function":{color:"#aa3731",fontWeight:"bold"},"& .control":{color:"#708"}}),Cu(Ou.define([{tag:ci.variableName,class:"variableName"},{tag:ci.name,class:"variableName"},{tag:ci.number,class:"number"},{tag:ci.string,class:"string"},{tag:ci.bool,class:"bool"},{tag:ci.function(ci.variableName),class:"function"},{tag:ci.function(ci.special(ci.variableName)),class:"function"},{tag:ci.controlKeyword,class:"control"},{tag:ci.operatorKeyword,class:"control"}]))];const Ym=new no;function Zm({extensions:t=[],container:e,contentAttributes:n={},tooltipContainer:i,onChange:r=()=>{},onKeyDown:o=()=>{},onLint:s=()=>{},readOnly:a=!1,value:l="",variables:c=[]}){const h=Qc.updateListener.of(t=>{t.docChanged&&r(t.state.doc.toString())}),u=Qc.updateListener.of(t=>{const e=t.transactions.flatMap(t=>t.effects).filter(t=>t.is(Tf));if(!e.length)return;const n=e.flatMap(t=>t.value);s(n)}),d=Qc.domEventHandlers({keydown:o});"string"==typeof i&&(i=document.querySelector(i));const p=i?oh({tooltipSpace:function(){return i.getBoundingClientRect()}}):[],f=[Ym.of(Vm.of(c)),Xm(),Iu(),h,ip(),Qc.contentAttributes.of(n),xu(),d,Jc.of([..._f]),new ru($m,[]),Um,u,p,Gm,...t];return a&&f.push(Qc.editable.of(!1)),this._cmEditor=new Qc({state:To.create({doc:l,extensions:f}),parent:e}),this}Zm.prototype.setValue=function(t){this._cmEditor.dispatch({changes:{from:0,to:this._cmEditor.state.doc.length,insert:t}})},Zm.prototype.focus=function(t){const e=this._cmEditor;if(e.contentDOM.focus(),e.focus(),"number"==typeof t){const n=e.state.doc.length;e.dispatch({selection:{anchor:t<=n?t:n}})}},Zm.prototype.getSelection=function(){return this._cmEditor.state.selection},Zm.prototype.setVariables=function(t){this._cmEditor.dispatch({effects:Ym.reconfigure(Vm.of(t))})};var Km=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],Jm=Km.join(","),tv="undefined"==typeof Element,ev=tv?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,nv=!tv&&Element.prototype.getRootNode?function(t){var e;return null==t||null===(e=t.getRootNode)||void 0===e?void 0:e.call(t)}:function(t){return null==t?void 0:t.ownerDocument},iv=function t(e,n){var i;void 0===n&&(n=!0);var r=null==e||null===(i=e.getAttribute)||void 0===i?void 0:i.call(e,"inert");return""===r||"true"===r||n&&e&&t(e.parentNode)},rv=function(t,e,n){if(iv(t))return[];var i=Array.prototype.slice.apply(t.querySelectorAll(Jm));return e&&ev.call(t,Jm)&&i.unshift(t),i.filter(n)},ov=function t(e,n,i){for(var r=[],o=Array.from(e);o.length;){var s=o.shift();if(!iv(s,!1))if("SLOT"===s.tagName){var a=s.assignedElements(),l=t(a.length?a:s.children,!0,i);i.flatten?r.push.apply(r,l):r.push({scopeParent:s,candidates:l})}else{ev.call(s,Jm)&&i.filter(s)&&(n||!e.includes(s))&&r.push(s);var c=s.shadowRoot||"function"==typeof i.getShadowRoot&&i.getShadowRoot(s),h=!iv(c,!1)&&(!i.shadowRootFilter||i.shadowRootFilter(s));if(c&&h){var u=t(!0===c?s.children:c.children,!0,i);i.flatten?r.push.apply(r,u):r.push({scopeParent:s,candidates:u})}else o.unshift.apply(o,s.children)}}return r},sv=function(t){return!isNaN(parseInt(t.getAttribute("tabindex"),10))},av=function(t){if(!t)throw new Error("No node provided");return t.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(t.tagName)||function(t){var e,n=null==t||null===(e=t.getAttribute)||void 0===e?void 0:e.call(t,"contenteditable");return""===n||"true"===n}(t))&&!sv(t)?0:t.tabIndex},lv=function(t,e){return t.tabIndex===e.tabIndex?t.documentOrder-e.documentOrder:t.tabIndex-e.tabIndex},cv=function(t){return"INPUT"===t.tagName},hv=function(t){var e=t.getBoundingClientRect(),n=e.width,i=e.height;return 0===n&&0===i},uv=function(t,e){return!(e.disabled||iv(e)||function(t){return cv(t)&&"hidden"===t.type}(e)||function(t,e){var n=e.displayCheck,i=e.getShadowRoot;if("hidden"===getComputedStyle(t).visibility)return!0;var r=ev.call(t,"details>summary:first-of-type")?t.parentElement:t;if(ev.call(r,"details:not([open]) *"))return!0;if(n&&"full"!==n&&"legacy-full"!==n){if("non-zero-area"===n)return hv(t)}else{if("function"==typeof i){for(var o=t;t;){var s=t.parentElement,a=nv(t);if(s&&!s.shadowRoot&&!0===i(s))return hv(t);t=t.assignedSlot?t.assignedSlot:s||a===t.ownerDocument?s:a.host}t=o}if(function(t){var e,n,i,r,o=t&&nv(t),s=null===(e=o)||void 0===e?void 0:e.host,a=!1;if(o&&o!==t)for(a=!!(null!==(n=s)&&void 0!==n&&null!==(i=n.ownerDocument)&&void 0!==i&&i.contains(s)||null!=t&&null!==(r=t.ownerDocument)&&void 0!==r&&r.contains(t));!a&&s;){var l,c,h;a=!(null===(c=s=null===(l=o=nv(s))||void 0===l?void 0:l.host)||void 0===c||null===(h=c.ownerDocument)||void 0===h||!h.contains(s))}return a}(t))return!t.getClientRects().length;if("legacy-full"!==n)return!0}return!1}(e,t)||function(t){return"DETAILS"===t.tagName&&Array.prototype.slice.apply(t.children).some(function(t){return"SUMMARY"===t.tagName})}(e)||function(t){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(t.tagName))for(var e=t.parentElement;e;){if("FIELDSET"===e.tagName&&e.disabled){for(var n=0;n<e.children.length;n++){var i=e.children.item(n);if("LEGEND"===i.tagName)return!!ev.call(e,"fieldset[disabled] *")||!i.contains(t)}return!0}e=e.parentElement}return!1}(e))},dv=function(t,e){return!(function(t){return function(t){return cv(t)&&"radio"===t.type}(t)&&!function(t){if(!t.name)return!0;var e,n=t.form||nv(t),i=function(t){return n.querySelectorAll('input[type="radio"][name="'+t+'"]')};if("undefined"!=typeof window&&void 0!==window.CSS&&"function"==typeof window.CSS.escape)e=i(window.CSS.escape(t.name));else try{e=i(t.name)}catch(t){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",t.message),!1}var r=function(t,e){for(var n=0;n<t.length;n++)if(t[n].checked&&t[n].form===e)return t[n]}(e,t.form);return!r||r===t}(t)}(e)||av(e)<0||!uv(t,e))},pv=function(t){var e=parseInt(t.getAttribute("tabindex"),10);return!!(isNaN(e)||e>=0)},fv=function t(e){var n=[],i=[];return e.forEach(function(e,r){var o=!!e.scopeParent,s=o?e.scopeParent:e,a=function(t,e){var n=av(t);return n<0&&e&&!sv(t)?0:n}(s,o),l=o?t(e.candidates):s;0===a?o?n.push.apply(n,l):n.push(s):i.push({documentOrder:r,tabIndex:a,item:e,isScope:o,content:l})}),i.sort(lv).reduce(function(t,e){return e.isScope?t.push.apply(t,e.content):t.push(e.content),t},[]).concat(n)},gv=function(t,e){if(e=e||{},!t)throw new Error("No node provided");return!1!==ev.call(t,Jm)&&dv(e,t)},mv=Km.concat("iframe").join(","),vv=function(t,e){if(e=e||{},!t)throw new Error("No node provided");return!1!==ev.call(t,mv)&&uv(e,t)};function yv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function bv(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?yv(Object(n),!0).forEach(function(e){var i,r,o;i=t,r=e,o=n[e],(r=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(r))in i?Object.defineProperty(i,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):i[r]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yv(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var xv=function(t){return"Tab"===(null==t?void 0:t.key)||9===(null==t?void 0:t.keyCode)},wv=function(t){return xv(t)&&!t.shiftKey},_v=function(t){return xv(t)&&t.shiftKey},Ov=function(t){return setTimeout(t,0)},kv=function(t,e){var n=-1;return t.every(function(t,i){return!e(t)||(n=i,!1)}),n},Sv=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return"function"==typeof t?t.apply(void 0,n):t},Ev=function(t){return t.target.shadowRoot&&"function"==typeof t.composedPath?t.composedPath()[0]:t.target},Cv=[],Av=function(t,e){var n,i=(null==e?void 0:e.document)||document,r=(null==e?void 0:e.trapStack)||Cv,o=bv({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:wv,isKeyBackward:_v},e),s={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0,recentNavEvent:void 0},a=function(t,e,n){return t&&void 0!==t[e]?t[e]:o[n||e]},l=function(t,e){var n="function"==typeof(null==e?void 0:e.composedPath)?e.composedPath():void 0;return s.containerGroups.findIndex(function(e){var i=e.container,r=e.tabbableNodes;return i.contains(t)||(null==n?void 0:n.includes(i))||r.find(function(e){return e===t})})},c=function(t){var e=o[t];if("function"==typeof e){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];e=e.apply(void 0,r)}if(!0===e&&(e=void 0),!e){if(void 0===e||!1===e)return e;throw new Error("`".concat(t,"` was specified but was not a node, or did not return a node"))}var a=e;if("string"==typeof e&&!(a=i.querySelector(e)))throw new Error("`".concat(t,"` as selector refers to no known node"));return a},h=function(){var t=c("initialFocus");if(!1===t)return!1;if(void 0===t||!vv(t,o.tabbableOptions))if(l(i.activeElement)>=0)t=i.activeElement;else{var e=s.tabbableGroups[0];t=e&&e.firstTabbableNode||c("fallbackFocus")}if(!t)throw new Error("Your focus-trap needs to have at least one focusable element");return t},u=function(){if(s.containerGroups=s.containers.map(function(t){var e=function(t,e){var n;return n=(e=e||{}).getShadowRoot?ov([t],e.includeContainer,{filter:dv.bind(null,e),flatten:!1,getShadowRoot:e.getShadowRoot,shadowRootFilter:pv}):rv(t,e.includeContainer,dv.bind(null,e)),fv(n)}(t,o.tabbableOptions),n=function(t,e){return(e=e||{}).getShadowRoot?ov([t],e.includeContainer,{filter:uv.bind(null,e),flatten:!0,getShadowRoot:e.getShadowRoot}):rv(t,e.includeContainer,uv.bind(null,e))}(t,o.tabbableOptions),i=e.length>0?e[0]:void 0,r=e.length>0?e[e.length-1]:void 0,s=n.find(function(t){return gv(t)}),a=n.slice().reverse().find(function(t){return gv(t)}),l=!!e.find(function(t){return av(t)>0});return{container:t,tabbableNodes:e,focusableNodes:n,posTabIndexesFound:l,firstTabbableNode:i,lastTabbableNode:r,firstDomTabbableNode:s,lastDomTabbableNode:a,nextTabbableNode:function(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.indexOf(t);return r<0?i?n.slice(n.indexOf(t)+1).find(function(t){return gv(t)}):n.slice(0,n.indexOf(t)).reverse().find(function(t){return gv(t)}):e[r+(i?1:-1)]}}}),s.tabbableGroups=s.containerGroups.filter(function(t){return t.tabbableNodes.length>0}),s.tabbableGroups.length<=0&&!c("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");if(s.containerGroups.find(function(t){return t.posTabIndexesFound})&&s.containerGroups.length>1)throw new Error("At least one node with a positive tabindex was found in one of your focus-trap's multiple containers. Positive tabindexes are only supported in single-container focus-traps.")},d=function t(e){!1!==e&&e!==i.activeElement&&(e&&e.focus?(e.focus({preventScroll:!!o.preventScroll}),s.mostRecentlyFocusedNode=e,function(t){return t.tagName&&"input"===t.tagName.toLowerCase()&&"function"==typeof t.select}(e)&&e.select()):t(h()))},p=function(t){var e=c("setReturnFocus",t);return e||!1!==e&&t},f=function(t){var e=t.target,n=t.event,i=t.isBackward,r=void 0!==i&&i;e=e||Ev(n),u();var a=null;if(s.tabbableGroups.length>0){var h=l(e,n),d=h>=0?s.containerGroups[h]:void 0;if(h<0)a=r?s.tabbableGroups[s.tabbableGroups.length-1].lastTabbableNode:s.tabbableGroups[0].firstTabbableNode;else if(r){var p=kv(s.tabbableGroups,function(t){var n=t.firstTabbableNode;return e===n});if(p<0&&(d.container===e||vv(e,o.tabbableOptions)&&!gv(e,o.tabbableOptions)&&!d.nextTabbableNode(e,!1))&&(p=h),p>=0){var f=0===p?s.tabbableGroups.length-1:p-1,g=s.tabbableGroups[f];a=av(e)>=0?g.lastTabbableNode:g.lastDomTabbableNode}else xv(n)||(a=d.nextTabbableNode(e,!1))}else{var m=kv(s.tabbableGroups,function(t){var n=t.lastTabbableNode;return e===n});if(m<0&&(d.container===e||vv(e,o.tabbableOptions)&&!gv(e,o.tabbableOptions)&&!d.nextTabbableNode(e))&&(m=h),m>=0){var v=m===s.tabbableGroups.length-1?0:m+1,y=s.tabbableGroups[v];a=av(e)>=0?y.firstTabbableNode:y.firstDomTabbableNode}else xv(n)||(a=d.nextTabbableNode(e))}}else a=c("fallbackFocus");return a},g=function(t){var e=Ev(t);l(e,t)>=0||(Sv(o.clickOutsideDeactivates,t)?n.deactivate({returnFocus:o.returnFocusOnDeactivate}):Sv(o.allowOutsideClick,t)||t.preventDefault())},m=function(t){var e=Ev(t),n=l(e,t)>=0;if(n||e instanceof Document)n&&(s.mostRecentlyFocusedNode=e);else{var i;t.stopImmediatePropagation();var r=!0;if(s.mostRecentlyFocusedNode)if(av(s.mostRecentlyFocusedNode)>0){var a=l(s.mostRecentlyFocusedNode),c=s.containerGroups[a].tabbableNodes;if(c.length>0){var u=c.findIndex(function(t){return t===s.mostRecentlyFocusedNode});u>=0&&(o.isKeyForward(s.recentNavEvent)?u+1<c.length&&(i=c[u+1],r=!1):u-1>=0&&(i=c[u-1],r=!1))}}else s.containerGroups.some(function(t){return t.tabbableNodes.some(function(t){return av(t)>0})})||(r=!1);else r=!1;r&&(i=f({target:s.mostRecentlyFocusedNode,isBackward:o.isKeyBackward(s.recentNavEvent)})),d(i||s.mostRecentlyFocusedNode||h())}s.recentNavEvent=void 0},v=function(t){if(function(t){return"Escape"===(null==t?void 0:t.key)||"Esc"===(null==t?void 0:t.key)||27===(null==t?void 0:t.keyCode)}(t)&&!1!==Sv(o.escapeDeactivates,t))return t.preventDefault(),void n.deactivate();(o.isKeyForward(t)||o.isKeyBackward(t))&&function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];s.recentNavEvent=t;var n=f({event:t,isBackward:e});n&&(xv(t)&&t.preventDefault(),d(n))}(t,o.isKeyBackward(t))},y=function(t){var e=Ev(t);l(e,t)>=0||Sv(o.clickOutsideDeactivates,t)||Sv(o.allowOutsideClick,t)||(t.preventDefault(),t.stopImmediatePropagation())},b=function(){if(s.active)return function(t,e){if(t.length>0){var n=t[t.length-1];n!==e&&n.pause()}var i=t.indexOf(e);-1===i||t.splice(i,1),t.push(e)}(r,n),s.delayInitialFocusTimer=o.delayInitialFocus?Ov(function(){d(h())}):d(h()),i.addEventListener("focusin",m,!0),i.addEventListener("mousedown",g,{capture:!0,passive:!1}),i.addEventListener("touchstart",g,{capture:!0,passive:!1}),i.addEventListener("click",y,{capture:!0,passive:!1}),i.addEventListener("keydown",v,{capture:!0,passive:!1}),n},x=function(){if(s.active)return i.removeEventListener("focusin",m,!0),i.removeEventListener("mousedown",g,!0),i.removeEventListener("touchstart",g,!0),i.removeEventListener("click",y,!0),i.removeEventListener("keydown",v,!0),n},w="undefined"!=typeof window&&"MutationObserver"in window?new MutationObserver(function(t){t.some(function(t){return Array.from(t.removedNodes).some(function(t){return t===s.mostRecentlyFocusedNode})})&&d(h())}):void 0,_=function(){w&&(w.disconnect(),s.active&&!s.paused&&s.containers.map(function(t){w.observe(t,{subtree:!0,childList:!0})}))};return n={get active(){return s.active},get paused(){return s.paused},activate:function(t){if(s.active)return this;var e=a(t,"onActivate"),n=a(t,"onPostActivate"),r=a(t,"checkCanFocusTrap");r||u(),s.active=!0,s.paused=!1,s.nodeFocusedBeforeActivation=i.activeElement,null==e||e();var o=function(){r&&u(),b(),_(),null==n||n()};return r?(r(s.containers.concat()).then(o,o),this):(o(),this)},deactivate:function(t){if(!s.active)return this;var e=bv({onDeactivate:o.onDeactivate,onPostDeactivate:o.onPostDeactivate,checkCanReturnFocus:o.checkCanReturnFocus},t);clearTimeout(s.delayInitialFocusTimer),s.delayInitialFocusTimer=void 0,x(),s.active=!1,s.paused=!1,_(),function(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1),t.length>0&&t[t.length-1].unpause()}(r,n);var i=a(e,"onDeactivate"),l=a(e,"onPostDeactivate"),c=a(e,"checkCanReturnFocus"),h=a(e,"returnFocus","returnFocusOnDeactivate");null==i||i();var u=function(){Ov(function(){h&&d(p(s.nodeFocusedBeforeActivation)),null==l||l()})};return h&&c?(c(p(s.nodeFocusedBeforeActivation)).then(u,u),this):(u(),this)},pause:function(t){if(s.paused||!s.active)return this;var e=a(t,"onPause"),n=a(t,"onPostPause");return s.paused=!0,null==e||e(),x(),_(),null==n||n(),this},unpause:function(t){if(!s.paused||!s.active)return this;var e=a(t,"onUnpause"),n=a(t,"onPostUnpause");return s.paused=!1,null==e||e(),u(),b(),_(),null==n||n(),this},updateContainerElements:function(t){var e=[].concat(t).filter(Boolean);return s.containers=e.map(function(t){return"string"==typeof t?i.querySelector(t):t}),s.active&&u(),_(),this}},n.updateContainerElements(t),n},Tv=function(t){return fe("svg",{...t,children:[fe("path",{fill:"#fff",style:{mixBlendMode:"multiply"},d:"M0 0h16v16H0z"}),fe("path",{fill:"#fff",style:{mixBlendMode:"multiply"},d:"M0 0h16v16H0z"}),fe("path",{d:"M7 3H5v2h2V3zm4 0H9v2h2V3zM7 7H5v2h2V7zm4 0H9v2h2V7zm-4 4H5v2h2v-2zm4 0H9v2h2v-2z",fill:"#161616"})]})};Tv.defaultProps={width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};var Pv=function(t){return fe("svg",{...t,children:fe("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.637 12.637v-4.72h1.362v4.721c0 .36-.137.676-.411.95-.275.275-.591.412-.95.412H3.362c-.38 0-.703-.132-.967-.396A1.315 1.315 0 0 1 2 12.638V3.362c0-.38.132-.703.396-.967S2.982 2 3.363 2h4.553v1.363H3.363v9.274h9.274ZM14 2H9.28l-.001 1.362h2.408L5.065 9.984l.95.95 6.622-6.622v2.409H14V2Z",fill:"currentcolor"})})};Pv.defaultProps={width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};var Mv=function(t){return fe("svg",{...t,children:[fe("path",{fill:"currentColor",d:"M28 4H10a2.006 2.006 0 0 0-2 2v14a2.006 2.006 0 0 0 2 2h18a2.006 2.006 0 0 0 2-2V6a2.006 2.006 0 0 0-2-2Zm0 16H10V6h18Z"}),fe("path",{fill:"currentColor",d:"M18 26H4V16h2v-2H4a2.006 2.006 0 0 0-2 2v10a2.006 2.006 0 0 0 2 2h14a2.006 2.006 0 0 0 2-2v-2h-2Z"})]})};Mv.defaultProps={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 32 32"},ht({description:{},getDescriptionForId:()=>{}}),ht({errors:{}});const Nv=ht({eventBus:null});ht({layout:{},setLayout:()=>{},getLayoutForKey:()=>{},setLayoutForKey:()=>{}});const Rv=ht({tooltip:{},getTooltipForId:()=>{}});function Dv(t){const{forId:e,element:n}=t,i=function(t,e){const{getTooltipForId:n}=At(Rv);return n(t,e)}(e,n),r=t.value||i;return r?fe(Bv,{...t,value:r,forId:Iv(e)}):t.children}function Bv(t){const{forId:e,value:n,parent:i,direction:r="right",position:o}=t,[s,a]=kt(!1),[l,c]=kt(!1);let h=null;const u=Et(null),d=Et(null),p=async t=>{const e=()=>a(!0);s||h||(t instanceof MouseEvent?h=setTimeout(e,200):(e(),c(!0)))},f=()=>{a(!1),c(!1)};St(()=>{const{current:t}=u;if(!t)return;const e=t=>{const e=document.activeElement===u.current||document.activeElement.closest(".bio-properties-panel-tooltip");!s||(({x:t,y:e})=>{const n=d.current,i=u.current;return n&&($v(t,e,i.getBoundingClientRect())||$v(t,e,n.getBoundingClientRect()))})({x:t.x,y:t.y})||e&&l||f()},n=t=>{const{relatedTarget:e}=t;s&&!u.current.matches(":hover")&&e&&!e.closest(".bio-properties-panel-tooltip")&&f()};return document.addEventListener("wheel",e),document.addEventListener("focusout",n),document.addEventListener("mousemove",e),()=>{document.removeEventListener("wheel",e),document.removeEventListener("mousemove",e),document.removeEventListener("focusout",n)}},[u.current,s,l]);const g=()=>fe("div",{class:`bio-properties-panel-tooltip ${r}`,role:"tooltip",id:"bio-properties-panel-tooltip","aria-labelledby":e,style:o||Lv(u.current),ref:d,onClick:t=>t.stopPropagation(),children:[fe("div",{class:"bio-properties-panel-tooltip-content",children:n}),fe("div",{class:"bio-properties-panel-tooltip-arrow"})]});return fe("div",{class:"bio-properties-panel-tooltip-wrapper",tabIndex:"0",ref:u,onMouseEnter:p,onMouseLeave:()=>{clearTimeout(h),h=null},onFocus:p,onKeyDown:t=>{"Escape"===t.code&&f()},children:[t.children,s?i?Kt(g(),i.current):g():null]})}function $v(t,e,n){const{top:i,right:r,bottom:o,left:s}=n;return t>=s&&t<=r&&e>=i&&e<=o}function Lv(t){const e=t.getBoundingClientRect();return`right: calc(100% - ${e.x}px); top: ${e.top-10+"px"};`}function Iv(t){return`bio-properties-panel-${t}`}function qv(t){const e=Et(t);return e.current=t,function(t){return gt=8,Ct(function(){return t},[])}((...t)=>e.current(...t))}const Fv=()=>{};Vt((t,e)=>{const{onInput:n,disabled:i,tooltipContainer:r,enableGutters:o,value:s,onLint:a=Fv,onPopupOpen:l=Fv,popupOpen:c,contentAttributes:h={},hostLanguage:u=null,singleLine:d=!1}=t,p=Et(),[f,g]=kt(),[m,v]=kt(s||"");!function(t,e){const[n,i]=kt(void 0);e.current=Ct(()=>({focus:e=>{t?t.focus(e):(void 0===e&&(e=1/0),i(e))}}),[t]),St(()=>{void 0!==n&&t&&(t.focus(n),i(!1))},[t,n])}(f,e);const y=qv(t=>{n(t),v(t)});return St(()=>{let t;return t=new Pm({container:p.current,onChange:y,value:m,onLint:a,contentAttributes:h,tooltipContainer:r,enableGutters:o,hostLanguage:u,singleLine:d}),g(t),()=>{a([]),p.current.innerHTML="",g(null)}},[]),St(()=>{f&&s!==m&&(f.setValue(s),v(s))},[s]),fe("div",{class:xe("bio-properties-panel-feelers-editor-container",c?"popupOpen":null),children:[fe("div",{class:"bio-properties-panel-feelers-editor__open-popup-placeholder",children:"Opened in editor"}),fe("div",{name:t.name,class:xe("bio-properties-panel-feelers-editor bio-properties-panel-input",m?"edited":null,i?"disabled":null),ref:p,onClick:()=>{e.current.focus()}}),fe("button",{type:"button",title:"Open pop-up editor",class:"bio-properties-panel-open-feel-popup",onClick:()=>l("feelers"),children:fe(Pv,{})})]})});const Vv=()=>{};function jv(t){t.preventDefault(),t.stopPropagation()}Vt((t,e)=>{const{contentAttributes:n,enableGutters:i,value:r,onInput:o,onFeelToggle:s=Vv,onLint:a=Vv,onPopupOpen:l=Vv,popupOpen:c,disabled:h,tooltipContainer:u,variables:d}=t,p=Et(),[f,g]=kt(),[m,v]=kt(r||"");!function(t,e){const[n,i]=kt(void 0);e.current=Ct(()=>({focus:e=>{t?t.focus(e):(void 0===e&&(e=1/0),i(e))}}),[t]),St(()=>{void 0!==n&&t&&(t.focus(n),i(!1))},[t,n])}(f,e);const y=qv(t=>{o(t),v(t)});return St(()=>{let t;return t=new Zm({container:p.current,onChange:y,onKeyDown:e=>{if("Backspace"!==e.key||!t)return;const n=t.getSelection(),i=n.ranges[n.mainIndex];0===i.from&&0===i.to&&s()},onLint:a,tooltipContainer:u,value:m,variables:d,extensions:[...i?[Fh()]:[],Qc.lineWrapping],contentAttributes:n}),g(t),()=>{a([]),p.current.innerHTML="",g(null)}},[]),St(()=>{f&&r!==m&&(f.setValue(r),v(r))},[r]),St(()=>{f&&f.setVariables(d)},[d]),fe("div",{class:xe("bio-properties-panel-feel-editor-container",h?"disabled":null,c?"popupOpen":null),children:[fe("div",{class:"bio-properties-panel-feel-editor__open-popup-placeholder",children:"Opened in editor"}),fe("div",{name:t.name,class:xe("bio-properties-panel-input",m?"edited":null),ref:p,onClick:()=>{e.current.focus()}}),fe("button",{type:"button",title:"Open pop-up editor",class:"bio-properties-panel-open-feel-popup",onClick:()=>l(),children:fe(Mv,{})})]})}),ht({open:()=>{},close:()=>{},source:null});const Hv=()=>{},zv=Vt(function(t,e){const{container:n,className:i,delayInitialFocus:r,position:o,width:s,height:a,onClose:l,onPostActivate:c=Hv,onPostDeactivate:h=Hv,returnFocus:u=!0,closeOnEscape:d=!0,title:p}=t,f=Et(null),g=Et(null),m=e||g,v=Ct(()=>{return"string"==typeof(t=n)?C(t):t;var t},[n]),y=()=>{f.current&&f.current.activate()};let b={};return o&&(b={...b,top:o.top+"px",left:o.left+"px"}),s&&(b.width=s+"px"),a&&(b.height=a+"px"),St(()=>(m.current&&m.current.addEventListener("focusin",y),()=>{m.current.removeEventListener("focusin",y)}),[m]),St(()=>(m.current&&(f.current=Av(m.current,{clickOutsideDeactivates:!0,delayInitialFocus:r,fallbackFocus:m.current,onPostActivate:c,onPostDeactivate:h,returnFocusOnDeactivate:u}),f.current.activate()),()=>f.current&&f.current.deactivate()),[m]),function(t,e,n){const i=At(Nv);n||({eventBus:n}=i);const r=Et(!1);n&&!r.current&&n.on(t,e),St(()=>(n&&r.current&&n.on(t,e),r.current=!0,()=>{n&&n.off(t,e)}),[e,t,n])}("propertiesPanel.detach",l),Kt(fe("div",{"aria-label":p,tabIndex:-1,ref:m,onKeyDown:t=>{t.stopPropagation(),d&&"Escape"===t.key&&l()},role:"dialog",class:xe("bio-properties-panel-popup",i),style:b,children:t.children}),v||document.body)});function Qv(t){return t.closest(".bio-properties-panel-popup")}function Wv(t){const{id:e,label:n,onInput:i,value:r,switcherLabel:o,inline:s,onFocus:a,onBlur:l,inputRef:c,tooltip:h}=t,[u,d]=kt(r);return St(()=>{r!==u&&d(r)},[r]),fe("div",{class:xe("bio-properties-panel-toggle-switch",{inline:s}),children:[fe("label",{class:"bio-properties-panel-label",for:Xv(e),children:fe(Dv,{value:h,forId:e,element:t.element,children:n})}),fe("div",{class:"bio-properties-panel-field-wrapper",children:[fe("label",{class:"bio-properties-panel-toggle-switch__switcher",children:[fe("input",{ref:c,id:Xv(e),class:"bio-properties-panel-input",type:"checkbox",onFocus:a,onBlur:l,name:e,onInput:t=>{(async()=>{i(!r)})(),d(t.target.value)},checked:!!u}),fe("span",{class:"bio-properties-panel-toggle-switch__slider"})]}),o&&fe("p",{class:"bio-properties-panel-toggle-switch__label",children:o})]})]})}function Xv(t){return`bio-properties-panel-${t}`}function Uv(t){const{debounce:e,disabled:n,displayLabel:i=!0,id:r,inputRef:o,label:s,max:a,min:l,onInput:c,step:h,value:u="",onFocus:d,onBlur:p}=t,[f,g]=kt(u),m=Ct(()=>e(t=>{t.validity.valid&&c(t.value?parseFloat(t.value):void 0)}),[c,e]);return St(()=>{u!==f&&g(u)},[u]),fe("div",{class:"bio-properties-panel-numberfield",children:[i&&fe("label",{for:Gv(r),class:"bio-properties-panel-label",children:s}),fe("input",{id:Gv(r),ref:o,type:"number",name:r,spellCheck:"false",autoComplete:"off",disabled:n,class:"bio-properties-panel-input",max:a,min:l,onInput:t=>{m(t.target),g(t.target.value)},onFocus:d,onBlur:p,step:h,value:f})]})}function Gv(t){return`bio-properties-panel-${t}`}function Yv(t){return`bio-properties-panel-${t}`}zv.Title=function(t){const{children:e,className:n,draggable:i,emit:r=()=>{},title:o,...s}=t,a=Et({startPosition:null,newPosition:null}),l=Et(),c=Et(),h=(t,e)=>{!function(t){t.preventDefault(),t.stopPropagation()}(t);const{x:n,y:i}=e,o={x:a.current.startPosition.x+n,y:a.current.startPosition.y+i},s=Qv(c.current);s.style.top=o.y+"px",s.style.left=o.x+"px",r("dragover",{newPosition:o,delta:e})};return fe("div",{class:xe("bio-properties-panel-popup__header",i&&"draggable",n),ref:c,draggable:i,onDragStart:t=>{(function(t,e){let n,i,r;function o(e){const o={x:e.clientX-i,y:e.clientY-r};return t.call(n,e,o)}function s(){document.removeEventListener("dragover",o,!0),document.removeEventListener("dragenter",jv,!0),document.removeEventListener("dragend",s),document.removeEventListener("drop",jv)}return function(t){n=this,i=t.clientX,r=t.clientY,t.dataTransfer&&t.dataTransfer.setDragImage(e||E('<canvas width="0" height="0" />'),0,0),document.addEventListener("dragover",o,!0),document.addEventListener("dragenter",jv,!0),document.addEventListener("dragend",s),document.addEventListener("drop",jv)}})(h,l.current)(t),t.stopPropagation();const e=Qv(c.current).getBoundingClientRect();a.current.startPosition={x:e.left,y:e.top},r("dragstart")},onDragEnd:()=>{a.current.newPosition=null,r("dragend")},...s,children:[i&&fe(z,{children:[fe("div",{ref:l,class:"bio-properties-panel-popup__drag-preview"}),fe("div",{class:"bio-properties-panel-popup__drag-handle",children:fe(Tv,{})})]}),fe("div",{class:"bio-properties-panel-popup__title",children:o}),e]})},zv.Body=function(t){const{children:e,className:n,...i}=t;return fe("div",{class:xe("bio-properties-panel-popup__body",n),...i,children:e})},zv.Footer=function(t){const{children:e,className:n,...i}=t;return fe("div",{class:xe("bio-properties-panel-popup__footer",n),...i,children:t.children})},Vt((t,e)=>{const{id:n,disabled:i,onInput:r,value:o,onFocus:s,onBlur:a}=t,l=Et();return e.current={focus:t=>{const e=l.current;e&&(e.focus(),"number"==typeof t&&(t>o.length&&(t=o.length),e.setSelectionRange(t,t)))}},fe("input",{id:Yv(n),type:"text",ref:l,name:n,spellCheck:"false",autoComplete:"off",disabled:i,class:"bio-properties-panel-input",onInput:t=>r(t.target.value),onFocus:s,onBlur:a,value:o||""})}),Vt((t,e)=>{const{id:n,debounce:i,disabled:r,onInput:o,value:s,min:a,max:l,step:c,onFocus:h,onBlur:u}=t,d=Et();return e.current={focus:t=>{const e=d.current;e&&(e.focus(),"number"==typeof t&&t!==1/0&&(t>s.length&&(t=s.length),e.setSelectionRange(t,t)))}},fe(Uv,{id:n,debounce:i,disabled:r,displayLabel:!1,inputRef:d,max:l,min:a,onInput:o,step:c,value:s,onFocus:h,onBlur:u})}),Vt((t,e)=>{const{id:n,disabled:i,onInput:r,value:o,onFocus:s,onBlur:a}=t,l=Et();return e.current={focus:()=>{const t=l.current;t&&(t.focus(),t.setSelectionRange(0,0))}},fe("textarea",{id:Yv(n),type:"text",ref:l,name:n,spellCheck:"false",autoComplete:"off",disabled:i,class:"bio-properties-panel-input",onInput:t=>r(t.target.value),onFocus:s,onBlur:a,value:o||"","data-gramm":"false"})}),Vt((t,e)=>{const{id:n,onInput:i,value:r,onFocus:o,onBlur:s,switcherLabel:a}=t,l=Et();return e.current={focus:()=>{const t=l.current;t&&t.focus()}},fe(Wv,{id:n,value:r,inputRef:l,onInput:i,onFocus:o,onBlur:s,switcherLabel:a})}),Vt((t,e)=>{const{id:n,disabled:i,onInput:r,value:o,onFocus:s,onBlur:a}=t,l=Et();return e.current={focus:()=>{const t=l.current;t&&t.focus()}},fe("input",{ref:l,id:Yv(n),name:n,onFocus:s,onBlur:a,type:"checkbox",class:"bio-properties-panel-input",onChange:({target:t})=>{r(t.checked)},checked:o,disabled:i})});var Zv=function(t,e,n,i){var r;e[0]=0;for(var o=1;o<e.length;o++){var s=e[o++],a=e[o]?(e[0]|=s?1:2,n[e[o++]]):e[++o];3===s?i[0]=a:4===s?i[1]=Object.assign(i[1]||{},a):5===s?(i[1]=i[1]||{})[e[++o]]=a:6===s?i[1][e[++o]]+=a+"":s?(r=t.apply(a,Zv(t,a,n,["",null])),i.push(r),a[0]?e[0]|=2:(e[o-2]=0,e[o]=r)):i.push(a)}return i},Kv=new Map,Jv=function(t){var e=Kv.get(this);return e||(e=new Map,Kv.set(this,e)),(e=Zv(this,e.get(t)||(e.set(t,e=function(t){for(var e,n,i=1,r="",o="",s=[0],a=function(t){1===i&&(t||(r=r.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?s.push(0,t,r):3===i&&(t||r)?(s.push(3,t,r),i=2):2===i&&"..."===r&&t?s.push(4,t,0):2===i&&r&&!t?s.push(5,0,!0,r):i>=5&&((r||!t&&5===i)&&(s.push(i,0,r,n),i=6),t&&(s.push(i,t,0,n),i=6)),r=""},l=0;l<t.length;l++){l&&(1===i&&a(),a(l));for(var c=0;c<t[l].length;c++)e=t[l][c],1===i?"<"===e?(a(),s=[s],i=3):r+=e:4===i?"--"===r&&">"===e?(i=1,r=""):r=e+r[0]:o?e===o?o="":r+=e:'"'===e||"'"===e?o=e:">"===e?(a(),i=1):i&&("="===e?(i=5,n=r,r=""):"/"===e&&(i<5||">"===t[l][c+1])?(a(),3===i&&(s=s[0]),i=s,(s=s[0]).push(2,0,i),i=0):" "===e||"\t"===e||"\n"===e||"\r"===e?(a(),i=2):r+=e),3===i&&"!--"===r&&(i=4,s=s[0])}return a(),s}(t)),e),arguments,[])).length>1?e:e[0]}.bind(j);const ty=20;function ey(t,e,n,i){y("base",b),y("context-pad",'.bio-improved-canvas .djs-palette {\n  z-index: 100;\n}\n\n.bio-improved-canvas {\n  --context-pad-background-color: white;\n  --context-pad-color: var(--gray-80);\n  --context-pad-divider-color: var(--gray-20);\n  --context-pad-hover-color: var(--gray-10);\n  --context-pad-active-color: #e8e8e8;\n  --context-pad-box-shadow: 0px 2px 6px 0px rgba(0, 0, 0, 0.30);\n\n  --context-pad-entry-call-to-action-background-color: var(--blue-60);\n  --context-pad-entry-call-to-action-hover-background-color: var(--blue-70);\n  --context-pad-entry-call-to-action-color: white;\n  --context-pad-padding: 4px;\n}\n\n.bio-improved-canvas .djs-context-pad {\n  width: auto;\n  background: var(--context-pad-background-color);\n  color: var(--context-pad-color);\n  border-radius: 4px;\n  box-shadow: var(--context-pad-box-shadow);\n  z-index: 50;\n\n  &:hover {\n    z-index: 150;\n  }\n}\n\n.bio-improved-canvas .djs-context-pad.open {\n  display: flex;\n  align-items: center;\n}\n\n.bio-improved-canvas .djs-context-pad .group {\n  display: flex;\n\n  &:nth-child(1 of .group) {\n    padding-left: var(--context-pad-padding);\n  }\n\n  &:nth-last-child(1 of .group) {\n    padding-right: var(--context-pad-padding);\n  }\n}\n\n.bio-improved-canvas .djs-context-pad .group:not(:last-child):after {\n  display: block;\n  content: "";\n  width: 0.5px;\n  height: 40px;\n  background: var(--context-pad-divider-color);\n  margin: auto var(--context-pad-padding);\n}\n\n.bio-improved-canvas .djs-context-pad .entry {\n  width: 32px;\n  height: 32px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: var(--context-pad-padding) 0 var(--context-pad-padding) 0;\n  background: none;\n  box-shadow: none;\n  border-radius: 0;\n  padding: 6px;\n\n  /* Safari icon fix */\n  & > svg {\n    height: 100%;\n  }\n}\n\n.bio-improved-canvas .djs-context-pad .bio-properties-panel-tooltip-wrapper {\n  position: relative;\n  text-decoration: none;\n}\n\n.bio-improved-canvas .djs-context-pad .bio-properties-panel-tooltip {\n  position: absolute;\n}\n\n.bio-improved-canvas .djs-context-pad .bio-properties-panel-tooltip-content {\n  font-size: 12px;\n  padding: 9px 12px;\n  border-radius: 4px;\n  width: max-content;\n}\n\n.bio-improved-canvas .djs-context-pad .entry:last-child {\n  margin-right: 0;\n}\n\n.bio-improved-canvas .djs-context-pad .entry:hover {\n  background: var(--context-pad-hover-color);\n}\n\n.bio-improved-canvas .djs-context-pad .entry.active {\n  background: var(--context-pad-active-color);\n}\n\n.bio-improved-canvas .djs-context-pad .separator {\n  width: 1px;\n  height: 18px;\n  background: var(--context-pad-divider-color);\n  margin: 0 var(--context-pad-padding);\n}\n\n/* Resource linking */\n.bio-improved-canvas .djs-context-pad .entry.resource-linking-no-resource svg {\n  fill: var(--blue-60);\n}'),this._canvas=t,this._contextPad=e,this._injector=i,e._getPosition=this._getPosition.bind(this),e._updateVisibility=this._updateVisibility.bind(this),n.on("contextPad.open",this._renderTooltips.bind(this)),n.on("canvas.viewbox.changed",()=>{this._updateVisibility()})}ey.prototype._updateVisibility=function(){if(!this._contextPad.isOpen())return;var t=this._contextPad._current.target,e=(Array.isArray(t)?t:[t]).some(t=>this._canvas.hasMarker(t,"djs-element-hidden"));const n=this._canvas.getContainer().getBoundingClientRect(),i=this._contextPad._getTargetBounds(this._contextPad._current.target),r=i.left>n.right||i.right<n.left||i.top>n.bottom||i.bottom<n.top;e||r?this._contextPad.hide():this._contextPad.show()},ey.prototype._getPosition=function(t){const e=this._canvas.getContainer().getBoundingClientRect(),n=this._contextPad._current.html.getBoundingClientRect(),i=this._contextPad._getTargetBounds(t),r=i.x+i.width/2;i.y,i.height;let o=r-n.width/2-e.left,s=i.top-n.height-15-e.top;o<ty&&(o=ty),o+n.width>e.width-ty&&(o=e.width-n.width-ty),s<ty&&(s=i.bottom+15-e.top),s<ty&&(s=ty),s+n.height>e.height-ty&&(s=e.height-n.height-ty);const a=this._injector.get("palette",!1);if(a){const t=a._container.getBoundingClientRect();o<t.right-e.left+ty&&s<t.bottom-e.top+ty&&(o=t.right-e.left+ty)}return{left:o,top:s}},ey.prototype._renderTooltips=function(){(this._contextPad._current.html||document).querySelectorAll(".entry").forEach(t=>{const e=t.getAttribute("title");t.removeAttribute("title"),t.setAttribute("aria-label",e),t.setAttribute("role","button");const n=E("<div></div>");t.parentNode.appendChild(n),t.parentNode.removeChild(t),ct(Jv`
        <${Dv} value="${e}" position=${"bottom: calc(100% - var(--context-pad-padding));"} direction="top">
          <div dangerouslySetInnerHTML=${{__html:t.outerHTML}}/>
        </${Dv}>`,n)})},ey.$inject=["canvas","contextPad","eventBus","injector"];var ny={delete:'\n  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="currentColor">\n<rect x="12" y="12" width="2" height="12"/><rect x="18" y="12" width="2" height="12"/>\n<path d="M4,6V8H6V28a2,2,0,0,0,2,2H24a2,2,0,0,0,2-2V8h2V6ZM8,28V8H24V28Z"/>\n<rect x="12" y="2" width="8" height="2"/></svg>',replace:'\n    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M1 9.41737C1 5.32087 4.29525 2 8.36017 2C11.9208 2 14.8915 4.54855 15.5732 7.9339H12.0402C10.4521 7.9339 9.12707 8.3311 8.20462 9.26079C7.28216 10.1905 6.88814 11.5258 6.88814 13.1261V16.6866C3.52889 15.9995 1 13.0057 1 9.41737Z" stroke="currentColor" stroke-width="1.5"/>\n      <path fill-rule="evenodd" clip-rule="evenodd" d="M11.2875 7.17578H18.6477C21.4359 7.17578 23.7998 9.37748 23.7998 12.2196V16.9667C23.7998 19.8089 21.4359 22.0105 18.6477 22.0105H11.2875C8.49927 22.0105 6.13538 19.8089 6.13538 16.9667V12.2196C6.13538 9.37748 8.49927 7.17578 11.2875 7.17578ZM11.2875 8.65926C9.25504 8.65926 7.60741 10.2533 7.60741 12.2196V16.9667C7.60741 18.933 9.25504 20.527 11.2875 20.527H18.6477C20.6801 20.527 22.3278 18.933 22.3278 16.9667V12.2196C22.3278 10.2533 20.6801 8.65926 18.6477 8.65926H11.2875Z" fill="currentColor"/>\n    </svg>',connect:'\n  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M9.50053 7.29585L19.7781 4.54188L17.0243 14.8196L13.914 11.7093L5.52502 20.0983C5.16516 20.4582 4.58176 20.4582 4.22177 20.0982C3.86192 19.7384 3.86196 19.155 4.22182 18.7951L12.6108 10.4061L9.50053 7.29585Z" fill="black"/>\n  </svg>\n  ',alignElements:'\n    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="currentColor">\n      <path d="M26,26H11a2.0023,2.0023,0,0,1-2-2V20a2.0023,2.0023,0,0,1,2-2H26a2.0023,2.0023,0,0,1,2,2v4A2.0023,2.0023,0,0,1,26,26Zm0-6.0012L11,20v4H26Z"/>\n      <path d="M18,14H11a2.0023,2.0023,0,0,1-2-2V8a2.0023,2.0023,0,0,1,2-2h7a2.0023,2.0023,0,0,1,2,2v4A2.0023,2.0023,0,0,1,18,14Zm0-6.0012L11,8v4h7Z"/>\n      <rect x="4" y="2" width="2" height="28"/>\n    </svg>',colorPicker:'\n    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n      <path fill="currentColor" d="M28.83,23.17,23,17.33V13a1,1,0,0,0-.29-.71l-10-10a1,1,0,0,0-1.42,0l-9,9a1,1,0,0,0,0,1.42l10,10A1,1,0,0,0,13,23h4.34l5.83,5.84a4,4,0,0,0,5.66-5.66ZM6,10.41l2.29,2.3,1.42-1.42L7.41,9,9,7.41l4.29,4.3,1.42-1.42L10.41,6,12,4.41,18.59,11,11,18.59,4.41,12Zm21.41,17a2,2,0,0,1-2.82,0l-6.13-6.12a1.8,1.8,0,0,0-.71-.29H13.41l-1-1L20,12.41l1,1v4.34a1,1,0,0,0,.29.7l6.12,6.14a2,2,0,0,1,0,2.82Z"/>\n    </svg>'};function iy(t,e,n){this._eventBus=e,this._contextPad=t,this._popupMenu=n,t.registerProvider(100,this)}function ry(t,e){return e.action.dragstart?`<div class="entry" draggable="true">${ny[t]}</div>`:`<div class="entry">${ny[t]}</div>`}function oy(t,e){delete t.className,t.html=ry(e,t)}function sy(t,e,n,i){return(r,o)=>{i(r,o);const s=function(t,e){return C(`.djs-context-pad .entry[aria-label="${t[e].title}"`)}(e,n);s.classList.add("active"),t.once("popupMenu.close",function(){s.classList.remove("active")})}}iy.prototype.getContextPadEntries=function(t){return t=>{if(t.replace){oy(t.replace,"replace");const e=t.replace.action.click;t.replace.action.click=sy(this._eventBus,t,"replace",e)}if(t.connect&&(oy(t.connect,"connect"),t.connect.group="edit"),t.delete){const e=t.delete;oy(e,"delete"),e.group="delete",t={...v(t,"delete"),delete:e}}return t}},iy.prototype.getMultiElementContextPadEntries=function(t){return t=>{if(t.delete){const e=t.delete;oy(e,"delete"),e.group="delete",t={...v(t,"delete"),delete:e}}return t}},iy.prototype._updatePopupMenuOpenPosition=function(t,e){t.action={click:(t,n)=>{const i=this._getMenuPosition(n);m(i,{cursor:{x:t.x,y:t.y}}),this._popupMenu.open(n,e,i)}}},iy.prototype._getMenuPosition=function(t){const e=this._contextPad.getPad(t).html.getBoundingClientRect();return{x:e.left,y:e.top-e.height-5}},iy.$inject=["contextPad","eventBus","popupMenu"];var ay={__depends__:[_],__init__:["improvedContextPad","improvedContextPadProvider"],improvedContextPad:["type",ey],improvedContextPadProvider:["type",iy]};function ly(t,e){var n=hy(t);return n&&"function"==typeof n.$instanceOf&&n.$instanceOf(e)}function cy(t,e){return p(e,function(e){return ly(t,e)})}function hy(t){return t&&t.businessObject||t}function uy(t,e,n){this._eventBus=e,this._contextPad=t,this._popupMenu=n,t.registerProvider(100,this)}uy.prototype.getContextPadEntries=function(t){return e=>{e.replace&&(e={replace:e.replace,...v(e,"replace")});const n=e["append.text-annotation"];for(const t in e)t.startsWith("append")&&delete e[t];if(n&&(e={...e,"append.text-annotation":n}),(ly(t,"bpmn:Participant")||ly(t,"bpmn:Lane"))&&["lane-insert-above","lane-insert-below","lane-divide-two","lane-divide-three"].forEach(t=>{e[t]&&(e[t].group="lanes")}),e["set-color"]){oy(e["set-color"],"colorPicker"),e["set-color"].group="edit",this._updatePopupMenuOpenPosition(e["set-color"],"color-picker");const t=e["set-color"].action.click;e["set-color"].action.click=sy(this._eventBus,e,"set-color",t)}if(e.delete){const t=e.delete;e={...v(e,"delete"),delete:{...t,group:"delete"}}}return e}},uy.prototype.getMultiElementContextPadEntries=function(){return t=>{if(t["align-elements"]){t["align-elements"].html=ry("alignElements",t["align-elements"]),this._updatePopupMenuOpenPosition(t["align-elements"],"align-elements");const e=t["align-elements"].action.click;t["align-elements"].action.click=sy(this._eventBus,t,"align-elements",e)}if(t["set-color"]){oy(t["set-color"],"colorPicker"),this._updatePopupMenuOpenPosition(t["set-color"],"color-picker");const e=t["set-color"].action.click;t["set-color"].action.click=sy(this._eventBus,t,"set-color",e)}if(t.delete){const e=t.delete;oy(e,"delete"),e.group="delete"}return t}},uy.prototype._updatePopupMenuOpenPosition=function(t,e){t.action={click:(t,n)=>{const i=this._getMenuPosition(n);m(i,{cursor:{x:t.x,y:t.y}}),this._popupMenu.open(n,e,i)}}},uy.prototype._getMenuPosition=function(t){const e=this._contextPad.getPad(t).html.getBoundingClientRect();return{x:e.left,y:e.top-e.height-5}},uy.$inject=["contextPad","eventBus","popupMenu"];var dy={__depends__:[ay],__init__:["BPMNimprovedContextPadProvider"],BPMNimprovedContextPadProvider:["type",uy]};const py={"align-elements-bottom":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n      <rect x="2" y="26" width="28" height="2"/>\n      <path d="M24,23H20a2.0023,2.0023,0,0,1-2-2V14a2.0023,2.0023,0,0,1,2-2h4a2.0023,2.0023,0,0,1,2,2v7A2.0023,2.0023,0,0,1,24,23Zm-4-9v7h4.0012L24,14Z"/>\n      <path d="M12,23H8a2.0023,2.0023,0,0,1-2-2V6A2.0023,2.0023,0,0,1,8,4h4a2.0023,2.0023,0,0,1,2,2V21A2.0023,2.0023,0,0,1,12,23ZM8,6V21h4.0012L12,6Z"/>\n    </svg>',"align-elements-right":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n      <path d="M4,24V20a2.0023,2.0023,0,0,1,2-2H21a2.0023,2.0023,0,0,1,2,2v4a2.0023,2.0023,0,0,1-2,2H6A2.0023,2.0023,0,0,1,4,24Zm2,0H21V20L6,19.9988Z" transform="translate(0 0)"/>\n      <path d="M12,12V8a2.0023,2.0023,0,0,1,2-2h7a2.0023,2.0023,0,0,1,2,2v4a2.0023,2.0023,0,0,1-2,2H14A2.0023,2.0023,0,0,1,12,12Zm2,0h7V8l-7-.0012Z" transform="translate(0 0)"/>\n      <rect x="26" y="2" width="2" height="28" transform="translate(54 32) rotate(-180)"/>\n    </svg>',"align-elements-left":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n      <path d="M26,26H11a2.0023,2.0023,0,0,1-2-2V20a2.0023,2.0023,0,0,1,2-2H26a2.0023,2.0023,0,0,1,2,2v4A2.0023,2.0023,0,0,1,26,26Zm0-6.0012L11,20v4H26Z"/>\n      <path d="M18,14H11a2.0023,2.0023,0,0,1-2-2V8a2.0023,2.0023,0,0,1,2-2h7a2.0023,2.0023,0,0,1,2,2v4A2.0023,2.0023,0,0,1,18,14Zm0-6.0012L11,8v4h7Z"/>\n      <rect x="4" y="2" width="2" height="28"/>\n    </svg>',"align-elements-center":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n      <path d="M24,18H17V14h3a2.0025,2.0025,0,0,0,2-2V8a2.0025,2.0025,0,0,0-2-2H17V2H15V6H12a2.0025,2.0025,0,0,0-2,2v4a2.0025,2.0025,0,0,0,2,2h3v4H8a2.0025,2.0025,0,0,0-2,2v4a2.0025,2.0025,0,0,0,2,2h7v4h2V26h7a2.0025,2.0025,0,0,0,2-2V20A2.0025,2.0025,0,0,0,24,18ZM12,8h8v4H12ZM24,24H8V20H24Z"/>\n    </svg>',"align-elements-top":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n      <path d="M24,20H20a2.0023,2.0023,0,0,1-2-2V11a2.0023,2.0023,0,0,1,2-2h4a2.0023,2.0023,0,0,1,2,2v7A2.0023,2.0023,0,0,1,24,20Zm-4-9v7h4.0012L24,11Z"/>\n      <path d="M12,28H8a2.0023,2.0023,0,0,1-2-2V11A2.0023,2.0023,0,0,1,8,9h4a2.0023,2.0023,0,0,1,2,2V26A2.0023,2.0023,0,0,1,12,28ZM8,11V26h4.0012L12,11Z"/>\n      <rect x="2" y="4" width="28" height="2"/>\n    </svg>',"align-elements-middle":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n    <path d="M30,15H26V12a2.0025,2.0025,0,0,0-2-2H20a2.0025,2.0025,0,0,0-2,2v3H14V8a2.0025,2.0025,0,0,0-2-2H8A2.0025,2.0025,0,0,0,6,8v7H2v2H6v7a2.0025,2.0025,0,0,0,2,2h4a2.0025,2.0025,0,0,0,2-2V17h4v3a2.0025,2.0025,0,0,0,2,2h4a2.0025,2.0025,0,0,0,2-2V17h4ZM8,24V8h4l.0012,16Zm12-4V12h4l.0012,8Z"/>\n    </svg>',"distribute-elements-horizontal":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n      <path d="M24,10H23V2H21v8H20a2.0023,2.0023,0,0,0-2,2v8a2.0023,2.0023,0,0,0,2,2h1v8h2V22h1a2.0023,2.0023,0,0,0,2-2V12A2.0023,2.0023,0,0,0,24,10Zm0,10H20V12h4Z"/>\n      <path d="M12,6H11V2H9V6H8A2.0023,2.0023,0,0,0,6,8V24a2.0023,2.0023,0,0,0,2,2H9v4h2V26h1a2.0023,2.0023,0,0,0,2-2V8A2.0023,2.0023,0,0,0,12,6Zm0,18H8V8h4Z"/>\n    </svg>',"distribute-elements-vertical":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n      <path d="M30,21H26V20a2.0023,2.0023,0,0,0-2-2H8a2.0023,2.0023,0,0,0-2,2v1H2v2H6v1a2.0023,2.0023,0,0,0,2,2H24a2.0023,2.0023,0,0,0,2-2V23h4Zm-6,3H8V20l16-.001Z"/>\n      <path d="M30,9H22V8a2.0023,2.0023,0,0,0-2-2H12a2.0023,2.0023,0,0,0-2,2V9H2v2h8v1a2.0023,2.0023,0,0,0,2,2h8a2.0023,2.0023,0,0,0,2-2V11h8ZM20,12H12V8l8-.001Z"/>\n    </svg>'};function fy(t,e){this._eventBus=e,t.registerProvider("align-elements",100,this)}function gy(t,e){this._eventBus=e,t.registerProvider("color-picker",100,this)}fy.prototype.getPopupMenuEntries=function(){return t=>(Object.keys(t).forEach(e=>{var n,i;i=e,delete(n=t[e]).className,n.imageHtml=py[i]}),t)},fy.$inject=["popupMenu","eventBus"],gy.prototype.getPopupMenuEntries=function(){const t='\n    <svg viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M8.5 16C12.6422 16 16 12.6422 16 8.5C16 4.35787 12.6422 1 8.5 1C4.35787 1 1 4.35787 1 8.5C1 12.6422 4.35787 16 8.5 16Z" fill="var(--fill-color)" stroke="var(--stroke-color)" stroke-width="1.2"/>\n    </svg>';return e=>{delete e["blue-color"].imageUrl,e["blue-color"].imageHtml=t.replace("var(--fill-color)","#D0E2FF").replace("var(--stroke-color)","#00539A"),delete e["green-color"].imageUrl,e["green-color"].imageHtml=t.replace("var(--fill-color)","#A7F0BA").replace("var(--stroke-color)","#0E6027"),delete e["orange-color"].imageUrl,e["orange-color"].imageHtml=t.replace("var(--fill-color)","#FFE0B1").replace("var(--stroke-color)","#F1C21B"),delete e["red-color"].imageUrl,e["red-color"].imageHtml=t.replace("var(--fill-color)","#FFD6E8").replace("var(--stroke-color)","#9F1853"),delete e["purple-color"].imageUrl,e["purple-color"].imageHtml=t.replace("var(--fill-color)","#E8DAFF").replace("var(--stroke-color)","#6929C4");const n=e["default-color"];return delete n.imageUrl,n.imageHtml=t.replace("var(--fill-color)","#FFFFFF").replace("var(--stroke-color)","#000000"),n.group="default-color",delete e["default-color"],e["default-color"]=n,e}},gy.$inject=["popupMenu","eventBus"];var my={__depends__:[{__depends__:[_],__init__:["horizontalPopupMenu","colorPickerPopupProvider"],horizontalPopupMenu:["type",function(){y("base",b),y("popup-menu",'.bio-improved-canvas .djs-popup.color-picker,\n.bio-improved-canvas .djs-popup.align-elements {\n  background-color: var(--context-pad-background-color);\n  border-radius: 4px;\n  box-shadow: var(--context-pad-box-shadow);\n  border: none;\n\n  & .djs-popup-results {\n    display: flex;\n    align-items: center;\n    padding: var(--context-pad-padding);\n    margin: 0;\n  }\n\n  & .djs-popup-group {\n    display: flex;\n    flex-direction: row;\n    width: auto;\n  }\n\n  & .djs-popup-group:not(:last-child):after {\n    display: block;\n    content: "";\n    width: 1px;\n    height: 18px;\n    background: var(--context-pad-divider-color);\n    margin: auto var(--context-pad-padding);\n  }\n\n  & .entry {\n    margin-top: 0;\n    padding: var(--context-pad-padding);\n  }\n\n  & .entry:hover,\n  & .entry.selected {\n    background-color: var(--context-pad-hover-color);\n    border-radius: 0;\n  }\n\n  & .djs-popup-entry-icon {\n    display: flex;\n    align-items: center;\n    height: 24px;\n    width: 24px;\n    fill: var(--context-pad-color);\n  }\n  \n  /* Safari icon fix */\n  & .djs-popup-entry-icon > svg {\n    height: 100%;\n  }\n}\n')}],colorPickerPopupProvider:["type",gy]}],__init__:["alignElementsPopupProvider"],alignElementsPopupProvider:["type",fy]};function vy(t){return a(t)&&u(t,"waypoints")}function yy(t){return a(t)&&u(t,"labelTarget")}function by(t,e,n,i){this._config=t,this._eventBus=n,this._contextPad=e,this._rules=i,!1!==t&&e.registerProvider(100,this)}function xy(t,e){const n=t.get("extensionElements");if(!n)return null;const i=n.get("values");return i&&i.length?i.find(t=>ly(t,e)):null}function wy(t){this._eventBus=t}function _y(t){return function(e,n,i,r,o){(c(e)||l(e))&&(o=r,r=i,i=n,n=e,e=null),this.on(e,t,n,i,r,o)}}function Oy(t){wy.call(this,t),this.init()}by.$inject=["config.resourceLinking","contextPad","eventBus","rules"],by.prototype.getContextPadEntries=function(t){return e=>{if(yy(t)||!this._canLinkResource(t))return e;let n,i;return ly(t,"bpmn:BusinessRuleTask")?(n="decision",i=function(t){const e=xy(hy(t),"zeebe:CalledDecision");if(!e)return!1;const n=e.get("decisionId");return h(n)&&n.trim().length}(t)):ly(t,"bpmn:CallActivity")?(n="process",i=function(t){const e=xy(hy(t),"zeebe:CalledElement");if(!e)return!1;const n=e.get("processId");return h(n)&&n.trim().length}(t)):cy(t,["bpmn:StartEvent","bpmn:UserTask"])&&(n="form",i=function(t){const e=xy(hy(t),"zeebe:FormDefinition");return!!e&&(function(t){const e=t.get("formKey");return h(e)&&e.trim().length}(e)||function(t){const e=t.get("formId");return h(e)&&e.trim().length}(e))}(t)),n?{"link-resource":{title:`Link ${n}`,html:`<div class="entry ${i?"":"resource-linking-no-resource"}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n                    <path d="M29.25,6.76a6,6,0,0,0-8.5,0l1.42,1.42a4,4,0,1,1,5.67,5.67l-8,8a4,4,0,1,1-5.67-5.66l1.41-1.42-1.41-1.42-1.42,1.42a6,6,0,0,0,0,8.5A6,6,0,0,0,17,25a6,6,0,0,0,4.27-1.76l8-8A6,6,0,0,0,29.25,6.76Z"/>\n                    <path d="M4.19,24.82a4,4,0,0,1,0-5.67l8-8a4,4,0,0,1,5.67,0A3.94,3.94,0,0,1,19,14a4,4,0,0,1-1.17,2.85L15.71,19l1.42,1.42,2.12-2.12a6,6,0,0,0-8.51-8.51l-8,8a6,6,0,0,0,0,8.51A6,6,0,0,0,7,28a6.07,6.07,0,0,0,4.28-1.76L9.86,24.82A4,4,0,0,1,4.19,24.82Z"/>\n                  </svg></div>`,action:e=>this._eventBus.fire("contextPad.linkResource",{element:t,originalEvent:e})},...e}:e}},by.prototype._canLinkResource=function(t){return this._rules.allowed("resourceLinking.linkResource",{element:t})},wy.$inject=["eventBus"],wy.prototype.on=function(t,e,n,i,r,o){if((c(e)||l(e))&&(o=r,r=i,i=n,n=e,e=null),c(n)&&(o=r,r=i,i=n,n=1e3),a(r)&&(o=r,r=!1),!c(i))throw new Error("handlerFn must be a function");s(t)||(t=[t]);var h=this._eventBus;d(t,function(t){var s=["commandStack",t,e].filter(function(t){return t}).join(".");h.on(s,n,r?function(t,e){return function(n){return t.call(e||null,n.context,n.command,n)}}(i,o):i,o)})},wy.prototype.canExecute=_y("canExecute"),wy.prototype.preExecute=_y("preExecute"),wy.prototype.preExecuted=_y("preExecuted"),wy.prototype.execute=_y("execute"),wy.prototype.executed=_y("executed"),wy.prototype.postExecute=_y("postExecute"),wy.prototype.postExecuted=_y("postExecuted"),wy.prototype.revert=_y("revert"),wy.prototype.reverted=_y("reverted"),Oy.$inject=["eventBus"],function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}(Oy,wy),Oy.prototype.addRule=function(t,e,n){var i=this;"string"==typeof t&&(t=[t]),t.forEach(function(t){i.canExecute(t,e,function(t,e,i){return n(t)},!0)})},Oy.prototype.init=function(){};class ky extends Oy{constructor(t,e,n){super(n),!1!==e&&this.addRule("resourceLinking.linkResource",({element:n})=>!(function(t){return hy(t).get("zeebe:modelerTemplate")}(n)||!cy(n,["bpmn:BusinessRuleTask","bpmn:CallActivity","bpmn:UserTask"])&&!(function(t){const e=hy(t).get("eventDefinitions");return ly(t,"bpmn:StartEvent")&&(!e||!e.length)}(n)&&function(t={}){const{noneStartEvent:e=!0}=t;return e}(e)&&function(t,e){if(ly(e,"bpmn:Process")&&t===e)return hy(t).get("isExecutable");if(ly(e,"bpmn:Collaboration")){const n=e.children.filter(t=>{if(!ly(t,"bpmn:Participant"))return!1;const e=hy(t).get("processRef");return e&&e.get("isExecutable")});return 1===n.length&&n[0]===t}return!1}(n.parent,t.getRootElement()))))}}ky.$inject=["canvas","config.resourceLinking","eventBus"];var Sy={__init__:["resourceLinkingContextPadProvider","resourceLinkingRules"],resourceLinkingContextPadProvider:["type",by],resourceLinkingRules:["type",ky]};function Ey(t,e){this._eventBus=e,this._contextPad=t,t.registerProvider(100,this)}Ey.$inject=["contextPad","eventBus"],Ey.prototype.getContextPadEntries=function(t){return e=>yy(t)?e:{...e,"show-comments":{title:"Show comments",html:'<div class="entry"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n  <path d="M17.74,30,16,29l4-7h6a2,2,0,0,0,2-2V8a2,2,0,0,0-2-2H6A2,2,0,0,0,4,8V20a2,2,0,0,0,2,2h9v2H6a4,4,0,0,1-4-4V8A4,4,0,0,1,6,4H26a4,4,0,0,1,4,4V20a4,4,0,0,1-4,4H21.16Z" transform="translate(0 0)"/>\n</svg></div>',action:e=>this._eventBus.fire("contextPad.showComments",{element:t,originalEvent:e}),group:"edit"}}};var Cy={__init__:["showComments"],showComments:["type",Ey]};function Ay(t){return{top:t.y,right:t.x+(t.width||0),bottom:t.y+(t.height||0),left:t.x}}class Ty{constructor(t,e,n){this._canvas=t,this._eventBus=e,this._className=n,this._current=null,y("base",b),y("append",".bio-improved-canvas .djs-palette {\n  z-index: 100;\n}\n\n.bio-improved-canvas .djs-create-pad {\n  position: absolute;\n  display: flex;\n  align-items: flex-start;\n  transform: translate(-20px, -20px);\n  z-index: 50;\n\n  &:not(.open) {\n    display: none;\n  }\n\n  &.hover {\n    z-index: 150;\n\n    .djs-create-pad-icon {\n      display: none;\n    }\n\n    .djs-create-pad-entries {\n      display: grid;\n    }\n  }\n\n  .djs-create-pad-icon {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    width: 40px;\n    height: 40px;\n    border-radius: 100%;\n\n    svg {\n      width: 20px;\n      height: 20px;\n      border-radius: 100%;\n      background-color: var(--color-blue-205-100-50);\n      box-shadow: var(--context-pad-box-shadow);\n    }\n  }\n\n  .djs-create-pad-entries {\n    display: none;\n    flex-direction: row;\n    overflow: hidden;\n    padding: 4px;\n    border-radius: 4px;\n    background-color: white;\n    color: var(--gray-80);\n    box-shadow: var(--context-pad-box-shadow);\n\n    .djs-create-pad-entry {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      width: 32px;\n      height: 32px;\n      font-size: 22px;\n  \n      * {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n      }\n  \n      &:hover {\n        background: var(--context-pad-hover-color);\n      }\n    }\n  }\n}"),e.on("selection.changed",({newSelection:t})=>{if(1!==t.length)return void(this.isOpen()&&this.close());const e=t[0];this.open(e)}),e.on("elements.changed",({elements:t})=>{if(!this.isOpen())return;const{target:e}=this._current;t.includes(e)&&this.open(e)}),e.on("canvas.viewbox.changed",()=>{this._updatePosition(),this._updateVisibility()}),this._container=document.createElement("div"),this._container.classList.add("djs-create-pad-container"),this._canvas.getContainer().appendChild(this._container)}open(t){this.close(),this.canOpen(t)&&this._open(t)}show(){this.isOpen()&&this._current.html.classList.add("open")}hide(){this.isOpen()&&this._current.html.classList.remove("open")}close(){if(!this._current)return;this._mouseEnterTimeout&&(clearTimeout(this._mouseEnterTimeout),this._mouseEnterTimeout=null),this._entryMouseEnterTimeout&&(clearTimeout(this._entryMouseEnterTimeout),this._entryMouseEnterTimeout=null),this._entryMouseLeaveCallback&&(this._entryMouseLeaveCallback(),this._entryMouseLeaveCallback=null),this._container.innerHTML="";const{html:t,target:e}=this._current;this._eventBus.fire("createPad.close",{html:t,target:e}),this._current=null}canOpen(t){throw new Error("must implement canOpen")}isOpen(){return!!this._current}getPosition(t){throw new Error("must implement getPosition")}getEntries(t){throw new Error("must implement getEntries")}getHtml(){return this.isOpen()?this._current.html:null}_open(t){const e=this._createHTML(t);this._container.appendChild(e),this._eventBus.fire("createPad.open",{html:e,target:t}),this._current={html:e,target:t},this._updatePosition(),this._updateVisibility(),this._eventBus.fire("createPad.open",{current:this._current})}_createHTML(t){const e=document.createElement("div");e.classList.add("djs-create-pad","open"),this._className&&e.classList.add(this._className);const n=document.createElement("div");n.classList.add("djs-create-pad-icon"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="4 4 24 24">\n  <polygon fill="white" points="17,15 17,10 15,10 15,15 10,15 10,17 15,17 15,22 17,22 17,17 22,17 22,15 "/>\n</svg>',e.appendChild(n);const i=this.getEntries(t),r=document.createElement("div");r.classList.add("djs-create-pad-entries");const o=Object.keys(i).length;r.style["grid-template-rows"]=`repeat(${o<2?"1":"2"}, 1fr)`,r.style["grid-template-columns"]=`repeat(${Math.ceil(o/2)}, 1fr)`;for(const e in i){const n=i[e],o=this._getEntryHtml(t,n);r.appendChild(o)}return e.appendChild(r),e.addEventListener("mouseenter",()=>{this._mouseEnterTimeout=setTimeout(()=>{e.classList.add("hover")},200),e.addEventListener("mouseleave",()=>{clearTimeout(this._mouseEnterTimeout),this._mouseEnterTimeout=null,e.classList.remove("hover")})}),e}_getEntryHtml(t,e){const n=document.createElement("div");n.classList.add("djs-create-pad-entry"),e.className&&n.classList.add(e.className),e.title&&n.setAttribute("title",e.title),e.html&&(n.innerHTML=e.html);const{action:i}=e;return i&&(i.click&&n.addEventListener("click",e=>i.click(e,t)),i.dragstart&&(n.setAttribute("draggable",!0),n.addEventListener("dragstart",e=>i.dragstart(e,t))),i.hover&&(n.addEventListener("mouseenter",e=>{this._entryMouseEnterTimeout=setTimeout(()=>{this._entryMouseLeaveCallback=i.hover(e,t)},300)}),n.addEventListener("mouseleave",e=>{clearTimeout(this._entryMouseEnterTimeout),this._entryMouseEnterTimeout=null,this._entryMouseLeaveCallback&&(this._entryMouseLeaveCallback(e,t),this._entryMouseLeaveCallback=null)}))),n}_updatePosition(){if(!this.isOpen())return;const t=this._current.html,e=this.getPosition(this._current.target);"x"in e&&"y"in e?(t.style.left=e.x+"px",t.style.top=e.y+"px"):["top","right","bottom","left"].forEach(function(n){n in e&&(t.style[n]=e[n]+"px")})}_updateVisibility(){if(!this.isOpen())return;const t=this._canvas.getContainer().getBoundingClientRect(),e=this._canvas.getGraphics(this._current.target).getBoundingClientRect();e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top?this.hide():this.show()}}Ty.$inject=["canvas","eventBus"];class Py extends Ty{constructor(t,e,n,i,r){super(e,i,"djs-append-create-pad"),this._appendContextPadProvider=t,this._contextPadProvider=n,this._rules=r}canOpen(t){return!vy(t)&&this._rules.allowed("shape.append",{element:t})}getEntries(t){return{...this._getContextPadEntries(t),...this._appendContextPadProvider.getContextPadEntries(t)}}getPosition(t){if(ly(t,"bpmn:BoundaryEvent"))return this._getBoundaryEventPosition(t);const e=this._canvas.getContainer().getBoundingClientRect(),n=this._canvas.getGraphics(t).getBoundingClientRect();let i=15;return this._rules.allowed("shape.resize",{shape:t})&&(i*=1.5),{left:n.right+i*this._canvas.zoom()-e.left,top:n.top+n.height/2-e.top}}_getBoundaryEventPosition(t){const e=function(t,e,n){a(n=n||0)||(n={x:n,y:n});var i=Ay(t),r=Ay(e),o=i.bottom+n.y<=r.top,s=i.left-n.x>=r.right,l=i.top-n.y>=r.bottom,c=o?"top":l?"bottom":null,h=i.right+n.x<=r.left?"left":s?"right":null;return h&&c?c+"-"+h:h||c||"intersect"}(vy(r=t)?function(t){for(var e=t.waypoints,n=e.reduce(function(t,n,i){var r=e[i-1];if(r){var o=t[t.length-1],s=o&&o.endLength||0,a=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}(r,n);t.push({start:r,end:n,startLength:s,endLength:s+a,length:a})}return t},[]),i=n.reduce(function(t,e){return t+e.length},0)/2,r=0,o=n[r];o.endLength<i;)o=n[++r];var s=(i-o.startLength)/o.length;return{x:o.start.x+(o.end.x-o.start.x)*s,y:o.start.y+(o.end.y-o.start.y)*s}}(r):(i={x:(n=r).x+(n.width||0)/2,y:n.y+(n.height||0)/2},{x:Math.round(i.x),y:Math.round(i.y)}),t.host);var n,i,r;const o=this._canvas.getContainer().getBoundingClientRect(),s=this._canvas.getGraphics(t).getBoundingClientRect();return e.includes("right")||e.includes("top")||e.includes("left")?{left:s.right+15*this._canvas.zoom()-o.left,top:s.top+s.height/2-o.top}:{left:s.left+s.width/2-o.left,top:s.bottom+15*this._canvas.zoom()-o.top}}_getContextPadEntries(t){const e=this._contextPadProvider.getContextPadEntries(t);for(const t in e)t.startsWith("append")&&"append"!==t&&"append.text-annotation"!==t||delete e[t];return function(t){return t=My(t,"append.append-task"),t=My(t,"append.gateway"),t=My(t,"append.intermediate-event"),t=My(t,"append.end-event"),t=My(t,"append.text-annotation")}(e)}}function My(t,e){const n=t[e];return n?(delete t[e],{...t,[e]:n}):t}Py.$inject=["appendContextPadProvider","canvas","contextPadProvider","eventBus","rules"];class Ny{constructor(t,e,n,i,r){this._injector=t,this._palette=e,this._popupMenu=n,this._selection=i,this._translate=r,this.unregisterActions(),this.registerActions()}unregisterActions(){const t=this._injector.get("editorActions",!1);t&&t.isRegistered("appendElement")&&t.unregister("appendElement")}registerActions(){const t=this._injector.get("appendCreatePad",!1),e=this._injector.get("editorActions",!1);t&&e&&e.register({appendCreatePad:e=>{const n=this._selection.get();if(t.isOpen()){const e=t.getHtml().getBoundingClientRect();this._popupMenu.open(n[0],"bpmn-append",{x:e.left,y:e.top},{title:this._translate("Append element"),width:300,search:!0})}else this._palette.triggerEntry("create","click",e)}})}}Ny.$inject=["injector","palette","popupMenu","selection","translate"];class Ry{constructor(t){const e=t.get("editorActions",!1),n=t.get("keyboard",!1);e&&n&&e.isRegistered("appendCreatePad")&&n.addListener(2e3,({keyEvent:t})=>{if(!n||!n.hasModifier(t))return n&&n.isKey(["a","A"],t)?(e&&e.trigger("appendCreatePad",t),!0):void 0})}}Ry.$inject=["injector"];const Dy=Object.prototype.toString,By=Object.prototype.hasOwnProperty;function $y(t){return void 0===t}function Ly(t){return"[object Array]"===Dy.call(t)}function Iy(t){return"[object Object]"===Dy.call(t)}function qy(t){return"[object Number]"===Dy.call(t)}function Fy(t){const e=Dy.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e||"[object GeneratorFunction]"===e||"[object AsyncGeneratorFunction]"===e||"[object Proxy]"===e}function Vy(t,e){return!(null==t)&&By.call(t,e)}function jy(t,e){const n=function(t){return Fy(t)?t:e=>e===t}(e);let i;return Hy(t,function(t,e){if(n(t,e))return i=t,!1}),i}function Hy(t,e){let n,i;if($y(t))return;const r=Ly(t)?Qy:zy;for(let o in t)if(Vy(t,o)&&(n=t[o],i=e(n,r(o)),!1===i))return n}function zy(t){return t}function Qy(t){return Number(t)}function Wy(t,...e){return Object.assign(t,...e)}const Xy={id:"events",name:"Events"},Uy={id:"tasks",name:"Tasks"},Gy={id:"data",name:"Data"},Yy={id:"participants",name:"Participants"},Zy={id:"subprocess",name:"Sub-processes"},Ky={id:"gateways",name:"Gateways"},Jy=[{label:"Start event",actionName:"none-start-event",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"Boundary event",actionName:"none-boundary-event",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:BoundaryEvent"}},{label:"End event",actionName:"none-end-event",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}].map(t=>({...t,group:Xy})),tb=[{label:"Message start event",actionName:"message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer start event",actionName:"timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional start event",actionName:"conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal start event",actionName:"signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}].map(t=>({...t,group:Xy})),eb=[{label:"Message intermediate catch event",actionName:"message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate throw event",actionName:"message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer intermediate catch event",actionName:"timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation intermediate throw event",actionName:"escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional intermediate catch event",actionName:"conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link intermediate catch event",actionName:"link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link intermediate throw event",actionName:"link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation intermediate throw event",actionName:"compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal intermediate catch event",actionName:"signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate throw event",actionName:"signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}].map(t=>({...t,group:Xy})),nb=[{label:"Message boundary event",actionName:"message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer boundary event",actionName:"timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation boundary event",actionName:"escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional boundary event",actionName:"conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Error boundary event",actionName:"error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel boundary event",actionName:"cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Signal boundary event",actionName:"signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Compensation boundary event",actionName:"compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message boundary event (non-interrupting)",actionName:"non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer boundary event (non-interrupting)",actionName:"non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation boundary event (non-interrupting)",actionName:"non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional boundary event (non-interrupting)",actionName:"non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal boundary event (non-interrupting)",actionName:"non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}].map(t=>({...t,group:Xy})),ib=[{label:"Message end event",actionName:"message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation end event",actionName:"escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error end event",actionName:"error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel end event",actionName:"cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation end event",actionName:"compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal end event",actionName:"signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate end event",actionName:"terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}].map(t=>({...t,group:Xy})),rb=[{label:"Exclusive gateway",actionName:"exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel gateway",actionName:"parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive gateway",search:"or",actionName:"inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"},rank:-1},{label:"Complex gateway",actionName:"complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"},rank:-1},{label:"Event-based gateway",actionName:"event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}].map(t=>({...t,group:Ky})),ob=[{label:"Call activity",actionName:"call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Transaction",actionName:"transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event sub-process",search:"subprocess",actionName:"event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Sub-process (collapsed)",search:"subprocess",actionName:"collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub-process (expanded)",search:"subprocess",actionName:"expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Ad-hoc sub-process (collapsed)",search:"adhoc subprocess",actionName:"collapsed-ad-hoc-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:AdHocSubProcess",isExpanded:!1}},{label:"Ad-hoc sub-process (expanded)",search:"adhoc subprocess",actionName:"expanded-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}}].map(t=>({...t,group:Zy})),sb=[...rb,...[{label:"Task",actionName:"task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"User task",actionName:"user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Service task",actionName:"service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Send task",actionName:"send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"},rank:-1},{label:"Receive task",actionName:"receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"},rank:-1},{label:"Manual task",actionName:"manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"},rank:-1},{label:"Business rule task",actionName:"rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Script task",actionName:"script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}}].map(t=>({...t,group:Uy})),...ob,...Jy,...tb,...eb,...ib,...nb,...[{label:"Data store reference",actionName:"data-store-reference",className:"bpmn-icon-data-store",target:{type:"bpmn:DataStoreReference"}},{label:"Data object reference",actionName:"data-object-reference",className:"bpmn-icon-data-object",target:{type:"bpmn:DataObjectReference"}}].map(t=>({...t,group:Gy})),...[{label:"Expanded pool/participant",search:"Non-empty pool/participant",actionName:"expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:"Empty pool/participant",search:"Collapsed pool/participant",actionName:"collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}].map(t=>({...t,group:Yy}))];function ab(t,e,n,i,r,o,s){this._elementFactory=t,this._popupMenu=e,this._create=n,this._autoPlace=i,this._rules=r,this._create=n,this._mouse=o,this._translate=s,this.register()}function lb(t,e,n,i,r){this._contextPad=t,this._popupMenu=e,this._translate=n,this._canvas=i,this._rules=r,this.register()}function cb(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}function hb(t,e){var n=ub(t);return n&&"function"==typeof n.$instanceOf&&n.$instanceOf(e)}function ub(t){return t&&t.businessObject||t}function db(t){this._eventBus=t}function pb(t){return function(e,n,i,r,o){(Fy(e)||qy(e))&&(o=r,r=i,i=n,n=e,e=null),this.on(e,t,n,i,r,o)}}function fb(t){db.call(this,t),this.init()}function gb(t){fb.call(this,t)}ab.$inject=["elementFactory","popupMenu","create","autoPlace","rules","mouse","translate"],ab.prototype.register=function(){this._popupMenu.registerProvider("bpmn-append",this)},ab.prototype.getPopupMenuEntries=function(t){const e=this._rules,n=this._translate,i={};return e.allowed("shape.append",{element:t})?(this._filterEntries(sb).forEach(e=>{const{actionName:r,className:o,label:s,target:a,description:l,group:c,search:h,rank:u}=e;i[`append-${r}`]={label:s&&n(s),className:o,description:l,group:c&&{...c,name:n(c.name)},search:h,rank:u,action:this._createEntryAction(t,a)}}),i):[]},ab.prototype._filterEntries=function(t){return t.filter(t=>{const e=t.target,{type:n,eventDefinitionType:i}=e;return!(["bpmn:StartEvent","bpmn:Participant"].includes(n)||"bpmn:BoundaryEvent"===n&&$y(i))})},ab.prototype._createEntryAction=function(t,e){const n=this._elementFactory,i=this._autoPlace,r=this._create,o=this._mouse,s=i=>{const s=n.create("shape",e);return i instanceof KeyboardEvent&&(i=o.getLastMoveEvent()),r.start(i,s,{source:t})};return{click:this._canAutoPlaceElement(e)?()=>{const r=n.create("shape",e);i.append(t,r)}:s,dragstart:s}},ab.prototype._canAutoPlaceElement=t=>{const{type:e}=t;return!("bpmn:BoundaryEvent"===e||"bpmn:SubProcess"===e&&t.triggeredByEvent||"bpmn:IntermediateCatchEvent"===e&&"bpmn:LinkEventDefinition"===t.eventDefinitionType)},lb.$inject=["contextPad","popupMenu","translate","canvas","rules"],lb.prototype.register=function(){this._contextPad.registerProvider(this)},lb.prototype.getContextPadEntries=function(t){const e=this._popupMenu,n=this._translate,i=this._rules,r=this._getAppendMenuPosition.bind(this);if(i.allowed("shape.append",{element:t}))return{append:{group:"model",html:'<div class="entry"><svg width="22" height="22" viewBox="0 0 5.82 5.82" xmlns="http://www.w3.org/2000/svg" fill="currentColor">\n  <path d="M1.3 3.4c.3 0 .5-.2.5-.5s-.2-.4-.5-.4c-.2 0-.4.1-.4.4 0 .3.2.5.4.5zM3 3.4c.2 0 .4-.2.4-.5s-.2-.4-.4-.4c-.3 0-.5.1-.5.4 0 .3.2.5.5.5zM4.6 3.4c.2 0 .4-.2.4-.5s-.2-.4-.4-.4c-.3 0-.5.1-.5.4 0 .3.2.5.5.5z"/>\n</svg></div>',title:n("Append element"),action:{click:function(t,i){const o=Wy(r(i),{cursor:{x:t.x,y:t.y}});e.open(i,"bpmn-append",o,{title:n("Append element"),width:300,search:!0})}}}}},lb.prototype._getAppendMenuPosition=function(t){const e=this._canvas.getContainer().querySelector(".djs-context-pad").getBoundingClientRect();return{x:e.right+5,y:e.top}},db.$inject=["eventBus"],db.prototype.on=function(t,e,n,i,r,o){if((Fy(e)||qy(e))&&(o=r,r=i,i=n,n=e,e=null),Fy(n)&&(o=r,r=i,i=n,n=1e3),Iy(r)&&(o=r,r=!1),!Fy(i))throw new Error("handlerFn must be a function");Ly(t)||(t=[t]);var s=this._eventBus;Hy(t,function(t){var a=["commandStack",t,e].filter(function(t){return t}).join(".");s.on(a,n,r?function(t,e){return function(n){return t.call(e||null,n.context,n.command,n)}}(i,o):i,o)})},db.prototype.canExecute=pb("canExecute"),db.prototype.preExecute=pb("preExecute"),db.prototype.preExecuted=pb("preExecuted"),db.prototype.execute=pb("execute"),db.prototype.executed=pb("executed"),db.prototype.postExecute=pb("postExecute"),db.prototype.postExecuted=pb("postExecuted"),db.prototype.revert=pb("revert"),db.prototype.reverted=pb("reverted"),fb.$inject=["eventBus"],cb(fb,db),fb.prototype.addRule=function(t,e,n){var i=this;"string"==typeof t&&(t=[t]),t.forEach(function(t){i.canExecute(t,e,function(t,e,i){return n(t)},!0)})},fb.prototype.init=function(){},cb(gb,fb),gb.$inject=["eventBus"],gb.prototype.init=function(){this.addRule("shape.append",function(t){const e=t.element,n=ub(e);return(!Iy(i=e)||!Vy(i,"labelTarget"))&&!function(t,e){return n=function(e){return hb(t,e)},!!jy(e,n);var n}(e,["bpmn:EndEvent","bpmn:Group","bpmn:TextAnnotation","bpmn:Lane","bpmn:Participant","bpmn:DataStoreReference","bpmn:DataObjectReference"])&&!e.waypoints&&(!hb(e,"bpmn:IntermediateThrowEvent")||!jy(ub(e).eventDefinitions||[],function(t){return hb(t,"bpmn:LinkEventDefinition")}))&&(!hb(e,"bpmn:SubProcess")||!n.triggeredByEvent)&&void 0;var i})};var mb,vb={__init__:["appendMenuProvider","appendContextPadProvider","appendRules"],appendMenuProvider:["type",ab],appendContextPadProvider:["type",lb],appendRules:["type",gb]};function yb(t,e,n,i,r,o){this._elementFactory=t,this._popupMenu=e,this._create=n,this._autoPlace=i,this._mouse=r,this._translate=o,this.register()}function bb(t,e,n,i,r){this._palette=t,this._translate=e,this._popupMenu=n,this._canvas=i,this._mouse=r,this.register()}yb.$inject=["elementFactory","popupMenu","create","autoPlace","mouse","translate"],yb.prototype.register=function(){this._popupMenu.registerProvider("bpmn-create",this)},yb.prototype.getPopupMenuEntries=function(){const t={};return sb.forEach(e=>{const{actionName:n,className:i,label:r,target:o,description:s,group:a,search:l,rank:c}=e,h=this._createEntryAction(o);t[`create-${n}`]={label:r&&this._translate(r),className:i,description:s,group:a&&{...a,name:this._translate(a.name)},search:l,rank:c,action:{click:h,dragstart:h}}}),t},yb.prototype._createEntryAction=function(t){const e=this._create,n=this._mouse,i=this._popupMenu,r=this._elementFactory;let o;return s=>(i.close(),o="bpmn:Participant"===t.type?r.createParticipantShape(t):r.create("shape",t),s instanceof KeyboardEvent&&(s=n.getLastMoveEvent()),e.start(s,o))},"undefined"!=typeof document&&((mb=document.createElement("div")).innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',mb.getElementsByTagName("link").length,mb=void 0),bb.$inject=["palette","translate","popupMenu","canvas","mouse"],bb.prototype.register=function(){this._palette.registerProvider(900,this)},bb.prototype.getPaletteEntries=function(t){const e=this._translate,n=this._popupMenu,i=this._canvas,r=this._mouse;return{create:{group:"create",html:'<div class="entry"> <svg width="46" height="46" viewBox="-2 -2 9.82 9.82" xmlns="http://www.w3.org/2000/svg" fill="currentColor">\n  <path d="M1.3 3.4c.3 0 .5-.2.5-.5s-.2-.4-.5-.4c-.2 0-.4.1-.4.4 0 .3.2.5.4.5zM3 3.4c.2 0 .4-.2.4-.5s-.2-.4-.4-.4c-.3 0-.5.1-.5.4 0 .3.2.5.5.5zM4.6 3.4c.2 0 .4-.2.4-.5s-.2-.4-.4-.4c-.3 0-.5.1-.5.4 0 .3.2.5.5.5z"/>\n</svg></div>',title:e("Create element"),action:{click:function(t){const o=(t=>{if(t instanceof KeyboardEvent)return{x:(t=r.getLastMoveEvent()).x,y:t.y};const e=t&&t.target||(n=n||document).querySelector('.djs-palette [data-action="create"]');var n;const i=e.getBoundingClientRect();return e&&{x:i.left+i.width/2+35,y:i.top+i.height/2+10}})(t),s=i.getRootElement();n.open(s,"bpmn-create",o,{title:e("Create element"),width:300,search:!0})}}}}};var xb={__init__:["createMenuProvider","createPaletteProvider"],createMenuProvider:["type",yb],createPaletteProvider:["type",bb]};function wb(t){this._injector=t,this.registerActions()}wb.$inject=["injector"],wb.prototype.registerActions=function(){const t=this._injector.get("editorActions",!1),e=this._injector.get("selection",!1),n=this._injector.get("contextPad",!1),i=this._injector.get("palette",!1),r=this._injector.get("popupMenu",!1),o={};e&&n&&i&&r&&i&&Wy(o,{appendElement:function(t){const o=e&&e.get();1!=o.length||r.isEmpty(o[0],"bpmn-append")?i.triggerEntry("create","click",t):n.triggerEntry("append","click",t)}}),i&&Wy(o,{createElement:function(t){i.triggerEntry("create","click",t)}}),t&&t.register(o)};var _b={__depends__:[vb,xb],__init__:["createAppendEditorActions"],createAppendEditorActions:["type",wb]},Ob=["c","C"],kb=["v","V"],Sb=["y","Y"],Eb=["z","Z"];function Cb(t){return!t.altKey&&(t.ctrlKey||t.metaKey)}function Ab(t,e){return-1!==(t=Ly(t)?t:[t]).indexOf(e.key)||-1!==t.indexOf(e.code)}function Tb(t){return t.shiftKey}function Pb(t,e){var n=this;t.on("editorActions.init",500,function(t){var i=t.editorActions;n.registerBindings(e,i)})}function Mb(t){this._injector=t,this._keyboard=this._injector.get("keyboard",!1),this._editorActions=this._injector.get("editorActions",!1),this._keyboard&&this._injector.invoke(Pb,this)}Pb.$inject=["eventBus","keyboard"],Pb.prototype.registerBindings=function(t,e){function n(n,i){e.isRegistered(n)&&t.addListener(i)}n("undo",function(t){if(Cb(n=t.keyEvent)&&!Tb(n)&&Ab(Eb,n))return e.trigger("undo"),!0;var n}),n("redo",function(t){if(Cb(n=t.keyEvent)&&(Ab(Sb,n)||Ab(Eb,n)&&Tb(n)))return e.trigger("redo"),!0;var n}),n("copy",function(t){if(Cb(n=t.keyEvent)&&Ab(Ob,n))return e.trigger("copy"),!0;var n}),n("paste",function(t){if(Cb(n=t.keyEvent)&&Ab(kb,n))return e.trigger("paste"),!0;var n}),n("stepZoom",function(t){var n=t.keyEvent;if(Ab(["+","Add","="],n)&&Cb(n))return e.trigger("stepZoom",{value:1}),!0}),n("stepZoom",function(t){var n=t.keyEvent;if(Ab(["-","Subtract"],n)&&Cb(n))return e.trigger("stepZoom",{value:-1}),!0}),n("zoom",function(t){var n=t.keyEvent;if(Ab("0",n)&&Cb(n))return e.trigger("zoom",{value:1}),!0}),n("removeSelection",function(t){if(Ab(["Backspace","Delete","Del"],t.keyEvent))return e.trigger("removeSelection"),!0})},cb(Mb,Pb),Mb.$inject=["injector"],Mb.prototype.registerBindings=function(){const t=this._keyboard,e=this._editorActions;function n(n,i){e&&e.isRegistered(n)&&t&&t.addListener(i)}Pb.prototype.registerBindings.call(this,t,e),n("appendElement",function(n){const i=n.keyEvent;if(!t||!t.hasModifier(i))return t&&t.isKey(["a","A"],i)?(e&&e.trigger("appendElement",i),!0):void 0}),n("createElement",function(n){const i=n.keyEvent;if(!t||!t.hasModifier(i))return t&&t.isKey(["n","N"],i)?(e&&e.trigger("createElement",i),!0):void 0})};var Nb={__depends__:[vb,xb,_b,{__depends__:[vb,xb],__init__:["createAppendKeyboardBindings"],createAppendKeyboardBindings:["type",Mb]}]},Rb=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Sub-process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Ad-hoc sub-process",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}}],Db=Rb,Bb=Object.freeze({__proto__:null,AD_HOC_SUBPROCESS_EXPANDED:[{label:"Sub-process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Ad-hoc sub-process (collapsed)",actionName:"replace-with-collapsed-ad-hoc-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:AdHocSubProcess",isExpanded:!1}}],BOUNDARY_EVENT:[{label:"Message boundary event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!0}},{label:"Timer boundary event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!0}},{label:"Escalation boundary event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!0}},{label:"Conditional boundary event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!0}},{label:"Error boundary event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",cancelActivity:!0}},{label:"Cancel boundary event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition",cancelActivity:!0}},{label:"Signal boundary event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!0}},{label:"Compensation boundary event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",cancelActivity:!0}},{label:"Message boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],DATA_OBJECT_REFERENCE:[{label:"Data store reference",actionName:"replace-with-data-store-reference",className:"bpmn-icon-data-store",target:{type:"bpmn:DataStoreReference"}}],DATA_STORE_REFERENCE:[{label:"Data object reference",actionName:"replace-with-data-object-reference",className:"bpmn-icon-data-object",target:{type:"bpmn:DataObjectReference"}}],END_EVENT:[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message end event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation end event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error end event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel end event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation end event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal end event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate end event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],EVENT_SUB_PROCESS:Db,EVENT_SUB_PROCESS_START_EVENT:[{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!0}},{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!0}},{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!0}},{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!0}},{label:"Error start event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",isInterrupting:!0}},{label:"Escalation start event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!0}},{label:"Compensation start event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",isInterrupting:!0}},{label:"Message start event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer start event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional start event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal start event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation start event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],GATEWAY:[{label:"Exclusive gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event-based gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],INTERMEDIATE_EVENT:[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message intermediate catch event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate throw event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer intermediate catch event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation intermediate throw event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional intermediate catch event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link intermediate catch event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link intermediate throw event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation intermediate throw event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal intermediate catch event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate throw event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],PARTICIPANT:[{label:"Expanded pool/participant",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:function(t){var e="Empty pool/participant";return t.children&&t.children.length&&(e+=" (removes content)"),e},actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}],SEQUENCE_FLOW:[{label:"Sequence flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],START_EVENT:[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],START_EVENT_SUB_PROCESS:[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}],SUBPROCESS_EXPANDED:[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Ad-hoc sub-process",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}},{label:"Sub-process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}}],TASK:[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"User task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Service task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Send task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"Manual task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business rule task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Script task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub-process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub-process (expanded)",actionName:"replace-with-expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Ad-hoc sub-process (collapsed)",actionName:"replace-with-collapsed-ad-hoc-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:AdHocSubProcess",isExpanded:!1}},{label:"Ad-hoc sub-process (expanded)",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}}],TRANSACTION:Rb});Object.values(Bb);var $b={__depends__:[Nb,_],__init__:["appendCreatePad","appendEditorActions","appendKeyboardBindings"],appendCreatePad:["type",Py],appendEditorActions:["type",Ny],appendKeyboardBindings:["type",Ry]};function Lb(t,e){var n,i,r,o;return e=!!e,s(t)||(t=[t]),d(t,function(t){var s=t;t.waypoints&&!e&&(s=Lb(t.waypoints,!0));var a=s.x,l=s.y,c=s.height||0,h=s.width||0;(a<n||void 0===n)&&(n=a),(l<i||void 0===i)&&(i=l),(a+h>r||void 0===r)&&(r=a+h),(l+c>o||void 0===o)&&(o=l+c)}),{x:n,y:i,height:o-i,width:r-n}}class Ib extends Ty{constructor(t,e,n,i,r,o,s,a,l,c){super(n,o,"djs-attach-create-pad"),this._appendContextPadProvider=t,this._attachPreview=e,this._create=i,this._elementFactory=r,this._injector=s,this._modeling=a,this._selection=l,this._translate=c}canOpen(t){const{attachers:e=[]}=t;return!e.length&&!hy(t).get("isForCompensation")&&!(ly(n=t,"bpmn:ReceiveTask")&&n.incoming.find(t=>ly(t.source,"bpmn:EventBasedGateway")))&&(ly(t,"bpmn:Task")||ly(t,"bpmn:SubProcess")&&!function(t){return t&&!!hy(t).triggeredByEvent}(t));var n}getPosition(t){const e=this._canvas.getContainer().getBoundingClientRect(),n=this._canvas.getGraphics(t).getBoundingClientRect();return{left:n.right+-25*this._canvas.zoom()-e.left,top:n.bottom+-5*this._canvas.zoom()-e.top}}getEntries(t){const e=(t,e,n=null)=>{const i=this._elementFactory.createShape({type:"bpmn:BoundaryEvent",eventDefinitionType:n});this._create.start(t,i,{source:e})},n=[[null,"bpmn-icon-intermediate-event-none"],["bpmn:MessageEventDefinition","bpmn-icon-intermediate-event-catch-message","message"],["bpmn:TimerEventDefinition","bpmn-icon-intermediate-event-catch-timer","timer"],["bpmn:ConditionalEventDefinition","bpmn-icon-intermediate-event-catch-condition","conditional"],["bpmn:ErrorEventDefinition","bpmn-icon-intermediate-event-catch-error","error"]].reduce((n,[i,r,o])=>({...n,[r]:{action:{click:(t,n)=>{this._attachPreview.cleanUp();const r=this._elementFactory.createShape({type:"bpmn:BoundaryEvent",eventDefinitionType:i}),o=Lb(n),s={x:o.x+o.width/2,y:o.y+o.height},{attachers:a=[]}=n;a.length?e(t,n,i):(this._modeling.createElements(r,s,n,{attach:!0}),this._selection.select(r))},dragstart:(t,n)=>{this._attachPreview.cleanUp(),e(t,n,i)},hover:(t,e)=>{const{attachers:n=[]}=e;if(!n.length)return this._attachPreview.create(e,"bpmn:BoundaryEvent",{eventDefinitionType:i}),()=>{this._attachPreview.cleanUp()}}},className:r,title:this._translate(t.attachers.length?`Create ${qb(o)}`:`Attach ${qb(o)}`)}}),{});if(!this._injector.get("appendContextPadProvider",!1))return n;const i=this._appendContextPadProvider.getContextPadEntries(t);return{...n,...i}}}function qb(t){return(t?t+" ":"")+"boundary event"}function Fb(t,e){this._complexPreview=t,this._elementFactory=e}Ib.$inject=["appendContextPadProvider","attachPreview","canvas","create","elementFactory","eventBus","injector","modeling","selection","translate"],Fb.prototype.create=function(t,e,n={}){const i=this._complexPreview,r=this._elementFactory.createShape({type:e,...n}),o=t.x+t.width/2,s=t.y+t.height;r.x=o-r.width/2,r.y=s-r.height/2,i.create({created:[r]})},Fb.prototype.cleanUp=function(){this._complexPreview.cleanUp()},Fb.$inject=["complexPreview","elementFactory"];var Vb={__depends__:[O,dy,my,$b,{__depends__:[Nb,_],__init__:["attachCreatePad","attachPreview"],attachCreatePad:["type",Ib],attachPreview:["type",Fb]},Sy,Cy]};function jb(t){this._contextPad=t,t.registerProvider(100,this)}jb.prototype.getContextPadEntries=function(){return t=>{t.replace&&(t={replace:t.replace,...v(t,"replace")});const e=Object.keys(t).filter(t=>t.startsWith("append"));return(t={...v(t,e),...e.reduce((e,n)=>({...e,[n]:t[n]}),{})}).delete&&(t={...v(t,"delete"),delete:t.delete}),t}},jb.$inject=["contextPad"];var Hb={__depends__:[O,{__depends__:[ay],__init__:["DMNimprovedContextPadProvider"],DMNimprovedContextPadProvider:["type",jb]}]}},75560(t,e,n){"use strict";n.d(e,{A:()=>f});var i=n(88641),r=n(57094),o=n(93083),s=n.n(o),a=n(81340),l=Math.min,c=Math.max;function h(t){t.preventDefault()}function u(t){t.stopPropagation()}function d(t){this.container=t.container,this.parent=s()('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=(0,a.P)("[contenteditable]",this.parent),this.keyHandler=t.keyHandler||function(){},this.resizeHandler=t.resizeHandler||function(){},this.autoResize=(0,r.bind)(this.autoResize,this),this.handlePaste=(0,r.bind)(this.handlePaste,this)}function p(t,e){this._eventBus=t,this._canvas=e,this._providers=[],this._textbox=new d({container:e.getContainer(),keyHandler:(0,r.bind)(this._handleKey,this),resizeHandler:(0,r.bind)(this._handleResize,this)})}d.prototype.create=function(t,e,n,i){var o=this.parent,s=this.content,l=this.container;i=this.options=i||{},e=this.style=e||{};var c=(0,r.pick)(e,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);(0,r.assign)(o.style,{width:t.width+"px",height:t.height+"px",maxWidth:t.maxWidth+"px",maxHeight:t.maxHeight+"px",minWidth:t.minWidth+"px",minHeight:t.minHeight+"px",left:t.x+"px",top:t.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},c);var h=(0,r.pick)(e,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return(0,r.assign)(s.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},h),i.centerVertically&&(0,r.assign)(s.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},h),s.innerText=n,a.f0.bind(s,"keydown",this.keyHandler),a.f0.bind(s,"mousedown",u),a.f0.bind(s,"paste",this.handlePaste),i.autoResize&&a.f0.bind(s,"input",this.autoResize),i.resizable&&this.resizable(e),l.appendChild(o),this.setSelection(s.lastChild,s.lastChild&&s.lastChild.length),o},d.prototype.handlePaste=function(t){var e,n=this.options,i=this.style;if(t.preventDefault(),e=t.clipboardData?t.clipboardData.getData("text/plain"):window.clipboardData.getData("Text"),this.insertText(e),n.autoResize){var r=this.autoResize(i);r&&this.resizeHandler(r)}},d.prototype.insertText=function(t){t=t.replace(/\r\n|\r|\n/g,"\n"),document.execCommand("insertText",!1,t)||this._insertTextIE(t)},d.prototype._insertTextIE=function(t){var e,n,i,r=this.getSelection(),o=r.startContainer,s=r.endContainer,l=r.startOffset,c=r.endOffset,h=r.commonAncestorContainer,u=(e=h.childNodes,[].slice.call(e));if(h.nodeType===Node.TEXT_NODE){var d=o.textContent;o.textContent=d.substring(0,l)+t+d.substring(c),n=o,i=l+t.length}else if(o===this.content&&s===this.content){var p=document.createTextNode(t);this.content.insertBefore(p,u[l]),n=p,i=p.textContent.length}else{var f=u.indexOf(o),g=u.indexOf(s);u.forEach(function(e,n){n===f?e.textContent=o.textContent.substring(0,l)+t+s.textContent.substring(c):n>f&&n<=g&&(0,a.TF)(e)}),n=o,i=l+t.length}n&&void 0!==i&&setTimeout(function(){self.setSelection(n,i)})},d.prototype.autoResize=function(){var t=this.parent,e=this.content,n=parseInt(this.style.fontSize)||12;if(e.scrollHeight>t.offsetHeight||e.scrollHeight<t.offsetHeight-n){var i=t.getBoundingClientRect(),r=e.scrollHeight;t.style.height=r+"px",this.resizeHandler({width:i.width,height:i.height,dx:0,dy:r-i.height})}},d.prototype.resizable=function(){var t=this,e=this.parent,n=this.resizeHandle,i=parseInt(this.style.minWidth)||0,o=parseInt(this.style.minHeight)||0,d=parseInt(this.style.maxWidth)||1/0,p=parseInt(this.style.maxHeight)||1/0;if(!n){var f,g,m,v;n=this.resizeHandle=s()('<div class="djs-direct-editing-resize-handle"></div>');var y=function(n){h(n),u(n);var r=l(c(m+n.clientX-f,i),d),s=l(c(v+n.clientY-g,o),p);e.style.width=r+"px",e.style.height=s+"px",t.resizeHandler({width:m,height:v,dx:n.clientX-f,dy:n.clientY-g})},b=function(t){h(t),u(t),a.f0.unbind(document,"mousemove",y,!1),a.f0.unbind(document,"mouseup",b,!1)};a.f0.bind(n,"mousedown",function(t){h(t),u(t),f=t.clientX,g=t.clientY;var n=e.getBoundingClientRect();m=n.width,v=n.height,a.f0.bind(document,"mousemove",y),a.f0.bind(document,"mouseup",b)})}(0,r.assign)(n.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),e.appendChild(n)},d.prototype.destroy=function(){var t=this.parent,e=this.content,n=this.resizeHandle;e.innerText="",t.removeAttribute("style"),e.removeAttribute("style"),a.f0.unbind(e,"keydown",this.keyHandler),a.f0.unbind(e,"mousedown",u),a.f0.unbind(e,"input",this.autoResize),a.f0.unbind(e,"paste",this.handlePaste),n&&(n.removeAttribute("style"),(0,a.TF)(n)),(0,a.TF)(t)},d.prototype.getValue=function(){return this.content.innerText.trim()},d.prototype.getSelection=function(){return window.getSelection().getRangeAt(0)},d.prototype.setSelection=function(t,e){var n=document.createRange();null===t?n.selectNodeContents(this.content):(n.setStart(t,e),n.setEnd(t,e));var i=window.getSelection();i.removeAllRanges(),i.addRange(n)},p.$inject=["eventBus","canvas"],p.prototype.registerProvider=function(t){this._providers.push(t)},p.prototype.isActive=function(t){return!(!this._active||t&&this._active.element!==t)},p.prototype.cancel=function(){this._active&&(this._fire("cancel"),this.close())},p.prototype._fire=function(t,e){this._eventBus.fire("directEditing."+t,e||{active:this._active})},p.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0,this._canvas.restoreFocus&&this._canvas.restoreFocus()},p.prototype.complete=function(){var t=this._active;if(t){var e,n=t.context.bounds,i=this.$textbox.getBoundingClientRect(),r=this.getValue();r===t.context.text&&i.height===n.height&&i.width===n.width||(e=this._textbox.container.getBoundingClientRect(),t.provider.update(t.element,r,t.context.text,{x:i.left-e.left,y:i.top-e.top,width:i.width,height:i.height})),this._fire("complete"),this.close()}},p.prototype.getValue=function(){return this._textbox.getValue()},p.prototype._handleKey=function(t){t.stopPropagation();var e=t.keyCode||t.charCode;return 27===e?(t.preventDefault(),this.cancel()):13!==e||t.shiftKey?void 0:(t.preventDefault(),this.complete())},p.prototype._handleResize=function(t){this._fire("resize",t)},p.prototype.activate=function(t){var e;this.isActive()&&this.cancel();var n=(0,r.find)(this._providers,function(n){return(e=n.activate(t))?n:null});return e&&(this.$textbox=this._textbox.create(e.bounds,e.style,e.text,e.options),this._active={element:t,context:e,provider:n},e.options&&e.options.resizable&&(this.resizable=!0),this._fire("activate")),!!e};const f={__depends__:[i.A],__init__:["directEditing"],directEditing:["type",p]}},49486(t,e,n){"use strict";function i(t,e){return function(t,e){e.appendChild(function(t,e){if(t.ownerDocument!==e.ownerDocument)try{return e.ownerDocument.importNode(t,!0)}catch(t){}return t}(t,e))}(e,t),t}n.d(e,{A:()=>y});var r={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":2,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":2,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function o(t,e,n){var i=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),o=r[i];o?(2===o&&"number"==typeof n&&(n=String(n)+"px"),t.style[i]=n):t.setAttributeNS(null,e,n)}function s(t,e,n){if("string"==typeof e){if(void 0===n)return function(t,e){return r[e]?t.style[e]:t.getAttributeNS(null,e)}(t,e);o(t,e,n)}else!function(t,e){var n,i,r=Object.keys(e);for(n=0;i=r[n];n++)o(t,i,e[i])}(t,e);return t}const a=Object.prototype.toString;function l(t){if(!t||!t.nodeType)throw new Error("A DOM element reference is required");this.el=t,this.list=t.classList}l.prototype.add=function(t){return this.list.add(t),this},l.prototype.remove=function(t){return"[object RegExp]"==a.call(t)?this.removeMatching(t):(this.list.remove(t),this)},l.prototype.removeMatching=function(t){const e=this.array();for(let n=0;n<e.length;n++)t.test(e[n])&&this.remove(e[n]);return this},l.prototype.toggle=function(t,e){return void 0!==e?e!==this.list.toggle(t,e)&&this.list.toggle(t):this.list.toggle(t),this},l.prototype.array=function(){return Array.from(this.list)},l.prototype.has=l.prototype.contains=function(t){return this.list.contains(t)};var c="http://www.w3.org/2000/svg",h='<svg xmlns="'+c+'"';function u(t,e){var n;return"<"===(t=t.trim()).charAt(0)?(n=function(t){var e=!1;"<svg"===t.substring(0,4)?-1===t.indexOf(c)&&(t=h+t.substring(4)):(t=h+">"+t+"</svg>",e=!0);var n=function(t){var e;return(e=new DOMParser).async=!1,e.parseFromString(t,"text/xml")}(t);if(!e)return n;for(var i=document.createDocumentFragment(),r=n.firstChild;r.firstChild;)i.appendChild(r.firstChild);return i}(t).firstChild,n=document.importNode(n,!0)):n=document.createElementNS(c,t),e&&s(n,e),n}var d=n(81340),p=n(78338),f=n(67319),g=1e5,m=1e5;function v(t,e){this._canvas=t;var n=this;e.on("diagram.init",function(){n._init(),n.toggle(!0)}),e.on("gridSnapping.toggle",function(t){var e=t.active;n.toggle(e),n._centerGridAroundViewbox()}),e.on("canvas.viewbox.changed",function(t){var e=t.viewbox;n._centerGridAroundViewbox(e)})}v.prototype._init=function(){var t=(0,d.P)("defs",this._canvas._svg);t||(t=u("defs"),i(this._canvas._svg,t));var e=this._pattern=u("pattern"),n="djs-grid-pattern-"+Math.trunc(1e6*Math.random());s(e,{id:n,width:p.E,height:p.E,patternUnits:"userSpaceOnUse"});var r=this._circle=u("circle");s(r,{cx:.5,cy:.5,r:.5,fill:"#ccc"}),i(e,r),i(t,e),s(this._gfx=u("rect"),{x:-5e4,y:-5e4,width:g,height:m,fill:`url(#${n})`})},v.prototype._centerGridAroundViewbox=function(t){t||(t=this._canvas.viewbox());var e=(0,f.pp)(t);s(this._gfx,{x:-5e4+(0,p.y)(e.x,p.E),y:-5e4+(0,p.y)(e.y,p.E)})},v.prototype.isVisible=function(){return this._visible},v.prototype.toggle=function(t){if(void 0===t&&(t=!this._visible),t!==this._visible){var e=this._getParent();t?i(e,this._gfx):function(t){for(var e;e=t.firstChild;)t.removeChild(e)}(e),this._visible=t}},v.prototype._getParent=function(){return this._canvas.getLayer("djs-grid",-2)},v.$inject=["canvas","eventBus"];var y={__init__:["grid"],grid:["type",v]}},72969(t,e,n){"use strict";function i(t,e){return function(t,e){e.appendChild(function(t,e){if(t.ownerDocument!==e.ownerDocument)try{return e.ownerDocument.importNode(t,!0)}catch(t){}return t}(t,e))}(e,t),t}n.d(e,{A:()=>m});var r={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":2,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":2,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function o(t,e,n){var i=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),o=r[i];o?(2===o&&"number"==typeof n&&(n=String(n)+"px"),t.style[i]=n):t.setAttributeNS(null,e,n)}function s(t,e,n){if("string"==typeof e){if(void 0===n)return function(t,e){return r[e]?t.style[e]:t.getAttributeNS(null,e)}(t,e);o(t,e,n)}else!function(t,e){var n,i,r=Object.keys(e);for(n=0;i=r[n];n++)o(t,i,e[i])}(t,e);return t}const a=Object.prototype.toString;function l(t){if(!t||!t.nodeType)throw new Error("A DOM element reference is required");this.el=t,this.list=t.classList}l.prototype.add=function(t){return this.list.add(t),this},l.prototype.remove=function(t){return"[object RegExp]"==a.call(t)?this.removeMatching(t):(this.list.remove(t),this)},l.prototype.removeMatching=function(t){const e=this.array();for(let n=0;n<e.length;n++)t.test(e[n])&&this.remove(e[n]);return this},l.prototype.toggle=function(t,e){return void 0!==e?e!==this.list.toggle(t,e)&&this.list.toggle(t):this.list.toggle(t),this},l.prototype.array=function(){return Array.from(this.list)},l.prototype.has=l.prototype.contains=function(t){return this.list.contains(t)};var c="http://www.w3.org/2000/svg",h='<svg xmlns="'+c+'"';function u(t,e){var n;return"<"===(t=t.trim()).charAt(0)?(n=function(t){var e=!1;"<svg"===t.substring(0,4)?-1===t.indexOf(c)&&(t=h+t.substring(4)):(t=h+">"+t+"</svg>",e=!0);var n=function(t){var e;return(e=new DOMParser).async=!1,e.parseFromString(t,"text/xml")}(t);if(!e)return n;for(var i=document.createDocumentFragment(),r=n.firstChild;r.firstChild;)i.appendChild(r.firstChild);return i}(t).firstChild,n=document.importNode(n,!0)):n=document.createElementNS(c,t),e&&s(n,e),n}function d(t,e){var n,r,o=(t=t||{}).borderColor||"rgba(0,0,0,0.1)",s=t.crossColor||"#CCC",a=-1;i(e.getLayer("djs-origin",-1),n=g("g",{"pointer-events":"none"})),!1!==t.showBorder&&i(n,g("path",{class:f("border"),d:p(["M",-22,a,"H",-1e3,"M",22,a,"H",6e3,"M",a,-22,"V",-1e3,"M",a,22,"V",3e3]),fill:"none",stroke:o,"stroke-width":"2px","stroke-dasharray":"6, 6","shape-rendering":"crispedges"})),i(n,g("path",{d:p(["M",-15,a,"H",15,"M",a,-15,"V",15]),class:f("cross"),fill:"none",stroke:s,"stroke-width":"2px","stroke-linecap":"round"})),(r=g("text",{x:-40,y:-10,fill:s,class:f("label")})).textContent="(0, 0)",i(n,r)}function p(t){return t.join(" ")}function f(t){return"djs-origin-"+t}function g(t,e){var n=u(t);return s(n,e),n}d.$inject=["config.origin","canvas"];const m={__init__:[d]}},96222(t,e,n){"use strict";n.d(e,{A:()=>P});var i=n(11719),r=n(7475),o=n(1591),s=n(24107),a=n(27828),l=n(57094),c=n(91970);function h(t,e){o.A.call(this,t,1),this.CONNECTION_STYLE=e.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=e.style({fill:"white",stroke:"fuchsia",strokeWidth:2}),this.FRAME_STYLE=e.style(["no-fill"],{stroke:"fuchsia",strokeDasharray:4,strokeWidth:2})}(0,r.A)(h,o.A),h.prototype.canRender=function(){return!0},h.prototype.drawShape=function(t,e,n){var i=(0,a.vt)("rect");return(0,a.CF)(i,{x:0,y:0,width:e.width||0,height:e.height||0}),(0,c.eb)(e)?(0,a.CF)(i,(0,l.assign)({},this.FRAME_STYLE,n||{})):(0,a.CF)(i,(0,l.assign)({},this.SHAPE_STYLE,n||{})),(0,a.BC)(t,i),i},h.prototype.drawConnection=function(t,e,n){var i=(0,s.RJ)(e.waypoints,(0,l.assign)({},this.CONNECTION_STYLE,n||{}));return(0,a.BC)(t,i),i},h.prototype.getShapePath=function(t){var e=t.x,n=t.y,i=t.width,r=[["M",e,n],["l",i,0],["l",0,t.height],["l",-i,0],["z"]];return(0,s.tx)(r)},h.prototype.getConnectionPath=function(t){var e,n,i=t.waypoints,r=[];for(e=0;n=i[e];e++)n=n.original||n,r.push([0===e?"M":"L",n.x,n.y]);return(0,s.tx)(r)},h.$inject=["eventBus","styles"];const u={__init__:["defaultRenderer"],defaultRenderer:["type",h],styles:["type",function(){var t={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},e=this;this.cls=function(t,e,n){var i=this.style(e,n);return(0,l.assign)(i,{class:t})},this.style=function(e,n){(0,l.isArray)(e)||n||(n=e,e=[]);var i=(0,l.reduce)(e,function(e,n){return(0,l.assign)(e,t[n]||{})},{});return n?(0,l.assign)(i,n):i},this.computeStyle=function(t,n,i){return(0,l.isArray)(n)||(i=n,n=[]),e.style(n||[],(0,l.assign)({},i,t||{}))}}]};var d=n(81340),p=n(93742),f=n(67319);function g(t,e){return Math.round(t*e)/e}function m(t){return(0,l.isNumber)(t)?t+"px":t}function v(t,e,n){const i=(0,a.vt)("g");(0,a.Ly)(i).add(e);const r=void 0!==n?n:t.childNodes.length-1;return t.insertBefore(i,t.childNodes[r]||null),i}const y={shape:["x","y","width","height"],connection:["waypoints"]};function b(t,e,n,i){this._eventBus=e,this._elementRegistry=i,this._graphicsFactory=n,this._rootsIdx=0,this._layers={},this._planes=[],this._rootElement=null,this._focused=!1,this._init(t||{})}function x(t,e){const n="matrix("+e.a+","+e.b+","+e.c+","+e.d+","+e.e+","+e.f+")";t.setAttribute("transform",n)}b.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"],b.prototype._init=function(t){const e=this._eventBus,n=this._container=function(t){const e=(t=(0,l.assign)({},{width:"100%",height:"100%"},t)).container||document.body,n=document.createElement("div");return n.setAttribute("class","djs-container djs-parent"),(0,d.HZ)(n,{position:"relative",overflow:"hidden",width:m(t.width),height:m(t.height)}),e.appendChild(n),n}(t),i=this._svg=(0,a.vt)("svg");(0,a.CF)(i,{width:"100%",height:"100%"}),(0,d.CF)(i,"tabindex",0),t.autoFocus&&e.on("element.hover",()=>{this.restoreFocus()}),e.on("element.mousedown",500,t=>{this.focus()}),i.addEventListener("focusin",()=>{this._setFocused(!0)}),i.addEventListener("focusout",()=>{this._setFocused(!1)}),i.addEventListener("mouseover",()=>{this._eventBus.fire("canvas.mouseover")}),i.addEventListener("mouseout",()=>{this._eventBus.fire("canvas.mouseout")}),(0,a.BC)(n,i);const r=this._viewport=v(i,"viewport");t.deferUpdate&&(this._viewboxChanged=(0,l.debounce)((0,l.bind)(this._viewboxChanged,this),300)),e.on("diagram.init",()=>{e.fire("canvas.init",{svg:i,viewport:r})}),e.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed","root.set"],()=>{delete this._cachedViewbox}),e.on("diagram.destroy",500,this._destroy,this),e.on("diagram.clear",500,this._clear,this)},b.prototype._destroy=function(){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});const t=this._container.parentNode;t&&t.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._planes,delete this._rootElement,delete this._viewport},b.prototype._setFocused=function(t){t!=this._focused&&(this._focused=t,this._eventBus.fire("canvas.focus.changed",{focused:t}))},b.prototype._clear=function(){this._elementRegistry.getAll().forEach(t=>{const e=(0,c.Pw)(t);"root"===e?this.removeRootElement(t):this._removeElement(t,e)}),this._planes=[],this._rootElement=null,delete this._cachedViewbox},b.prototype.focus=function(){this._svg.focus({preventScroll:!0}),this._setFocused(!0)},b.prototype.restoreFocus=function(){document.activeElement===document.body&&this.focus()},b.prototype.isFocused=function(){return this._focused},b.prototype.getDefaultLayer=function(){return this.getLayer("base",0)},b.prototype.getLayer=function(t,e){if(!t)throw new Error("must specify a name");let n=this._layers[t];if(n||(n=this._layers[t]=this._createLayer(t,e)),void 0!==e&&n.index!==e)throw new Error("layer <"+t+"> already created at index <"+e+">");return n.group},b.prototype._getChildIndex=function(t){return(0,l.reduce)(this._layers,function(e,n){return n.visible&&t>=n.index&&e++,e},0)},b.prototype._createLayer=function(t,e){void 0===e&&(e=1);const n=this._getChildIndex(e);return{group:v(this._viewport,"layer-"+t,n),index:e,visible:!0}},b.prototype.showLayer=function(t){if(!t)throw new Error("must specify a name");const e=this._layers[t];if(!e)throw new Error("layer <"+t+"> does not exist");const n=this._viewport,i=e.group,r=e.index;if(e.visible)return i;const o=this._getChildIndex(r);return n.insertBefore(i,n.childNodes[o]||null),e.visible=!0,i},b.prototype.hideLayer=function(t){if(!t)throw new Error("must specify a name");const e=this._layers[t];if(!e)throw new Error("layer <"+t+"> does not exist");const n=e.group;return e.visible?((0,a.TF)(n),e.visible=!1,n):n},b.prototype._removeLayer=function(t){const e=this._layers[t];e&&(delete this._layers[t],(0,a.TF)(e.group))},b.prototype.getActiveLayer=function(){const t=this._findPlaneForRoot(this.getRootElement());return t?t.layer:null},b.prototype.findRoot=function(t){if("string"==typeof t&&(t=this._elementRegistry.get(t)),!t)return;const e=this._findPlaneForRoot(function(t){for(;t.parent;)t=t.parent;return t}(t))||{};return e.rootElement},b.prototype.getRootElements=function(){return this._planes.map(function(t){return t.rootElement})},b.prototype._findPlaneForRoot=function(t){return(0,l.find)(this._planes,function(e){return e.rootElement===t})},b.prototype.getContainer=function(){return this._container},b.prototype._updateMarker=function(t,e,n){let i;t.id||(t=this._elementRegistry.get(t)),t.markers=t.markers||new Set,i=this._elementRegistry._elements[t.id],i&&((0,l.forEach)([i.gfx,i.secondaryGfx],function(i){i&&(n?(t.markers.add(e),(0,a.Ly)(i).add(e)):(t.markers.delete(e),(0,a.Ly)(i).remove(e)))}),this._eventBus.fire("element.marker.update",{element:t,gfx:i.gfx,marker:e,add:!!n}))},b.prototype.addMarker=function(t,e){this._updateMarker(t,e,!0)},b.prototype.removeMarker=function(t,e){this._updateMarker(t,e,!1)},b.prototype.hasMarker=function(t,e){return t.id||(t=this._elementRegistry.get(t)),!!t.markers&&t.markers.has(e)},b.prototype.toggleMarker=function(t,e){this.hasMarker(t,e)?this.removeMarker(t,e):this.addMarker(t,e)},b.prototype.getRootElement=function(){const t=this._rootElement;return t||this._planes.length?t:this.setRootElement(this.addRootElement(null))},b.prototype.addRootElement=function(t){const e=this._rootsIdx++;t||(t={id:"__implicitroot_"+e,children:[],isImplicit:!0});const n=t.layer="root-"+e;this._ensureValid("root",t);const i=this.getLayer(n,0);return this.hideLayer(n),this._addRoot(t,i),this._planes.push({rootElement:t,layer:i}),t},b.prototype.removeRootElement=function(t){if("string"==typeof t&&(t=this._elementRegistry.get(t)),this._findPlaneForRoot(t))return this._removeRoot(t),this._removeLayer(t.layer),this._planes=this._planes.filter(function(e){return e.rootElement!==t}),this._rootElement===t&&(this._rootElement=null),t},b.prototype.setRootElement=function(t){if(t===this._rootElement)return t;let e;if(!t)throw new Error("rootElement required");return e=this._findPlaneForRoot(t),e||(t=this.addRootElement(t)),this._setRoot(t),t},b.prototype._removeRoot=function(t){const e=this._elementRegistry,n=this._eventBus;n.fire("root.remove",{element:t}),n.fire("root.removed",{element:t}),e.remove(t)},b.prototype._addRoot=function(t,e){const n=this._elementRegistry,i=this._eventBus;i.fire("root.add",{element:t}),n.add(t,e),i.fire("root.added",{element:t,gfx:e})},b.prototype._setRoot=function(t,e){const n=this._rootElement;n&&(this._elementRegistry.updateGraphics(n,null,!0),this.hideLayer(n.layer)),t&&(e||(e=this._findPlaneForRoot(t).layer),this._elementRegistry.updateGraphics(t,this._svg,!0),this.showLayer(t.layer)),this._rootElement=t,this._eventBus.fire("root.set",{element:t})},b.prototype._ensureValid=function(t,e){if(!e.id)throw new Error("element must have an id");if(this._elementRegistry.get(e.id))throw new Error("element <"+e.id+"> already exists");const n=y[t];if(!(0,l.every)(n,function(t){return void 0!==e[t]}))throw new Error("must supply { "+n.join(", ")+" } with "+t)},b.prototype._setParent=function(t,e,n){(0,p.WQ)(e.children,t,n),t.parent=e},b.prototype._addElement=function(t,e,n,i){n=n||this.getRootElement();const r=this._eventBus,o=this._graphicsFactory;this._ensureValid(t,e),r.fire(t+".add",{element:e,parent:n}),this._setParent(e,n,i);const s=o.create(t,e,i);return this._elementRegistry.add(e,s),o.update(t,e,s),r.fire(t+".added",{element:e,gfx:s}),e},b.prototype.addShape=function(t,e,n){return this._addElement("shape",t,e,n)},b.prototype.addConnection=function(t,e,n){return this._addElement("connection",t,e,n)},b.prototype._removeElement=function(t,e){const n=this._elementRegistry,i=this._graphicsFactory,r=this._eventBus;if(t=n.get(t.id||t))return r.fire(e+".remove",{element:t}),i.remove(t),(0,p.TF)(t.parent&&t.parent.children,t),t.parent=null,r.fire(e+".removed",{element:t}),n.remove(t),t},b.prototype.removeShape=function(t){return this._removeElement(t,"shape")},b.prototype.removeConnection=function(t){return this._removeElement(t,"connection")},b.prototype.getGraphics=function(t,e){return this._elementRegistry.getGraphics(t,e)},b.prototype._changeViewbox=function(t){this._eventBus.fire("canvas.viewbox.changing"),t.apply(this),this._cachedViewbox=null,this._viewboxChanged()},b.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})},b.prototype.viewbox=function(t){if(void 0===t&&this._cachedViewbox)return structuredClone(this._cachedViewbox);const e=this._viewport,n=this.getSize();let i,r,o,s,l,c,h;return t?(this._changeViewbox(function(){l=Math.min(n.width/t.width,n.height/t.height);const i=this._svg.createSVGMatrix().scale(l).translate(-t.x,-t.y);(0,a.pd)(e,i)}),t):(o=this._rootElement?this.getActiveLayer():null,i=o&&o.getBBox()||{},s=(0,a.pd)(e),r=s?s.matrix:(0,a.uK)(),l=g(r.a,1e3),c=g(-r.e||0,1e3),h=g(-r.f||0,1e3),t=this._cachedViewbox={x:c?c/l:0,y:h?h/l:0,width:n.width/l,height:n.height/l,scale:l,inner:{width:i.width||0,height:i.height||0,x:i.x||0,y:i.y||0},outer:n})},b.prototype.scroll=function(t){const e=this._viewport;let n=e.getCTM();return t&&this._changeViewbox(function(){t=(0,l.assign)({dx:0,dy:0},t||{}),n=this._svg.createSVGMatrix().translate(t.dx,t.dy).multiply(n),x(e,n)}),{x:n.e,y:n.f}},b.prototype.scrollToElement=function(t,e){let n=100;"string"==typeof t&&(t=this._elementRegistry.get(t));const i=this.findRoot(t);if(i!==this.getRootElement()&&this.setRootElement(i),i===t)return;e||(e={}),"number"==typeof e&&(n=e),e={top:e.top||n,right:e.right||n,bottom:e.bottom||n,left:e.left||n};const r=(0,c.U7)(t),o=(0,f.Fy)(r),s=this.viewbox(),a=this.zoom();let l,h;s.y+=e.top/a,s.x+=e.left/a,s.width-=(e.right+e.left)/a,s.height-=(e.bottom+e.top)/a;const u=(0,f.Fy)(s);if(r.width<s.width&&r.height<s.height){const t=Math.max(0,o.right-u.right),e=Math.min(0,o.left-u.left),n=Math.max(0,o.bottom-u.bottom),i=Math.min(0,o.top-u.top);l=t||e,h=n||i}else l=r.x-s.x,h=r.y-s.y;this.scroll({dx:-l*a,dy:-h*a})},b.prototype.zoom=function(t,e){if(!t)return this.viewbox(t).scale;if("fit-viewport"===t)return this._fitViewport(e);let n,i;return this._changeViewbox(function(){"object"!=typeof e&&(n=this.viewbox().outer,e={x:n.width/2,y:n.height/2}),i=this._setZoom(t,e)}),g(i.a,1e3)},b.prototype._fitViewport=function(t){const e=this.viewbox(),n=e.outer,i=e.inner;let r,o;return i.x>=0&&i.y>=0&&i.x+i.width<=n.width&&i.y+i.height<=n.height&&!t?o={x:0,y:0,width:Math.max(i.width+i.x,n.width),height:Math.max(i.height+i.y,n.height)}:(r=Math.min(1,n.width/i.width,n.height/i.height),o={x:i.x+(t?i.width/2-n.width/r/2:0),y:i.y+(t?i.height/2-n.height/r/2:0),width:n.width/r,height:n.height/r}),this.viewbox(o),this.viewbox(!1).scale},b.prototype._setZoom=function(t,e){const n=this._svg,i=this._viewport,r=n.createSVGMatrix(),o=n.createSVGPoint();let s,a,c,h,u;c=i.getCTM();const d=c.a;return e?(s=(0,l.assign)(o,e),a=s.matrixTransform(c.inverse()),h=r.translate(a.x,a.y).scale(1/d*t).translate(-a.x,-a.y),u=c.multiply(h)):u=r.scale(t),x(this._viewport,u),u},b.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}},b.prototype.getAbsoluteBBox=function(t){const e=this.viewbox();let n;return n=t.waypoints?this.getGraphics(t).getBBox():t,{x:n.x*e.scale-e.x*e.scale,y:n.y*e.scale-e.y*e.scale,width:n.width*e.scale,height:n.height*e.scale}},b.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var w="data-element-id";function _(t){this._elements={},this._eventBus=t}_.$inject=["eventBus"],_.prototype.add=function(t,e,n){var i=t.id;this._validateId(i),(0,a.CF)(e,w,i),n&&(0,a.CF)(n,w,i),this._elements[i]={element:t,gfx:e,secondaryGfx:n}},_.prototype.remove=function(t){var e=this._elements,n=t.id||t,i=n&&e[n];i&&((0,a.CF)(i.gfx,w,""),i.secondaryGfx&&(0,a.CF)(i.secondaryGfx,w,""),delete e[n])},_.prototype.updateId=function(t,e){this._validateId(e),"string"==typeof t&&(t=this.get(t)),this._eventBus.fire("element.updateId",{element:t,newId:e});var n=this.getGraphics(t),i=this.getGraphics(t,!0);this.remove(t),t.id=e,this.add(t,n,i)},_.prototype.updateGraphics=function(t,e,n){var i=t.id||t,r=this._elements[i];return n?r.secondaryGfx=e:r.gfx=e,e&&(0,a.CF)(e,w,i),e},_.prototype.get=function(t){var e;e="string"==typeof t?t:t&&(0,a.CF)(t,w);var n=this._elements[e];return n&&n.element},_.prototype.filter=function(t){var e=[];return this.forEach(function(n,i){t(n,i)&&e.push(n)}),e},_.prototype.find=function(t){for(var e=this._elements,n=Object.keys(e),i=0;i<n.length;i++){var r=e[n[i]],o=r.element;if(t(o,r.gfx))return o}},_.prototype.getAll=function(){return this.filter(function(t){return t})},_.prototype.forEach=function(t){var e=this._elements;Object.keys(e).forEach(function(n){var i=e[n],r=i.element,o=i.gfx;return t(r,o)})},_.prototype.getGraphics=function(t,e){var n=t.id||t,i=this._elements[n];return i&&(e?i.secondaryGfx:i.gfx)},_.prototype._validateId=function(t){if(!t)throw new Error("element must have an id");if(this._elements[t])throw new Error("element with id "+t+" already added")};var O=n(87496),k=n(54988),S=n(37706),E=n(46757);function C(t,e){this._eventBus=t,this._elementRegistry=e}function A(t,e,n){var i=n||e.firstChild;t!==i&&e.insertBefore(t,i)}C.$inject=["eventBus","elementRegistry"],C.prototype._getChildrenContainer=function(t){var e,n=this._elementRegistry.getGraphics(t);return t.parent?(e=(0,S.i)(n))||(e=(0,a.vt)("g"),(0,a.Ly)(e).add("djs-children"),(0,a.BC)(n.parentNode,e)):e=n,e},C.prototype._clear=function(t){var e=(0,S.P)(t);return(0,d.IU)(e),e},C.prototype._createContainer=function(t,e,n,i){var r=(0,a.vt)("g");(0,a.Ly)(r).add("djs-group"),void 0!==n?A(r,e,e.childNodes[n]):(0,a.BC)(e,r);var o=(0,a.vt)("g");(0,a.Ly)(o).add("djs-element"),(0,a.Ly)(o).add("djs-"+t),i&&(0,a.Ly)(o).add("djs-frame"),(0,a.BC)(r,o);var s=(0,a.vt)("g");return(0,a.Ly)(s).add("djs-visual"),(0,a.BC)(o,s),o},C.prototype.create=function(t,e,n){var i=this._getChildrenContainer(e.parent);return this._createContainer(t,i,n,(0,c.eb)(e))},C.prototype.updateContainments=function(t){var e,n=this,i=this._elementRegistry;e=(0,l.reduce)(t,function(t,e){return e.parent&&(t[e.parent.id]=e.parent),t},{}),(0,l.forEach)(e,function(t){var e=t.children;if(e){var r=n._getChildrenContainer(t);(0,l.forEach)(e.slice().reverse(),function(t){A(i.getGraphics(t).parentNode,r)})}})},C.prototype.drawShape=function(t,e,n={}){return this._eventBus.fire("render.shape",{gfx:t,element:e,attrs:n})},C.prototype.getShapePath=function(t){return this._eventBus.fire("render.getShapePath",t)},C.prototype.drawConnection=function(t,e,n={}){return this._eventBus.fire("render.connection",{gfx:t,element:e,attrs:n})},C.prototype.getConnectionPath=function(t){return this._eventBus.fire("render.getConnectionPath",t)},C.prototype.update=function(t,e,n){if(e.parent){var i=this._clear(n);if("shape"===t)this.drawShape(i,e),(0,E.Tl)(n,e.x,e.y);else{if("connection"!==t)throw new Error("unknown type: "+t);this.drawConnection(i,e)}e.hidden?(0,a.CF)(n,"display","none"):(0,a.CF)(n,"display","block")}},C.prototype.remove=function(t){var e=this._elementRegistry.getGraphics(t);(0,a.TF)(e.parentNode)};const T={__depends__:[u],__init__:["canvas"],canvas:["type",b],elementRegistry:["type",_],elementFactory:["type",O.A],eventBus:["type",k.A],graphicsFactory:["type",C]};function P(t,e){this._injector=e||function(t){return e=[{config:["value",t=t||{}]},T].concat(t.modules||[]),(n=new i.zZ(e)).init(),n;var e,n}(t),this.get("eventBus").fire("diagram.init")}P.prototype.get=function(t,e){return this._injector.get(t,e)},P.prototype.invoke=function(t,e,n){return this._injector.invoke(t,e,n)},P.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")},P.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")}},95917(t,e,n){"use strict";n.d(e,{A:()=>r});var i=n(57094);function r(t,e){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[],trigger:null},this._injector=e,this._eventBus=t,this._uid=1,t.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}r.$inject=["eventBus","injector"],r.prototype.execute=function(t,e){if(!t)throw new Error("command required");this._currentExecution.trigger="execute";const n={command:t,context:e};this._pushAction(n),this._internalExecute(n),this._popAction()},r.prototype.canExecute=function(t,e){const n={command:t,context:e},i=this._getHandler(t);let r=this._fire(t,"canExecute",n);if(void 0===r){if(!i)return!1;i.canExecute&&(r=i.canExecute(e))}return r},r.prototype.clear=function(t){this._stack.length=0,this._stackIdx=-1,!1!==t&&this._fire("changed",{trigger:"clear"})},r.prototype.undo=function(){let t,e=this._getUndoAction();if(e){for(this._currentExecution.trigger="undo",this._pushAction(e);e&&(this._internalUndo(e),t=this._getUndoAction(),t&&t.id===e.id);)e=t;this._popAction()}},r.prototype.redo=function(){let t,e=this._getRedoAction();if(e){for(this._currentExecution.trigger="redo",this._pushAction(e);e&&(this._internalExecute(e,!0),t=this._getRedoAction(),t&&t.id===e.id);)e=t;this._popAction()}},r.prototype.register=function(t,e){this._setHandler(t,e)},r.prototype.registerHandler=function(t,e){if(!t||!e)throw new Error("command and handlerCls must be defined");const n=this._injector.instantiate(e);this.register(t,n)},r.prototype.canUndo=function(){return!!this._getUndoAction()},r.prototype.canRedo=function(){return!!this._getRedoAction()},r.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]},r.prototype._getUndoAction=function(){return this._stack[this._stackIdx]},r.prototype._internalUndo=function(t){const e=t.command,n=t.context,i=this._getHandler(e);this._atomicDo(()=>{this._fire(e,"revert",t),i.revert&&this._markDirty(i.revert(n)),this._revertedAction(t),this._fire(e,"reverted",t)})},r.prototype._fire=function(t,e,n){arguments.length<3&&(n=e,e=null);const i=e?[t+"."+e,e]:[t];let r;n=this._eventBus.createEvent(n);for(const t of i)if(r=this._eventBus.fire("commandStack."+t,n),n.cancelBubble)break;return r},r.prototype._createId=function(){return this._uid++},r.prototype._atomicDo=function(t){const e=this._currentExecution;e.atomic=!0;try{t()}finally{e.atomic=!1}},r.prototype._internalExecute=function(t,e){const n=t.command,i=t.context,r=this._getHandler(n);if(!r)throw new Error("no command handler registered for <"+n+">");this._pushAction(t),e||(this._fire(n,"preExecute",t),r.preExecute&&r.preExecute(i),this._fire(n,"preExecuted",t)),this._atomicDo(()=>{this._fire(n,"execute",t),r.execute&&this._markDirty(r.execute(i)),this._executedAction(t,e),this._fire(n,"executed",t)}),e||(this._fire(n,"postExecute",t),r.postExecute&&r.postExecute(i),this._fire(n,"postExecuted",t)),this._popAction()},r.prototype._pushAction=function(t){const e=this._currentExecution,n=e.actions,i=n[0];if(e.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+t.command+")");t.id||(t.id=i&&i.id||this._createId()),n.push(t)},r.prototype._popAction=function(){const t=this._currentExecution,e=t.trigger,n=t.actions,r=t.dirty;n.pop(),n.length||(this._eventBus.fire("elements.changed",{elements:(0,i.uniqueBy)("id",r.reverse())}),r.length=0,this._fire("changed",{trigger:e}),t.trigger=null)},r.prototype._markDirty=function(t){const e=this._currentExecution;t&&(t=(0,i.isArray)(t)?t:[t],e.dirty=e.dirty.concat(t))},r.prototype._executedAction=function(t,e){const n=++this._stackIdx;e||this._stack.splice(n,this._stack.length,t)},r.prototype._revertedAction=function(t){this._stackIdx--},r.prototype._getHandler=function(t){return this._handlerMap[t]},r.prototype._setHandler=function(t,e){if(!t||!e)throw new Error("command and handler required");if(this._handlerMap[t])throw new Error("overriding handler for command <"+t+">");this._handlerMap[t]=e}},19112(t,e,n){"use strict";n.d(e,{A:()=>i});const i={commandStack:["type",n(95917).A]}},87496(t,e,n){"use strict";n.d(e,{A:()=>o});var i=n(49768),r=n(57094);function o(){this._uid=12}o.prototype.createRoot=function(t){return this.create("root",t)},o.prototype.createLabel=function(t){return this.create("label",t)},o.prototype.createShape=function(t){return this.create("shape",t)},o.prototype.createConnection=function(t){return this.create("connection",t)},o.prototype.create=function(t,e){return(e=(0,r.assign)({},e||{})).id||(e.id=t+"_"+this._uid++),(0,i.v)(t,e)}},1591(t,e,n){"use strict";function i(t,e){var n=this;e=e||1e3,t.on(["render.shape","render.connection"],e,function(t,e){var i=t.type,r=e.element,o=e.gfx,s=e.attrs;if(n.canRender(r))return"render.shape"===i?n.drawShape(o,r,s):n.drawConnection(o,r,s)}),t.on(["render.getShapePath","render.getConnectionPath"],e,function(t,e){if(n.canRender(e))return"render.getShapePath"===t.type?n.getShapePath(e):n.getConnectionPath(e)})}n.d(e,{A:()=>i}),i.prototype.canRender=function(t){},i.prototype.drawShape=function(t,e){},i.prototype.drawConnection=function(t,e){},i.prototype.getShapePath=function(t){},i.prototype.getConnectionPath=function(t){}},30566(t,e,n){"use strict";n.d(e,{A:()=>c});var i=n(57094);function r(t){return t&&t[t.length-1]}function o(t){return t.y}function s(t){return t.x}var a={left:s,center:s,right:function(t){return t.x+t.width},top:o,middle:o,bottom:function(t){return t.y+t.height}};function l(t,e){this._modeling=t,this._rules=e}l.$inject=["modeling","rules"],l.prototype._getOrientationDetails=function(t){var e="x",n="width";return-1!==["top","bottom","middle"].indexOf(t)&&(e="y",n="height"),{axis:e,dimension:n}},l.prototype._isType=function(t,e){return-1!==e.indexOf(t)},l.prototype._alignmentPosition=function(t,e){var n,o,s,a=this._getOrientationDetails(t),l=a.axis,c=a.dimension,h={},u={},d=!1;if(this._isType(t,["left","top"]))h[t]=e[0][l];else if(this._isType(t,["right","bottom"]))s=r(e),h[t]=s[l]+s[c];else if(this._isType(t,["center","middle"])){if((0,i.forEach)(e,function(t){var e=t[l]+Math.round(t[c]/2);u[e]?u[e].elements.push(t):u[e]={elements:[t],center:e}}),n=(0,i.sortBy)(u,function(t){return t.elements.length>1&&(d=!0),t.elements.length}),d)return h[t]=r(n).center,h;o=e[0],s=r(e=(0,i.sortBy)(e,function(t){return t[l]+t[c]})),h[t]=function(t,e){return Math.round((t[l]+e[l]+e[c])/2)}(o,s)}return h},l.prototype.trigger=function(t,e){var n,r=this._modeling,o=(0,i.filter)(t,function(t){return!(t.waypoints||t.host||t.labelTarget)});if(n=this._rules.allowed("elements.align",{elements:o}),(0,i.isArray)(n)&&(o=n),!(o.length<2)&&n){var s=a[e],l=(0,i.sortBy)(o,s),c=this._alignmentPosition(e,l);r.alignElements(l,c)}};const c={__init__:["alignElements"],alignElements:["type",l]}},27714(t,e,n){"use strict";n.d(e,{D6:()=>s,cR:()=>o,dq:()=>c,u6:()=>a});var i=n(67319),r=n(57094),o=50;function s(t,e,n,i){for(var r;r=l(t,n,e);)n=i(e,n,r);return n}function a(t){return function(e,n,i){var r={x:n.x,y:n.y};return["x","y"].forEach(function(o){var s=t[o];if(s){var a="x"===o?"width":"height",l=s.margin,c=s.minDistance;r[o]=l<0?Math.min(i[o]+l-e[a]/2,n[o]-c+l):Math.max(i[o]+i[a]+l+e[a]/2,n[o]+c+l)}}),r}}function l(t,e,n){var o={x:e.x-n.width/2,y:e.y-n.height/2,width:n.width,height:n.height},s=function(t){var e=h(t);return t.host&&(e=e.concat(h(t.host))),t.attachers&&(e=e.concat(t.attachers.reduce(function(t,e){return t.concat(h(e))},[]))),e}(t);return(0,r.find)(s,function(t){return t!==n&&"intersect"===(0,i.vc)(t,o,10)})}function c(t,e){e||(e={});var n=e.defaultDistance||o,s=e.direction||"e",a=e.filter,l=e.getWeight||function(e){return e.source===t?1:-1},c=e.maxDistance||250,h=e.reference||"start";function d(t,e){return"n"===s?"start"===h?(0,i.Fy)(t).top-(0,i.Fy)(e).bottom:"center"===h?(0,i.Fy)(t).top-(0,i.pp)(e).y:(0,i.Fy)(t).top-(0,i.Fy)(e).top:"w"===s?"start"===h?(0,i.Fy)(t).left-(0,i.Fy)(e).right:"center"===h?(0,i.Fy)(t).left-(0,i.pp)(e).x:(0,i.Fy)(t).left-(0,i.Fy)(e).left:"s"===s?"start"===h?(0,i.Fy)(e).top-(0,i.Fy)(t).bottom:"center"===h?(0,i.pp)(e).y-(0,i.Fy)(t).bottom:(0,i.Fy)(e).bottom-(0,i.Fy)(t).bottom:"start"===h?(0,i.Fy)(e).left-(0,i.Fy)(t).right:"center"===h?(0,i.pp)(e).x-(0,i.Fy)(t).right:(0,i.Fy)(e).right-(0,i.Fy)(t).right}a||(a=u);var p=t.incoming.filter(a).map(function(e){var n=l(e),i=n<0?d(e.source,t):d(t,e.source);return{id:e.source.id,distance:i,weight:n}}),f=t.outgoing.filter(a).map(function(e){var n=l(e),i=n>0?d(t,e.target):d(e.target,t);return{id:e.target.id,distance:i,weight:n}}),g=p.concat(f).reduce(function(t,e){return t[e.id+"__weight_"+e.weight]=e,t},{});return(0,r.reduce)(g,function(t,e){var n=e.distance,i=e.weight;return n<0||n>c||(t[String(n)]||(t[String(n)]=0),t[String(n)]+=1*i,(!t.distance||t[t.distance]<t[String(n)])&&(t.distance=n)),t},{}).distance||n}function h(t){return(e=t,e.outgoing.map(function(t){return t.target})).concat(function(t){return t.incoming.map(function(t){return t.source})}(t));var e}function u(){return!0}},89768(t,e,n){"use strict";n.d(e,{A:()=>a});var i=n(67319),r=n(27714);function o(t,e,n){t.on("autoPlace",100,function(t){var e=t.shape;return function(t,e,n){n||(n={});var o=n.defaultDistance||r.cR,s=(0,i.pp)(t);return{x:(0,i.Fy)(t).right+o+e.width/2,y:s.y}}(t.source,e)}),t.on("autoPlace.end",function(t){n.scrollToElement(t.shape)}),this.append=function(n,i,r){t.fire("autoPlace.start",{source:n,shape:i});var o=t.fire("autoPlace",{source:n,shape:i}),s=e.appendShape(n,i,o,n.parent,r);return t.fire("autoPlace.end",{source:n,shape:s}),s}}function s(t,e){t.on("autoPlace.end",500,function(t){e.select(t.shape)})}o.$inject=["eventBus","modeling","canvas"],s.$inject=["eventBus","selection"];const a={__init__:["autoPlaceSelectionBehavior"],autoPlace:["type",o],autoPlaceSelectionBehavior:["type",s]}},15167(t,e,n){"use strict";n.d(e,{A:()=>l});var i=n(43513),r=n(57094),o=n(51303);function s(t,e,n){this._canvas=n,this._opts=(0,r.assign)({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},t);var i=this;e.on("drag.move",function(t){var e=i._toBorderPoint(t);i.startScroll(e)}),e.on(["drag.cleanup"],function(){i.stopScroll()})}function a(t,e,n){return e<t&&t<n}s.$inject=["config.autoScroll","eventBus","canvas"],s.prototype.startScroll=function(t){var e=this._canvas,n=this._opts,i=this,r=e.getContainer().getBoundingClientRect(),o=[t.x,t.y,r.width-t.x,r.height-t.y];this.stopScroll();for(var s=0,l=0,c=0;c<4;c++)a(o[c],n.scrollThresholdOut[c],n.scrollThresholdIn[c])&&(0===c?s=n.scrollStep:1==c?l=n.scrollStep:2==c?s=-n.scrollStep:3==c&&(l=-n.scrollStep));0===s&&0===l||(e.scroll({dx:s,dy:l}),this._scrolling=setTimeout(function(){i.startScroll(t)},n.scrollRepeatTimeout))},s.prototype.stopScroll=function(){clearTimeout(this._scrolling)},s.prototype.setOptions=function(t){this._opts=(0,r.assign)({},this._opts,t)},s.prototype._toBorderPoint=function(t){var e=this._canvas._container.getBoundingClientRect(),n=(0,o.gK)(t.originalEvent);return{x:n.x-e.left,y:n.y-e.top}};const l={__depends__:[i.A],__init__:["autoScroll"],autoScroll:["type",s]}},67392(t,e,n){"use strict";function i(t){return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))}function r(t){return Math.atan((t[1].y-t[0].y)/(t[1].x-t[0].x))}function o(t,e){return e?{x:Math.cos(e)*t.x-Math.sin(e)*t.y,y:Math.sin(e)*t.x+Math.cos(e)*t.y}:t}function s(t,e){var n=e[0],i=e[1],r={x:i.x-n.x,y:i.y-n.y},o=function(t,e,n){var i=[{n:t[0]-n[0],lambda:e[0]},{n:t[1]-n[1],lambda:e[1]}];return-(i[0].n*e[0]+i[1].n*e[1])/(i[0].lambda*e[0]+i[1].lambda*e[1])}([n.x,n.y],[r.x,r.y],[t.x,t.y]);return{x:n.x+o*r.x,y:n.y+o*r.y}}function a(t,e){var n=s(t,e);return i({x:n.x-t.x,y:n.y-t.y})}function l(t,e){return i({x:t.x-e.x,y:t.y-e.y})}n.d(e,{P0:()=>s,VE:()=>o,YZ:()=>a,_H:()=>r,kf:()=>l})},86816(t,e,n){"use strict";n.d(e,{A:()=>U});var i=n(43513),r=n(81734),o=n(57094),s=n(81340),a=n(51303),l=n(71711),c=n(27828),h=n(46757),u=n(42596),d=n(67392),p="djs-bendpoint",f="djs-segment-dragger";function g(t,e,n){var i=function(t,e){var n,i=(0,a.gK)(e),r=t._container.getBoundingClientRect();n={x:r.left,y:r.top};var o=t.viewbox();return{x:o.x+(i.x-n.x)/o.scale,y:o.y+(i.y-n.y)/o.scale}}(t,n);return(0,u.C)(e,i)}function m(t,e){var n=(0,c.vt)("g");(0,c.Ly)(n).add(p),(0,c.BC)(t,n);var i=(0,c.vt)("circle");(0,c.CF)(i,{cx:0,cy:0,r:4}),(0,c.Ly)(i).add("djs-visual"),(0,c.BC)(n,i);var r=(0,c.vt)("circle");return(0,c.CF)(r,{cx:0,cy:0,r:10}),(0,c.Ly)(r).add("djs-hit"),(0,c.BC)(n,r),e&&(0,c.Ly)(n).add(e),n}function v(t,e,n){var i=(0,c.vt)("g"),r=(0,l.P8)(e,n),o=(0,l.ke)(e,n);return(0,c.BC)(t,i),function(t,e,n,i){var r=(0,c.vt)("g");(0,c.BC)(t,r);var o=function(t,e,n){var i=e.x-t.x,r=e.y-t.y;return y("h"===n?i:r)}(e,n,i),s=(0,c.vt)("rect");(0,c.CF)(s,{x:-9,y:-3,width:18,height:6}),(0,c.Ly)(s).add("djs-visual"),(0,c.BC)(r,s);var a=(0,c.vt)("rect");(0,c.CF)(a,{x:-o/2,y:-8.5,width:o,height:17}),(0,c.Ly)(a).add("djs-hit"),(0,c.BC)(r,a),(0,h.e$)(r,"v"===i?90:0,0,0)}(i,e,n,o),(0,c.Ly)(i).add(f),(0,c.Ly)(i).add("h"===o?"horizontal":"vertical"),(0,h.Tl)(i,r.x,r.y),i}function y(t){return Math.abs(Math.round(2*t/3))}var b=n(75340),x=n(72120);function w(t,e,n,i,r){function a(t,e,i){s.f0.bind(t,e,function(t){n.triggerMouseEvent(e,t,i),t.stopPropagation()})}function u(t,n){var i=e.getLayer("overlays"),r=(0,s.P)('.djs-bendpoints[data-element-id="'+(0,b.F)(t.id)+'"]',i);return!r&&n&&(r=(0,c.vt)("g"),(0,c.CF)(r,{"data-element-id":t.id}),(0,c.Ly)(r).add("djs-bendpoints"),(0,c.BC)(i,r),a(r,"mousedown",t),a(r,"click",t),a(r,"dblclick",t)),r}function d(t,e){return(0,s.P)('.djs-segment-dragger[data-segment-idx="'+t+'"]',e)}function w(t,e){e.waypoints.forEach(function(e,n){var i=m(t);(0,c.BC)(t,i),(0,h.Tl)(i,e.x,e.y)}),m(t,"floating")}function _(t,e){for(var n,i,r,o=e.waypoints,s=1;s<o.length;s++)n=o[s-1],i=o[s],(0,l.ke)(n,i)&&(r=v(t,n,i),(0,c.CF)(r,{"data-segment-idx":s}),a(r,"mousemove",e))}function O(t){var e=u(t);return e||(w(e=u(t,!0),t),_(e,t)),e}function k(t){var e=u(t);e&&(function(t){(0,o.forEach)((0,s.YG)("."+f,t),function(t){(0,c.TF)(t)})}(e),function(t){(0,o.forEach)((0,s.YG)("."+p,t),function(t){(0,c.TF)(t)})}(e),_(e,t),w(e,t))}t.on("connection.changed",function(t){k(t.element)}),t.on("connection.remove",function(t){var e=u(t.element);e&&(0,c.TF)(e)}),t.on("element.marker.update",function(t){var e,n=t.element;n.waypoints&&(e=O(n),t.add?(0,c.Ly)(e).add(t.marker):(0,c.Ly)(e).remove(t.marker))}),t.on("element.mousemove",function(t){var n,i,r=t.element,o=r.waypoints;if(o){if(n=u(r,!0),!(i=g(e,o,t.originalEvent)))return;!function(t,e){var n=(0,s.P)(".floating",t),i=e.point;n&&(0,h.Tl)(n,i.x,i.y)}(n,i),i.bendpoint||function(t,e,n){var i,r,o=d(e.index,t),a=n[e.index-1],c=n[e.index],u=e.point,p=(0,l.P8)(a,c),f=(0,l.ke)(a,c);o&&(i=function(t){return(0,s.P)(".djs-visual",t)}(o),r={x:u.x-p.x,y:u.y-p.y},"v"===f&&(r={x:r.y,y:r.x}),(0,h.Tl)(i,r.x,r.y))}(n,i,o)}}),t.on("element.mousedown",function(t){if((0,x.ls)(t)){var n=t.originalEvent,o=t.element;if(o.waypoints)return function(t,n){var o,s=n.waypoints,a=g(e,s,t);if(a)return o=function(t,e){var n,i,r=t.waypoints;return e.index<=0||e.bendpoint?null:(n={start:r[e.index-1],end:r[e.index]},(i=(0,l.ke)(n.start,n.end))?y("h"===i?n.end.x-n.start.x:n.end.y-n.start.y)/2:null)}(n,a),function(t,e,n){var i,r,o,s,a,c,h=t.index,u=t.point;return!(h<=0||t.bendpoint)&&(i=e[h-1],r=e[h],o=(0,l.P8)(i,r),s=(0,l.ke)(i,r),a=Math.abs(u.x-o.x),c=Math.abs(u.y-o.y),s&&a<=n&&c<=n)}(a,s,o)?r.start(t,n,a.index):i.start(t,n,a.index,!a.bendpoint),!0}(n,o)}}),t.on("selection.changed",function(t){var e=t.newSelection[0];e&&e.waypoints&&O(e)}),t.on("element.hover",function(t){var e=t.element;e.waypoints&&(O(e),n.registerEvent(t.gfx,"mousemove","element.mousemove"))}),t.on("element.out",function(t){n.unregisterEvent(t.gfx,"mousemove","element.mousemove")}),t.on("element.updateId",function(t){var e=t.element,n=t.newId;if(e.waypoints){var i=u(e);i&&(0,c.CF)(i,{"data-element-id":n})}}),this.addHandles=O,this.updateHandles=k,this.getBendpointsContainer=u,this.getSegmentDragger=d}w.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];var _=n(67319),O=Math.round,k="reconnectStart",S="reconnectEnd",E="updateWaypoints";function C(t,e,n,i,r,o){this._injector=t,this.start=function(t,e,o,s){var a,l=n.getGraphics(e),c=e.source,h=e.target,u=e.waypoints,d=(a=s||0!==o?s||o!==u.length-1?E:S:k)===E?"connection.updateWaypoints":"connection.reconnect",p=r.allowed(d,{connection:e,source:c,target:h});!1===p&&(p=r.allowed(d,{connection:e,source:h,target:c})),!1!==p&&i.init(t,"bendpoint.move",{data:{connection:e,connectionGfx:l,context:{allowed:p,bendpointIndex:o,connection:e,source:c,target:h,insert:s,type:a}}})},e.on("bendpoint.move.hover",function(t){var e,n=t.context,i=n.connection,o=i.source,s=i.target,a=t.hover,l=n.type;if(n.hover=a,a){var c=l===E?"connection.updateWaypoints":"connection.reconnect";if(e=n.allowed=r.allowed(c,{connection:i,source:l===k?a:o,target:l===S?a:s}))return n.source=l===k?a:o,void(n.target=l===S?a:s);!1===e&&(e=n.allowed=r.allowed(c,{connection:i,source:l===S?a:s,target:l===k?a:o})),e&&(n.source=l===S?a:s,n.target=l===k?a:o)}}),e.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(t){var e=t.context,n=e.type;e.hover=null,e.source=null,e.target=null,n!==E&&(e.allowed=!1)}),e.on("bendpoint.move.end",function(t){var e=t.context,n=e.allowed,i=e.bendpointIndex,r=e.connection,s=e.insert,a=r.waypoints.slice(),l=e.source,c=e.target,h=e.type,u=e.hints||{},d={x:O(t.x),y:O(t.y)};if(!n)return!1;h===E?(s?a.splice(i,0,d):a[i]=d,u.bendpointMove={insert:s,bendpointIndex:i},a=this.cropWaypoints(r,a),o.updateWaypoints(r,(0,_.Wy)(a),u)):(h===k?(u.docking="source",A(e)&&(u.docking="target",u.newWaypoints=a.reverse())):h===S&&(u.docking="target",A(e)&&(u.docking="source",u.newWaypoints=a.reverse())),o.reconnect(r,l,c,d,u))},this)}function A(t){var e=t.hover,n=t.source,i=t.target,r=t.type;return r===k?e&&i&&e===i&&n!==i:r===S?e&&n&&e===n&&n!==i:void 0}C.$inject=["injector","eventBus","canvas","dragging","rules","modeling"],C.prototype.cropWaypoints=function(t,e){var n=this._injector.get("connectionDocking",!1);if(!n)return e;var i=t.waypoints;return t.waypoints=e,t.waypoints=n.getCroppedWaypoints(t),e=t.waypoints,t.waypoints=i,e};var T="updateWaypoints",P="connect-ok",M="connect-not-ok",N="connect-hover",R="djs-updating",D="djs-dragging";function B(t,e,n,i){this._injector=e;var r=e.get("connectionPreview",!1);n.on("bendpoint.move.start",function(t){var e=t.context,n=e.bendpointIndex,r=e.connection,o=e.insert,s=r.waypoints,a=s.slice();e.waypoints=s,o&&a.splice(n,0,{x:t.x,y:t.y}),r.waypoints=a;var l=e.draggerGfx=m(i.getLayer("overlays"));(0,c.Ly)(l).add("djs-dragging"),i.addMarker(r,D),i.addMarker(r,R)}),n.on("bendpoint.move.hover",function(t){var e=t.context,n=e.allowed,r=e.hover,o=e.type;if(r){if(i.addMarker(r,N),o===T)return;n?(i.removeMarker(r,M),i.addMarker(r,P)):!1===n&&(i.removeMarker(r,P),i.addMarker(r,M))}}),n.on(["bendpoint.move.out","bendpoint.move.cleanup"],1100,function(t){var e=t.context,n=e.hover,r=e.target;n&&(i.removeMarker(n,N),i.removeMarker(n,r?P:M))}),n.on("bendpoint.move.move",function(e){var n=e.context,i=n.allowed,o=n.bendpointIndex,s=n.draggerGfx,a=n.hover,l=n.type,c=n.connection,u=c.source,d=c.target,p=c.waypoints.slice(),f={x:e.x,y:e.y},g=n.hints||{},m={};r&&(g.connectionStart&&(m.connectionStart=g.connectionStart),g.connectionEnd&&(m.connectionEnd=g.connectionEnd),"reconnectStart"===l?A(n)?(m.connectionEnd=m.connectionEnd||f,m.source=d,m.target=a||u,p=p.reverse()):(m.connectionStart=m.connectionStart||f,m.source=a||u,m.target=d):"reconnectEnd"===l?A(n)?(m.connectionStart=m.connectionStart||f,m.source=a||d,m.target=u,p=p.reverse()):(m.connectionEnd=m.connectionEnd||f,m.source=u,m.target=a||d):(m.noCropping=!0,m.noLayout=!0,p[o]=f),l===T&&(p=t.cropWaypoints(c,p)),m.waypoints=p,r.drawPreview(n,i,m)),(0,h.Tl)(s,e.x,e.y)},this),n.on(["bendpoint.move.end","bendpoint.move.cancel"],1100,function(t){var e=t.context,n=e.connection,o=e.draggerGfx,s=e.hover,a=e.target,l=e.waypoints;n.waypoints=l,(0,c.TF)(o),i.removeMarker(n,R),i.removeMarker(n,D),s&&(i.removeMarker(s,P),i.removeMarker(s,a?P:M)),r&&r.cleanUp(e)})}B.$inject=["bendpointMove","injector","eventBus","canvas"];var $="connect-hover",L="djs-updating";function I(t,e,n){return q(t,e,t[e]+n)}function q(t,e,n){return{x:"x"===e?n:t.x,y:"y"===e?n:t.y}}function F(t){return"x"===t?"y":"x"}function V(t,e,n){var i,r;return t.original?t.original:(i=(0,_.pp)(e),q(t,r=F(n),i[r]))}function j(t,e,n,i,r,o){var s=t.get("connectionDocking",!1);function a(t,e){if(!s)return e;var n,i=t.waypoints;return t.waypoints=e,n=s.getCroppedWaypoints(t),t.waypoints=i,n}function u(t){r.update("connection",t.connection,t.connectionGfx)}this.start=function(t,e,r){var o,s,a,c,h=n.getGraphics(e),u=r-1,d=r,p=e.waypoints,f=p[u],m=p[d],v=g(n,p,t);(s=(0,l.ke)(f,m))&&(a="v"===s?"x":"y",0===u&&(f=V(f,e.source,a)),d===p.length-1&&(m=V(m,e.target,a)),o={connection:e,segmentStartIndex:u,segmentEndIndex:d,segmentStart:f,segmentEnd:m,axis:a,dragPosition:c=v?v.point:{x:(f.x+m.x)/2,y:(f.y+m.y)/2}},i.init(t,c,"connectionSegment.move",{cursor:"x"===a?"resize-ew":"resize-ns",data:{connection:e,connectionGfx:h,context:o}}))},e.on("connectionSegment.move.start",function(t){var e=t.context,i=t.connection,r=n.getLayer("overlays");e.originalWaypoints=i.waypoints.slice(),e.draggerGfx=v(r,e.segmentStart,e.segmentEnd),(0,c.Ly)(e.draggerGfx).add("djs-dragging"),n.addMarker(i,L)}),e.on("connectionSegment.move.move",function(t){var e,n,i=t.context,r=i.connection,o=i.segmentStartIndex,s=i.segmentEndIndex,l=i.segmentStart,c=i.segmentEnd,d=i.axis,p=i.originalWaypoints.slice(),f=I(l,d,t["d"+d]),g=I(c,d,t["d"+d]),m=p.length,v=0;p[o]=f,p[s]=g,o<2&&(e=(0,_.vc)(r.source,f),1===o?"intersect"===e&&(p.shift(),p[0]=f,v--):"intersect"!==e&&(p.unshift(l),v++)),s>m-3&&(n=(0,_.vc)(r.target,g),s===m-2?"intersect"===n&&(p.pop(),p[p.length-1]=g):"intersect"!==n&&p.push(c)),i.newWaypoints=r.waypoints=a(r,p),function(t,e,n){var i,r,o,s,a,l,c=t.newWaypoints,u=(i=n,r=c[t.segmentStartIndex+e],o=c[t.segmentEndIndex+e],s=F(t.axis),a=Math.max(r[s],o[s]),l=Math.min(r[s],o[s]),q(r,s,Math.min(Math.max(l+20,i[s]),a-20)));(0,h.Tl)(t.draggerGfx,u.x,u.y)}(i,v,t),i.newSegmentStartIndex=o+v,u(t)}),e.on("connectionSegment.move.hover",function(t){t.context.hover=t.hover,n.addMarker(t.hover,$)}),e.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(t){var e=t.context.hover;e&&n.removeMarker(e,$)}),e.on("connectionSegment.move.cleanup",function(t){var e=t.context,i=e.connection;e.draggerGfx&&(0,c.TF)(e.draggerGfx),n.removeMarker(i,L)}),e.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(t){var e=t.context;e.connection.waypoints=e.originalWaypoints,u(t)}),e.on("connectionSegment.move.end",function(t){var e=t.context,n=e.connection,i=e.newWaypoints,r=e.newSegmentStartIndex,s=function(t,e){var n=0;return{waypoints:t.filter(function(i,r){return!(0,l.XP)(t[r-1],t[r+1],i)||(n=r<=e?n-1:n,!1)}),segmentOffset:n}}(i=i.map(function(t){return{original:t.original,x:Math.round(t.x),y:Math.round(t.y)}}),r),c=a(n,s.waypoints),h=s.segmentOffset,u={segmentMove:{segmentStartIndex:e.segmentStartIndex,newSegmentStartIndex:r+h}};o.updateWaypoints(n,c,u)})}j.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","modeling"];var H=n(67633),z=n(64242),Q=Math.abs,W=Math.round;function X(t){function e(t,e){if((0,o.isArray)(t)){for(var n=t.length;n--;)if(Q(t[n]-e)<=10)return t[n]}else{var i=e%(t=+t);if(i<10)return e-i;if(i>t-10)return e-i+t}return e}function n(t,e){return t.waypoints?(i=function(t,e){for(var n,i=e.waypoints,r=1/0,o=0;o<i.length-1;o++){var s=i[o],a=i[o+1],l=(0,d.YZ)(t,[s,a]);l<r&&(r=l,n=o)}return[i[n],i[n+1]]}(n=e,t),(0,d.P0)(n,i)):t.width?{x:W(t.width/2+t.x),y:W(t.height/2+t.y)}:void 0;var n,i}t.on("connectionSegment.move.move",1500,function(t){var i,r,s=function(t){var e=t.context,i=e.snapPoints,r=e.connection,s=r.waypoints,a=e.segmentStart,l=e.segmentStartIndex,c=e.segmentEnd,h=e.segmentEndIndex,u=e.axis;if(i)return i;var d=[s[l-1],a,c,s[h+1]];return l<2&&d.unshift(n(r.source,t)),h>s.length-3&&d.unshift(n(r.target,t)),e.snapPoints=i={horizontal:[],vertical:[]},(0,o.forEach)(d,function(t){t&&(t=t.original||t,"y"===u&&i.horizontal.push(t.y),"x"===u&&i.vertical.push(t.x))}),i}(t),a=t.x,l=t.y;if(s){var c=a-(i=e(s.vertical,a)),h=l-(r=e(s.horizontal,l));(0,o.assign)(t,{dx:t.dx-c,dy:t.dy-h,x:i,y:r}),(c||-1!==s.vertical.indexOf(a))&&(0,H.CU)(t,"x",i),(h||-1!==s.horizontal.indexOf(l))&&(0,H.CU)(t,"y",r)}}),t.on(["connect.hover","connect.move","connect.end"],1500,function(t){var e=t.context.hover,i=e&&n(e,t);(0,z.fX)(e)&&i&&i.x&&i.y&&((0,H.CU)(t,"x",i.x),(0,H.CU)(t,"y",i.y))}),t.on(["bendpoint.move.move","bendpoint.move.end"],1500,function(t){var i,r,s=t.context,a=function(t){var e=t.snapPoints,n=t.connection.waypoints,i=t.bendpointIndex;if(e)return e;var r=[n[i-1],n[i+1]];return t.snapPoints=e={horizontal:[],vertical:[]},(0,o.forEach)(r,function(t){t&&(t=t.original||t,e.horizontal.push(t.y),e.vertical.push(t.x))}),e}(s),l=s.hover,c=l&&n(l,t),h=t.x,u=t.y;if(a){var d=h-(i=e(c?a.vertical.concat([c.x]):a.vertical,h)),p=u-(r=e(c?a.horizontal.concat([c.y]):a.horizontal,u));(0,o.assign)(t,{dx:t.dx-d,dy:t.dy-p,x:t.x-d,y:t.y-p}),(d||-1!==a.vertical.indexOf(h))&&(0,H.CU)(t,"x",i),(p||-1!==a.horizontal.indexOf(u))&&(0,H.CU)(t,"y",r)}})}X.$inject=["eventBus"];const U={__depends__:[i.A,r.A],__init__:["bendpoints","bendpointSnapping","bendpointMovePreview"],bendpoints:["type",w],bendpointMove:["type",C],bendpointMovePreview:["type",B],connectionSegmentMove:["type",j],bendpointSnapping:["type",X]}},17987(t,e,n){"use strict";n.d(e,{A:()=>o});var i=n(91970);function r(t,e,n,r){t.on("element.changed",function(r){var o=r.element;(o.parent||o===e.getRootElement())&&(r.gfx=n.getGraphics(o)),r.gfx&&t.fire((0,i.Pw)(o)+".changed",r)}),t.on("elements.changed",function(e){var n=e.elements;n.forEach(function(e){t.fire("element.changed",{element:e})}),r.updateContainments(n)}),t.on("shape.changed",function(t){r.update("shape",t.element,t.gfx)}),t.on("connection.changed",function(t){r.update("connection",t.element,t.gfx)})}r.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"];const o={__init__:["changeSupport"],changeSupport:["type",r]}},62639(t,e,n){"use strict";function i(){}n.d(e,{A:()=>i}),i.prototype.get=function(){return this._data},i.prototype.set=function(t){this._data=t},i.prototype.clear=function(){var t=this._data;return delete this._data,t},i.prototype.isEmpty=function(){return!this._data}},48909(t,e,n){"use strict";n.d(e,{A:()=>i});const i={clipboard:["type",n(62639).A]}},25359(t,e,n){"use strict";n.d(e,{A:()=>p});var i=n(86104),r=n(81734),o=n(43513),s=n(67319),a=n(57094);function l(t,e,n,i){function r(t,e){return i.allowed("connection.create",{source:t,target:e})}t.on("connect.hover",function(t){var e,n=t.context,i=n.start,o=t.hover;if(n.hover=o,e=n.canExecute=r(i,o),!(0,a.isNil)(e)){if(!1!==e)return n.source=i,void(n.target=o);e=n.canExecute=r(o,i),(0,a.isNil)(e)||!1!==e&&(n.source=o,n.target=i)}}),t.on(["connect.out","connect.cleanup"],function(t){var e=t.context;e.hover=null,e.source=null,e.target=null,e.canExecute=!1}),t.on("connect.end",function(t){var e=t.context,i=e.canExecute,r=e.connectionStart,o={x:t.x,y:t.y},s=e.source,l=e.target;if(!i)return!1;var h=null,u={connectionStart:c(e)?o:r,connectionEnd:c(e)?r:o};(0,a.isObject)(i)&&(h=i),e.connection=n.connect(s,l,h,u)}),this.start=function(t,n,i,r){(0,a.isObject)(i)||(r=i,i=(0,s.pp)(n)),e.init(t,"connect",{autoActivate:r,data:{shape:n,context:{start:n,connectionStart:i}}})}}function c(t){var e=t.hover,n=t.source,i=t.target;return e&&n&&e===n&&n!==i}l.$inject=["eventBus","dragging","modeling","rules"];var h="connect-ok",u="connect-not-ok";function d(t,e,n){var i=t.get("connectionPreview",!1);i&&e.on("connect.move",function(t){var e=t.context,n=e.canExecute,r=e.hover,o=e.source,s=e.start,a=e.startPosition,l=e.target,h=e.connectionStart||a,u=e.connectionEnd||{x:t.x,y:t.y},d=h,p=u;c(e)&&(d=u,p=h),i.drawPreview(e,n,{source:o||s,target:l||r,connectionStart:d,connectionEnd:p})}),e.on("connect.hover",900,function(t){var e=t.context,i=t.hover,r=e.canExecute;null!==r&&n.addMarker(i,r?h:u)}),e.on(["connect.out","connect.cleanup"],1100,function(t){var e=t.hover;e&&(n.removeMarker(e,h),n.removeMarker(e,u))}),i&&e.on("connect.cleanup",function(t){i.cleanUp(t.context)})}d.$inject=["injector","eventBus","canvas"];const p={__depends__:[i.A,r.A,o.A],__init__:["connectPreview"],connect:["type",l],connectPreview:["type",d]}},48461(t,e,n){"use strict";n.d(e,{A:()=>l});var i=n(27828),r=n(57094),o=n(67319),s=n(24107);function a(t,e,n,i){this._canvas=e,this._graphicsFactory=n,this._elementFactory=i,this._connectionDocking=t.get("connectionDocking",!1),this._layouter=t.get("layouter",!1)}a.$inject=["injector","canvas","graphicsFactory","elementFactory"],a.prototype.drawPreview=function(t,e,n){n=n||{};var r,s,a,l=t.connectionPreviewGfx,c=t.getConnection,h=n.source,u=n.target,d=n.waypoints,p=n.connectionStart,f=n.connectionEnd,g=n.noLayout,m=n.noCropping,v=n.noNoop,y=this;l||(l=t.connectionPreviewGfx=this.createConnectionPreviewGfx()),(0,i.IU)(l),c||(c=t.getConnection=(s=function(t,e,n){return y.getConnection(t,e,n)},a={},function(t){var e=JSON.stringify(t),n=a[e];return n||(n=a[e]=s.apply(null,arguments)),n})),e&&(r=c(e,h,u)),r?(r.waypoints=d||[],this._layouter&&!g&&(r.waypoints=this._layouter.layoutConnection(r,{source:h,target:u,connectionStart:p,connectionEnd:f,waypoints:n.waypoints||r.waypoints})),r.waypoints&&r.waypoints.length||(r.waypoints=[h?(0,o.pp)(h):p,u?(0,o.pp)(u):f]),this._connectionDocking&&(h||u)&&!m&&(r.waypoints=this._connectionDocking.getCroppedWaypoints(r,h,u)),this._graphicsFactory.drawConnection(l,r,{stroke:"var(--element-dragger-color)"})):!v&&this.drawNoopPreview(l,n)},a.prototype.drawNoopPreview=function(t,e){var n=e.source,r=e.target,s=e.connectionStart||(0,o.pp)(n),a=e.connectionEnd||(0,o.pp)(r),l=this.cropWaypoints(s,a,n,r),c=this.createNoopConnection(l[0],l[1]);(0,i.BC)(t,c)},a.prototype.cropWaypoints=function(t,e,n,i){var r=this._graphicsFactory,s=n&&r.getShapePath(n),a=i&&r.getShapePath(i),l=r.getConnectionPath({waypoints:[t,e]});return[t=n&&(0,o.ki)(s,l,!0)||t,e=i&&(0,o.ki)(a,l,!1)||e]},a.prototype.cleanUp=function(t){t&&t.connectionPreviewGfx&&(0,i.TF)(t.connectionPreviewGfx)},a.prototype.getConnection=function(t){var e=function(t){return(0,r.isObject)(t)?t:{}}(t);return this._elementFactory.createConnection(e)},a.prototype.createConnectionPreviewGfx=function(){var t=(0,i.vt)("g");return(0,i.CF)(t,{pointerEvents:"none"}),(0,i.Ly)(t).add("djs-dragger"),(0,i.BC)(this._canvas.getActiveLayer(),t),t},a.prototype.createNoopConnection=function(t,e){return(0,s.RJ)([t,e],{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"})};const l={__init__:["connectionPreview"],connectionPreview:["type",a]}},80598(t,e,n){"use strict";n.d(e,{A:()=>m});var i=n(88641),r=n(4912);const o=new(n(43709).A);function s(t){this._scheduled={},t.on("diagram.destroy",()=>{Object.keys(this._scheduled).forEach(t=>{this.cancel(t)})})}s.$inject=["eventBus"],s.prototype.schedule=function(t,e=o.next()){this.cancel(e);const n=this._schedule(t,e);return this._scheduled[e]=n,n.promise},s.prototype._schedule=function(t,e){const n=function(){const t={};return t.promise=new Promise((e,n)=>{t.resolve=e,t.reject=n}),t}();return{executionId:setTimeout(()=>{try{this._scheduled[e]=null;try{n.resolve(t())}catch(t){n.reject(t)}}catch(t){console.error("Scheduler#_schedule execution failed",t)}}),promise:n.promise}},s.prototype.cancel=function(t){const e=this._scheduled[t];e&&(this._cancel(e),this._scheduled[t]=null)},s.prototype._cancel=function(t){clearTimeout(t.executionId)};const a={scheduler:["type",s]};var l=n(57094),c=n(93083),h=n.n(c),u=n(81340),d=n(75340),p=n(64242),f=".entry";function g(t,e,n,i){this._canvas=t,this._elementRegistry=e,this._eventBus=n,this._scheduler=i,this._current=null,this._init()}g.$inject=["canvas","elementRegistry","eventBus","scheduler"],g.prototype._init=function(){var t=this;this._eventBus.on("selection.changed",function(e){var n=e.newSelection,i=n.length?1===n.length?n[0]:n:null;i?t.open(i,!0):t.close()}),this._eventBus.on("elements.changed",function(e){var n=e.elements,i=t._current;if(i){var r=i.target,o=(0,l.isArray)(r)?r:[r];if(o.filter(function(t){return n.includes(t)}).length){t.close();var s=o.filter(function(e){return t._elementRegistry.get(e.id)});s.length&&t._updateAndOpen(s.length>1?s:s[0])}}}),this._eventBus.on("canvas.viewbox.changed",function(){t._updatePosition()}),this._eventBus.on("element.marker.update",function(e){if(t.isOpen()){var n=e.element,i=t._current;((0,l.isArray)(i.target)?i.target:[i.target]).includes(n)&&t._updateVisibility()}}),this._container=this._createContainer()},g.prototype._createContainer=function(){var t=h()('<div class="djs-context-pad-parent"></div>');return this._canvas.getContainer().appendChild(t),t},g.prototype.registerProvider=function(t,e){e||(e=t,t=1e3),this._eventBus.on("contextPad.getProviders",t,function(t){t.providers.push(e)})},g.prototype.getEntries=function(t){var e=this._getProviders(),n=(0,l.isArray)(t)?"getMultiElementContextPadEntries":"getContextPadEntries",i={};return(0,l.forEach)(e,function(e){if((0,l.isFunction)(e[n])){var r=e[n](t);(0,l.isFunction)(r)?i=r(i):(0,l.forEach)(r,function(t,e){i[e]=t})}}),i},g.prototype.trigger=function(t,e,n){var i,r,o=this,s=e.delegateTarget||e.target;return s?(i=(0,u.CF)(s,"data-action"),r=e.originalEvent||e,"mouseover"!==t?"mouseout"===t?(clearTimeout(this._timeout),void(this._mouseout&&(this._mouseout(),this._mouseout=null))):this.triggerEntry(i,t,r,n):void(this._timeout=setTimeout(function(){o._mouseout=o.triggerEntry(i,"hover",r,n)},300))):e.preventDefault()},g.prototype.triggerEntry=function(t,e,n,i){if(this.isShown()){var r=this._current.target,o=this._current.entries[t];if(o){var s=o.action;if(!1!==this._eventBus.fire("contextPad.trigger",{entry:o,event:n})){if((0,l.isFunction)(s)){if("click"===e)return s(n,r,i)}else if(s[e])return s[e](n,r,i);n.preventDefault()}}}},g.prototype.open=function(t,e){!e&&this.isOpen(t)||(this.close(),this._updateAndOpen(t))},g.prototype._getProviders=function(){var t=this._eventBus.createEvent({type:"contextPad.getProviders",providers:[]});return this._eventBus.fire(t),t.providers},g.prototype._updateAndOpen=function(t){var e,n=this.getEntries(t),i=this._createHtml(t);(0,l.forEach)(n,function(t,n){var r,o,s,a,c=t.group||"default",p=h()(t.html||'<div class="entry" draggable="true"></div>');(0,u.CF)(p,"data-action",n),(r=(0,u.P)("[data-group="+(0,d.F)(c)+"]",i))||(r=h()('<div class="group"></div>'),(0,u.CF)(r,"data-group",c),i.appendChild(r)),r.appendChild(p),t.className&&(o=p,s=t.className,a=(0,u.Ly)(o),(s=(0,l.isArray)(s)?s:s.split(/\s+/g)).forEach(function(t){a.add(t)})),t.title&&(0,u.CF)(p,"title",t.title),t.imageUrl&&(e=h()("<img>"),(0,u.CF)(e,"src",t.imageUrl),e.style.width="100%",e.style.height="100%",p.appendChild(e))}),(0,u.Ly)(i).add("open"),this._current={entries:n,html:i,target:t},this._updatePosition(),this._updateVisibility(),this._eventBus.fire("contextPad.open",{current:this._current})},g.prototype._createHtml=function(t){var e=this,n=h()('<div class="djs-context-pad"></div>');return u.Mm.bind(n,f,"click",function(t){e.trigger("click",t)}),u.Mm.bind(n,f,"dragstart",function(t){e.trigger("dragstart",t)}),u.Mm.bind(n,f,"mouseover",function(t){e.trigger("mouseover",t)}),u.Mm.bind(n,f,"mouseout",function(t){e.trigger("mouseout",t)}),u.f0.bind(n,"mousedown",function(t){t.stopPropagation()}),this._container.appendChild(n),this._eventBus.fire("contextPad.create",{target:t,pad:n}),n},g.prototype.getPad=function(t){let e;return console.warn(new Error("ContextPad#getPad is deprecated and will be removed in future library versions, cf. https://github.com/bpmn-io/diagram-js/pull/888")),e=this.isOpen()&&function(t,e){return t=(0,l.isArray)(t)?t:[t],e=(0,l.isArray)(e)?e:[e],t.length===e.length&&(0,l.every)(t,function(t){return e.includes(t)})}(this._current.target,t)?this._current.html:this._createHtml(t),{html:e}},g.prototype.close=function(){this.isOpen()&&(clearTimeout(this._timeout),this._container.innerHTML="",this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)},g.prototype.isOpen=function(t){var e=this._current;if(!e)return!1;if(!t)return!0;var n=e.target;return(0,l.isArray)(t)===(0,l.isArray)(n)&&((0,l.isArray)(t)?t.length===n.length&&(0,l.every)(t,function(t){return n.includes(t)}):n===t)},g.prototype.isShown=function(){return this.isOpen()&&(0,u.Ly)(this._current.html).has("open")},g.prototype.show=function(){this.isOpen()&&((0,u.Ly)(this._current.html).add("open"),this._updatePosition(),this._eventBus.fire("contextPad.show",{current:this._current}))},g.prototype.hide=function(){this.isOpen()&&((0,u.Ly)(this._current.html).remove("open"),this._eventBus.fire("contextPad.hide",{current:this._current}))},g.prototype._getPosition=function(t){if(!(0,l.isArray)(t)&&(0,p.fX)(t)){var e=this._canvas.viewbox(),n=(o=t).waypoints[o.waypoints.length-1],i=n.x*e.scale-e.x*e.scale,r=n.y*e.scale-e.y*e.scale;return{left:i+8*this._canvas.zoom(),top:r}}var o,s=this._canvas.getContainer().getBoundingClientRect(),a=this._getTargetBounds(t);return{left:a.right-s.left+8*this._canvas.zoom(),top:a.top-s.top}},g.prototype._updatePosition=function(){this._scheduler.schedule(()=>{if(this.isOpen()){var t=this._current.html,e=this._getPosition(this._current.target);"x"in e&&"y"in e?(t.style.left=e.x+"px",t.style.top=e.y+"px"):["top","right","bottom","left"].forEach(function(n){n in e&&(t.style[n]=e[n]+"px")})}},"ContextPad#_updatePosition")},g.prototype._updateVisibility=function(){this._scheduler.schedule(()=>{if(this.isOpen()){var t=this,e=this._current.target;((0,l.isArray)(e)?e:[e]).some(function(e){return t._canvas.hasMarker(e,"djs-element-hidden")})?t.hide():t.show()}},"ContextPad#_updateVisibility")},g.prototype._getTargetBounds=function(t){var e=this;return((0,l.isArray)(t)?t:[t]).map(function(t){return e._canvas.getGraphics(t)}).reduce(function(t,e){const n=e.getBoundingClientRect();return t.top=Math.min(t.top,n.top),t.right=Math.max(t.right,n.right),t.bottom=Math.max(t.bottom,n.bottom),t.left=Math.min(t.left,n.left),t.x=t.left,t.y=t.top,t.width=t.right-t.left,t.height=t.bottom-t.top,t},{top:1/0,right:-1/0,bottom:-1/0,left:1/0})};const m={__depends__:[i.A,a,r.A],contextPad:["type",g]}},84322(t,e,n){"use strict";n.d(e,{A:()=>_});var i=n(43513),r=n(30601),o=n(81734),s=n(86104),a=n(57094),l=n(91970),c=n(64242),h="drop-ok",u="drop-not-ok",d="attach-ok",p="new-parent",f="create";function g(t,e,n,i,r){function o(e,n){[d,h,u,p].forEach(function(i){i===n?t.addMarker(e,i):t.removeMarker(e,i)})}function s(){var t=e.context();t&&t.prefix===f&&e.cancel()}n.on(["create.move","create.hover"],function(t){var e=t.context,n=e.elements,i=t.hover,s=e.source,l=e.hints||{};if(!i)return e.canExecute=!1,void(e.target=null);m(t);var h={x:t.x,y:t.y},f=e.canExecute=i&&function(t,e,n,i,o){if(!e)return!1;t=(0,a.filter)(t,function(e){var n=e.labelTarget;return!(e.parent||(0,c.J2)(e)&&-1!==t.indexOf(n))});var s=(0,a.find)(t,function(t){return!(0,c.fX)(t)}),l=!1,h=!1,u=!1;v(t)&&(l=r.allowed("shape.attach",{position:n,shape:s,target:e})),l||(u=v(t)?r.allowed("shape.create",{position:n,shape:s,source:i,target:e}):r.allowed("elements.create",{elements:t,position:n,target:e}));var d=o.connectionTarget;return u||l?(s&&i&&(h=r.allowed("connection.create",{source:d===i?s:i,target:d===i?i:s,hints:{targetParent:e,targetAttach:l}})),{attach:l,connect:h}):(null===u||null===l)&&null}(n,i,h,s,l);i&&null!==f&&(e.target=i,f&&f.attach?o(i,d):o(i,f?p:u))}),n.on(["create.end","create.out","create.cleanup"],function(t){var e=t.hover;e&&o(e,null)}),n.on("create.end",function(t){var e=t.context,n=e.source,r=e.shape,o=e.elements,s=e.target,l=e.canExecute,h=l&&l.attach,u=l&&l.connect,d=e.hints||{};if(!1===l||!s)return!1;m(t);var p={x:t.x,y:t.y};u?r=i.appendShape(n,r,p,s,{attach:h,connection:!0===u?{}:u,connectionTarget:d.connectionTarget}):(o=i.createElements(o,p,s,(0,a.assign)({},d,{attach:h})),r=(0,a.find)(o,function(t){return!(0,c.fX)(t)})),(0,a.assign)(e,{elements:o,shape:r}),(0,a.assign)(t,{elements:o,shape:r})}),n.on("create.init",function(){n.on("elements.changed",s),n.once(["create.cancel","create.end"],2e3,function(){n.off("elements.changed",s)})}),this.start=function(t,n,i){(0,a.isArray)(n)||(n=[n]);var r=(0,a.find)(n,function(t){return!(0,c.fX)(t)});if(r){i=(0,a.assign)({elements:n,hints:{},shape:r},i||{}),(0,a.forEach)(n,function(t){(0,a.isNumber)(t.x)||(t.x=0),(0,a.isNumber)(t.y)||(t.y=0)});var o=(0,a.filter)(n,function(t){return!t.hidden}),s=(0,l.U7)(o);(0,a.forEach)(n,function(t){(0,c.fX)(t)&&(t.waypoints=(0,a.map)(t.waypoints,function(t){return{x:t.x-s.x-s.width/2,y:t.y-s.y-s.height/2}})),(0,a.assign)(t,{x:t.x-s.x-s.width/2,y:t.y-s.y-s.height/2})}),e.init(t,f,{cursor:"grabbing",autoActivate:!0,data:{shape:r,elements:n,context:i}})}}}function m(t){var e=t.context.createConstraints;e&&(e.left&&(t.x=Math.max(t.x,e.left)),e.right&&(t.x=Math.min(t.x,e.right)),e.top&&(t.y=Math.max(t.y,e.top)),e.bottom&&(t.y=Math.min(t.y,e.bottom)))}function v(t){return t&&1===t.length&&!(0,c.fX)(t[0])}g.$inject=["canvas","dragging","eventBus","modeling","rules"];var y=n(46757),b=n(37706),x=n(27828);function w(t,e,n,i,r){e.on("create.move",750,function(e){var o,s=e.hover,a=e.context,l=a.elements,c=a.dragGroup;c||(c=a.dragGroup=function(t){var e=(0,x.vt)("g");(0,x.CF)(e,r.cls("djs-drag-group",["no-events"]));var o=(0,x.vt)("g");return t.forEach(function(t){var r;t.hidden||(t.waypoints?(r=n._createContainer("connection",o),n.drawConnection((0,b.P)(r),t)):(r=n._createContainer("shape",o),n.drawShape((0,b.P)(r),t),(0,y.Tl)(r,t.x,t.y)),i.addDragger(t,e,r))}),e}(l)),s?(c.parentNode||(o=t.getActiveLayer(),(0,x.BC)(o,c)),(0,y.Tl)(c,e.x,e.y)):(0,x.TF)(c)}),e.on("create.cleanup",function(t){var e=t.context.dragGroup;e&&(0,x.TF)(e)})}w.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"];const _={__depends__:[i.A,r.A,o.A,s.A],__init__:["create","createPreview"],create:["type",g],createPreview:["type",w]}},27855(t,e,n){"use strict";n.d(e,{A:()=>s});var i=n(57094),r={horizontal:["x","width"],vertical:["y","height"]};function o(t,e){this._modeling=t,this._filters=[],this.registerFilter(function(t){var n=e.allowed("elements.distribute",{elements:t});return(0,i.isArray)(n)?n:n?t:[]})}o.$inject=["modeling","rules"],o.prototype.registerFilter=function(t){if("function"!=typeof t)throw new Error("the filter has to be a function");this._filters.push(t)},o.prototype.trigger=function(t,e){var n,i,r=this._modeling;if(!(t.length<3||(this._setOrientation(e),i=this._filterElements(t),(n=this._createGroups(i)).length<=2)))return r.distributeElements(n,this._axis,this._dimension),n},o.prototype._filterElements=function(t){var e=this._filters,n=this._axis,r=this._dimension,o=[].concat(t);return e.length?((0,i.forEach)(e,function(t){o=t(o,n,r)}),o):t},o.prototype._createGroups=function(t){var e=[],n=this,r=this._axis,o=this._dimension;if(!r)throw new Error('must have a defined "axis" and "dimension"');var s=(0,i.sortBy)(t,r);return(0,i.forEach)(s,function(t,i){var s,a=n._findRange(t,r,o),l=e[e.length-1];l&&n._hasIntersection(l.range,a)?e[e.length-1].elements.push(t):(s={range:a,elements:[t]},e.push(s))}),e},o.prototype._setOrientation=function(t){var e=r[t];this._axis=e[0],this._dimension=e[1]},o.prototype._hasIntersection=function(t,e){return Math.max(t.min,t.max)>=Math.min(e.min,e.max)&&Math.min(t.min,t.max)<=Math.max(e.min,e.max)},o.prototype._findRange=function(t){var e=t[this._axis];return{min:e+5,max:e+t[this._dimension]-5}};const s={__init__:["distributeElements"],distributeElements:["type",o]}},43513(t,e,n){"use strict";n.d(e,{A:()=>v});var i=n(81340),r=n(51303);function o(t,e,n){var o,s,a=this,l=n.get("dragging",!1);l&&e.on("drag.start",function(n){e.once("drag.move",1500,function(e){!function(e){if(!e.hover){var n=e.originalEvent,i=a._findTargetGfx(n),r=i&&t.get(i);i&&r&&(e.stopPropagation(),l.hover({element:r,gfx:i}),l.move(n))}}(e)})}),e.on("element.hover",function(t){o=t.gfx,s=t.element}),e.on("element.hover",1500,function(t){s&&e.fire("element.out",{element:s,gfx:o})}),e.on("element.out",function(){o=null,s=null}),this._findTargetGfx=function(t){var e,n;if(t instanceof MouseEvent)return e=(0,r.gK)(t),n=document.elementFromPoint(e.x,e.y),(0,i.kp)(n,"svg, .djs-element",!0)}}o.$inject=["elementRegistry","eventBus","injector"];const s={__init__:["hoverFix"],hoverFix:["type",o]};var a=n(86104),l=n(57094),c=n(25141),h=n(48872),u=n(79356),d=n(56287),p=Math.round,f="djs-drag-active";function g(t){t.preventDefault()}function m(t,e,n,o){var s,a={threshold:5,trapClick:!0};function m(t){var n=e.viewbox(),i=e._container.getBoundingClientRect();return{x:n.x+(t.x-i.left)/n.scale,y:n.y+(t.y-i.top)/n.scale}}function v(e,n){n=n||s;var i=t.createEvent((0,l.assign)({},n.payload,n.data,{isTouch:n.isTouch}));return!1!==t.fire("drag."+e,i)&&t.fire(n.prefix+"."+e,i)}function y(t,i){var o,a=s.payload,h=s.displacement,d=s.globalStart,g=(0,r.gK)(t),y=(0,u.p)(g,d),b=s.localStart,x=m(g),w=(0,u.p)(x,b);if(!s.active&&(i||(o=y,Math.sqrt(Math.pow(o.x,2)+Math.pow(o.y,2))>s.threshold))){if((0,l.assign)(a,{x:p(b.x+h.x),y:p(b.y+h.y),dx:0,dy:0},{originalEvent:t}),!1===v("start"))return S();s.active=!0,s.keepSelection||(a.previousSelection=n.get(),n.select(null)),s.cursor&&(0,c.hZ)(s.cursor),e.addMarker(e.getRootElement(),f)}(0,r.dG)(t),s.active&&((0,l.assign)(a,{x:p(x.x+h.x),y:p(x.y+h.y),dx:p(w.x),dy:p(w.y)},{originalEvent:t}),v("move"))}function b(t){var e=!0;s.active&&(t&&(s.payload.originalEvent=t,(0,r.dG)(t)),e=v("end")),!1===e&&v("rejected"),v("ended",E(!0!==e))}function x(t){(0,d.m0)("Escape",t)&&(g(t),S())}function w(e){var n;s.active&&(n=(0,h.a)(t),setTimeout(n,400),g(e)),b(e)}function _(t){y(t)}function O(t){var e=s.payload;e.hoverGfx=t.gfx,e.hover=t.element,v("hover")}function k(t){v("out");var e=s.payload;e.hoverGfx=null,e.hover=null}function S(t){var e;if(s){var n=s.active;n&&v("cancel"),e=E(t),n&&v("canceled",e)}}function E(r){var a,l;v("cleanup"),(0,c.wC)(),l=s.trapClick?w:b,i.f0.unbind(document,"mousemove",y),i.f0.unbind(document,"dragstart",g),i.f0.unbind(document,"selectstart",g),i.f0.unbind(document,"mousedown",l,!0),i.f0.unbind(document,"mouseup",l,!0),i.f0.unbind(document,"keyup",x),i.f0.unbind(document,"touchstart",_,!0),i.f0.unbind(document,"touchcancel",S,!0),i.f0.unbind(document,"touchmove",y,!0),i.f0.unbind(document,"touchend",b,!0),t.off("element.hover",O),t.off("element.out",k),e.removeMarker(e.getRootElement(),f);var h=s.payload.previousSelection;return!1!==r&&h&&!n.get().length&&function(t){var e=t.filter(function(t){return o.get(t.id)});e.length&&n.select(e)}(h),a=s,s=null,a}t.on("diagram.destroy",S),this.init=function(e,n,o,c){s&&S(!1),"string"==typeof n&&(c=o,o=n,n=null);var h,d,p,f,E,C=(c=(0,l.assign)({},a,c||{})).data||{};f=c.trapClick?w:b,e?(h=(0,r.AF)(e)||e,d=(0,r.gK)(e),(0,r.dG)(e),"dragstart"===h.type&&g(h)):(h=null,d={x:0,y:0}),p=m(d),n||(n=p),E=function(t){return"undefined"!=typeof TouchEvent&&t instanceof TouchEvent}(h),s=(0,l.assign)({prefix:o,data:C,payload:{},globalStart:d,displacement:(0,u.p)(n,p),localStart:p,isTouch:E},c),c.manual||(E?(i.f0.bind(document,"touchstart",_,!0),i.f0.bind(document,"touchcancel",S,!0),i.f0.bind(document,"touchmove",y,!0),i.f0.bind(document,"touchend",b,!0)):(i.f0.bind(document,"mousemove",y),i.f0.bind(document,"dragstart",g),i.f0.bind(document,"selectstart",g),i.f0.bind(document,"mousedown",f,!0),i.f0.bind(document,"mouseup",f,!0)),i.f0.bind(document,"keyup",x),t.on("element.hover",O),t.on("element.out",k)),v("init"),c.autoActivate&&y(e,!0)},this.move=y,this.hover=O,this.out=k,this.end=b,this.cancel=S,this.context=function(){return s},this.setOptions=function(t){(0,l.assign)(a,t)}}m.$inject=["eventBus","canvas","selection","elementRegistry"];const v={__depends__:[s,a.A],dragging:["type",m]}},46622(t,e,n){"use strict";n.d(e,{A:()=>o});var i=n(57094),r="is not a registered action";function o(t,e){this._actions={};var n=this;t.on("diagram.init",function(){n._registerDefaultActions(e),t.fire("editorActions.init",{editorActions:n})})}function s(t,e){return new Error(t+" "+e)}o.$inject=["eventBus","injector"],o.prototype._registerDefaultActions=function(t){var e=t.get("commandStack",!1),n=t.get("modeling",!1),r=t.get("selection",!1),o=t.get("zoomScroll",!1),s=t.get("copyPaste",!1),a=t.get("canvas",!1),l=t.get("rules",!1),c=t.get("keyboardMove",!1),h=t.get("keyboardMoveSelection",!1);e&&(this.register("undo",function(){e.undo()}),this.register("redo",function(){e.redo()})),s&&r&&this.register("copy",function(){var t=r.get();if(t.length)return s.copy(t)}),s&&r&&this.register("duplicate",function(){var t=r.get();if(t.length)return s.duplicate(t)}),s&&this.register("paste",function(){s.paste()}),s&&r&&l&&this.register("cut",function(){var t=r.get();if(t.length){var e=l.allowed("elements.delete",{elements:t});if(!1!==e){var n=(0,i.isArray)(e)?e:t;return s.cut(n.slice())}}}),o&&this.register("stepZoom",function(t){o.stepZoom(t.value)}),a&&this.register("zoom",function(t){a.zoom(t.value)}),n&&r&&l&&this.register("removeSelection",function(){var t=r.get();if(t.length){var e,o=l.allowed("elements.delete",{elements:t});!1!==o&&(e=(0,i.isArray)(o)?o:t).length&&n.removeElements(e.slice())}}),c&&this.register("moveCanvas",function(t){c.moveCanvas(t)}),h&&this.register("moveSelection",function(t){h.moveSelection(t.direction,t.accelerated)})},o.prototype.trigger=function(t,e){if(!this._actions[t])throw s(t,r);return this._actions[t](e)},o.prototype.register=function(t,e){var n=this;if("string"==typeof t)return this._registerAction(t,e);(0,i.forEach)(t,function(t,e){n._registerAction(e,t)})},o.prototype._registerAction=function(t,e){if(this.isRegistered(t))throw s(t,"is already registered");this._actions[t]=e},o.prototype.unregister=function(t){if(!this.isRegistered(t))throw s(t,r);this._actions[t]=void 0},o.prototype.getActions=function(){return Object.keys(this._actions)},o.prototype.isRegistered=function(t){return!!this._actions[t]}},88354(t,e,n){"use strict";n.d(e,{A:()=>i});const i={__init__:["editorActions"],editorActions:["type",n(46622).A]}},78338(t,e,n){"use strict";n.d(e,{E:()=>i,y:()=>r});var i=10;function r(t,e,n){return n||(n="round"),Math[n](t/e)*e}},54964(t,e,n){"use strict";n.d(e,{A:()=>g});var i=n(67633),r=n(56287),o=n(57094),s=n(78338);function a(t,e,n){var s=!n||!1!==n.active;this._eventBus=e;var a=this;e.on("diagram.init",800,function(){a.setActive(s)}),e.on(["create.move","create.end","bendpoint.move.move","bendpoint.move.end","connect.move","connect.end","connectionSegment.move.move","connectionSegment.move.end","resize.move","resize.end","shape.move.move","shape.move.end"],1200,function(e){var n=e.originalEvent;if(!(!a.active||n&&(0,r.nM)(n))){var s=e.context,u=s.gridSnappingContext;u||(u=s.gridSnappingContext={}),["x","y"].forEach(function(n){var r={},s=function(t,e,n){var i=t.context,r=t.shape,s=i.gridSnappingContext,a=s.snapLocation,c=s.snapOffset;return c&&(0,o.isNumber)(c[e])?c[e]:(c||(c=s.snapOffset={}),(0,o.isNumber)(c[e])||(c[e]=0),r?(n.get(r.id)||(l(e)?c[e]+=r[e]+r.width/2:c[e]+=r[e]+r.height/2),a?("x"===e?/left/.test(a)?c[e]-=r.width/2:/right/.test(a)&&(c[e]+=r.width/2):/top/.test(a)?c[e]-=r.height/2:/bottom/.test(a)&&(c[e]+=r.height/2),c[e]):c[e]):c[e])}(e,n,t);s&&(r.offset=s);var u=function(t,e){var n=t.context,i=n.createConstraints,r=n.resizeConstraints||{},o=n.gridSnappingContext,s=o.snapConstraints;if(s&&s[e])return s[e];s||(s=o.snapConstraints={}),s[e]||(s[e]={});var a=n.direction;i&&(l(e)?(s.x.min=i.left,s.x.max=i.right):(s.y.min=i.top,s.y.max=i.bottom));var u=r.min,d=r.max;return u&&(l(e)?h(a)?s.x.max=u.left:s.x.min=u.right:c(a)?s.y.max=u.top:s.y.min=u.bottom),d&&(l(e)?h(a)?s.x.min=d.left:s.x.max=d.right:c(a)?s.y.min=d.top:s.y.max=d.bottom),s[e]}(e,n);u&&(0,o.assign)(r,u),(0,i.AC)(e,n)||a.snapEvent(e,n,r)})}})}function l(t){return"x"===t}function c(t){return-1!==t.indexOf("n")}function h(t){return-1!==t.indexOf("w")}a.prototype.snapEvent=function(t,e,n){var r=this.snapValue(t[e],n);(0,i.CU)(t,e,r)},a.prototype.getGridSpacing=function(){return s.E},a.prototype.snapValue=function(t,e){var n,i,r=0;return e&&e.offset&&(r=e.offset),t+=r,t=(0,s.y)(t,s.E),e&&e.min&&(n=e.min,(0,o.isNumber)(n)&&(n=(0,s.y)(n+r,s.E,"ceil"),t=Math.max(t,n))),e&&e.max&&(i=e.max,(0,o.isNumber)(i)&&(i=(0,s.y)(i+r,s.E,"floor"),t=Math.min(t,i))),t-r},a.prototype.isActive=function(){return this.active},a.prototype.setActive=function(t){this.active=t,this._eventBus.fire("gridSnapping.toggle",{active:t})},a.prototype.toggleActive=function(){this.setActive(!this.active)},a.$inject=["elementRegistry","eventBus","config.gridSnapping"];var u=n(7475),d=n(98142);function p(t,e){d.A.call(this,t),this._gridSnapping=e;var n=this;this.preExecute("shape.resize",function(t){var e=t.context,i=(e.hints||{}).autoResize;if(i){var r=e.shape,s=e.newBounds;(0,o.isString)(i)?e.newBounds=n.snapComplex(s,i):e.newBounds=n.snapSimple(r,s)}})}function f(t,e){t.on(["spaceTool.move","spaceTool.end"],2e3,function(t){var n,i=t.context;i.initialized&&("x"===i.axis?(n=e.snapValue(t.dx),t.x=t.x+n-t.dx,t.dx=n):(n=e.snapValue(t.dy),t.y=t.y+n-t.dy,t.dy=n))})}p.$inject=["eventBus","gridSnapping","modeling"],(0,u.A)(p,d.A),p.prototype.snapSimple=function(t,e){var n=this._gridSnapping;return e.width=n.snapValue(e.width,{min:e.width}),e.height=n.snapValue(e.height,{min:e.height}),e.x=t.x+t.width/2-e.width/2,e.y=t.y+t.height/2-e.height/2,e},p.prototype.snapComplex=function(t,e){return/w|e/.test(e)&&(t=this.snapHorizontally(t,e)),/n|s/.test(e)&&(t=this.snapVertically(t,e)),t},p.prototype.snapHorizontally=function(t,e){var n=this._gridSnapping,i=/w/.test(e),r=/e/.test(e),s={};return s.width=n.snapValue(t.width,{min:t.width}),r&&(i?(s.x=n.snapValue(t.x,{max:t.x}),s.width+=n.snapValue(t.x-s.x,{min:t.x-s.x})):t.x=t.x+t.width-s.width),(0,o.assign)(t,s),t},p.prototype.snapVertically=function(t,e){var n=this._gridSnapping,i=/n/.test(e),r=/s/.test(e),s={};return s.height=n.snapValue(t.height,{min:t.height}),i&&(r?(s.y=n.snapValue(t.y,{max:t.y}),s.height+=n.snapValue(t.y-s.y,{min:t.y-s.y})):t.y=t.y+t.height-s.height),(0,o.assign)(t,s),t},f.$inject=["eventBus","gridSnapping"];const g={__depends__:[{__init__:["gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior"],gridSnappingResizeBehavior:["type",p],gridSnappingSpaceToolBehavior:["type",f]}],__init__:["gridSnapping"],gridSnapping:["type",a]}},827(t,e,n){"use strict";n.d(e,{A:()=>u});var i=n(44391),r=n(74071),o=n(72120),s=n(56287),a=1500,l="grab";function c(t,e,n,i,r,s){this._dragging=n,this._mouse=s;var l=this,c=i.get("keyboard",!1);r.registerTool("hand",{tool:"hand",dragging:"hand.move"}),t.on("element.mousedown",a,function(t){if((0,o.Io)(t))return l.activateMove(t.originalEvent,!0),!1}),c&&c.addListener(a,function(t){if(h(t.keyEvent)&&!l.isActive()){var e=l._mouse.getLastMoveEvent();l.activateMove(e,!!e)}},"keyboard.keydown"),c&&c.addListener(a,function(t){h(t.keyEvent)&&l.isActive()&&l.toggle()},"keyboard.keyup"),t.on("hand.end",function(e){var n=e.originalEvent.target;if(!(e.hover||n instanceof SVGElement))return!1;t.once("hand.ended",function(){l.activateMove(e.originalEvent,{reactivate:!0})})}),t.on("hand.move.move",function(t){var n=e.viewbox().scale;e.scroll({dx:t.dx*n,dy:t.dy*n})}),t.on("hand.move.end",function(e){var n=e.context.reactivate;return!(0,o.Io)(e)&&n&&t.once("hand.move.ended",function(t){l.activateHand(t.originalEvent,!0,!0)}),!1})}function h(t){return(0,s.m0)("Space",t)}c.$inject=["eventBus","canvas","dragging","injector","toolManager","mouse"],c.prototype.activateMove=function(t,e,n){"object"==typeof e&&(n=e,e=!1),this._dragging.init(t,"hand.move",{autoActivate:e,cursor:l,data:{context:n||{}}})},c.prototype.activateHand=function(t,e,n){this._dragging.init(t,"hand",{trapClick:!1,autoActivate:e,cursor:l,data:{context:{reactivate:n}}})},c.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var t=this._mouse.getLastMoveEvent();this.activateHand(t,!!t)},c.prototype.isActive=function(){var t=this._dragging.context();return!!t&&/^(hand|hand\.move)$/.test(t.prefix)};const u={__depends__:[i.A,r.A],__init__:["handTool"],handTool:["type",c]}},88641(t,e,n){"use strict";n.d(e,{A:()=>u});var i=n(57094),r=n(81340),o=n(72120),s=n(27828),a=n(24107);function l(t){return!0}function c(t){return(0,o.ls)(t)||(0,o.JH)(t)}function h(t,e,n){var h=this;function u(n,i,r){var s,a;(function(t,e){return!(g[t]||o.ls)(e)})(n,i)||(r?a=e.getGraphics(r):(s=i.delegateTarget||i.target)&&(a=s,r=e.get(a)),a&&r&&!1===t.fire(n,{element:r,gfx:a,originalEvent:i})&&(i.stopPropagation(),i.preventDefault()))}var d={};function p(t){return d[t]}var f={click:"element.click",contextmenu:"element.contextmenu",dblclick:"element.dblclick",mousedown:"element.mousedown",mousemove:"element.mousemove",mouseover:"element.hover",mouseout:"element.out",mouseup:"element.mouseup"},g={"element.contextmenu":l,"element.mousedown":c,"element.mouseup":c,"element.click":c,"element.dblclick":c};function m(t,e,n,i){var o=d[n]=function(t){u(n,t)};i&&(g[n]=i),o.$delegate=r.Mm.bind(t,"svg, .djs-element",e,o)}function v(t,e,n){var i=p(n);i&&r.Mm.unbind(t,e,i.$delegate)}t.on("canvas.destroy",function(t){var e;e=t.svg,(0,i.forEach)(f,function(t,n){v(e,n,t)})}),t.on("canvas.init",function(t){var e;e=t.svg,(0,i.forEach)(f,function(t,n){m(e,n,t)})}),t.on(["shape.added","connection.added"],function(e){var n=e.element,i=e.gfx;t.fire("interactionEvents.createHit",{element:n,gfx:i})}),t.on(["shape.changed","connection.changed"],500,function(e){var n=e.element,i=e.gfx;t.fire("interactionEvents.updateHit",{element:n,gfx:i})}),t.on("interactionEvents.createHit",500,function(t){var e=t.element,n=t.gfx;h.createDefaultHit(e,n)}),t.on("interactionEvents.updateHit",function(t){var e=t.element,n=t.gfx;h.updateDefaultHit(e,n)});var y=w("djs-hit djs-hit-stroke"),b=w("djs-hit djs-hit-click-stroke"),x={all:w("djs-hit djs-hit-all"),"click-stroke":b,stroke:y,"no-move":w("djs-hit djs-hit-no-move")};function w(t,e){return e=(0,i.assign)({stroke:"white",strokeWidth:15},e||{}),n.cls(t,["no-fill","no-border"],e)}function _(t,e){var n=x[e];if(!n)throw new Error("invalid hit type <"+e+">");return(0,s.CF)(t,n),t}function O(t,e){(0,s.BC)(t,e)}this.removeHits=function(t){var e=(0,r.YG)(".djs-hit",t);(0,i.forEach)(e,s.TF)},this.createDefaultHit=function(t,e){var n,i=t.waypoints,r=t.isFrame;return i?this.createWaypointsHit(e,i):(n=r?"stroke":"all",this.createBoxHit(e,n,{width:t.width,height:t.height}))},this.createWaypointsHit=function(t,e){var n=(0,a.RJ)(e);return _(n,"stroke"),O(t,n),n},this.createBoxHit=function(t,e,n){n=(0,i.assign)({x:0,y:0},n);var r=(0,s.vt)("rect");return _(r,e),(0,s.CF)(r,n),O(t,r),r},this.updateDefaultHit=function(t,e){var n=(0,r.P)(".djs-hit",e);if(n)return t.waypoints?(0,a.si)(n,t.waypoints):(0,s.CF)(n,{width:t.width,height:t.height}),n},this.fire=u,this.triggerMouseEvent=function(t,e,n){var i=f[t];if(!i)throw new Error("unmapped DOM event name <"+t+">");return u(i,e,n)},this.mouseHandler=p,this.registerEvent=m,this.unregisterEvent=v}h.$inject=["eventBus","elementRegistry","styles"];const u={__init__:["interactionEvents"],interactionEvents:["type",h]}},6188(t,e,n){"use strict";n.d(e,{A:()=>p});var i=n(76137),r=n(86104),o=n(57094),s={moveSpeed:1,moveSpeedAccelerated:10},a="left",l="right",c="down",h={ArrowLeft:a,Left:a,ArrowUp:"up",Up:"up",ArrowRight:l,Right:l,ArrowDown:c,Down:c},u={left:function(t){return{x:-t,y:0}},up:function(t){return{x:0,y:-t}},right:function(t){return{x:t,y:0}},down:function(t){return{x:0,y:t}}};function d(t,e,n,i,r){var a=this;this._config=(0,o.assign)({},s,t||{}),e.addListener(1500,function(t){var n=t.keyEvent,i=h[n.key];if(i&&!e.isCmd(n)){var r=e.isShift(n);return a.moveSelection(i,r),!0}}),this.moveSelection=function(t,e){var o=r.get();if(o.length){var s=this._config[e?"moveSpeedAccelerated":"moveSpeed"],a=u[t](s);i.allowed("elements.move",{shapes:o,hints:{keyboardMove:!0}})&&n.moveElements(o,a)}}}d.$inject=["config.keyboardMoveSelection","keyboard","modeling","rules","selection"];const p={__depends__:[i.A,r.A],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",d]}},29725(t,e,n){"use strict";n.d(e,{Ay:()=>r});var i=n(56287);function r(t,e){var n=this;t.on("editorActions.init",500,function(t){var i=t.editorActions;n.registerBindings(e,i)})}r.$inject=["eventBus","keyboard"],r.prototype.registerBindings=function(t,e){function n(n,i){e.isRegistered(n)&&t.addListener(i)}n("undo",function(t){var n=t.keyEvent;if((0,i.DG)(n))return e.trigger("undo"),!0}),n("redo",function(t){var n=t.keyEvent;if((0,i.hM)(n))return e.trigger("redo"),!0}),n("copy",function(t){var n=t.keyEvent;if((0,i.sN)(n))return e.trigger("copy"),!0}),n("paste",function(t){var n=t.keyEvent;if((0,i.qC)(n))return e.trigger("paste"),!0}),n("duplicate",function(t){var n=t.keyEvent;if((0,i.KD)(n))return e.trigger("duplicate"),!0}),n("cut",function(t){var n=t.keyEvent;if((0,i.xZ)(n))return e.trigger("cut"),!0}),n("stepZoom",function(t){var n=t.keyEvent;if((0,i.m0)(["+","Add","="],n)&&(0,i.nM)(n))return e.trigger("stepZoom",{value:1}),!0}),n("stepZoom",function(t){var n=t.keyEvent;if((0,i.m0)(["-","Subtract"],n)&&(0,i.nM)(n))return e.trigger("stepZoom",{value:-1}),!0}),n("zoom",function(t){var n=t.keyEvent;if((0,i.m0)("0",n)&&(0,i.nM)(n))return e.trigger("zoom",{value:1}),!0}),n("removeSelection",function(t){var n=t.keyEvent;if((0,i.m0)(["Backspace","Delete","Del"],n))return e.trigger("removeSelection"),!0})}},76137(t,e,n){"use strict";n.d(e,{A:()=>c});var i=n(57094),r=n(81340),o=n(56287),s="keyboard.keydown",a="Keyboard binding is now implicit; explicit binding to an element got removed. For more information, see https://github.com/bpmn-io/diagram-js/issues/661";function l(t,e){var n=this;this._config=t=t||{},this._eventBus=e,this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),e.on("diagram.destroy",function(){n._fire("destroy"),n.unbind()}),t.bindTo&&console.error("unsupported configuration <keyboard.bindTo>",new Error(a));var i=t&&!1!==t.bind;e.on("canvas.init",function(t){n._target=t.svg,i&&n.bind(),n._fire("init")})}l.$inject=["config.keyboard","eventBus"],l.prototype._keydownHandler=function(t){this._keyHandler(t,s)},l.prototype._keyupHandler=function(t){this._keyHandler(t,"keyboard.keyup")},l.prototype._keyHandler=function(t,e){if(!this._isEventIgnored(t)){var n={keyEvent:t};this._eventBus.fire(e||s,n)&&t.preventDefault()}},l.prototype._isEventIgnored=function(t){return!1},l.prototype.bind=function(t){t&&console.error("unsupported argument <node>",new Error(a)),this.unbind(),t=this._node=this._target,r.f0.bind(t,"keydown",this._keydownHandler),r.f0.bind(t,"keyup",this._keyupHandler),this._fire("bind")},l.prototype.getBinding=function(){return this._node},l.prototype.unbind=function(){var t=this._node;t&&(this._fire("unbind"),r.f0.unbind(t,"keydown",this._keydownHandler),r.f0.unbind(t,"keyup",this._keyupHandler)),this._node=null},l.prototype._fire=function(t){this._eventBus.fire("keyboard."+t,{node:this._node})},l.prototype.addListener=function(t,e,n){(0,i.isFunction)(t)&&(n=e,e=t,t=1e3),this._eventBus.on(n||s,t,e)},l.prototype.removeListener=function(t,e){this._eventBus.off(e||s,t)},l.prototype.hasModifier=o.mp,l.prototype.isCmd=o.nM,l.prototype.isShift=o.Tu,l.prototype.isKey=o.m0;const c={__init__:["keyboard","keyboardBindings"],keyboard:["type",l],keyboardBindings:["type",n(29725).Ay]}},2159(t,e,n){"use strict";n.d(e,{A:()=>d});var i=n(44391),r=n(74071),o=n(57094),s=n(91970),a=n(72120),l=n(27828),c="crosshair";function h(t,e,n,i,r,o,s){this._selection=r,this._dragging=n,this._mouse=s;var c=this;o.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),t.on("lasso.selection.end",function(e){var n=e.originalEvent.target;(e.hover||n instanceof SVGElement)&&t.once("lasso.selection.ended",function(){c.activateLasso(e.originalEvent,!0)})}),t.on("lasso.end",0,function(t){var e=t.context,n=u(t),r=i.filter(function(t){return t}),o=(0,a.KH)(t);c.select(r,n,o?e.selection:[])}),t.on("lasso.start",function(t){var n=t.context;n.bbox=u(t),function(t){var n,i=e.getActiveLayer();n=t.frame=(0,l.vt)("rect"),(0,l.CF)(n,{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),(0,l.BC)(i,n)}(n),n.selection=r.get()}),t.on("lasso.move",function(t){var e=t.context;e.bbox=u(t),function(t){var e=t.frame,n=t.bbox;(0,l.CF)(e,{x:n.x,y:n.y,width:n.width,height:n.height})}(e)}),t.on("lasso.cleanup",function(t){!function(t){t.frame&&(0,l.TF)(t.frame)}(t.context)}),t.on("element.mousedown",1500,function(t){if((0,a.KH)(t))return c.activateLasso(t.originalEvent),!0})}function u(t){var e={x:t.x-t.dx,y:t.y-t.dy},n={x:t.x,y:t.y};return e.x<=n.x&&e.y<n.y||e.x<n.x&&e.y<=n.y?{x:e.x,y:e.y,width:n.x-e.x,height:n.y-e.y}:e.x>=n.x&&e.y<n.y||e.x>n.x&&e.y<=n.y?{x:n.x,y:e.y,width:e.x-n.x,height:n.y-e.y}:e.x<=n.x&&e.y>n.y||e.x<n.x&&e.y>=n.y?{x:e.x,y:n.y,width:n.x-e.x,height:e.y-n.y}:e.x>=n.x&&e.y>n.y||e.x>n.x&&e.y>=n.y?{x:n.x,y:n.y,width:e.x-n.x,height:e.y-n.y}:{x:n.x,y:n.y,width:0,height:0}}h.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager","mouse"],h.prototype.activateLasso=function(t,e){this._dragging.init(t,"lasso",{autoActivate:e,cursor:c,data:{context:{}}})},h.prototype.activateSelection=function(t,e){this._dragging.init(t,"lasso.selection",{trapClick:!1,autoActivate:e,cursor:c,data:{context:{}},keepSelection:!0})},h.prototype.select=function(t,e,n=[]){var i=(0,s.rx)(t,e);this._selection.select([...n,...(0,o.values)(i)])},h.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var t=this._mouse.getLastMoveEvent();this.activateSelection(t,!!t)},h.prototype.isActive=function(){var t=this._dragging.context();return t&&/^lasso/.test(t.prefix)};const d={__depends__:[i.A,r.A],__init__:["lassoTool"],lassoTool:["type",h]}},77550(t,e,n){"use strict";n.d(e,{A:()=>Y});var i=n(57094);function r(t,e){this._modeling=t,this._canvas=e}function o(t){this._modeling=t}function s(t,e){this._canvas=t,this._layouter=e}r.$inject=["modeling","canvas"],r.prototype.preExecute=function(t){var e=this._modeling,n=t.elements,r=t.alignment;(0,i.forEach)(n,function(t){var n={x:0,y:0};(0,i.isDefined)(r.left)?n.x=r.left-t.x:(0,i.isDefined)(r.right)?n.x=r.right-t.width-t.x:(0,i.isDefined)(r.center)?n.x=r.center-Math.round(t.width/2)-t.x:(0,i.isDefined)(r.top)?n.y=r.top-t.y:(0,i.isDefined)(r.bottom)?n.y=r.bottom-t.height-t.y:(0,i.isDefined)(r.middle)&&(n.y=r.middle-Math.round(t.height/2)-t.y),e.moveElements([t],n,t.parent)})},r.prototype.postExecute=function(t){},o.$inject=["modeling"],o.prototype.preExecute=function(t){var e=t.source;if(!e)throw new Error("source required");var n=t.target||e.parent,i=t.shape,r=t.hints||{};i=t.shape=this._modeling.createShape(i,t.position,n,{attach:r.attach}),t.shape=i},o.prototype.postExecute=function(t){var e,n,r=t.hints||{};e=t.source,n=t.shape,(0,i.some)(e.outgoing,function(t){return t.target===n})||(r.connectionTarget===t.source?this._modeling.connect(t.shape,t.source,t.connection):this._modeling.connect(t.source,t.shape,t.connection))},s.$inject=["canvas","layouter"],s.prototype.execute=function(t){var e=t.connection,n=t.source,i=t.target,r=t.parent,o=t.parentIndex,s=t.hints;if(!n||!i)throw new Error("source and target required");if(!r)throw new Error("parent required");return e.source=n,e.target=i,e.waypoints||(e.waypoints=this._layouter.layoutConnection(e,s)),this._canvas.addConnection(e,r,o),e},s.prototype.revert=function(t){var e=t.connection;return this._canvas.removeConnection(e),e.source=null,e.target=null,e};var a=n(91970),l=n(64242),c=Math.round;function h(t){this._modeling=t}h.$inject=["modeling"],h.prototype.preExecute=function(t){var e=t.elements,n=t.parent,r=t.parentIndex,o=t.position,s=t.hints,h=this._modeling;(0,i.forEach)(e,function(t){(0,i.isNumber)(t.x)||(t.x=0),(0,i.isNumber)(t.y)||(t.y=0)});var u=(0,i.filter)(e,function(t){return!t.hidden}),d=(0,a.U7)(u);(0,i.forEach)(e,function(t){(0,l.fX)(t)&&(t.waypoints=(0,i.map)(t.waypoints,function(t){return{x:c(t.x-d.x-d.width/2+o.x),y:c(t.y-d.y-d.height/2+o.y)}})),(0,i.assign)(t,{x:c(t.x-d.x-d.width/2+o.x),y:c(t.y-d.y-d.height/2+o.y)})});var p=(0,a.wT)(e),f={};(0,i.forEach)(e,function(t){if((0,l.fX)(t))f[t.id]=(0,i.isNumber)(r)?h.createConnection(f[t.source.id],f[t.target.id],r,t,t.parent||n,s):h.createConnection(f[t.source.id],f[t.target.id],t,t.parent||n,s);else{var e=(0,i.assign)({},s);-1===p.indexOf(t)&&(e.autoResize=!1),(0,l.J2)(t)&&(e=(0,i.omit)(e,["attach"])),f[t.id]=(0,i.isNumber)(r)?h.createShape(t,(0,i.pick)(t,["x","y","width","height"]),t.parent||n,r,e):h.createShape(t,(0,i.pick)(t,["x","y","width","height"]),t.parent||n,e)}}),t.elements=(0,i.values)(f)};var u=n(7475),d=Math.round;function p(t){this._canvas=t}function f(t){p.call(this,t)}p.$inject=["canvas"],p.prototype.execute=function(t){var e=t.shape,n=t.position,r=t.parent,o=t.parentIndex;if(!r)throw new Error("parent required");if(!n)throw new Error("position required");return void 0!==n.width?(0,i.assign)(e,n):(0,i.assign)(e,{x:n.x-d(e.width/2),y:n.y-d(e.height/2)}),this._canvas.addShape(e,r,o),e},p.prototype.revert=function(t){var e=t.shape;return this._canvas.removeShape(e),e},(0,u.A)(f,p),f.$inject=["canvas"];var g=p.prototype.execute;f.prototype.execute=function(t){var e=t.shape;return function(t){["width","height"].forEach(function(e){void 0===t[e]&&(t[e]=0)})}(e),e.labelTarget=t.labelTarget,g.call(this,t)};var m=p.prototype.revert;f.prototype.revert=function(t){return t.shape.labelTarget=null,m.call(this,t)};var v=n(93742),y=n(55063);function b(t,e){this._canvas=t,this._modeling=e}function x(t,e){this._modeling=t,this._elementRegistry=e}function w(t,e){this._canvas=t,this._modeling=e}function _(t){this._modeling=t}b.$inject=["canvas","modeling"],b.prototype.preExecute=function(t){var e=this._modeling,n=t.connection;(0,y.l)(n.incoming,function(t){e.removeConnection(t,{nested:!0})}),(0,y.l)(n.outgoing,function(t){e.removeConnection(t,{nested:!0})})},b.prototype.execute=function(t){var e=t.connection,n=e.parent;return t.parent=n,t.parentIndex=(0,v.qh)(n.children,e),t.source=e.source,t.target=e.target,this._canvas.removeConnection(e),e.source=null,e.target=null,e},b.prototype.revert=function(t){var e=t.connection,n=t.parent,i=t.parentIndex;return e.source=t.source,e.target=t.target,(0,v.WQ)(n.children,e,i),this._canvas.addConnection(e,n),e},x.$inject=["modeling","elementRegistry"],x.prototype.postExecute=function(t){var e=this._modeling,n=this._elementRegistry,r=t.elements;(0,i.forEach)(r,function(t){n.get(t.id)&&(t.waypoints?e.removeConnection(t):e.removeShape(t))})},w.$inject=["canvas","modeling"],w.prototype.preExecute=function(t){var e=this._modeling,n=t.shape;(0,y.l)(n.incoming,function(t){e.removeConnection(t,{nested:!0})}),(0,y.l)(n.outgoing,function(t){e.removeConnection(t,{nested:!0})}),(0,y.l)(n.children,function(t){(0,l.fX)(t)?e.removeConnection(t,{nested:!0}):e.removeShape(t,{nested:!0})})},w.prototype.execute=function(t){var e=this._canvas,n=t.shape,i=n.parent;return t.oldParent=i,t.oldParentIndex=(0,v.qh)(i.children,n),e.removeShape(n),n},w.prototype.revert=function(t){var e=this._canvas,n=t.shape,i=t.oldParent,r=t.oldParentIndex;return(0,v.WQ)(i.children,n,r),e.addShape(n,i),n},_.$inject=["modeling"];var O={x:"y",y:"x"};function k(t,e){this._layouter=t,this._canvas=e}function S(){}_.prototype.preExecute=function(t){var e=this._modeling,n=t.groups,r=t.axis,o=t.dimension;function s(t,e){t.range.min=Math.min(e[r],t.range.min),t.range.max=Math.max(e[r]+e[o],t.range.max)}function a(t){return t[r]+t[o]/2}function l(t){return t.length-1}function c(t){return t.max-t.min}var h,u,d=n[0],p=l(n),f=n[p],g=0;(0,i.forEach)(n,function(t,h){var u,d,f;t.elements.length<2?h&&h!==n.length-1&&(s(t,t.elements[0]),g+=c(t.range)):(d=(u=(0,i.sortBy)(t.elements,r))[0],h===p&&(d=u[l(u)]),f=a(d),t.range=null,(0,i.forEach)(u,function(n){!function(t,n){var i={y:0};i[r]=t-a(n),i[r]&&(i[O[r]]=0,e.moveElements([n],i,n.parent))}(f,n),null!==t.range?s(t,n):t.range={min:n[r],max:n[r]+n[o]}}),h&&h!==n.length-1&&(g+=c(t.range)))}),u=Math.abs(f.range.min-d.range.max),(h=Math.round((u-g)/(n.length-1)))<n.length-1||(0,i.forEach)(n,function(t,s){var a,l={};t!==d&&t!==f&&(a=n[s-1],t.range.max=0,(0,i.forEach)(t.elements,function(n,i){l[O[r]]=0,l[r]=a.range.max-n[r]+h,t.range.min!==n[r]&&(l[r]+=n[r]-t.range.min),l[r]&&e.moveElements([n],l,n.parent),t.range.max=Math.max(n[r]+n[o],i?t.range.max:0)}))})},_.prototype.postExecute=function(t){},k.$inject=["layouter","canvas"],k.prototype.execute=function(t){var e=t.connection,n=e.waypoints;return(0,i.assign)(t,{oldWaypoints:n}),e.waypoints=this._layouter.layoutConnection(e,t.hints),e},k.prototype.revert=function(t){var e=t.connection;return e.waypoints=t.oldWaypoints,e},S.prototype.execute=function(t){var e=t.connection,n=t.delta,r=t.newParent||e.parent,o=t.newParentIndex,s=e.parent;return t.oldParent=s,t.oldParentIndex=(0,v.TF)(s.children,e),(0,v.WQ)(r.children,e,o),e.parent=r,(0,i.forEach)(e.waypoints,function(t){t.x+=n.x,t.y+=n.y,t.original&&(t.original.x+=n.x,t.original.y+=n.y)}),e},S.prototype.revert=function(t){var e=t.connection,n=e.parent,r=t.oldParent,o=t.oldParentIndex,s=t.delta;return(0,v.TF)(n.children,e),(0,v.WQ)(r.children,e,o),e.parent=r,(0,i.forEach)(e.waypoints,function(t){t.x-=s.x,t.y-=s.y,t.original&&(t.original.x-=s.x,t.original.y-=s.y)}),e};var E=n(44944);function C(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}function A(t){this._modeling=t}function T(t){this._helper=new A(t)}function P(t){this._modeling=t,this._helper=new A(t)}function M(t){this._modeling=t}function N(t){return t.original||t}function R(t,e){this._modeling=t,this._rules=e}function D(t){this._modeling=t}C.prototype.add=function(t,e){return this.addAll([t],e)},C.prototype.addAll=function(t,e){var n=(0,a.yO)(t,!!e,this);return(0,i.assign)(this,n),this},A.prototype.moveRecursive=function(t,e,n){return t?this.moveClosure(this.getClosure(t),e,n):[]},A.prototype.moveClosure=function(t,e,n,r,o){var s=this._modeling,a=t.allShapes,l=t.allConnections,c=t.enclosedConnections,h=t.topLevel,u=!1;o&&o.parent===n&&(u=!0),(0,i.forEach)(a,function(t){s.moveShape(t,e,h[t.id]&&!u&&n,{recurse:!1,layout:!1})}),(0,i.forEach)(l,function(t){var i=!!a[t.source.id],r=!!a[t.target.id];c[t.id]&&i&&r?s.moveConnection(t,e,h[t.id]&&!u&&n):s.layoutConnection(t,{connectionStart:i&&(0,E.IY)(t,t.source,e),connectionEnd:r&&(0,E.OF)(t,t.target,e)})})},A.prototype.getClosure=function(t){return(new C).addAll(t,!0)},T.$inject=["modeling"],T.prototype.preExecute=function(t){t.closure=this._helper.getClosure(t.shapes)},T.prototype.postExecute=function(t){var e,n=t.hints;n&&n.primaryShape&&(e=n.primaryShape,n.oldParent=e.parent),this._helper.moveClosure(t.closure,t.delta,t.newParent,t.newHost,e)},P.$inject=["modeling"],P.prototype.execute=function(t){var e=t.shape,n=t.delta,r=t.newParent||e.parent,o=t.newParentIndex,s=e.parent;return t.oldBounds=(0,i.pick)(e,["x","y","width","height"]),t.oldParent=s,t.oldParentIndex=(0,v.TF)(s.children,e),(0,v.WQ)(r.children,e,o),(0,i.assign)(e,{parent:r,x:e.x+n.x,y:e.y+n.y}),e},P.prototype.postExecute=function(t){var e=t.shape,n=t.delta,r=t.hints,o=this._modeling;!1!==r.layout&&((0,i.forEach)(e.incoming,function(t){o.layoutConnection(t,{connectionEnd:(0,E.OF)(t,e,n)})}),(0,i.forEach)(e.outgoing,function(t){o.layoutConnection(t,{connectionStart:(0,E.IY)(t,e,n)})})),!1!==r.recurse&&this.moveChildren(t)},P.prototype.revert=function(t){var e=t.shape,n=t.oldParent,r=t.oldParentIndex,o=t.delta;return(0,v.WQ)(n.children,e,r),(0,i.assign)(e,{parent:n,x:e.x-o.x,y:e.y-o.y}),e},P.prototype.moveChildren=function(t){var e=t.delta,n=t.shape;this._helper.moveRecursive(n.children,e,null)},P.prototype.getNewParent=function(t){return t.newParent||t.shape.parent},M.$inject=["modeling"],M.prototype.execute=function(t){var e=t.newSource,n=t.newTarget,r=t.connection,o=t.dockingOrPoints;if(!e&&!n)throw new Error("newSource or newTarget required");return(0,i.isArray)(o)&&(t.oldWaypoints=r.waypoints,r.waypoints=o),e&&(t.oldSource=r.source,r.source=e),n&&(t.oldTarget=r.target,r.target=n),r},M.prototype.postExecute=function(t){var e=t.connection,n=t.newSource,r=t.newTarget,o=t.dockingOrPoints,s=t.hints||{},a={};s.connectionStart&&(a.connectionStart=s.connectionStart),s.connectionEnd&&(a.connectionEnd=s.connectionEnd),!1!==s.layoutConnection&&(!n||r&&"source"!==s.docking||(a.connectionStart=a.connectionStart||N((0,i.isArray)(o)?o[0]:o)),!r||n&&"target"!==s.docking||(a.connectionEnd=a.connectionEnd||N((0,i.isArray)(o)?o[o.length-1]:o)),s.newWaypoints&&(a.waypoints=s.newWaypoints),this._modeling.layoutConnection(e,a))},M.prototype.revert=function(t){var e=t.oldSource,n=t.oldTarget,i=t.oldWaypoints,r=t.connection;return e&&(r.source=e),n&&(r.target=n),i&&(r.waypoints=i),r},R.$inject=["modeling","rules"],R.prototype.preExecute=function(t){var e,n=this,r=this._modeling,o=this._rules,s=t.oldShape,a=t.newData,l=t.hints||{};function c(t,e,n){return o.allowed("connection.reconnect",{connection:n,source:t,target:e})}var h,u={x:a.x,y:a.y},d={x:s.x,y:s.y,width:s.width,height:s.height};e=t.newShape=t.newShape||n.createShape(a,u,s.parent,l),s.host&&r.updateAttachment(e,s.host),!1!==l.moveChildren&&(h=s.children.slice(),r.moveElements(h,{x:0,y:0},e,l));var p=s.incoming.slice(),f=s.outgoing.slice();(0,i.forEach)(p,function(t){c(t.source,e,t)&&n.reconnectEnd(t,e,(0,E.tQ)(t,e,d),l)}),(0,i.forEach)(f,function(t){var i=t.target;c(e,i,t)&&n.reconnectStart(t,e,(0,E.Fe)(t,e,d),l)})},R.prototype.postExecute=function(t){var e=t.oldShape;this._modeling.removeShape(e)},R.prototype.execute=function(t){},R.prototype.revert=function(t){},R.prototype.createShape=function(t,e,n,i){return this._modeling.createShape(t,e,n,i)},R.prototype.reconnectStart=function(t,e,n,i){this._modeling.reconnectStart(t,e,n,i)},R.prototype.reconnectEnd=function(t,e,n,i){this._modeling.reconnectEnd(t,e,n,i)},D.$inject=["modeling"],D.prototype.execute=function(t){var e=t.shape,n=t.newBounds,r=t.minBounds;if(void 0===n.x||void 0===n.y||void 0===n.width||void 0===n.height)throw new Error("newBounds must have {x, y, width, height} properties");if(r&&(n.width<r.width||n.height<r.height))throw new Error("width and height cannot be less than minimum height and width");if(!r&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return t.oldBounds={width:e.width,height:e.height,x:e.x,y:e.y},(0,i.assign)(e,{width:n.width,height:n.height,x:n.x,y:n.y}),e},D.prototype.postExecute=function(t){var e=this._modeling,n=t.shape,r=t.oldBounds;!1!==(t.hints||{}).layout&&((0,i.forEach)(n.incoming,function(t){e.layoutConnection(t,{connectionEnd:(0,E.tQ)(t,n,r)})}),(0,i.forEach)(n.outgoing,function(t){e.layoutConnection(t,{connectionStart:(0,E.Fe)(t,n,r)})}))},D.prototype.revert=function(t){var e=t.shape,n=t.oldBounds;return(0,i.assign)(e,{width:n.width,height:n.height,x:n.x,y:n.y}),e};var B=n(27224);function $(t){this._modeling=t}function L(t){return(0,i.assign)({},t)}function I(t){switch(t){case"n":case"s":return"y";case"w":case"e":return"x"}}function q(t,e,n){var i=I(n);return/e|s/.test(n)?t[i]>e:/n|w/.test(n)?t[i]<e:void 0}function F(t,e){return-1!==t.indexOf(e)}function V(t){this._modeling=t}function j(t){var e={};return(0,i.forEach)(t,function(t){e[t.id]=t.hidden,t.children&&(e=(0,i.assign)({},e,j(t.children)))}),e}function H(t,e){var n=[];return(0,i.forEach)(t,function(t){t.hidden=e,n=n.concat(t),t.children&&(n=n.concat(H(t.children,t.collapsed||e)))}),n}function z(t,e){var n=[];return(0,i.forEach)(t,function(t){t.hidden=e[t.id],n=n.concat(t),t.children&&(n=n.concat(z(t.children,e)))}),n}function Q(t){this._modeling=t}function W(t,e){return(0,v.TF)(t&&t.attachers,e)}function X(t,e,n){if(t){var i=t.attachers;i||(t.attachers=i=[]),(0,v.WQ)(i,e,n)}}function U(){}$.$inject=["modeling"],$.prototype.preExecute=function(t){var e=t.delta,n=t.direction,r=t.movingShapes,o=t.resizingShapes,s=t.start,a={};this.moveShapes(r,e),(0,i.forEach)(o,function(t){a[t.id]=function(t){return{x:t.x,y:t.y,height:t.height,width:t.width}}(t)}),this.resizeShapes(o,e,n),this.updateConnectionWaypoints((0,B.Gq)(r,o),e,n,s,r,o,a)},$.prototype.execute=function(){},$.prototype.revert=function(){},$.prototype.moveShapes=function(t,e){var n=this;(0,i.forEach)(t,function(t){n._modeling.moveShape(t,e,null,{autoResize:!1,layout:!1,recurse:!1})})},$.prototype.resizeShapes=function(t,e,n){var r=this;(0,i.forEach)(t,function(t){var i=(0,B.Ih)(t,n,e);r._modeling.resizeShape(t,i,null,{attachSupport:!1,autoResize:!1,layout:!1})})},$.prototype.updateConnectionWaypoints=function(t,e,n,r,o,s,a){var l=this,c=o.concat(s);(0,i.forEach)(t,function(t){var h=t.source,u=t.target,d=function(t){return(0,i.map)(t.waypoints,function(t){return(t=L(t)).original&&(t.original=L(t.original)),t})}(t),p=I(n),f={};F(c,h)&&F(c,u)?(d=(0,i.map)(d,function(t){return q(t,r,n)&&(t[p]=t[p]+e[p]),t.original&&q(t.original,r,n)&&(t.original[p]=t.original[p]+e[p]),t}),l._modeling.updateWaypoints(t,d,{labelBehavior:!1})):(F(c,h)||F(c,u))&&(F(o,h)?f.connectionStart=(0,E.IY)(t,h,e):F(o,u)?f.connectionEnd=(0,E.OF)(t,u,e):F(s,h)?f.connectionStart=(0,E.Fe)(t,h,a[h.id]):F(s,u)&&(f.connectionEnd=(0,E.tQ)(t,u,a[u.id])),l._modeling.layoutConnection(t,f))})},V.$inject=["modeling"],V.prototype.execute=function(t){var e=t.shape,n=e.children;t.oldChildrenVisibility=j(n),e.collapsed=!e.collapsed;var i=H(n,e.collapsed);return[e].concat(i)},V.prototype.revert=function(t){var e=t.shape,n=t.oldChildrenVisibility,i=z(e.children,n);return e.collapsed=!e.collapsed,[e].concat(i)},Q.$inject=["modeling"],Q.prototype.execute=function(t){var e=t.shape,n=t.newHost,i=e.host;return t.oldHost=i,t.attacherIdx=W(i,e),X(n,e),e.host=n,e},Q.prototype.revert=function(t){var e=t.shape,n=t.newHost,i=t.oldHost,r=t.attacherIdx;return e.host=i,W(n,e),X(i,e,r),e},U.prototype.execute=function(t){var e=t.connection,n=t.newWaypoints;return t.oldWaypoints=e.waypoints,e.waypoints=n,e},U.prototype.revert=function(t){var e=t.connection,n=t.oldWaypoints;return e.waypoints=n,e};var G=n(49768);function Y(t,e,n){this._eventBus=t,this._elementFactory=e,this._commandStack=n;var i=this;t.on("diagram.init",function(){i.registerHandlers(n)})}Y.$inject=["eventBus","elementFactory","commandStack"],Y.prototype.getHandlers=function(){return{"shape.append":o,"shape.create":p,"shape.delete":w,"shape.move":P,"shape.resize":D,"shape.replace":R,"shape.toggleCollapse":V,spaceTool:$,"label.create":f,"connection.create":s,"connection.delete":b,"connection.move":S,"connection.layout":k,"connection.updateWaypoints":U,"connection.reconnect":M,"elements.create":h,"elements.move":T,"elements.delete":x,"elements.distribute":_,"elements.align":r,"element.updateAttachment":Q}},Y.prototype.registerHandlers=function(t){(0,i.forEach)(this.getHandlers(),function(e,n){t.registerHandler(n,e)})},Y.prototype.moveShape=function(t,e,n,i,r){"object"==typeof i&&(r=i,i=null);var o={shape:t,delta:e,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("shape.move",o)},Y.prototype.updateAttachment=function(t,e){var n={shape:t,newHost:e};this._commandStack.execute("element.updateAttachment",n)},Y.prototype.moveElements=function(t,e,n,i){var r,o=(i=i||{}).attach,s=n;!0===o?(r=n,s=n.parent):!1===o&&(r=null);var a={shapes:t,delta:e,newParent:s,newHost:r,hints:i};this._commandStack.execute("elements.move",a)},Y.prototype.moveConnection=function(t,e,n,i,r){"object"==typeof i&&(r=i,i=void 0);var o={connection:t,delta:e,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("connection.move",o)},Y.prototype.layoutConnection=function(t,e){var n={connection:t,hints:e||{}};this._commandStack.execute("connection.layout",n)},Y.prototype.createConnection=function(t,e,n,i,r,o){"object"==typeof n&&(o=r,r=i,i=n,n=void 0);var s={source:t,target:e,parent:r,parentIndex:n,connection:i=this._create("connection",i),hints:o};return this._commandStack.execute("connection.create",s),s.connection},Y.prototype.createShape=function(t,e,n,i,r){"number"!=typeof i&&(r=i,i=void 0);var o,s,a=(r=r||{}).attach;t=this._create("shape",t),a?(o=n.parent,s=n):o=n;var l={position:e,shape:t,parent:o,parentIndex:i,host:s,hints:r};return this._commandStack.execute("shape.create",l),l.shape},Y.prototype.createElements=function(t,e,n,r,o){(0,i.isArray)(t)||(t=[t]),"number"!=typeof r&&(o=r,r=void 0);var s={position:e,elements:t,parent:n,parentIndex:r,hints:o=o||{}};return this._commandStack.execute("elements.create",s),s.elements},Y.prototype.createLabel=function(t,e,n,i){n=this._create("label",n);var r={labelTarget:t,position:e,parent:i||t.parent,shape:n};return this._commandStack.execute("label.create",r),r.shape},Y.prototype.appendShape=function(t,e,n,i,r){r=r||{};var o={source:t,position:n,target:i,shape:e=this._create("shape",e),connection:r.connection,connectionParent:r.connectionParent,hints:r};return this._commandStack.execute("shape.append",o),o.shape},Y.prototype.removeElements=function(t){var e={elements:t};this._commandStack.execute("elements.delete",e)},Y.prototype.distributeElements=function(t,e,n){var i={groups:t,axis:e,dimension:n};this._commandStack.execute("elements.distribute",i)},Y.prototype.removeShape=function(t,e){var n={shape:t,hints:e||{}};this._commandStack.execute("shape.delete",n)},Y.prototype.removeConnection=function(t,e){var n={connection:t,hints:e||{}};this._commandStack.execute("connection.delete",n)},Y.prototype.replaceShape=function(t,e,n){var i={oldShape:t,newData:e,hints:n||{}};return this._commandStack.execute("shape.replace",i),i.newShape},Y.prototype.alignElements=function(t,e){var n={elements:t,alignment:e};this._commandStack.execute("elements.align",n)},Y.prototype.resizeShape=function(t,e,n,i){var r={shape:t,newBounds:e,minBounds:n,hints:i};this._commandStack.execute("shape.resize",r)},Y.prototype.createSpace=function(t,e,n,i,r){var o={delta:n,direction:i,movingShapes:t,resizingShapes:e,start:r};this._commandStack.execute("spaceTool",o)},Y.prototype.updateWaypoints=function(t,e,n){var i={connection:t,newWaypoints:e,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",i)},Y.prototype.reconnect=function(t,e,n,i,r){var o={connection:t,newSource:e,newTarget:n,dockingOrPoints:i,hints:r||{}};this._commandStack.execute("connection.reconnect",o)},Y.prototype.reconnectStart=function(t,e,n,r){r||(r={}),this.reconnect(t,e,t.target,n,(0,i.assign)(r,{docking:"source"}))},Y.prototype.reconnectEnd=function(t,e,n,r){r||(r={}),this.reconnect(t,t.source,e,n,(0,i.assign)(r,{docking:"target"}))},Y.prototype.connect=function(t,e,n,i){return this.createConnection(t,e,n||{},t.parent,i)},Y.prototype._create=function(t,e){return(0,G.w)(e)?e:this._elementFactory.create(t,e)},Y.prototype.toggleCollapse=function(t,e){var n={shape:t,hints:e||{}};this._commandStack.execute("shape.toggleCollapse",n)}},44944(t,e,n){"use strict";n.d(e,{Fe:()=>s,IY:()=>l,OF:()=>c,tQ:()=>a});var i=n(84410),r=n(67319),o=n(57094);function s(t,e,n){var r=u(t),o=d(r,e),s=r[0];return o.length?o[o.length-1]:(0,i._)(s.original||s,n,e)}function a(t,e,n){var r=u(t),o=d(r,e),s=r[r.length-1];return o.length?o[0]:(0,i._)(s.original||s,n,e)}function l(t,e,n){var r=u(t),o=h(e,n),s=r[0];return(0,i._)(s.original||s,o,e)}function c(t,e,n){var r=u(t),o=h(e,n),s=r[r.length-1];return(0,i._)(s.original||s,o,e)}function h(t,e){return{x:t.x-e.x,y:t.y-e.y,width:t.width,height:t.height}}function u(t){var e=t.waypoints;if(!e.length)throw new Error("connection#"+t.id+": no waypoints");return e}function d(t,e){var n=(0,o.map)(t,p);return(0,o.filter)(n,function(t){return function(t,e){return"intersect"===(0,r.vc)(e,t,1)}(t,e)})}function p(t){return t.original||t}},74071(t,e,n){"use strict";function i(t){var e=this;function n(t){e._lastMoveEvent=t}this._lastMoveEvent=null,t.on("canvas.init",function(t){(e._svg=t.svg).addEventListener("mousemove",n)}),t.on("canvas.destroy",function(){e._lastMouseEvent=null,e._svg.removeEventListener("mousemove",n)})}n.d(e,{A:()=>r}),i.$inject=["eventBus"],i.prototype.getLastMoveEvent=function(){return this._lastMoveEvent||((t=document.createEvent("MouseEvent")).initMouseEvent&&t.initMouseEvent("mousemove",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t);var t};const r={__init__:["mouse"],mouse:["type",i]}},16351(t,e,n){"use strict";n.d(e,{A:()=>k});var i=n(88641),r=n(86104),o=n(46055),s=n(81734),a=n(43513),l=n(30601),c=n(57094),h=n(27828),u=n(51303),d=n(72120),p=Math.round;function f(t,e,n,i,r){function o(t,e,n,i){return r.allowed("elements.move",{shapes:t,delta:e,position:n,target:i})}function s(t,n,i,r){if((0,c.isObject)(i)&&(r=i,i=!1),!n.waypoints&&n.parent&&!(0,h.Ly)(t.target).has("djs-hit-no-move")){var o=function(t){return{x:t.x+p(t.width/2),y:t.y+p(t.height/2)}}(n);return e.init(t,o,"shape.move",{cursor:"grabbing",autoActivate:i,data:{shape:n,context:r||{}}}),!0}}t.on("shape.move.start",1500,function(t){var e,n,r=t.context,o=t.shape,s=i.get().slice();-1===s.indexOf(o)&&(s=[o]),e=s,n=(0,c.groupBy)(e,"id"),s=(0,c.filter)(e,function(t){for(;t=t.parent;)if(n[t.id])return!1;return!0}),(0,c.assign)(r,{shapes:s,validatedShapes:s,shape:o})}),t.on("shape.move.start",1250,function(t){var e=t.context,n=e.validatedShapes;if(!(e.canExecute=o(n)))return!1}),t.on("shape.move.move",500,function(t){var e,n=t.context,i=n.validatedShapes,r=t.hover,s={x:t.dx,y:t.dy};e=o(i,s,{x:t.x,y:t.y},r),n.delta=s,n.canExecute=e,n.target=null!==e?r:null}),t.on("shape.move.end",function(t){var e=t.context,i=e.delta,r=e.canExecute,o="attach"===r,s=e.shapes;if(!1===r)return!1;i.x=p(i.x),i.y=p(i.y),0===i.x&&0===i.y||n.moveElements(s,i,e.target,{primaryShape:e.shape,attach:o})}),t.on("element.mousedown",function(t){if((0,d.ls)(t)){var e=(0,u.AF)(t);if(!e)throw new Error("must supply DOM mousedown event");return s(e,t.element)}}),this.start=s}f.$inject=["eventBus","dragging","modeling","selection","rules"];var g=n(91970),m=n(46757),v=n(64242),y="djs-dragging",b="drop-ok",x="drop-not-ok",w="new-parent",_="attach-ok";function O(t,e,n,i){function r(t){var e=(0,g.cZ)(t,!0),n=e.flatMap(t=>(t.incoming||[]).concat(t.outgoing||[])),i=e.concat(n);return[...new Set(i)]}function o(t,n){[_,b,x,w].forEach(function(i){i===n?e.addMarker(t,i):e.removeMarker(t,i)})}t.on("shape.move.start",499,function(t){var o,s=t.context,a=s.shapes,l=s.allDraggedElements,u=function(t){var e;return e=r(t),(0,c.filter)(e,function(t){return!(0,v.fX)(t)||(0,c.find)(e,(0,c.matchPattern)({id:t.source.id}))&&(0,c.find)(e,(0,c.matchPattern)({id:t.target.id}))})}(a);if(!s.dragGroup){var d=(0,h.vt)("g");(0,h.CF)(d,n.cls("djs-drag-group",["no-events"]));var p=e.getActiveLayer();(0,h.BC)(p,d),s.dragGroup=d}u.forEach(function(t){i.addDragger(t,s.dragGroup)}),l=l?(0,c.flatten)([l,r(a)]):r(a),(0,c.forEach)(l,function(t){e.addMarker(t,y)}),s.allDraggedElements=l,s.differentParents=(o=a,1!==(0,c.size)((0,c.groupBy)(o,function(t){return t.parent&&t.parent.id})))}),t.on("shape.move.move",499,function(t){var e=t.context,n=e.dragGroup,i=e.target,r=e.shape.parent,s=e.canExecute;i&&("attach"===s?o(i,_):e.canExecute&&r&&i.id!==r.id?o(i,w):o(i,e.canExecute?b:x)),(0,m.Tl)(n,t.dx,t.dy)}),t.on(["shape.move.out","shape.move.cleanup"],function(t){var e=t.context.target;e&&o(e,null)}),t.on("shape.move.cleanup",function(t){var n=t.context,i=n.allDraggedElements,r=n.dragGroup;(0,c.forEach)(i,function(t){e.removeMarker(t,y)}),r&&(0,h.TF)(r)}),this.makeDraggable=function(t,n,r){i.addDragger(n,t.dragGroup),r&&e.addMarker(n,y),t.allDraggedElements?t.allDraggedElements.push(n):t.allDraggedElements=[n]}}O.$inject=["eventBus","canvas","styles","previewSupport"];const k={__depends__:[i.A,r.A,o.A,s.A,a.A,l.A],__init__:["move","movePreview"],move:["type",f],movePreview:["type",O]}},46055(t,e,n){"use strict";n.d(e,{A:()=>h});var i=n(86104),r=n(91970),o=n(27828),s=n(81340),a=n(57094);function l(t,e){this._eventBus=t,this.offset=5;var n=e.cls("djs-outline",["no-fill"]),i=this;function r(t){var e=(0,o.vt)("rect");return(0,o.CF)(e,(0,a.assign)({x:0,y:0,rx:4,width:100,height:100},n)),e}t.on(["shape.added","shape.changed"],500,function(t){var e=t.element,n=t.gfx,a=(0,s.P)(".djs-outline",n);a||(a=i.getOutline(e)||r(),(0,o.BC)(n,a)),i.updateShapeOutline(a,e)}),t.on(["connection.added","connection.changed"],function(t){var e=t.element,n=t.gfx,a=(0,s.P)(".djs-outline",n);a||(a=r(),(0,o.BC)(n,a)),i.updateConnectionOutline(a,e)})}function c(t,e,n){this._canvas=e;var i=this;t.on("element.changed",function(t){n.isSelected(t.element)&&i._updateMultiSelectionOutline(n.get())}),t.on("selection.changed",function(t){var e=t.newSelection;i._updateMultiSelectionOutline(e)})}l.prototype.updateShapeOutline=function(t,e){var n=!1,i=this._getProviders();i.length&&(0,a.forEach)(i,function(i){n=n||i.updateOutline(e,t)}),n||(0,o.CF)(t,{x:-this.offset,y:-this.offset,width:e.width+2*this.offset,height:e.height+2*this.offset})},l.prototype.updateConnectionOutline=function(t,e){var n=(0,r.U7)(e);(0,o.CF)(t,{x:n.x-this.offset,y:n.y-this.offset,width:n.width+2*this.offset,height:n.height+2*this.offset})},l.prototype.registerProvider=function(t,e){e||(e=t,t=1e3),this._eventBus.on("outline.getProviders",t,function(t){t.providers.push(e)})},l.prototype._getProviders=function(){var t=this._eventBus.createEvent({type:"outline.getProviders",providers:[]});return this._eventBus.fire(t),t.providers},l.prototype.getOutline=function(t){var e,n=this._getProviders();return(0,a.forEach)(n,function(n){(0,a.isFunction)(n.getOutline)&&(e=e||n.getOutline(t))}),e},l.$inject=["eventBus","styles","elementRegistry"],c.prototype._updateMultiSelectionOutline=function(t){var e=this._canvas.getLayer("selectionOutline");(0,o.IU)(e);var n=t.length>1,i=this._canvas.getContainer();if((0,o.Ly)(i)[n?"add":"remove"]("djs-multi-select"),n){var s=function(t){return{x:t.x-6,y:t.y-6,width:t.width+12,height:t.height+12}}((0,r.U7)(t)),l=(0,o.vt)("rect");(0,o.CF)(l,(0,a.assign)({rx:3},s)),(0,o.Ly)(l).add("djs-selection-outline"),(0,o.BC)(e,l)}},c.$inject=["eventBus","canvas","selection"];const h={__depends__:[i.A],__init__:["outline","multiSelectionOutline"],outline:["type",l],multiSelectionOutline:["type",c]}},4912(t,e,n){"use strict";n.d(e,{A:()=>p});var i=n(57094),r=n(81340),o=n(93083),s=n.n(o),a=n(91970),l=new(n(43709).A)("ov");function c(t,e,n,o){var a,c;this._eventBus=e,this._canvas=n,this._elementRegistry=o,this._ids=l,this._overlayDefaults=(0,i.assign)({show:null,scale:!0},t&&t.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=(a=n.getContainer(),c=s()('<div class="djs-overlay-container" />'),(0,r.HZ)(c,{position:"absolute",width:0,height:0}),a.insertBefore(c,a.firstChild),c),this._init()}function h(t,e,n){(0,r.HZ)(t,{left:e+"px",top:n+"px"})}function u(t,e){t.style.display=!1===e?"none":""}function d(t,e){t.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){t.style[n+"transform"]=e})}c.$inject=["config.overlays","eventBus","canvas","elementRegistry"],c.prototype.get=function(t){if((0,i.isString)(t)&&(t={id:t}),(0,i.isString)(t.element)&&(t.element=this._elementRegistry.get(t.element)),t.element){var e=this._getOverlayContainer(t.element,!0);return e?t.type?(0,i.filter)(e.overlays,(0,i.matchPattern)({type:t.type})):e.overlays.slice():[]}return t.type?(0,i.filter)(this._overlays,(0,i.matchPattern)({type:t.type})):t.id?this._overlays[t.id]:null},c.prototype.add=function(t,e,n){if((0,i.isObject)(e)&&(n=e,e=null),t.id||(t=this._elementRegistry.get(t)),!n.position)throw new Error("must specifiy overlay position");if(!n.html)throw new Error("must specifiy overlay html");if(!t)throw new Error("invalid element specified");var r=this._ids.next();return n=(0,i.assign)({},this._overlayDefaults,n,{id:r,type:e,element:t,html:n.html}),this._addOverlay(n),r},c.prototype.remove=function(t){var e=this.get(t)||[];(0,i.isArray)(e)||(e=[e]);var n=this;(0,i.forEach)(e,function(t){var e=n._getOverlayContainer(t.element,!0);if(t&&((0,r.TF)(t.html),(0,r.TF)(t.htmlContainer),delete t.htmlContainer,delete t.element,delete n._overlays[t.id]),e){var i=e.overlays.indexOf(t);-1!==i&&e.overlays.splice(i,1)}})},c.prototype.isShown=function(){return"none"!==this._overlayRoot.style.display},c.prototype.show=function(){u(this._overlayRoot)},c.prototype.hide=function(){u(this._overlayRoot,!1)},c.prototype.clear=function(){this._overlays={},this._overlayContainers=[],(0,r.IU)(this._overlayRoot)},c.prototype._updateOverlayContainer=function(t){var e=t.element,n=t.html,i=e.x,o=e.y;if(e.waypoints){var s=(0,a.U7)(e);i=s.x,o=s.y}h(n,i,o),(0,r.CF)(t.html,"data-container-id",e.id)},c.prototype._updateOverlay=function(t){var e,n,i=t.position,r=t.htmlContainer,o=t.element,s=i.left,l=i.top;void 0!==i.right&&(e=o.waypoints?(0,a.U7)(o).width:o.width,s=-1*i.right+e),void 0!==i.bottom&&(n=o.waypoints?(0,a.U7)(o).height:o.height,l=-1*i.bottom+n),h(r,s||0,l||0),this._updateOverlayVisibilty(t,this._canvas.viewbox())},c.prototype._createOverlayContainer=function(t){var e=s()('<div class="djs-overlays" />');(0,r.HZ)(e,{position:"absolute"}),this._overlayRoot.appendChild(e);var n={html:e,element:t,overlays:[]};return this._updateOverlayContainer(n),this._overlayContainers.push(n),n},c.prototype._updateRoot=function(t){var e=t.scale||1,n="matrix("+[e,0,0,e,-1*t.x*e,-1*t.y*e].join(",")+")";d(this._overlayRoot,n)},c.prototype._getOverlayContainer=function(t,e){var n=(0,i.find)(this._overlayContainers,function(e){return e.element===t});return n||e?n:this._createOverlayContainer(t)},c.prototype._addOverlay=function(t){var e,n,o=t.id,a=t.element,l=t.html;l.get&&l.constructor.prototype.jquery&&(l=l.get(0)),(0,i.isString)(l)&&(l=s()(l)),n=this._getOverlayContainer(a),e=s()('<div class="djs-overlay" data-overlay-id="'+o+'">'),(0,r.HZ)(e,{position:"absolute"}),e.appendChild(l),t.type&&(0,r.Ly)(e).add("djs-overlay-"+t.type),u(e,this._canvas.findRoot(a)===this._canvas.getRootElement()),t.htmlContainer=e,n.overlays.push(t),n.html.appendChild(e),this._overlays[o]=t,this._updateOverlay(t),this._updateOverlayVisibilty(t,this._canvas.viewbox())},c.prototype._updateOverlayVisibilty=function(t,e){var n=t.show,r=this._canvas.findRoot(t.element),o=n&&n.minZoom,s=n&&n.maxZoom,a=t.htmlContainer,l=!0;(r!==this._canvas.getRootElement()||n&&((0,i.isDefined)(o)&&o>e.scale||(0,i.isDefined)(s)&&s<e.scale))&&(l=!1),u(a,l),this._updateOverlayScale(t,e)},c.prototype._updateOverlayScale=function(t,e){var n,r,o,s=t.scale,a=t.htmlContainer,l="";!0!==s&&(!1===s?(n=1,r=1):(n=s.min,r=s.max),(0,i.isDefined)(n)&&e.scale<n&&(o=(1/e.scale||1)*n),(0,i.isDefined)(r)&&e.scale>r&&(o=(1/e.scale||1)*r)),(0,i.isDefined)(o)&&(l="scale("+o+","+o+")"),d(a,l)},c.prototype._updateOverlaysVisibilty=function(t){var e=this;(0,i.forEach)(this._overlays,function(n){e._updateOverlayVisibilty(n,t)})},c.prototype._init=function(){var t=this._eventBus,e=this;t.on("canvas.viewbox.changing",function(t){e.hide()}),t.on("canvas.viewbox.changed",function(t){var n;n=t.viewbox,e._updateRoot(n),e._updateOverlaysVisibilty(n),e.show()}),t.on(["shape.remove","connection.remove"],function(t){var n=t.element,o=e.get({element:n});(0,i.forEach)(o,function(t){e.remove(t.id)});var s=e._getOverlayContainer(n);if(s){(0,r.TF)(s.html);var a=e._overlayContainers.indexOf(s);-1!==a&&e._overlayContainers.splice(a,1)}}),t.on("element.changed",500,function(t){var n=t.element,r=e._getOverlayContainer(n,!0);r&&((0,i.forEach)(r.overlays,function(t){e._updateOverlay(t)}),e._updateOverlayContainer(r))}),t.on("element.marker.update",function(t){var n=e._getOverlayContainer(t.element,!0);n&&(0,r.Ly)(n.html)[t.add?"add":"remove"](t.marker)}),t.on("root.set",function(){e._updateOverlaysVisibilty(e._canvas.viewbox())}),t.on("diagram.clear",this.clear,this)};const p={__init__:["overlays"],overlays:["type",c]}},33266(t,e,n){"use strict";n.d(e,{A:()=>m});var i=n(57094),r=n(93083),o=n.n(r),s=n(81340),a=n(75340),l=".djs-palette-toggle",c=".entry",h=l+", "+c,u="djs-palette-",d="open",p="two-column";function f(t,e){this._eventBus=t,this._canvas=e;var n=this;t.on("tool-manager.update",function(t){var e=t.tool;n.updateToolHighlight(e)}),t.on("i18n.changed",function(){n._update()}),t.on("diagram.init",function(){n._diagramInitialized=!0,n._rebuild()})}function g(t,e){var n=e.getPaletteEntries();return(0,i.isFunction)(n)?n(t):((0,i.forEach)(n,function(e,n){t[n]=e}),t)}f.$inject=["eventBus","canvas"],f.prototype.registerProvider=function(t,e){e||(e=t,t=1e3),this._eventBus.on("palette.getProviders",t,function(t){t.providers.push(e)}),this._rebuild()},f.prototype.getEntries=function(){return this._getProviders().reduce(g,{})},f.prototype._rebuild=function(){this._diagramInitialized&&this._getProviders().length&&(this._container||this._init(),this._update())},f.prototype._init=function(){var t=this,e=this._eventBus,n=this._getParentContainer(),i=this._container=o()(f.HTML_MARKUP);n.appendChild(i),(0,s.Ly)(n).add(u+"shown"),s.Mm.bind(i,h,"click",function(e){var n=e.delegateTarget;if((0,s.cK)(n,l))return t.toggle();t.trigger("click",e)}),s.f0.bind(i,"mousedown",function(t){t.stopPropagation()}),s.Mm.bind(i,c,"dragstart",function(e){t.trigger("dragstart",e)}),e.on("canvas.resized",this._layoutChanged,this),e.fire("palette.create",{container:i})},f.prototype._getProviders=function(t){var e=this._eventBus.createEvent({type:"palette.getProviders",providers:[]});return this._eventBus.fire(e),e.providers},f.prototype._toggleState=function(t){t=t||{};var e,n=this._getParentContainer(),i=this._container,r=this._eventBus,o=(0,s.Ly)(i),a=(0,s.Ly)(n);e="twoColumn"in t?t.twoColumn:this._needsCollapse(n.clientHeight,this._entries||{}),o.toggle(p,e),a.toggle(u+p,e),"open"in t&&(o.toggle(d,t.open),a.toggle(u+d,t.open)),r.fire("palette.changed",{twoColumn:e,open:this.isOpen()})},f.prototype._update=function(){var t=(0,s.P)(".djs-palette-entries",this._container),e=this._entries=this.getEntries();(0,s.IU)(t),(0,i.forEach)(e,function(e,n){var r=e.group||"default",l=(0,s.P)("[data-group="+(0,a.F)(r)+"]",t);l||(l=o()('<div class="group"></div>'),(0,s.CF)(l,"data-group",r),t.appendChild(l));var c,h,u,d=e.html||(e.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),p=o()(d);if(l.appendChild(p),!e.separator&&((0,s.CF)(p,"data-action",n),e.title&&(0,s.CF)(p,"title",e.title),e.className&&(c=p,h=e.className,u=(0,s.Ly)(c),((0,i.isArray)(h)?h:h.split(/\s+/g)).forEach(function(t){u.add(t)})),e.imageUrl)){var f=o()("<img>");(0,s.CF)(f,"src",e.imageUrl),p.appendChild(f)}}),this.open()},f.prototype.trigger=function(t,e,n){var i,r,o=e.delegateTarget||e.target;return o?(i=(0,s.CF)(o,"data-action"),r=e.originalEvent||e,this.triggerEntry(i,t,r,n)):e.preventDefault()},f.prototype.triggerEntry=function(t,e,n,r){var o,s;if((o=this._entries[t])&&(s=o.action,!1!==this._eventBus.fire("palette.trigger",{entry:o,event:n}))){if((0,i.isFunction)(s)){if("click"===e)return s(n,r)}else if(s[e])return s[e](n,r);n.preventDefault()}},f.prototype._layoutChanged=function(){this._toggleState({})},f.prototype._needsCollapse=function(t,e){return t<46*Object.keys(e).length+50},f.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})},f.prototype.open=function(){this._toggleState({open:!0})},f.prototype.toggle=function(){this.isOpen()?this.close():this.open()},f.prototype.isActiveTool=function(t){return t&&this._activeTool===t},f.prototype.updateToolHighlight=function(t){var e,n;this._toolsContainer||(e=(0,s.P)(".djs-palette-entries",this._container),this._toolsContainer=(0,s.P)("[data-group=tools]",e)),n=this._toolsContainer,(0,i.forEach)(n.children,function(e){var n=e.getAttribute("data-action");if(n){var i=(0,s.Ly)(e);n=n.replace("-tool",""),i.contains("entry")&&n===t?i.add("highlighted-entry"):i.remove("highlighted-entry")}})},f.prototype.isOpen=function(){return(0,s.Ly)(this._container).has(d)},f.prototype._getParentContainer=function(){return this._canvas.getContainer()},f.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';const m={__init__:["palette"],palette:["type",f]}},96412(t,e,n){"use strict";n.d(e,{A:()=>y});var i=n(60616),r=n(29610),o=n(81340),s=n(93083),a=n.n(s),l=n(57094),c=n(43078),h=n(11750);function u(t){const{headerEntries:e,onSelect:n,selectedEntry:i,setSelectedEntry:o,title:s}=t,a=(0,c.Kr)(()=>e.reduce((t,e)=>{const n=e.group||"default",i=t.find(t=>t.id===n);return i?i.entries.push(e):t.push({id:n,entries:[e]}),t},[]),[e]),l=t=>t.action&&!t.disabled;return r.qy`
    <div class="djs-popup-header">
      <h3 class="djs-popup-title" title=${s}>${s}</h3>
      ${a.map(t=>r.qy`
        <ul key=${t.id} class="djs-popup-header-group" data-header-group=${t.id}>

          ${t.entries.map(t=>r.qy`
            <li key=${t.id}>
              <${l(t)?"button":"span"}
                class=${function(t,e){return(0,h.A)("entry",t.className,t.active?"active":"",t.disabled?"disabled":"",e?"selected":"")}(t,t===i)}
                onClick=${e=>((t,e)=>{if(l(e))return n(t,e)})(e,t)}
                title=${t.title||t.label}
                data-id=${t.id}
                aria-disabled=${t.disabled||void 0}
                onMouseEnter=${()=>l(t)&&o(t)}
                onMouseLeave=${()=>l(t)&&o(null)}
                onFocus=${()=>l(t)&&o(t)}
                onBlur=${()=>l(t)&&o(null)}
              >
                ${t.imageUrl&&r.qy`<img class="djs-popup-entry-icon" src=${t.imageUrl} alt="" />`||t.imageHtml&&r.qy`<div class="djs-popup-entry-icon" dangerouslySetInnerHTML=${{__html:t.imageHtml}} />`}
                ${t.label?r.qy`
                  <span class="djs-popup-label">${t.label}</span>
                `:null}
              </${t.action?"button":"span"}>
            </li>
          `)}
        </ul>
      `)}
    </div>
  `}function d(t){const{entry:e,selected:n,onMouseEnter:i,onMouseLeave:o,onAction:s}=t,a=(t,n)=>{if(!e.disabled)return s(t,e,n)};return r.qy`
    <li
      class=${(0,h.A)("entry",{selected:n,disabled:e.disabled})}
      data-id=${e.id}
      title=${e.title||e.label}
      aria-disabled=${e.disabled||void 0}
      tabIndex="0"
      onClick=${a}
      onFocus=${i}
      onBlur=${o}
      onMouseEnter=${i}
      onMouseLeave=${o}
      onDragStart=${t=>a(t,"dragstart")}
      draggable=${!0}
    >
      <div class="djs-popup-entry-content">
        <span
          class=${(0,h.A)("djs-popup-entry-name",e.className)}
        >
          ${e.imageUrl&&r.qy`<img class="djs-popup-entry-icon" src=${e.imageUrl} alt="" />`||e.imageHtml&&r.qy`<div class="djs-popup-entry-icon" dangerouslySetInnerHTML=${{__html:e.imageHtml}} />`}

          ${e.label?r.qy`
            <span class="djs-popup-label">
              ${e.label}
            </span>
          `:null}
        </span>
        ${e.description&&r.qy`
          <span
            class="djs-popup-entry-description"
            title=${e.description}
          >
            ${e.description}
          </span>
        `}
      </div>
      ${e.documentationRef&&r.qy`
        <div class="djs-popup-entry-docs">
          <a
            href="${e.documentationRef}"
            onClick=${t=>t.stopPropagation()}
            title="Open element documentation"
            target="_blank"
            rel="noopener"
          >
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M10.6368 10.6375V5.91761H11.9995V10.6382C11.9995 10.9973 11.8623 11.3141 11.5878 11.5885C11.3134 11.863 10.9966 12.0002 10.6375 12.0002H1.36266C0.982345 12.0002 0.660159 11.8681 0.396102 11.6041C0.132044 11.34 1.52588e-05 11.0178 1.52588e-05 10.6375V1.36267C1.52588e-05 0.98236 0.132044 0.660173 0.396102 0.396116C0.660159 0.132058 0.982345 2.95639e-05 1.36266 2.95639e-05H5.91624V1.36267H1.36266V10.6375H10.6368ZM12 0H7.2794L7.27873 1.36197H9.68701L3.06507 7.98391L4.01541 8.93425L10.6373 2.31231V4.72059H12V0Z" fill="#818798"/>
            </svg>
          </a>
        </div>
      `}
    </li>
  `}function p(t){const{selectedEntry:e,setSelectedEntry:n,groupedEntries:i,...o}=t,s=(0,c.li)();return(0,c.Nf)(()=>{const t=s.current;if(!t)return;const e=t.querySelector(".selected");var n;e&&("function"==typeof(n=e).scrollIntoViewIfNeeded?n.scrollIntoViewIfNeeded():n.scrollIntoView({scrollMode:"if-needed",block:"nearest"}))},[e]),r.qy`
    <div class="djs-popup-results" ref=${s}>
      ${i.map(t=>r.qy`
        ${t.name&&r.qy`
          <div key=${t.id} class="entry-header" title=${t.name}>
            ${t.name}
          </div>
        `}
        <ul class="djs-popup-group" data-group=${t.id}>
          ${t.entries.map(t=>r.qy`
            <${d}
              key=${t.id}
              entry=${t}
              selected=${t===e}
              onMouseEnter=${()=>n(t)}
              onMouseLeave=${()=>n(null)}
              ...${o}
            />
          `)}
        </ul>
      `)}
    </div>
  `}function f(t){const{onClose:e,onSelect:n,className:i,headerEntries:s,position:a,title:h,width:d,scale:f,search:m,emptyPlaceholder:v,searchFn:y,entries:b,onOpened:x,onClosed:w}=t,_=(0,c.Kr)(()=>!!(0,l.isDefined)(m)&&b.length>5,[m,b]),[O,k]=(0,c.J0)(""),S=(0,c.hb)((t,e)=>{if(!_)return t;if(!e.trim())return t.filter(({rank:t=0})=>t>=0);const n=t.filter(({searchable:t})=>!1!==t);return y(n,e,{keys:["label","search","description"]}).map(({item:t})=>t)},[_]),[E,C]=(0,c.J0)(S(b,O)),[A,T]=(0,c.J0)(E[0]),P=(0,c.Kr)(()=>function(t){const e=[],n=t=>e.find(e=>t.id===e.id);return t.forEach(t=>{const i=t.group?(t=>"string"==typeof t?{id:t}:t)(t.group):{id:"default"};(t=>!!n(t))(i)?n(i).entries.push(t):e.push({...i,entries:[t]})}),e}(E),[E]),M=(0,c.hb)(t=>{T(t[0]),C(t)},[C,T]);(0,c.vJ)(()=>{M(S(b,O))},[O,b]);const N=(0,c.hb)(t=>{const e=function(t){const e=[];return t.forEach(t=>{t.entries.forEach(t=>{e.push(t)})}),e}(P);let n=e.indexOf(A)+t;n<0&&(n=e.length-1),n>=e.length&&(n=0),T(e[n])},[P,A,T]),R=(0,c.hb)(t=>{if("Enter"===t.key&&A){if(A.disabled)return;return n(t,A)}return"ArrowUp"===t.key?(N(-1),t.preventDefault()):"ArrowDown"===t.key?(N(1),t.preventDefault()):void 0},[n,A,N]),D=(0,c.hb)(t=>{(0,o.cK)(t.target,"input")&&k(()=>t.target.value)},[k]);(0,c.vJ)(()=>(x(),()=>{w()}),[]);const B=(0,c.Kr)(()=>h||s.length>0,[h,s]);return r.qy`
    <${g}
      onClose=${e}
      onKeyup=${D}
      onKeydown=${R}
      className=${i}
      position=${a}
      width=${d}
      scale=${f}
    >
      ${B&&r.qy`
        <${u}
          headerEntries=${s}
          onSelect=${n}
          selectedEntry=${A}
          setSelectedEntry=${T}
          title=${h}
        />
      `}
      ${b.length>0&&r.qy`
        <div class="djs-popup-body">

          ${_&&r.qy`
          <div class="djs-popup-search">
            <svg class="djs-popup-search-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M9.0325 8.5H9.625L13.3675 12.25L12.25 13.3675L8.5 9.625V9.0325L8.2975 8.8225C7.4425 9.5575 6.3325 10 5.125 10C2.4325 10 0.25 7.8175 0.25 5.125C0.25 2.4325 2.4325 0.25 5.125 0.25C7.8175 0.25 10 2.4325 10 5.125C10 6.3325 9.5575 7.4425 8.8225 8.2975L9.0325 8.5ZM1.75 5.125C1.75 6.9925 3.2575 8.5 5.125 8.5C6.9925 8.5 8.5 6.9925 8.5 5.125C8.5 3.2575 6.9925 1.75 5.125 1.75C3.2575 1.75 1.75 3.2575 1.75 5.125Z" fill="#22242A"/>
            </svg>
            <input type="text" spellcheck=${!1} aria-label="${h}" />
          </div>
          `}

          <${p}
            groupedEntries=${P}
            selectedEntry=${A}
            setSelectedEntry=${T}
            onAction=${n}
          />
        </div>
      `}
    ${v&&0===E.length&&r.qy`
      <div class="djs-popup-no-results">${(0,l.isFunction)(v)?v(O):v}</div>
    `}
    </${g}>
  `}function g(t){const{onClose:e,onKeydown:n,onKeyup:i,className:s,children:a,position:l}=t,u=(0,c.li)();return(0,c.Nf)(()=>{if("function"!=typeof l)return;const t=u.current,e=l(t);t.style.left=`${e.x}px`,t.style.top=`${e.y}px`},[u.current,l]),(0,c.Nf)(()=>{const t=u.current;t&&(t.querySelector("input")||t).focus()},[]),(0,c.vJ)(()=>{const t=t=>{if("Escape"===t.key)return t.preventDefault(),e()},n=t=>{if(!(0,o.kp)(t.target,".djs-popup",!0))return e()};return document.documentElement.addEventListener("keydown",t),document.body.addEventListener("click",n),()=>{document.documentElement.removeEventListener("keydown",t),document.body.removeEventListener("click",n)}},[]),r.qy`
    <div
      class=${(0,h.A)("djs-popup",s)}
      style=${function(t){return{transform:`scale(${t.scale})`,width:`${t.width}px`,"transform-origin":"top left"}}(t)}
      onKeydown=${n}
      onKeyup=${i}
      ref=${u}
      tabIndex="-1"
    >
      ${a}
    </div>
  `}var m=["contextPad.close","canvas.viewbox.changing","commandStack.changed"];function v(t,e,n,i){this._eventBus=e,this._canvas=n,this._search=i,this._current=null;var r=(0,l.isDefined)(t&&t.scale)?t.scale:{min:1,max:1};this._config={scale:r},e.on("diagram.destroy",()=>{this.close()}),e.on("element.changed",t=>{const e=this.isOpen()&&this._current.target;t.element===e&&this.refresh()})}v.$inject=["config.popupMenu","eventBus","canvas","search"],v.prototype._render=function(){const{position:t,providerId:e,entries:n,headerEntries:o,emptyPlaceholder:s,options:a}=this._current,l=Object.entries(n).map(([t,e])=>({id:t,...e})),c=Object.entries(o).map(([t,e])=>({id:t,...e})),h=t&&(e=>this._ensureVisible(e,t)),u=this._updateScale(this._current.container);(0,i.render)(r.qy`
      <${f}
        onClose=${t=>this.close(t)}
        onSelect=${(t,e,n)=>this.trigger(t,e,n)}
        position=${h}
        className=${e}
        entries=${l}
        headerEntries=${c}
        emptyPlaceholder=${s}
        scale=${u}
        onOpened=${this._onOpened.bind(this)}
        onClosed=${this._onClosed.bind(this)}
        searchFn=${this._search}
        ...${{...a}}
      />
    `,this._current.container)},v.prototype.open=function(t,e,n,i){if(!t)throw new Error("target is missing");if(!e)throw new Error("providers for <"+e+"> not found");if(!n)throw new Error("position is missing");this.isOpen()&&this.close();const{entries:r,headerEntries:o,emptyPlaceholder:s}=this._getContext(t,e);this._current={position:n,providerId:e,target:t,entries:r,headerEntries:o,emptyPlaceholder:s,container:this._createContainer({provider:e}),options:i},this._emit("open"),this._bindAutoClose(),this._render()},v.prototype.refresh=function(){if(!this.isOpen())return;const{target:t,providerId:e}=this._current,{entries:n,headerEntries:i,emptyPlaceholder:r}=this._getContext(t,e);this._current={...this._current,entries:n,headerEntries:i,emptyPlaceholder:r},this._emit("refresh"),this._render()},v.prototype._getContext=function(t,e){const n=this._getProviders(e);if(!n||!n.length)throw new Error("provider for <"+e+"> not found");const i=this._getEntries(t,n),r=this._getHeaderEntries(t,n);return{entries:i,headerEntries:r,emptyPlaceholder:this._getEmptyPlaceholder(n),empty:!(Object.keys(i).length||Object.keys(r).length)}},v.prototype.close=function(){this.isOpen()&&(this._emit("close"),this.reset(),this._canvas.restoreFocus(),this._current=null)},v.prototype.reset=function(){const t=this._current.container;(0,i.render)(null,t),(0,o.TF)(t)},v.prototype._emit=function(t,e){this._eventBus.fire(`popupMenu.${t}`,e)},v.prototype._onOpened=function(){this._emit("opened")},v.prototype._onClosed=function(){this._emit("closed")},v.prototype._createContainer=function(t){var e=this._canvas.getContainer();const n=a()(`<div class="djs-popup-parent djs-scrollable" data-popup=${t.provider}></div>`);return e.appendChild(n),n},v.prototype._bindAutoClose=function(){this._eventBus.once(m,this.close,this)},v.prototype._unbindAutoClose=function(){this._eventBus.off(m,this.close,this)},v.prototype._updateScale=function(){var t,e,n=this._canvas.zoom(),i=this._config.scale,r=n;return!0!==i&&(!1===i?(t=1,e=1):(t=i.min,e=i.max),(0,l.isDefined)(t)&&n<t&&(r=t),(0,l.isDefined)(e)&&n>e&&(r=e)),r},v.prototype._ensureVisible=function(t,e){var n=document.documentElement.getBoundingClientRect(),i=t.getBoundingClientRect(),r={},o=e.x,s=e.y;return e.x+i.width>n.width&&(r.x=!0),e.y+i.height>n.height&&(r.y=!0),r.x&&r.y?(o=e.x-i.width,s=e.y-i.height):r.x?(o=e.x-i.width,s=e.y):r.y&&e.y<i.height?(o=e.x,s=10):r.y&&(o=e.x,s=e.y-i.height),e.y<n.top&&(s=e.y+i.height),{x:o,y:s}},v.prototype.isEmpty=function(t,e){if(!t)throw new Error("target is missing");if(!e)throw new Error("provider ID is missing");const n=this._getProviders(e);return!n||!n.length||this._getContext(t,e).empty},v.prototype.registerProvider=function(t,e,n){n||(n=e,e=1e3),this._eventBus.on("popupMenu.getProviders."+t,e,function(t){t.providers.push(n)})},v.prototype._getProviders=function(t){var e=this._eventBus.createEvent({type:"popupMenu.getProviders."+t,providers:[]});return this._eventBus.fire(e),e.providers},v.prototype._getEntries=function(t,e){var n={};return(0,l.forEach)(e,function(e){if(e.getPopupMenuEntries){var i=e.getPopupMenuEntries(t);(0,l.isFunction)(i)?n=i(n):(0,l.forEach)(i,function(t,e){n[e]=t})}else(0,l.forEach)(e.getEntries(t),function(t){var e=t.id;if(!e)throw new Error("entry ID is missing");n[e]=(0,l.omit)(t,["id"])})}),n},v.prototype._getHeaderEntries=function(t,e){var n={};return(0,l.forEach)(e,function(e){if(e.getPopupMenuHeaderEntries){var i=e.getPopupMenuHeaderEntries(t);(0,l.isFunction)(i)?n=i(n):(0,l.forEach)(i,function(t,e){n[e]=t})}else{if(!e.getHeaderEntries)return;(0,l.forEach)(e.getHeaderEntries(t),function(t){var e=t.id;if(!e)throw new Error("entry ID is missing");n[e]=(0,l.omit)(t,["id"])})}}),n},v.prototype._getEmptyPlaceholder=function(t){const e=t.find(t=>(0,l.isFunction)(t.getEmptyPlaceholder));return e&&e.getEmptyPlaceholder()},v.prototype.isOpen=function(){return!!this._current},v.prototype.trigger=function(t,e,n="click"){if(t.preventDefault(),!e){let n=(0,o.kp)(t.delegateTarget||t.target,".entry",!0),i=(0,o.CF)(n,"data-id");e={id:i,...this._getEntry(i)}}const i=e.action;if(!1!==this._emit("trigger",{entry:e,event:t}))if((0,l.isFunction)(i)){if("click"===n)return i(t,e)}else if(i[n])return i[n](t,e)},v.prototype._getEntry=function(t){var e=this._current.entries[t]||this._current.headerEntries[t];if(!e)throw new Error("entry not found");return e};const y={__depends__:[n(98294).A],__init__:["popupMenu"],popupMenu:["type",v]}},30601(t,e,n){"use strict";n.d(e,{A:()=>h});var i=n(27828),r=n(81340),o=n(37706);const s=new(n(43709).A)("ps");var a=["marker-start","marker-mid","marker-end"],l=["circle","ellipse","line","path","polygon","polyline","path","rect"];function c(t,e,n,i){this._elementRegistry=t,this._canvas=n,this._styles=i}c.$inject=["elementRegistry","eventBus","canvas","styles"],c.prototype.cleanUp=function(){console.warn("PreviewSupport#cleanUp is deprecated and will be removed in future versions. You do not need to manually clean up previews anymore. cf. https://github.com/bpmn-io/diagram-js/pull/906")},c.prototype.getGfx=function(t){return this._elementRegistry.getGraphics(t)},c.prototype.addDragger=function(t,e,n,r="djs-dragger"){n=n||this.getGfx(t);var s=(0,i.o8)(n),a=n.getBoundingClientRect();return this._cloneMarkers((0,o.P)(s),r),(0,i.CF)(s,this._styles.cls(r,[],{x:a.top,y:a.left})),(0,i.BC)(e,s),(0,i.CF)(s,"data-preview-support-element-id",t.id),s},c.prototype.addFrame=function(t,e){var n=(0,i.vt)("rect",{class:"djs-resize-overlay",width:t.width,height:t.height,x:t.x,y:t.y});return(0,i.BC)(e,n),(0,i.CF)(n,"data-preview-support-element-id",t.id),n},c.prototype._cloneMarkers=function(t,e="djs-dragger",n=t){var o,s=this;t.childNodes&&t.childNodes.forEach(t=>{s._cloneMarkers(t,e,n)}),o=t,-1!==l.indexOf(o.nodeName)&&a.forEach(function(o){if((0,i.CF)(t,o)){var a=function(t,e,n){var o=(0,i.CF)(t,e).match(/url\(['"]?#([^'"]*)['"]?\)/)[1];return(0,r.P)("marker#"+o,n||document)}(t,o,s._canvas.getContainer());a&&s._cloneMarker(n,t,a,o,e)}})},c.prototype._cloneMarker=function(t,e,n,o,a="djs-dragger"){var l=[n.id,a,s.next()].join("-"),c=(0,r.P)("marker#"+n.id,t);t=t||this._canvas._svg;var h=c||(0,i.o8)(n);h.id=l,(0,i.Ly)(h).add(a);var u=(0,r.P)(":scope > defs",t);u||(u=(0,i.vt)("defs"),(0,i.BC)(t,u)),(0,i.BC)(u,h);var d="url(#"+h.id+")";(0,i.CF)(e,o,d)};const h={__init__:["previewSupport"],previewSupport:["type",c]}},78303(t,e,n){"use strict";n.d(e,{A:()=>a});var i=n(57094),r=Math.round;function o(t,e){this._modeling=t,this._eventBus=e}function s(t,e){e.on("replace.end",500,function(e){const{newElement:n,hints:i={}}=e;!1!==i.select&&t.select(n)})}o.$inject=["modeling","eventBus"],o.prototype.replaceElement=function(t,e,n){if(t.waypoints)return null;var o=this._modeling,s=this._eventBus;s.fire("replace.start",{element:t,attrs:e,hints:n});var a=e.width||t.width,l=e.height||t.height,c=e.x||t.x,h=e.y||t.y,u=r(c+a/2),d=r(h+l/2),p=o.replaceShape(t,(0,i.assign)({},e,{x:u,y:d,width:a,height:l}),n);return s.fire("replace.end",{element:t,newElement:p,hints:n}),p},s.$inject=["selection","eventBus"];const a={__init__:["replace","replaceSelectionBehavior"],replaceSelectionBehavior:["type",s],replace:["type",o]}},60593(t,e,n){"use strict";n.d(e,{Cw:()=>p,Dp:()=>d,Ih:()=>c,Sc:()=>l,rF:()=>h,uR:()=>m});var i=n(57094),r=n(91970),o=n(67319),s=Math.max,a=Math.min;function l(t,e){return{top:t.top-e.top,right:t.right-e.right,bottom:t.bottom-e.bottom,left:t.left-e.left}}function c(t,e,n){var i=n.x,r=n.y,o={x:t.x,y:t.y,width:t.width,height:t.height};return-1!==e.indexOf("n")?(o.y=t.y+r,o.height=t.height-r):-1!==e.indexOf("s")&&(o.height=t.height+r),-1!==e.indexOf("e")?o.width=t.width+i:-1!==e.indexOf("w")&&(o.x=t.x+i,o.width=t.width-i),o}function h(t,e){return{x:t.x+(e.left||0),y:t.y+(e.top||0),width:t.width-(e.left||0)+(e.right||0),height:t.height-(e.top||0)+(e.bottom||0)}}function u(t,e,n){var r=e[t],o=n.min&&n.min[t],l=n.max&&n.max[t];return(0,i.isNumber)(o)&&(r=(/top|left/.test(t)?a:s)(r,o)),(0,i.isNumber)(l)&&(r=(/top|left/.test(t)?s:a)(r,l)),r}function d(t,e){if(!e)return t;var n=(0,o.Fy)(t);return(0,o.cD)({top:u("top",n,e),right:u("right",n,e),bottom:u("bottom",n,e),left:u("left",n,e)})}function p(t,e,n,i){var r=(0,o.Fy)(e),l={top:/n/.test(t)?r.bottom-n.height:r.top,left:/w/.test(t)?r.right-n.width:r.left,bottom:/s/.test(t)?r.top+n.height:r.bottom,right:/e/.test(t)?r.left+n.width:r.right},c=i?(0,o.Fy)(i):l,h={top:a(l.top,c.top),left:a(l.left,c.left),bottom:s(l.bottom,c.bottom),right:s(l.right,c.right)};return(0,o.cD)(h)}function f(t,e){return void 0!==t?t:20}function g(t){return!t.waypoints&&"label"!==t.type}function m(t,e){var n;if((n=void 0===t.length?(0,i.filter)(t.children,g):t).length)return function(t,e){var n,i,r,o;return"object"==typeof e?(n=f(e.left),i=f(e.right),r=f(e.top),o=f(e.bottom)):n=i=r=o=f(e),{x:t.x-n,y:t.y-r,width:t.width+n+i,height:t.height+r+o}}((0,r.U7)(n),e)}},60188(t,e,n){"use strict";n.d(e,{A:()=>O});var i=n(81734),r=n(43513),o=n(30601),s=n(57094),a=n(60593),l=n(67319);function c(t,e,n,i){this._dragging=i,this._rules=e;var r=this;t.on("resize.start",function(t){var e,n,i;n=(e=t.context).resizeConstraints,i=e.minBounds,void 0===n&&(void 0===i&&(i=r.computeMinResizeBox(e)),e.resizeConstraints={min:(0,l.Fy)(i)})}),t.on("resize.move",function(t){var e={x:t.dx,y:t.dy};!function(t,e){var n,i=t.shape,o=t.direction,s=t.resizeConstraints;t.delta=e,n=(0,a.Ih)(i,o,e),t.newBounds=(0,a.Dp)(n,s),t.canExecute=r.canResize(t)}(t.context,e)}),t.on("resize.end",function(t){!function(t){var e=t.shape,i=t.canExecute,r=t.newBounds;if(i){if(!function(t,e){return t.x!==e.x||t.y!==e.y||t.width!==e.width||t.height!==e.height}(e,r=(0,l.Au)(r)))return;n.resizeShape(e,r)}}(t.context)})}function h(t,e){var n=(0,l.pp)(t),i=(0,l.Fy)(t),r={x:n.x,y:n.y};return-1!==e.indexOf("n")?r.y=i.top:-1!==e.indexOf("s")&&(r.y=i.bottom),-1!==e.indexOf("e")?r.x=i.right:-1!==e.indexOf("w")&&(r.x=i.left),r}function u(t){var e="resize-";return"n"===t||"s"===t?e+"ns":"e"===t||"w"===t?e+"ew":"nw"===t||"se"===t?e+"nwse":e+"nesw"}c.prototype.canResize=function(t){var e=this._rules,n=(0,s.pick)(t,["newBounds","shape","delta","direction"]);return e.allowed("shape.resize",n)},c.prototype.activate=function(t,e,n){var i,r,o=this._dragging;if("string"==typeof n&&(n={direction:n}),!(r=(i=(0,s.assign)({shape:e},n)).direction))throw new Error("must provide a direction (n|w|s|e|nw|se|ne|sw)");o.init(t,h(e,r),"resize",{autoActivate:!0,cursor:u(r),data:{shape:e,context:i}})},c.prototype.computeMinResizeBox=function(t){var e,n,i=t.shape,r=t.direction;return e=t.minDimensions||{width:10,height:10},n=(0,a.uR)(i,t.childrenBoxPadding),(0,a.Cw)(r,i,e,n)},c.$inject=["eventBus","rules","modeling","dragging"];var d=n(27828),p="djs-resizing",f="resize-not-ok";function g(t,e,n){t.on("resize.move",500,function(t){var i,r,o,s;r=(i=t.context).shape,o=i.newBounds,(s=i.frame)||(s=i.frame=n.addFrame(r,e.getActiveLayer()),e.addMarker(r,p)),o.width>5&&(0,d.CF)(s,{x:o.x,width:o.width}),o.height>5&&(0,d.CF)(s,{y:o.y,height:o.height}),i.canExecute?(0,d.Ly)(s).remove(f):(0,d.Ly)(s).add(f)}),t.on("resize.cleanup",function(t){var n,i;i=(n=t.context).shape,n.frame&&(0,d.TF)(n.frame),e.removeMarker(i,p)})}g.$inject=["eventBus","canvas","previewSupport"];var m=n(81340),v=n(72120),y=n(46757),b=n(64242),x="djs-resizer",w=["n","w","s","e","nw","ne","se","sw"];function _(t,e,n,i){this._resize=i,this._canvas=e;var r=this;t.on("selection.changed",function(t){var e=t.newSelection;r.removeResizers(),1===e.length&&(0,s.forEach)(e,(0,s.bind)(r.addResizer,r))}),t.on("shape.changed",function(t){var e=t.element;n.isSelected(e)&&(r.removeResizers(),r.addResizer(e))})}_.prototype.makeDraggable=function(t,e,n){var i=this._resize;function r(e){(0,v.ls)(e)&&i.activate(e,t,n)}m.f0.bind(e,"mousedown",r),m.f0.bind(e,"touchstart",r)},_.prototype._createResizer=function(t,e,n,i){var r=this._getResizersParent(),o=function(t){var e={x:0,y:0};return-1!==t.indexOf("e")?e.x=6:-1!==t.indexOf("w")&&(e.x=-6),-1!==t.indexOf("s")?e.y=6:-1!==t.indexOf("n")&&(e.y=-6),e}(i),s=(0,d.vt)("g");(0,d.Ly)(s).add(x),(0,d.Ly)(s).add(x+"-"+t.id),(0,d.Ly)(s).add(x+"-"+i),(0,d.BC)(r,s);var a=(0,d.vt)("rect");(0,d.CF)(a,{x:-4+o.x,y:-4+o.y,width:8,height:8}),(0,d.Ly)(a).add(x+"-visual"),(0,d.BC)(s,a);var l=(0,d.vt)("rect");return(0,d.CF)(l,{x:-10+o.x,y:-10+o.y,width:20,height:20}),(0,d.Ly)(l).add(x+"-hit"),(0,d.BC)(s,l),(0,y.pd)(s,e,n),s},_.prototype.createResizer=function(t,e){var n=h(t,e),i=this._createResizer(t,n.x,n.y,e);this.makeDraggable(t,i,e)},_.prototype.addResizer=function(t){var e=this;!(0,b.fX)(t)&&this._resize.canResize({shape:t})&&(0,s.forEach)(w,function(n){e.createResizer(t,n)})},_.prototype.removeResizers=function(){var t=this._getResizersParent();(0,d.IU)(t)},_.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")},_.$inject=["eventBus","canvas","selection","resize"];const O={__depends__:[i.A,r.A,o.A],__init__:["resize","resizePreview","resizeHandles"],resize:["type",c],resizePreview:["type",g],resizeHandles:["type",_]}},24049(t,e,n){"use strict";n.d(e,{A:()=>o});var i=n(7475),r=n(98142);function o(t){r.A.call(this,t),this.init()}o.$inject=["eventBus"],(0,i.A)(o,r.A),o.prototype.addRule=function(t,e,n){var i=this;"string"==typeof t&&(t=[t]),t.forEach(function(t){i.canExecute(t,e,function(t,e,i){return n(t)},!0)})},o.prototype.init=function(){}},81734(t,e,n){"use strict";function i(t){this._commandStack=t.get("commandStack",!1)}n.d(e,{A:()=>r}),i.$inject=["injector"],i.prototype.allowed=function(t,e){var n=!0,i=this._commandStack;return i&&(n=i.canExecute(t,e)),void 0===n||n};const r={__init__:["rules"],rules:["type",i]}},35506(t,e,n){"use strict";n.d(e,{A:()=>p});var i=n(4912),r=n(86104),o=n(31323),s=n(81340),a=n(93083),l=n.n(a),c=n(75340),h=n(56287);function u(t,e,n,i){this._open=!1,this._results={},this._eventMaps=[],this._cachedRootElement=null,this._cachedSelection=null,this._cachedViewbox=null,this._canvas=t,this._eventBus=e,this._selection=n,this._translate=i,this._container=this._getBoxHtml(),this._searchInput=(0,s.P)(u.INPUT_SELECTOR,this._container),this._resultsContainer=(0,s.P)(u.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),e.on(["canvas.destroy","diagram.destroy","drag.init","elements.changed"],this.close,this)}function d(t,e,n){var i=function(t){var e="";return t.forEach(function(t){var n=(0,c.Z)(t.value||t.matched||t.normal),i=t.match||t.matched;e+=i?'<b class="'+u.RESULT_HIGHLIGHT_CLASS+'">'+n+"</b>":n}),""!==e?e:null}(e),r=l()(n);r.innerHTML=i,t.appendChild(r)}u.$inject=["canvas","eventBus","selection","translate"],u.prototype._bindEvents=function(){var t=this;function e(e,n,i,r){t._eventMaps.push({el:e,type:i,listener:s.Mm.bind(e,n,i,r)})}e(document,"html","click",function(e){t.close(!1)}),e(this._container,u.INPUT_SELECTOR,"click",function(t){t.stopPropagation(),t.delegateTarget.focus()}),e(this._container,u.RESULT_SELECTOR,"mouseover",function(e){e.stopPropagation(),t._scrollToNode(e.delegateTarget),t._preselect(e.delegateTarget)}),e(this._container,u.RESULT_SELECTOR,"click",function(e){e.stopPropagation(),t._select(e.delegateTarget)}),e(this._container,u.INPUT_SELECTOR,"keydown",function(t){(0,h.m0)("ArrowUp",t)&&t.preventDefault(),(0,h.m0)("ArrowDown",t)&&t.preventDefault()}),e(this._container,u.INPUT_SELECTOR,"keyup",function(e){if((0,h.m0)("Escape",e))return t.close();if((0,h.m0)("Enter",e)){var n=t._getCurrentResult();return n?t._select(n):t.close(!1)}return(0,h.m0)("ArrowUp",e)?t._scrollToDirection(!0):(0,h.m0)("ArrowDown",e)?t._scrollToDirection():void((0,h.m0)(["ArrowLeft","ArrowRight"],e)||t._search(e.delegateTarget.value))})},u.prototype._unbindEvents=function(){this._eventMaps.forEach(function(t){s.Mm.unbind(t.el,t.type,t.listener)})},u.prototype._search=function(t){var e=this;if(this._clearResults(),t.trim()){var n=this._searchProvider.find(t);if((n=n.filter(function(t){return!e._canvas.getRootElements().includes(t.element)})).length){n.forEach(function(t){var n=t.element.id,i=e._createResultNode(t,n);e._results[n]={element:t.element,node:i}});var i=(0,s.P)(u.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(i),this._preselect(i)}else this._selection.select(null)}},u.prototype._scrollToDirection=function(t){var e=this._getCurrentResult();if(e){var n=t?e.previousElementSibling:e.nextElementSibling;n&&(this._scrollToNode(n),this._preselect(n))}},u.prototype._scrollToNode=function(t){if(t&&t!==this._getCurrentResult()){var e=t.offsetTop,n=this._resultsContainer.scrollTop,i=e-this._resultsContainer.clientHeight+t.clientHeight;e<n?this._resultsContainer.scrollTop=e:n<i&&(this._resultsContainer.scrollTop=i)}},u.prototype._clearResults=function(){(0,s.IU)(this._resultsContainer),this._results={},this._eventBus.fire("searchPad.cleared")},u.prototype._getCurrentResult=function(){return(0,s.P)(u.RESULT_SELECTED_SELECTOR,this._resultsContainer)},u.prototype._createResultNode=function(t,e){var n=l()(u.RESULT_HTML);return t.primaryTokens.length>0&&d(n,t.primaryTokens,u.RESULT_PRIMARY_HTML),d(n,t.secondaryTokens,u.RESULT_SECONDARY_HTML),(0,s.CF)(n,u.RESULT_ID_ATTRIBUTE,e),this._resultsContainer.appendChild(n),n},u.prototype.registerProvider=function(t){this._searchProvider=t},u.prototype.open=function(){if(!this._searchProvider)throw new Error("no search provider registered");this.isOpen()||(this._cachedRootElement=this._canvas.getRootElement(),this._cachedSelection=this._selection.get(),this._cachedViewbox=this._canvas.viewbox(),this._selection.select(null),this._bindEvents(),this._open=!0,(0,s.Ly)(this._canvas.getContainer()).add("djs-search-open"),(0,s.Ly)(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))},u.prototype.close=function(t=!0){this.isOpen()&&(t&&(this._cachedRootElement&&this._canvas.setRootElement(this._cachedRootElement),this._cachedSelection&&this._selection.select(this._cachedSelection),this._cachedViewbox&&this._canvas.viewbox(this._cachedViewbox),this._eventBus.fire("searchPad.restored")),this._cachedRootElement=null,this._cachedSelection=null,this._cachedViewbox=null,this._unbindEvents(),this._open=!1,(0,s.Ly)(this._canvas.getContainer()).remove("djs-search-open"),(0,s.Ly)(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._eventBus.fire("searchPad.closed"),this._canvas.restoreFocus())},u.prototype.toggle=function(){this.isOpen()?this.close():this.open()},u.prototype.isOpen=function(){return this._open},u.prototype._preselect=function(t){var e=this._getCurrentResult();if(t!==e){e&&(0,s.Ly)(e).remove(u.RESULT_SELECTED_CLASS);var n=(0,s.CF)(t,u.RESULT_ID_ATTRIBUTE),i=this._results[n].element;(0,s.Ly)(t).add(u.RESULT_SELECTED_CLASS),this._canvas.scrollToElement(i,{top:300}),this._selection.select(i),this._eventBus.fire("searchPad.preselected",i)}},u.prototype._select=function(t){var e=(0,s.CF)(t,u.RESULT_ID_ATTRIBUTE),n=this._results[e].element;this._cachedSelection=null,this._cachedViewbox=null,this.close(!1),this._canvas.scrollToElement(n,{top:300}),this._selection.select(n),this._eventBus.fire("searchPad.selected",n)},u.prototype._getBoxHtml=function(){const t=l()(u.BOX_HTML),e=(0,s.P)(u.INPUT_SELECTOR,t);return e&&e.setAttribute("aria-label",this._translate("Search in diagram")),t},u.CONTAINER_SELECTOR=".djs-search-container",u.INPUT_SELECTOR=".djs-search-input input",u.RESULTS_CONTAINER_SELECTOR=".djs-search-results",u.RESULT_SELECTOR=".djs-search-result",u.RESULT_SELECTED_CLASS="djs-search-result-selected",u.RESULT_SELECTED_SELECTOR="."+u.RESULT_SELECTED_CLASS,u.RESULT_ID_ATTRIBUTE="data-result-id",u.RESULT_HIGHLIGHT_CLASS="djs-search-highlight",u.BOX_HTML='<div class="djs-search-container djs-scrollable">\n  <div class="djs-search-input">\n    <svg class="djs-search-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path fill-rule="evenodd" clip-rule="evenodd" d="M9.0325 8.5H9.625L13.3675 12.25L12.25 13.3675L8.5 9.625V9.0325L8.2975 8.8225C7.4425 9.5575 6.3325 10 5.125 10C2.4325 10 0.25 7.8175 0.25 5.125C0.25 2.4325 2.4325 0.25 5.125 0.25C7.8175 0.25 10 2.4325 10 5.125C10 6.3325 9.5575 7.4425 8.8225 8.2975L9.0325 8.5ZM1.75 5.125C1.75 6.9925 3.2575 8.5 5.125 8.5C6.9925 8.5 8.5 6.9925 8.5 5.125C8.5 3.2575 6.9925 1.75 5.125 1.75C3.2575 1.75 1.75 3.2575 1.75 5.125Z" fill="#22242A"/>\n    </svg>\n    <input type="text" spellcheck="false" />\n  </div>\n  <div class="djs-search-results" />\n</div>',u.RESULT_HTML='<div class="djs-search-result"></div>',u.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>',u.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>';const p={__depends__:[o.A,i.A,r.A],searchPad:["type",u]}},98294(t,e,n){"use strict";n.d(e,{A:()=>u});var i=n(57094);function r(t,e){return o(e)-o(t)}function o(t){return t.reduce((t,e)=>t+s(e),0)}function s(t){if((0,i.isArray)(t))return Math.max(...t.map(s));const e=Math.log(t.value.length);return t.match?(t.start?t.end?131.9:7.87:t.wordStart?2.19:1)*e:-.07*e}function a(t=""){return(0,i.isArray)(t)?t.join(", "):t}function l(t,e){return a(t).localeCompare(a(e))}function c(t,e){if(!t)return{tokens:[],matchedWords:{}};const n=[],i={},r=e.map(h),o=[`(?<all>${r.join("\\s+")})`,...r].join("|"),s=new RegExp(o,"ig");let a,l=0;for(;a=s.exec(t);){const[r]=a,o=a.index,s=a.index+r.length,c=0===o,h=s===t.length,u=!!a.groups.all,d=c||/\s/.test(t.charAt(o-1)),p=h||/\s/.test(t.charAt(s));a.index>l&&n.push({value:t.slice(l,a.index),index:l}),n.push({value:r,index:a.index,match:!0,wordStart:d,wordEnd:p,start:c,end:h,all:u});const f=u?e:[r];for(const t of f)i[t.toLowerCase()]=!0;l=a.index+r.length}return l<t.length&&n.push({value:t.slice(l),index:l}),{tokens:n,matchedWords:i}}function h(t){return t.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&")}const u={search:["value",function(t,e,n){const{keys:o}=n;if(!(e=e.trim().toLowerCase()))throw new Error("<pattern> must not be empty");const s=e.trim().toLowerCase().split(/\s+/);return t.flatMap(t=>{const e=function(t,e,n){const{matchedWords:r,tokens:o}=n.reduce((n,r)=>{const o=t[r],{tokens:s,matchedWords:a}=(0,i.isArray)(o)?o.reduce((t,n)=>{const{tokens:i,matchedWords:r}=c(n,e);return{tokens:[...t.tokens,i],matchedWords:{...t.matchedWords,...r}}},{matchedWords:{},tokens:[]}):c(o,e);return{tokens:{...n.tokens,[r]:s},matchedWords:{...n.matchedWords,...a}}},{matchedWords:{},tokens:{}});return Object.keys(r).length!==e.length?null:o}(t,s,o);return e?{item:t,tokens:e}:[]}).sort(function(t){return(e,n)=>{let i=0,o=1;for(const s of t){const t=r(e.tokens[s],n.tokens[s]);if(0!==t){i+=t*o,o*=.9;continue}const a=l(e.item[s],n.item[s]);0===a||(i+=a*o,o*=.9)}return i}}(o))}]}},86104(t,e,n){"use strict";n.d(e,{A:()=>d});var i=n(88641),r=n(57094);function o(t,e){this._eventBus=t,this._canvas=e,this._selectedElements=[];var n=this;t.on(["shape.remove","connection.remove"],function(t){var e=t.element;n.deselect(e)}),t.on(["diagram.clear","root.set"],function(t){n.select(null)})}o.$inject=["eventBus","canvas"],o.prototype.deselect=function(t){var e=this._selectedElements,n=e.indexOf(t);if(-1!==n){var i=e.slice();e.splice(n,1),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:e})}},o.prototype.get=function(){return this._selectedElements},o.prototype.isSelected=function(t){return-1!==this._selectedElements.indexOf(t)},o.prototype.select=function(t,e){var n=this._selectedElements,i=n.slice();(0,r.isArray)(t)||(t=t?[t]:[]);var o=this._canvas,s=o.getRootElement();t=t.filter(function(t){var e=o.findRoot(t);return s===e}),e?(0,r.forEach)(t,function(t){-1===n.indexOf(t)&&n.push(t)}):this._selectedElements=n=t.slice(),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:n})};var s="hover",a="selected";function l(t,e){function n(e,n){t.addMarker(e,n)}function i(e,n){t.removeMarker(e,n)}this._canvas=t,e.on("element.hover",function(t){n(t.element,s)}),e.on("element.out",function(t){i(t.element,s)}),e.on("selection.changed",function(t){var e=t.oldSelection,o=t.newSelection;(0,r.forEach)(e,function(t){-1===o.indexOf(t)&&i(t,a)}),(0,r.forEach)(o,function(t){-1===e.indexOf(t)&&n(t,a)})})}l.$inject=["canvas","eventBus"];var c=n(72120);function h(t,e,n,i){t.on("create.end",500,function(t){var n=t.context,i=n.canExecute,o=n.elements,s=(n.hints||{}).autoSelect;if(i){if(!1===s)return;(0,r.isArray)(s)?e.select(s):e.select(o.filter(u))}}),t.on("connect.end",500,function(t){var n=t.context.connection;n&&e.select(n)}),t.on("shape.move.end",500,function(t){var n=t.previousSelection||[],o=i.get(t.context.shape.id);(0,r.find)(n,function(t){return o.id===t.id})||e.select(o)}),t.on("element.click",function(t){if((0,c.ls)(t)){var i=t.element;i===n.getRootElement()&&(i=null);var r=e.isSelected(i),o=e.get().length>1,s=(0,c.KH)(t);if(r&&o)return s?e.deselect(i):e.select(i);r?e.deselect(i):e.select(i,s)}})}function u(t){return!t.hidden}h.$inject=["eventBus","selection","canvas","elementRegistry"];const d={__init__:["selectionVisuals","selectionBehavior"],__depends__:[i.A],selection:["type",o],selectionVisuals:["type",l],selectionBehavior:["type",h]}},39680(t,e,n){"use strict";n.d(e,{A:()=>l});var i=n(59046),r=n(67633),o=n(56287),s=n(57094),a=n(64242);function l(t,e,n){var i=this;this._elementRegistry=t,e.on(["create.start","shape.move.start"],function(t){i.initSnap(t)}),e.on(["create.move","create.end","shape.move.move","shape.move.end"],1250,function(t){var e=t.context,s=e.shape,a=e.snapContext,l=e.target;if((!t.originalEvent||!(0,o.nM)(t.originalEvent))&&!(0,r.AC)(t)&&l){var c=a.pointsForTarget(l);c.initialized||((c=i.addSnapTargetPoints(c,s,l)).initialized=!0),n.snap(t,c)}}),e.on(["create.cleanup","shape.move.cleanup"],function(){n.hide()})}l.$inject=["elementRegistry","eventBus","snapping"],l.prototype.initSnap=function(t){var e,n=this._elementRegistry,o=t.context,s=o.shape,l=o.snapContext;l||(l=o.snapContext=new i.A);var c=(e=n.get(s.id)?(0,r.jz)(s,t):{x:t.x+(0,r.jz)(s).x,y:t.y+(0,r.jz)(s).y}).x-s.width/2,h=e.y-s.height/2,u=e.x+s.width/2,d=e.y+s.height/2;return l.setSnapOrigin("mid",{x:e.x-t.x,y:e.y-t.y}),(0,a.J2)(s)||(l.setSnapOrigin("top-left",{x:c-t.x,y:h-t.y}),l.setSnapOrigin("bottom-right",{x:u-t.x,y:d-t.y})),l},l.prototype.addSnapTargetPoints=function(t,e,n){var i=this.getSnapTargets(e,n);return(0,s.forEach)(i,function(n){if((0,a.J2)(n))(0,a.J2)(e)&&t.add("mid",(0,r.jz)(n));else if((0,a.fX)(n)){if(n.waypoints.length<3)return;var i=n.waypoints.slice(1,-1);(0,s.forEach)(i,function(e){t.add("mid",e)})}else t.add("mid",(0,r.jz)(n))}),(0,s.isNumber)(e.x)&&(0,s.isNumber)(e.y)?(this._elementRegistry.get(e.id)&&t.add("mid",(0,r.jz)(e)),t):t},l.prototype.getSnapTargets=function(t,e){return(0,r.i0)(e).filter(function(t){return!t.hidden})}},59046(t,e,n){"use strict";n.d(e,{A:()=>o});var i=n(57094),r=n(67633);function o(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}function s(){this._snapValues={}}o.prototype.getSnapOrigin=function(t){return this._snapOrigins[t]},o.prototype.setSnapOrigin=function(t,e){this._snapOrigins[t]=e,-1===this._snapLocations.indexOf(t)&&this._snapLocations.push(t)},o.prototype.addDefaultSnap=function(t,e){var n=this._defaultSnaps[t];n||(n=this._defaultSnaps[t]=[]),n.push(e)},o.prototype.getSnapLocations=function(){return this._snapLocations},o.prototype.setSnapLocations=function(t){this._snapLocations=t},o.prototype.pointsForTarget=function(t){var e=t.id||t,n=this._targets[e];return n||(n=this._targets[e]=new s).initDefaults(this._defaultSnaps),n},s.prototype.add=function(t,e){var n=this._snapValues[t];n||(n=this._snapValues[t]={x:[],y:[]}),-1===n.x.indexOf(e.x)&&n.x.push(e.x),-1===n.y.indexOf(e.y)&&n.y.push(e.y)},s.prototype.snap=function(t,e,n,i){var o=this._snapValues[e];return o&&(0,r._)(t[n],o[n],i)},s.prototype.initDefaults=function(t){var e=this;(0,i.forEach)(t||{},function(t,n){(0,i.forEach)(t,function(t){e.add(n,t)})})}},67633(t,e,n){"use strict";n.d(e,{AC:()=>c,CU:()=>h,_:()=>o,i0:()=>u,jz:()=>l,lA:()=>s,oF:()=>a});var i=Math.abs,r=Math.round;function o(t,e,n){var r,o;for(n=void 0===n?10:n,r=0;r<e.length;r++)if(o=e[r],i(o-t)<=n)return o}function s(t){return{x:t.x,y:t.y}}function a(t){return{x:t.x+t.width,y:t.y+t.height}}function l(t,e){return!t||isNaN(t.x)||isNaN(t.y)?e:{x:r(t.x+t.width/2),y:r(t.y+t.height/2)}}function c(t,e){var n=t.snapped;return!!n&&("string"==typeof e?n[e]:n.x&&n.y)}function h(t,e,n){if("string"!=typeof e)throw new Error("axis must be in [x, y]");if("number"!=typeof n&&!1!==n)throw new Error("value must be Number or false");var i,r=t[e],o=t.snapped=t.snapped||{};return!1===n?o[e]=!1:(o[e]=!0,i=n-r,t[e]+=i,t["d"+e]+=i),r}function u(t){return t.children||[]}},56875(t,e,n){"use strict";n.d(e,{A:()=>f});var i=n(39680),r=n(59046),o=n(67633),s=n(56287),a=n(67319),l=n(57094),c=n(64242);function h(t,e){var n=this;t.on(["resize.start"],function(t){n.initSnap(t)}),t.on(["resize.move","resize.end"],1250,function(t){var i=t.context,r=i.shape,a=r.parent,l=i.direction,c=i.snapContext;if(!(t.originalEvent&&(0,s.nM)(t.originalEvent)||(0,o.AC)(t))){var h=c.pointsForTarget(a);h.initialized||((h=n.addSnapTargetPoints(h,r,a,l)).initialized=!0),function(t){return"n"===t||"s"===t}(l)&&(0,o.CU)(t,"x",t.x),function(t){return"e"===t||"w"===t}(l)&&(0,o.CU)(t,"y",t.y),e.snap(t,h)}}),t.on(["resize.cleanup"],function(){e.hide()})}function u(t,e){var n=(0,a.pp)(t),i=(0,a.Fy)(t),r={x:n.x,y:n.y};return-1!==e.indexOf("n")?r.y=i.top:-1!==e.indexOf("s")&&(r.y=i.bottom),-1!==e.indexOf("e")?r.x=i.right:-1!==e.indexOf("w")&&(r.x=i.left),r}h.prototype.initSnap=function(t){var e=t.context,n=e.shape,i=e.direction,o=e.snapContext;o||(o=e.snapContext=new r.A);var s=u(n,i);return o.setSnapOrigin("corner",{x:s.x-t.x,y:s.y-t.y}),o},h.prototype.addSnapTargetPoints=function(t,e,n,i){var r=this.getSnapTargets(e,n);return(0,l.forEach)(r,function(e){t.add("corner",(0,o.oF)(e)),t.add("corner",(0,o.lA)(e))}),t.add("corner",u(e,i)),t},h.$inject=["eventBus","snapping"],h.prototype.getSnapTargets=function(t,e){return(0,o.i0)(e).filter(function(e){return n=t,!(e.host===n||(0,c.fX)(e)||function(t){return!!t.hidden}(e)||(0,c.J2)(e));var n})};var d=n(27828);function p(t){this._canvas=t,this._asyncHide=(0,l.debounce)((0,l.bind)(this.hide,this),1e3)}p.$inject=["canvas"],p.prototype.snap=function(t,e){var n=t.context.snapContext,i=n.getSnapLocations(),r={x:(0,o.AC)(t,"x"),y:(0,o.AC)(t,"y")};(0,l.forEach)(i,function(i){var o=n.getSnapOrigin(i),s={x:t.x+o.x,y:t.y+o.y};if((0,l.forEach)(["x","y"],function(t){var n;r[t]||void 0!==(n=e.snap(s,i,t,7))&&(r[t]={value:n,originValue:n-o[t]})}),r.x&&r.y)return!1}),this.showSnapLine("vertical",r.x&&r.x.value),this.showSnapLine("horizontal",r.y&&r.y.value),(0,l.forEach)(["x","y"],function(e){var n=r[e];(0,l.isObject)(n)&&(0,o.CU)(t,e,n.originValue)})},p.prototype._createLine=function(t){var e=this._canvas.getLayer("snap"),n=(0,d.vt)("path");return(0,d.CF)(n,{d:"M0,0 L0,0"}),(0,d.Ly)(n).add("djs-snap-line"),(0,d.BC)(e,n),{update:function(e){(0,l.isNumber)(e)?"horizontal"===t?(0,d.CF)(n,{d:"M-100000,"+e+" L+100000,"+e,display:""}):(0,d.CF)(n,{d:"M "+e+",-100000 L "+e+", +100000",display:""}):(0,d.CF)(n,{display:"none"})}}},p.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}},p.prototype.showSnapLine=function(t,e){var n=this.getSnapLine(t);n&&n.update(e),this._asyncHide()},p.prototype.getSnapLine=function(t){return this._snapLines||this._createSnapLines(),this._snapLines[t]},p.prototype.hide=function(){(0,l.forEach)(this._snapLines,function(t){t.update()})};const f={__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",i.A],resizeSnapping:["type",h],snapping:["type",p]}},27224(t,e,n){"use strict";n.d(e,{Gq:()=>o,Ih:()=>a,u6:()=>r});var i=n(57094);function r(t,e){if("x"===t){if(e>0)return"e";if(e<0)return"w"}if("y"===t){if(e>0)return"s";if(e<0)return"n"}return null}function o(t,e){var n=[];return(0,i.forEach)(t.concat(e),function(r){var o=r.incoming,a=r.outgoing;(0,i.forEach)(o.concat(a),function(i){var r=i.source,o=i.target;(s(t,r)||s(t,o)||s(e,r)||s(e,o))&&(s(n,i)||n.push(i))})}),n}function s(t,e){return-1!==t.indexOf(e)}function a(t,e,n){var i=t.x,r=t.y,o=t.width,s=t.height,a=n.x,l=n.y;switch(e){case"n":return{x:i,y:r+l,width:o,height:s-l};case"s":return{x:i,y:r,width:o,height:s+l};case"w":return{x:i+a,y:r,width:o-a,height:s};case"e":return{x:i,y:r,width:o+a,height:s};default:throw new Error("unknown direction: "+e)}}},44391(t,e,n){"use strict";n.d(e,{A:()=>a});var i=n(43513),r=n(57094),o=n(81340);function s(t){this._eventBus=t,this._tools=[],this._active=null}s.$inject=["eventBus"],s.prototype.registerTool=function(t,e){var n=this._tools;if(!e)throw new Error('A tool has to be registered with it\'s "events"');n.push(t),this.bindEvents(t,e)},s.prototype.isActive=function(t){return t&&this._active===t},s.prototype.length=function(t){return this._tools.length},s.prototype.setActive=function(t){var e=this._eventBus;this._active!==t&&(this._active=t,e.fire("tool-manager.update",{tool:t}))},s.prototype.bindEvents=function(t,e){var n=this._eventBus,i=[];n.on(e.tool+".init",function(e){e.context.reactivate||!this.isActive(t)?this.setActive(t):this.setActive(null)},this),(0,r.forEach)(e,function(t){i.push(t+".ended"),i.push(t+".canceled")}),n.on(i,250,function(t){this._active&&(function(t){var e=t.originalEvent&&t.originalEvent.target;return e&&(0,o.kp)(e,'.group[data-group="tools"]')}(t)||this.setActive(null))},this)};const a={__depends__:[i.A],__init__:["toolManager"],toolManager:["type",s]}},57905(t,e,n){"use strict";n.d(e,{A:()=>r});var i=n(67319);function r(){}r.prototype.layoutConnection=function(t,e){return[(e=e||{}).connectionStart||(0,i.pp)(e.source||t.source),e.connectionEnd||(0,i.pp)(e.target||t.target)]}},10270(t,e,n){"use strict";n.d(e,{A:()=>s});var i=n(57094),r=n(67319);function o(t){return(0,i.assign)({original:t.point.original||t.point},t.actual)}function s(t,e){this._elementRegistry=t,this._graphicsFactory=e}s.$inject=["elementRegistry","graphicsFactory"],s.prototype.getCroppedWaypoints=function(t,e,n){e=e||t.source,n=n||t.target;var i=this.getDockingPoint(t,e,!0),r=this.getDockingPoint(t,n),s=t.waypoints.slice(i.idx+1,r.idx);return s.unshift(o(i)),s.push(o(r)),s},s.prototype.getDockingPoint=function(t,e,n){var i,r,o=t.waypoints;return{point:r=o[i=n?0:o.length-1],actual:this._getIntersection(e,t,n)||r,idx:i}},s.prototype._getIntersection=function(t,e,n){var i=this._getShapePath(t),o=this._getConnectionPath(e);return(0,r.ki)(i,o,n)},s.prototype._getConnectionPath=function(t){return this._graphicsFactory.getConnectionPath(t)},s.prototype._getShapePath=function(t){return this._graphicsFactory.getShapePath(t)},s.prototype._getGfx=function(t){return this._elementRegistry.getGraphics(t)}},67319(t,e,n){"use strict";n.d(e,{Au:()=>a,Fy:()=>c,PG:()=>l,Wy:()=>f,cD:()=>h,ki:()=>p,pp:()=>u,vc:()=>d});var i=n(57094),r=n(71711),o=n(33732),s=n(64242);function a(t){return{x:Math.round(t.x),y:Math.round(t.y),width:Math.round(t.width),height:Math.round(t.height)}}function l(t){return{x:Math.round(t.x),y:Math.round(t.y)}}function c(t){return{top:t.y,right:t.x+(t.width||0),bottom:t.y+(t.height||0),left:t.x}}function h(t){return{x:t.left,y:t.top,width:t.right-t.left,height:t.bottom-t.top}}function u(t){return(0,s.fX)(t)?function(t){for(var e=t.waypoints,n=e.reduce(function(t,n,i){var r,o,s=e[i-1];if(s){var a=t[t.length-1],l=a&&a.endLength||0,c=(r=s,o=n,Math.sqrt(Math.pow(r.x-o.x,2)+Math.pow(r.y-o.y,2)));t.push({start:s,end:n,startLength:l,endLength:l+c,length:c})}return t},[]),i=n.reduce(function(t,e){return t+e.length},0)/2,r=0,o=n[r];o.endLength<i;)o=n[++r];var s=(i-o.startLength)/o.length;return{x:o.start.x+(o.end.x-o.start.x)*s,y:o.start.y+(o.end.y-o.start.y)*s}}(t):l({x:(e=t).x+(e.width||0)/2,y:e.y+(e.height||0)/2});var e}function d(t,e,n){n=n||0,(0,i.isObject)(n)||(n={x:n,y:n});var r=c(t),o=c(e),s=r.bottom+n.y<=o.top,a=r.left-n.x>=o.right,l=r.top-n.y>=o.bottom,h=s?"top":l?"bottom":null,u=r.right+n.x<=o.left?"left":a?"right":null;return u&&h?h+"-"+u:u||h||"intersect"}function p(t,e,n){var s,a,c=(s=t,a=e,(0,o.A)(s,a));return 1===c.length||2===c.length&&(0,r.cK)(c[0],c[1])<1?l(c[0]):c.length>1?l((c=(0,i.sortBy)(c,function(t){var e=Math.floor(100*t.t2)||1;return e=((e=100-e)<10?"0":"")+e,t.segment2+"#"+e}))[n?0:c.length-1]):null}function f(t){t=t.slice();for(var e,n,i,o=0;t[o];)e=t[o],n=t[o-1],i=t[o+1],0===(0,r.cK)(e,i)||(0,r.XP)(n,i,e)?t.splice(o,1):o++;return t}},56373(t,e,n){"use strict";n.d(e,{A:()=>a});var i=n(76137),r=n(57094),o={moveSpeed:50,moveSpeedAccelerated:200};function s(t,e,n){var i=this;this._config=(0,r.assign)({},o,t||{}),e.addListener(function(t){var n=t.keyEvent,r=i._config;if(e.isCmd(n)&&e.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],n)){var o,s=e.isShift(n)?r.moveSpeedAccelerated:r.moveSpeed;switch(n.key){case"ArrowLeft":case"Left":o="left";break;case"ArrowUp":case"Up":o="up";break;case"ArrowRight":case"Right":o="right";break;case"ArrowDown":case"Down":o="down"}return i.moveCanvas({speed:s,direction:o}),!0}}),this.moveCanvas=function(t){var e=0,i=0,r=t.speed/Math.min(Math.sqrt(n.viewbox().scale),1);switch(t.direction){case"left":e=r;break;case"up":i=r;break;case"right":e=-r;break;case"down":i=-r}n.scroll({dx:e,dy:i})}}s.$inject=["config.keyboardMove","keyboard","canvas"];const a={__depends__:[i.A],__init__:["keyboardMove"],keyboardMove:["type",s]}},84361(t,e,n){"use strict";n.d(e,{A:()=>c});var i=n(25141),r=n(48872),o=n(79356),s=n(81340),a=n(51303);function l(t,e){var n;function l(t){return function(t){if(!(0,s.kp)(t.target,".djs-draggable")){var e=t.button;if(!(e>=2||t.ctrlKey||t.shiftKey||t.altKey))return n={button:e,start:(0,a.gK)(t)},s.f0.bind(document,"mousemove",c),s.f0.bind(document,"mouseup",h),!0}}(t.originalEvent)}function c(s){var l,c=n.start,h=n.button,u=(0,a.gK)(s),d=(0,o.p)(u,c);if(!n.dragging&&(l=d,Math.sqrt(Math.pow(l.x,2)+Math.pow(l.y,2))>15)&&(n.dragging=!0,0===h&&(0,r.a)(t),(0,i.hZ)("grab")),n.dragging){var p=n.last||n.start;d=(0,o.p)(u,p),e.scroll({dx:d.x,dy:d.y}),n.last=u}s.preventDefault()}function h(t){s.f0.unbind(document,"mousemove",c),s.f0.unbind(document,"mouseup",h),n=null,(0,i.wC)()}t.on("canvas.focus.changed",function(e){e.focused?t.on("element.mousedown",500,l):t.off("element.mousedown",l)}),this.isActive=function(){return!!n}}l.$inject=["eventBus","canvas"];const c={__init__:["moveCanvas"],moveCanvas:["type",l]}},3834(t,e,n){"use strict";n.d(e,{A:()=>u});var i=n(81340);function r(t){return Math.log(t)/Math.log(10)}function o(t,e){var n=r(t.min),i=r(t.max);return(Math.abs(n)+Math.abs(i))/e}var s=n(13128),a=n(57094),l=Math.sign||function(t){return t>=0?1:-1},c={min:.2,max:4};function h(t,e,n){t=t||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=(0,a.bind)(this._handleWheel,this),this._totalDelta=0,this._scale=t.scale||.75;var i=this;e.on("canvas.mouseover",function(){i._init(!1!==t.enabled)}),e.on("canvas.mouseout",function(){i._init(!1)})}h.$inject=["config.zoomScroll","eventBus","canvas"],h.prototype.scroll=function(t){this._canvas.scroll(t)},h.prototype.reset=function(){this._canvas.zoom("fit-viewport")},h.prototype.zoom=function(t,e){var n=o(c,20);this._totalDelta+=t,Math.abs(this._totalDelta)>.1&&(this._zoom(t,e,n),this._totalDelta=0)},h.prototype._handleWheel=function(t){if(this._enabled){var e=this._container;t.preventDefault();var n,i=t.ctrlKey||(0,s.c)()&&t.metaKey,r=t.shiftKey,o=-1*this._scale;if(o*=i?0===t.deltaMode?.02:.32:0===t.deltaMode?1:16,i){var a=e.getBoundingClientRect(),c={x:t.clientX-a.left,y:t.clientY-a.top};n=Math.sqrt(Math.pow(t.deltaY,2)+Math.pow(t.deltaX,2))*l(t.deltaY)*o,this.zoom(n,c)}else n=r?{dx:o*t.deltaY,dy:0}:{dx:o*t.deltaX,dy:o*t.deltaY},this.scroll(n)}},h.prototype.stepZoom=function(t,e){var n=o(c,10);this._zoom(t,e,n)},h.prototype._zoom=function(t,e,n){var i=this._canvas,o=t>0?1:-1,s=r(i.zoom()),a=Math.round(s/n)*n;a+=n*o;var l,h,u=Math.pow(10,a);i.zoom((l=c,h=u,Math.max(l.min,Math.min(l.max,h))),e)},h.prototype.toggle=function(t){var e=this._container,n=this._handleWheel,r=this._enabled;return void 0===t&&(t=!r),r!==t&&i.f0[t?"bind":"unbind"](e,"wheel",n,!1),this._enabled=t,t},h.prototype._init=function(t){this.toggle(t)};const u={__init__:["zoomScroll"],zoomScroll:["type",h]}},84410(t,e,n){"use strict";n.d(e,{D:()=>s,_:()=>o});var i=n(67319),r=n(79356);function o(t,e,n){var o=(0,r.g)(e),s=(0,r.g)(n),a=(0,r.p)(t,o),l=a.x*(n.width/e.width),c=a.y*(n.height/e.height);return(0,i.PG)({x:s.x+l,y:s.y+c})}function s(t,e,n){var o=(0,r.g)(t),s=(0,r.g)(e),a=(0,r.g)(n),l=(0,r.p)(t,o),c=(0,r.p)(o,s),h=function(t,e,n){var r=(0,i.Fy)(e),o=(0,i.Fy)(n);if(function(t,e){return function(t,e){return t.right!==e.right&&t.left!==e.left}(t,e)||function(t,e){return t.top!==e.top&&t.bottom!==e.bottom}(t,e)}(r,o))return null;var s,a,l=(0,i.vc)(e,t);if("top"===l)s={x:0,y:o.bottom-r.bottom};else if("bottom"===l)s={x:0,y:o.top-r.top};else if("right"===l)s={x:o.left-r.left,y:0};else{if("left"!==l)return null;s={x:o.right-r.right,y:0}}return a={x:t.x+s.x,y:t.y+s.y},(0,i.vc)(n,a)!==l?null:s}(o,e,n);if(h)return h;var u=c.x*(n.width/e.width),d=c.y*(n.height/e.height),p=a.x+u,f=a.y+d;return(0,i.PG)({x:p+l.x-t.x,y:f+l.y-t.y})}},48872(t,e,n){"use strict";function i(t,e){function n(){return!1}return e=e||"element.click",t.once(e,5e3,n),function(){t.off(e,n)}}n.d(e,{a:()=>i})},25141(t,e,n){"use strict";n.d(e,{hZ:()=>o,wC:()=>s});var i=n(81340),r=/^djs-cursor-.*$/;function o(t){var e=(0,i.Ly)(document.body);e.removeMatching(r),t&&e.add("djs-cursor-"+t)}function s(){o(null)}},91970(t,e,n){"use strict";n.d(e,{Pw:()=>d,U7:()=>h,cZ:()=>l,eb:()=>p,qO:()=>a,rx:()=>u,wT:()=>r,yO:()=>c});var i=n(57094);function r(t){return(0,i.filter)(t,function(e){return!(0,i.find)(t,function(t){return t!==e&&o(e,t)})})}function o(t,e){if(e){if(t===e)return e;if(t.parent)return o(t.parent,e)}}function s(t,e,n){var i=!n||-1===t.indexOf(e);return i&&t.push(e),i}function a(t,e,n){n=n||0,(0,i.isArray)(t)||(t=[t]),(0,i.forEach)(t,function(t,r){var o=e(t,r,n);(0,i.isArray)(o)&&o.length&&a(o,e,n+1)})}function l(t,e){return function(t,e,n){var i=[],r=[];return a(t,function(t,o,a){s(i,t,e);var l=t.children;if((-1===n||a<n)&&l&&s(r,l,e))return l}),i}(t,!e,-1)}function c(t,e,n){(0,i.isUndefined)(e)&&(e=!0),(0,i.isObject)(e)&&(n=e,e=!0);var r=f((n=n||{}).allShapes),o=f(n.allConnections),s=f(n.enclosedElements),l=f(n.enclosedConnections),c=f(n.topLevel,e&&(0,i.groupBy)(t,function(t){return t.id}));function h(t){c[t.source.id]&&c[t.target.id]&&(c[t.id]=[t]),r[t.source.id]&&r[t.target.id]&&(l[t.id]=s[t.id]=t),o[t.id]=t}return a(t,function(t){if(s[t.id]=t,!t.waypoints)return r[t.id]=t,(0,i.forEach)(t.incoming,h),(0,i.forEach)(t.outgoing,h),t.children;l[t.id]=o[t.id]=t}),{allShapes:r,allConnections:o,topLevel:c,enclosedConnections:l,enclosedElements:s}}function h(t,e){var n,r,o,s;return e=!!e,(0,i.isArray)(t)||(t=[t]),(0,i.forEach)(t,function(t){var i=t;t.waypoints&&!e&&(i=h(t.waypoints,!0));var a=i.x,l=i.y,c=i.height||0,u=i.width||0;(a<n||void 0===n)&&(n=a),(l<r||void 0===r)&&(r=l),(a+u>o||void 0===o)&&(o=a+u),(l+c>s||void 0===s)&&(s=l+c)}),{x:n,y:r,height:s-r,width:o-n}}function u(t,e){var n={};return(0,i.forEach)(t,function(t){var r=t;r.waypoints&&(r=h(r)),!(0,i.isNumber)(e.y)&&r.x>e.x&&(n[t.id]=t),!(0,i.isNumber)(e.x)&&r.y>e.y&&(n[t.id]=t),r.x>e.x&&r.y>e.y&&((0,i.isNumber)(e.width)&&(0,i.isNumber)(e.height)&&r.width+r.x<e.width+e.x&&r.height+r.y<e.height+e.y?n[t.id]=t:(0,i.isNumber)(e.width)&&(0,i.isNumber)(e.height)||(n[t.id]=t))}),n}function d(t){return"waypoints"in t?"connection":"x"in t?"shape":"root"}function p(t){return!(!t||!t.isFrame)}function f(t,e){return(0,i.assign)({},t||{},e||{})}},75340(t,e,n){"use strict";function i(t){return CSS.escape(t)}n.d(e,{F:()=>i,Z:()=>o});var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function o(t){return(t=""+t)&&t.replace(/[&<>"']/g,function(t){return r[t]})}},51303(t,e,n){"use strict";function i(t){t&&"function"==typeof t.stopPropagation&&t.stopPropagation()}function r(t){return t.originalEvent||t.srcEvent}function o(t){i(t),i(r(t))}function s(t){return t.pointers&&t.pointers.length&&(t=t.pointers[0]),t.touches&&t.touches.length&&(t=t.touches[0]),t?{x:t.clientX,y:t.clientY}:null}n.d(e,{AF:()=>r,dG:()=>o,gK:()=>s})},71711(t,e,n){"use strict";n.d(e,{El:()=>l,P8:()=>c,XP:()=>o,cK:()=>r,ke:()=>s});var i=n(57094);function r(t,e){return t&&e?Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)):-1}function o(t,e,n,i){if(void 0===i&&(i=5),!t||!e||!n)return!1;var o=(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x),s=r(t,e);return Math.abs(o/s)<=i}function s(t,e){var n=Array.from(arguments).flat();const i={x:"v",y:"h"};for(const[t,e]of Object.entries(i))if(a(t,n))return e;return!1}function a(t,e){const n=e[0];return(0,i.every)(e,function(e){return Math.abs(n[t]-e[t])<=2})}function l(t,e,n){return n=n||0,t.x>e.x-n&&t.y>e.y-n&&t.x<e.x+e.width+n&&t.y<e.y+e.height+n}function c(t,e){return{x:Math.round(t.x+(e.x-t.x)/2),y:Math.round(t.y+(e.y-t.y)/2)}}},37706(t,e,n){"use strict";function i(t){return t.childNodes[0]}function r(t){return t.parentNode.childNodes[1]}n.d(e,{P:()=>i,i:()=>r})},43709(t,e,n){"use strict";function i(t){this._counter=0,this._prefix=(t?t+"-":"")+Math.floor(1e9*Math.random())+"-"}n.d(e,{A:()=>i}),i.prototype.next=function(){return this._prefix+ ++this._counter}},42596(t,e,n){"use strict";n.d(e,{C:()=>a});var i=n(71711),r=n(33732),o=Math.round,s=Math.max;function a(t,e){return function(t,e){var n,r;for(n=0;r=t[n];n++)if((0,i.cK)(r,e)<=10)return{point:t[n],bendpoint:!0,index:n};return null}(t,e)||function(t,e){var n,i,a,l,c=(0,r.A)((a=10,[["M",(i=e).x,i.y],["m",0,-a],["a",a,a,0,1,1,0,20],["a",a,a,0,1,1,0,-20],["z"]]),(n=[],t.forEach(function(t,e){n.push([0===e?"M":"L",t.x,t.y])}),n)),h=c[0],u=c[c.length-1];return h?h!==u?h.segment2!==u.segment2?{point:t[l=s(h.segment2,u.segment2)-1],bendpoint:!0,index:l}:{point:{x:o(h.x+u.x)/2,y:o(h.y+u.y)/2},index:h.segment2}:{point:{x:o(h.x),y:o(h.y)},index:h.segment2}:null}(t,e)}},72120(t,e,n){"use strict";n.d(e,{Io:()=>l,JH:()=>a,KH:()=>c,ls:()=>s});var i=n(51303),r=n(13128);function o(t,e){return((0,i.AF)(t)||t).button===e}function s(t){return o(t,0)}function a(t){return o(t,1)}function l(t){var e=(0,i.AF)(t)||t;return!!s(t)&&((0,r.c)()?e.metaKey:e.ctrlKey)}function c(t){var e=(0,i.AF)(t)||t;return s(t)&&e.shiftKey}},13128(t,e,n){"use strict";function i(){return/mac/i.test(navigator.platform)}n.d(e,{c:()=>i})},79356(t,e,n){"use strict";function i(t){return{x:t.x+t.width/2,y:t.y+t.height/2}}function r(t,e){return{x:t.x-e.x,y:t.y-e.y}}n.d(e,{g:()=>i,p:()=>r})},55063(t,e,n){"use strict";function i(t,e){if("function"!=typeof e)throw new Error("removeFn iterator must be a function");if(t){for(var n;n=t[0];)e(n);return t}}n.d(e,{l:()=>i})},24107(t,e,n){"use strict";n.d(e,{RJ:()=>u,si:()=>d,tx:()=>o});var i=n(57094),r=n(27828);function o(t){return t.flat().join(",").replace(/,?([A-Za-z]),?/g,"$1")}function s(t){return["L",t.x,t.y]}function a(t,e,n){return["C",t.x,t.y,e.x,e.y,n.x,n.y]}function l(t,e){const n=t.length,i=[(r=t[0],["M",r.x,r.y])];var r;for(let r=1;r<n;r++){const n=t[r-1],o=t[r],l=t[r+1];if(!l||!e){i.push(s(o));continue}const u=Math.min(e,h(o.x-n.x,o.y-n.y),h(l.x-o.x,l.y-o.y));if(!u){i.push(s(o));continue}const d=c(o,n,u),p=c(o,n,.5*u),f=c(o,l,u),g=c(o,l,.5*u);i.push(s(d)),i.push(a(p,g,f))}return i}function c(t,e,n){const i=e.x-t.x,r=e.y-t.y,o=n/h(i,r);return{x:t.x+i*o,y:t.y+r*o}}function h(t,e){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))}function u(t,e,n){(0,i.isNumber)(e)&&(n=e,e=null),e||(e={});const o=(0,r.vt)("path",e);return(0,i.isNumber)(n)&&(o.dataset.cornerRadius=String(n)),d(o,t)}function d(t,e){const n=parseInt(t.dataset.cornerRadius,10)||0;return(0,r.CF)(t,{d:o(l(e,n))}),t}},46757(t,e,n){"use strict";n.d(e,{Tl:()=>o,e$:()=>s,pd:()=>r});var i=n(27828);function r(t,e,n,r,o){var s=(0,i.l1)();s.setTranslate(e,n);var a=(0,i.l1)();a.setRotate(r||0,0,0);var l=(0,i.l1)();l.setScale(o||1,o||1),(0,i.pd)(t,[s,a,l])}function o(t,e,n){var r=(0,i.l1)();r.setTranslate(e,n),(0,i.pd)(t,r)}function s(t,e){var n=(0,i.l1)();n.setRotate(e,0,0),(0,i.pd)(t,n)}},4156(t,e,n){"use strict";n.d(e,{A:()=>u});var i=n(57094),r=n(27828),o=n(81340),s={width:150,height:50};function a(t,e){var n;e.textContent=t;try{var i,r=""===t;return e.textContent=r?"dummy":t,i={width:(n=e.getBBox()).width+2*n.x,height:n.height},r&&(i.width=0),i}catch(t){return console.log(t),{width:0,height:0}}}function l(t,e,n){for(var i,r=t.shift(),o=r;;){if((i=a(o,n)).width=o?i.width:0," "===o||""===o||i.width<Math.round(e)||o.length<2)return c(t,o,r,i);o=h(o,i.width,e)}}function c(t,e,n,i){if(e.length<n.length){var r=n.slice(e.length).trim();t.unshift(r)}return{width:i.width,height:i.height,text:e}}function h(t,e,n){var i=Math.max(t.length*(n/e),1),r=function(t,e){var n,i=t.split(/(\s|-|\u00AD)/g),r=[],o=0;if(i.length>1)for(;n=i.shift();){if(!(n.length+o<e)){"-"!==n&&""!==n||r.pop();break}r.push(n),o+=n.length}var s=r[r.length-1];return s&&""===s&&(r[r.length-1]="-"),r.join("")}(t,i);return r||(r=t.slice(0,Math.max(Math.round(i-1),1))),r}function u(t){this._config=(0,i.assign)({},{size:s,padding:0,style:{},align:"center-top"},t||{})}u.prototype.createText=function(t,e){return this.layoutText(t,e).element},u.prototype.getDimensions=function(t,e){return this.layoutText(t,e).dimensions},u.prototype.layoutText=function(t,e){var n=(0,i.assign)({},this._config.size,e.box),s=(0,i.assign)({},this._config.style,e.style),a=function(t){var e=t.split("-");return{horizontal:e[0]||"center",vertical:e[1]||"top"}}(e.align||this._config.align),c=function(t){return(0,i.isObject)(t)?(0,i.assign)({top:0,left:0,right:0,bottom:0},t):{top:t,left:t,right:t,bottom:t}}(void 0!==e.padding?e.padding:this._config.padding),h=e.fitBox||!1,u=function(t){if("fontSize"in t&&"lineHeight"in t)return t.lineHeight*parseInt(t.fontSize,10)}(s),d=t.split(/\u00AD?\r?\n/),p=[],f=n.width-c.left-c.right,g=(0,r.vt)("text");(0,r.CF)(g,{x:0,y:0}),(0,r.CF)(g,s);var m=function(){var t=document.getElementById("helper-svg");return t||(t=(0,r.vt)("svg"),(0,r.CF)(t,{id:"helper-svg"}),(0,o.HZ)(t,{visibility:"hidden",position:"fixed",width:0,height:0}),document.body.appendChild(t)),t}();for((0,r.BC)(m,g);d.length;)p.push(l(d,f,g));"middle"===a.vertical&&(c.top=c.bottom=0);var v=(0,i.reduce)(p,function(t,e,n){return t+(u||e.height)},0)+c.top+c.bottom,y=(0,i.reduce)(p,function(t,e,n){return e.width>t?e.width:t},0),b=c.top;"middle"===a.vertical&&(b+=(n.height-v)/2),b-=(u||p[0].height)/4;var x=(0,r.vt)("text");return(0,r.CF)(x,s),(0,i.forEach)(p,function(t){var e;switch(b+=u||t.height,a.horizontal){case"left":e=c.left;break;case"right":e=(h?y:f)-c.right-t.width;break;default:e=Math.max(((h?y:f)-t.width)/2+c.left,0)}var n=(0,r.vt)("tspan");(0,r.CF)(n,{x:e,y:b}),n.textContent=t.text,(0,r.BC)(x,n)}),(0,r.TF)(g),{dimensions:{width:y,height:v},element:x}}},96495(t){(function(){var e,n,i,r,o,s;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(t.exports=function(){return(e()-o)/1e6},n=process.hrtime,r=(e=function(){var t;return 1e9*(t=n())[0]+t[1]})(),s=1e9*process.uptime(),o=r-s):Date.now?(t.exports=function(){return Date.now()-i},i=Date.now()):(t.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)},43078(t,e,n){"use strict";n.d(e,{Bi:()=>A,J0:()=>y,Kr:()=>k,MN:()=>C,NT:()=>E,Nf:()=>w,WO:()=>b,Yn:()=>O,hb:()=>S,li:()=>_,vJ:()=>x});var i,r,o,s,a=n(60616),l=0,c=[],h=a.options,u=h.__b,d=h.__r,p=h.diffed,f=h.__c,g=h.unmount,m=h.__;function v(t,e){h.__h&&h.__h(r,t,l||e),l=0;var n=r.__H||(r.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function y(t){return l=1,b(B,t)}function b(t,e,n){var o=v(i++,2);if(o.t=t,!o.__c&&(o.__=[n?n(e):B(void 0,e),function(t){var e=o.__N?o.__N[0]:o.__[0],n=o.t(e,t);e!==n&&(o.__N=[n,o.__[1]],o.__c.setState({}))}],o.__c=r,!r.__f)){var s=function(t,e,n){if(!o.__c.__H)return!0;var i=o.__c.__H.__.filter(function(t){return!!t.__c});if(i.every(function(t){return!t.__N}))return!a||a.call(this,t,e,n);var r=o.__c.props!==t;return i.forEach(function(t){if(t.__N){var e=t.__[0];t.__=t.__N,t.__N=void 0,e!==t.__[0]&&(r=!0)}}),a&&a.call(this,t,e,n)||r};r.__f=!0;var a=r.shouldComponentUpdate,l=r.componentWillUpdate;r.componentWillUpdate=function(t,e,n){if(this.__e){var i=a;a=void 0,s(t,e,n),a=i}l&&l.call(this,t,e,n)},r.shouldComponentUpdate=s}return o.__N||o.__}function x(t,e){var n=v(i++,3);!h.__s&&D(n.__H,e)&&(n.__=t,n.u=e,r.__H.__h.push(n))}function w(t,e){var n=v(i++,4);!h.__s&&D(n.__H,e)&&(n.__=t,n.u=e,r.__h.push(n))}function _(t){return l=5,k(function(){return{current:t}},[])}function O(t,e,n){l=6,w(function(){if("function"==typeof t){var n=t(e());return function(){t(null),n&&"function"==typeof n&&n()}}if(t)return t.current=e(),function(){return t.current=null}},null==n?n:n.concat(t))}function k(t,e){var n=v(i++,7);return D(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function S(t,e){return l=8,k(function(){return t},e)}function E(t){var e=r.context[t.__c],n=v(i++,9);return n.c=t,e?(null==n.__&&(n.__=!0,e.sub(r)),e.props.value):t.__}function C(t,e){h.useDebugValue&&h.useDebugValue(e?e(t):t)}function A(){var t=v(i++,11);if(!t.__){for(var e=r.__v;null!==e&&!e.__m&&null!==e.__;)e=e.__;var n=e.__m||(e.__m=[0,0]);t.__="P"+n[0]+"-"+n[1]++}return t.__}function T(){for(var t;t=c.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(N),t.__H.__h.forEach(R),t.__H.__h=[]}catch(e){t.__H.__h=[],h.__e(e,t.__v)}}h.__b=function(t){r=null,u&&u(t)},h.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),m&&m(t,e)},h.__r=function(t){d&&d(t),i=0;var e=(r=t.__c).__H;e&&(o===r?(e.__h=[],r.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(e.__h.forEach(N),e.__h.forEach(R),e.__h=[],i=0)),o=r},h.diffed=function(t){p&&p(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(1!==c.push(e)&&s===h.requestAnimationFrame||((s=h.requestAnimationFrame)||M)(T)),e.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.u=void 0})),o=r=null},h.__c=function(t,e){e.some(function(t){try{t.__h.forEach(N),t.__h=t.__h.filter(function(t){return!t.__||R(t)})}catch(n){e.some(function(t){t.__h&&(t.__h=[])}),e=[],h.__e(n,t.__v)}}),f&&f(t,e)},h.unmount=function(t){g&&g(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(t){try{N(t)}catch(t){e=t}}),n.__H=void 0,e&&h.__e(e,n.__v))};var P="function"==typeof requestAnimationFrame;function M(t){var e,n=function(){clearTimeout(i),P&&cancelAnimationFrame(e),setTimeout(t)},i=setTimeout(n,35);P&&(e=requestAnimationFrame(n))}function N(t){var e=r,n=t.__c;"function"==typeof n&&(t.__c=void 0,n()),r=e}function R(t){var e=r;t.__c=t.__(),r=e}function D(t,e){return!t||t.length!==e.length||e.some(function(e,n){return e!==t[n]})}function B(t,e){return"function"==typeof e?e(t):e}},56182(t,e,n){for(var i=n(96495),r="undefined"==typeof window?global:window,o=["moz","webkit"],s="AnimationFrame",a=r["request"+s],l=r["cancel"+s]||r["cancelRequest"+s],c=0;!a&&c<o.length;c++)a=r[o[c]+"Request"+s],l=r[o[c]+"Cancel"+s]||r[o[c]+"CancelRequest"+s];if(!a||!l){var h=0,u=0,d=[],p=1e3/60;a=function(t){if(0===d.length){var e=i(),n=Math.max(0,p-(e-h));h=n+e,setTimeout(function(){var t=d.slice(0);d.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(h)}catch(t){setTimeout(function(){throw t},0)}},Math.round(n))}return d.push({handle:++u,callback:t,cancelled:!1}),u},l=function(t){for(var e=0;e<d.length;e++)d[e].handle===t&&(d[e].cancelled=!0)}}t.exports=function(t){return a.call(r,t)},t.exports.cancel=function(){l.apply(r,arguments)},t.exports.polyfill=function(t){t||(t=r),t.requestAnimationFrame=a,t.cancelAnimationFrame=l}},62019(t){t.exports=function(t){this.ok=!1,this.alpha=1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t=(t=t.replace(/ /g,"")).toLowerCase();var e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};t=e[t]||t;for(var n=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseFloat(t[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],i=0;i<n.length;i++){var r=n[i].re,o=n[i].process,s=r.exec(t);if(s){var a=o(s);this.r=a[0],this.g=a[1],this.b=a[2],a.length>3&&(this.alpha=a[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),n=this.b.toString(16);return 1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==n.length&&(n="0"+n),"#"+t+e+n},this.getHelpXML=function(){for(var t=new Array,i=0;i<n.length;i++)for(var r=n[i].example,o=0;o<r.length;o++)t[t.length]=r[o];for(var s in e)t[t.length]=s;var a=document.createElement("ul");for(a.setAttribute("id","rgbcolor-examples"),i=0;i<t.length;i++)try{var l=document.createElement("li"),c=new RGBColor(t[i]),h=document.createElement("div");h.style.cssText="margin: 3px; border: 1px solid black; background:"+c.toHex()+"; color:"+c.toHex(),h.appendChild(document.createTextNode("test"));var u=document.createTextNode(" "+t[i]+" -> "+c.toRGB()+" -> "+c.toHex());l.appendChild(h),l.appendChild(u),a.appendChild(l)}catch(t){}return a}}},23807(t,e,n){"use strict";n.d(e,{_n:()=>N});var i=n(782),r=n(31650);function o(t){return 45==t||46==t||58==t||t>=65&&t<=90||95==t||t>=97&&t<=122||t>=161}function s(t){return 9==t||10==t||13==t||32==t}let a=null,l=null,c=0;function h(t,e){let n=t.pos+e;if(l==t&&c==n)return a;for(;s(t.peek(e));)e++;let i="";for(;;){let n=t.peek(e);if(!o(n))break;i+=String.fromCharCode(n),e++}return l=t,c=n,a=i||null}function u(t,e){this.name=t,this.parent=e}const d=new i.Aj({start:null,shift:(t,e,n,i)=>1==e?new u(h(i,1)||"",t):t,reduce:(t,e)=>11==e&&t?t.parent:t,reuse(t,e,n,i){let r=e.type.id;return 1==r||13==r?new u(h(i,1)||"",t):t},strict:!1}),p=new i.Lu((t,e)=>{if(60==t.next)if(t.advance(),47==t.next){t.advance();let n=h(t,0);if(!n)return t.acceptToken(5);if(e.context&&n==e.context.name)return t.acceptToken(2);for(let i=e.context;i;i=i.parent)if(i.name==n)return t.acceptToken(3,-2);t.acceptToken(4)}else if(33!=t.next&&63!=t.next)return t.acceptToken(1)},{contextual:!0});function f(t,e){return new i.Lu(n=>{let i=0,r=e.charCodeAt(0);t:for(;!(n.next<0);n.advance(),i++)if(n.next==r){for(let t=1;t<e.length;t++)if(n.peek(t)!=e.charCodeAt(t))continue t;break}i&&n.acceptToken(t)})}const g=f(36,"--\x3e"),m=f(37,"?>"),v=f(38,"]]>"),y=(0,r.pn)({Text:r._A.content,"StartTag StartCloseTag EndTag SelfCloseEndTag":r._A.angleBracket,TagName:r._A.tagName,"MismatchedCloseTag/TagName":[r._A.tagName,r._A.invalid],AttributeName:r._A.attributeName,AttributeValue:r._A.attributeValue,Is:r._A.definitionOperator,"EntityReference CharacterReference":r._A.character,Comment:r._A.blockComment,ProcessingInst:r._A.processingInstruction,DoctypeDecl:r._A.documentMeta,Cdata:r._A.special(r._A.string)}),b=i.U1.deserialize({version:14,states:",lOQOaOOOrOxO'#CfOzOpO'#CiO!tOaO'#CgOOOP'#Cg'#CgO!{OrO'#CrO#TOtO'#CsO#]OpO'#CtOOOP'#DT'#DTOOOP'#Cv'#CvQQOaOOOOOW'#Cw'#CwO#eOxO,59QOOOP,59Q,59QOOOO'#Cx'#CxO#mOpO,59TO#uO!bO,59TOOOP'#C|'#C|O$TOaO,59RO$[OpO'#CoOOOP,59R,59ROOOQ'#C}'#C}O$dOrO,59^OOOP,59^,59^OOOS'#DO'#DOO$lOtO,59_OOOP,59_,59_O$tOpO,59`O$|OpO,59`OOOP-E6t-E6tOOOW-E6u-E6uOOOP1G.l1G.lOOOO-E6v-E6vO%UO!bO1G.oO%UO!bO1G.oO%dOpO'#CkO%lO!bO'#CyO%zO!bO1G.oOOOP1G.o1G.oOOOP1G.w1G.wOOOP-E6z-E6zOOOP1G.m1G.mO&VOpO,59ZO&_OpO,59ZOOOQ-E6{-E6{OOOP1G.x1G.xOOOS-E6|-E6|OOOP1G.y1G.yO&gOpO1G.zO&gOpO1G.zOOOP1G.z1G.zO&oO!bO7+$ZO&}O!bO7+$ZOOOP7+$Z7+$ZOOOP7+$c7+$cO'YOpO,59VO'bOpO,59VO'mO!bO,59eOOOO-E6w-E6wO'{OpO1G.uO'{OpO1G.uOOOP1G.u1G.uO(TOpO7+$fOOOP7+$f7+$fO(]O!bO<<GuOOOP<<Gu<<GuOOOP<<G}<<G}O'bOpO1G.qO'bOpO1G.qO(hO#tO'#CnO(vO&jO'#CnOOOO1G.q1G.qO)UOpO7+$aOOOP7+$a7+$aOOOP<<HQ<<HQOOOPAN=aAN=aOOOPAN=iAN=iO'bOpO7+$]OOOO7+$]7+$]OOOO'#Cz'#CzO)^O#tO,59YOOOO,59Y,59YOOOO'#C{'#C{O)lO&jO,59YOOOP<<G{<<G{OOOO<<Gw<<GwOOOO-E6x-E6xOOOO1G.t1G.tOOOO-E6y-E6y",stateData:")z~OPQOSVOTWOVWOWWOXWOiXOyPO!QTO!SUO~OvZOx]O~O^`Oz^O~OPQOQcOSVOTWOVWOWWOXWOyPO!QTO!SUO~ORdO~P!SOteO!PgO~OuhO!RjO~O^lOz^O~OvZOxoO~O^qOz^O~O[vO`sOdwOz^O~ORyO~P!SO^{Oz^O~OteO!P}O~OuhO!R!PO~O^!QOz^O~O[!SOz^O~O[!VO`sOd!WOz^O~Oa!YOz^O~Oz^O[mX`mXdmX~O[!VO`sOd!WO~O^!]Oz^O~O[!_Oz^O~O[!aOz^O~O[!cO`sOd!dOz^O~O[!cO`sOd!dO~Oa!eOz^O~Oz^O{!gO}!hO~Oz^O[ma`madma~O[!kOz^O~O[!lOz^O~O[!mO`sOd!nO~OW!qOX!qO{!sO|!qO~OW!tOX!tO}!sO!O!tO~O[!vOz^O~OW!qOX!qO{!yO|!qO~OW!tOX!tO}!yO!O!tO~O",goto:"%cxPPPPPPPPPPyyP!PP!VPP!`!jP!pyyyP!v!|#S$[$k$q$w$}%TPPPP%ZXWORYbXRORYb_t`qru!T!U!bQ!i!YS!p!e!fR!w!oQdRRybXSORYbQYORmYQ[PRn[Q_QQkVjp_krz!R!T!X!Z!^!`!f!j!oQr`QzcQ!RlQ!TqQ!XsQ!ZtQ!^{Q!`!QQ!f!YQ!j!]R!o!eQu`S!UqrU![u!U!bR!b!TQ!r!gR!x!rQ!u!hR!z!uQbRRxbQfTR|fQiUR!OiSXOYTaRb",nodeNames:" StartTag StartCloseTag MissingCloseTag StartCloseTag StartCloseTag Document Text EntityReference CharacterReference Cdata Element EndTag OpenTag TagName Attribute AttributeName Is AttributeValue CloseTag SelfCloseEndTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag DoctypeDecl",maxTerm:50,context:d,nodeProps:[["closedBy",1,"SelfCloseEndTag EndTag",13,"CloseTag MissingCloseTag"],["openedBy",12,"StartTag StartCloseTag",19,"OpenTag",20,"StartTag"],["isolate",-6,13,18,19,21,22,24,""]],propSources:[y],skippedNodes:[0],repeatNodeCount:9,tokenData:"!)v~R!YOX$qXY)iYZ)iZ]$q]^)i^p$qpq)iqr$qrs*vsv$qvw+fwx/ix}$q}!O0[!O!P$q!P!Q2z!Q![$q![!]4n!]!^$q!^!_8U!_!`!#t!`!a!$l!a!b!%d!b!c$q!c!}4n!}#P$q#P#Q!'W#Q#R$q#R#S4n#S#T$q#T#o4n#o%W$q%W%o4n%o%p$q%p&a4n&a&b$q&b1p4n1p4U$q4U4d4n4d4e$q4e$IS4n$IS$I`$q$I`$Ib4n$Ib$Kh$q$Kh%#t4n%#t&/x$q&/x&Et4n&Et&FV$q&FV;'S4n;'S;:j8O;:j;=`)c<%l?&r$q?&r?Ah4n?Ah?BY$q?BY?Mn4n?MnO$qi$zXVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qa%nVVP!O`Ov%gwx&Tx!^%g!^!_&o!_;'S%g;'S;=`'W<%lO%gP&YTVPOv&Tw!^&T!_;'S&T;'S;=`&i<%lO&TP&lP;=`<%l&T`&tS!O`Ov&ox;'S&o;'S;=`'Q<%lO&o`'TP;=`<%l&oa'ZP;=`<%l%gX'eWVP|WOr'^rs&Tsv'^w!^'^!^!_'}!_;'S'^;'S;=`(i<%lO'^W(ST|WOr'}sv'}w;'S'};'S;=`(c<%lO'}W(fP;=`<%l'}X(lP;=`<%l'^h(vV|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oh)`P;=`<%l(oi)fP;=`<%l$qo)t`VP|W!O`zUOX$qXY)iYZ)iZ]$q]^)i^p$qpq)iqr$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk+PV{YVP!O`Ov%gwx&Tx!^%g!^!_&o!_;'S%g;'S;=`'W<%lO%g~+iast,n![!]-r!c!}-r#R#S-r#T#o-r%W%o-r%p&a-r&b1p-r4U4d-r4e$IS-r$I`$Ib-r$Kh%#t-r&/x&Et-r&FV;'S-r;'S;:j/c?&r?Ah-r?BY?Mn-r~,qQ!Q![,w#l#m-V~,zQ!Q![,w!]!^-Q~-VOX~~-YR!Q![-c!c!i-c#T#Z-c~-fS!Q![-c!]!^-Q!c!i-c#T#Z-c~-ug}!O-r!O!P-r!Q![-r![!]-r!]!^/^!c!}-r#R#S-r#T#o-r$}%O-r%W%o-r%p&a-r&b1p-r1p4U-r4U4d-r4e$IS-r$I`$Ib-r$Je$Jg-r$Kh%#t-r&/x&Et-r&FV;'S-r;'S;:j/c?&r?Ah-r?BY?Mn-r~/cOW~~/fP;=`<%l-rk/rW}bVP|WOr'^rs&Tsv'^w!^'^!^!_'}!_;'S'^;'S;=`(i<%lO'^k0eZVP|W!O`Or$qrs%gsv$qwx'^x}$q}!O1W!O!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk1aZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a2S!a;'S$q;'S;=`)c<%lO$qk2_X!PQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qm3TZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a3v!a;'S$q;'S;=`)c<%lO$qm4RXdSVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qo4{!P`S^QVP|W!O`Or$qrs%gsv$qwx'^x}$q}!O4n!O!P4n!P!Q$q!Q![4n![!]4n!]!^$q!^!_(o!_!c$q!c!}4n!}#R$q#R#S4n#S#T$q#T#o4n#o$}$q$}%O4n%O%W$q%W%o4n%o%p$q%p&a4n&a&b$q&b1p4n1p4U4n4U4d4n4d4e$q4e$IS4n$IS$I`$q$I`$Ib4n$Ib$Je$q$Je$Jg4n$Jg$Kh$q$Kh%#t4n%#t&/x$q&/x&Et4n&Et&FV$q&FV;'S4n;'S;:j8O;:j;=`)c<%l?&r$q?&r?Ah4n?Ah?BY$q?BY?Mn4n?MnO$qo8RP;=`<%l4ni8]Y|W!O`Oq(oqr8{rs&osv(owx'}x!a(o!a!b!#U!b;'S(o;'S;=`)]<%lO(oi9S_|W!O`Or(ors&osv(owx'}x}(o}!O:R!O!f(o!f!g;e!g!}(o!}#ODh#O#W(o#W#XLp#X;'S(o;'S;=`)]<%lO(oi:YX|W!O`Or(ors&osv(owx'}x}(o}!O:u!O;'S(o;'S;=`)]<%lO(oi;OV!QP|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oi;lX|W!O`Or(ors&osv(owx'}x!q(o!q!r<X!r;'S(o;'S;=`)]<%lO(oi<`X|W!O`Or(ors&osv(owx'}x!e(o!e!f<{!f;'S(o;'S;=`)]<%lO(oi=SX|W!O`Or(ors&osv(owx'}x!v(o!v!w=o!w;'S(o;'S;=`)]<%lO(oi=vX|W!O`Or(ors&osv(owx'}x!{(o!{!|>c!|;'S(o;'S;=`)]<%lO(oi>jX|W!O`Or(ors&osv(owx'}x!r(o!r!s?V!s;'S(o;'S;=`)]<%lO(oi?^X|W!O`Or(ors&osv(owx'}x!g(o!g!h?y!h;'S(o;'S;=`)]<%lO(oi@QY|W!O`Or?yrs@psv?yvwA[wxBdx!`?y!`!aCr!a;'S?y;'S;=`Db<%lO?ya@uV!O`Ov@pvxA[x!`@p!`!aAy!a;'S@p;'S;=`B^<%lO@pPA_TO!`A[!`!aAn!a;'SA[;'S;=`As<%lOA[PAsOiPPAvP;=`<%lA[aBQSiP!O`Ov&ox;'S&o;'S;=`'Q<%lO&oaBaP;=`<%l@pXBiX|WOrBdrsA[svBdvwA[w!`Bd!`!aCU!a;'SBd;'S;=`Cl<%lOBdXC]TiP|WOr'}sv'}w;'S'};'S;=`(c<%lO'}XCoP;=`<%lBdiC{ViP|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oiDeP;=`<%l?yiDoZ|W!O`Or(ors&osv(owx'}x!e(o!e!fEb!f#V(o#V#WIr#W;'S(o;'S;=`)]<%lO(oiEiX|W!O`Or(ors&osv(owx'}x!f(o!f!gFU!g;'S(o;'S;=`)]<%lO(oiF]X|W!O`Or(ors&osv(owx'}x!c(o!c!dFx!d;'S(o;'S;=`)]<%lO(oiGPX|W!O`Or(ors&osv(owx'}x!v(o!v!wGl!w;'S(o;'S;=`)]<%lO(oiGsX|W!O`Or(ors&osv(owx'}x!c(o!c!dH`!d;'S(o;'S;=`)]<%lO(oiHgX|W!O`Or(ors&osv(owx'}x!}(o!}#OIS#O;'S(o;'S;=`)]<%lO(oiI]V|W!O`yPOr(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oiIyX|W!O`Or(ors&osv(owx'}x#W(o#W#XJf#X;'S(o;'S;=`)]<%lO(oiJmX|W!O`Or(ors&osv(owx'}x#T(o#T#UKY#U;'S(o;'S;=`)]<%lO(oiKaX|W!O`Or(ors&osv(owx'}x#h(o#h#iK|#i;'S(o;'S;=`)]<%lO(oiLTX|W!O`Or(ors&osv(owx'}x#T(o#T#UH`#U;'S(o;'S;=`)]<%lO(oiLwX|W!O`Or(ors&osv(owx'}x#c(o#c#dMd#d;'S(o;'S;=`)]<%lO(oiMkX|W!O`Or(ors&osv(owx'}x#V(o#V#WNW#W;'S(o;'S;=`)]<%lO(oiN_X|W!O`Or(ors&osv(owx'}x#h(o#h#iNz#i;'S(o;'S;=`)]<%lO(oi! RX|W!O`Or(ors&osv(owx'}x#m(o#m#n! n#n;'S(o;'S;=`)]<%lO(oi! uX|W!O`Or(ors&osv(owx'}x#d(o#d#e!!b#e;'S(o;'S;=`)]<%lO(oi!!iX|W!O`Or(ors&osv(owx'}x#X(o#X#Y?y#Y;'S(o;'S;=`)]<%lO(oi!#_V!SP|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(ok!$PXaQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qo!$wX[UVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk!%mZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a!&`!a;'S$q;'S;=`)c<%lO$qk!&kX!RQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk!'aZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_#P$q#P#Q!(S#Q;'S$q;'S;=`)c<%lO$qk!(]ZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a!)O!a;'S$q;'S;=`)c<%lO$qk!)ZXxQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$q",tokenizers:[p,g,m,v,0,1,2,3,4],topRules:{Document:[0,6]},tokenPrec:0});var x=n(63960),w=n(36744),_=n(68944);function O(t,e){let n=e&&e.getChild("TagName");return n?t.sliceString(n.from,n.to):""}function k(t,e){let n=e&&e.firstChild;return n&&"OpenTag"==n.name?O(t,n):""}function S(t){for(let e=t&&t.parent;e;e=e.parent)if("Element"==e.name)return e;return null}class E{constructor(t,e,n){this.attrs=e,this.attrValues=n,this.children=[],this.name=t.name,this.completion=Object.assign(Object.assign({type:"type"},t.completion||{}),{label:this.name}),this.openCompletion=Object.assign(Object.assign({},this.completion),{label:"<"+this.name}),this.closeCompletion=Object.assign(Object.assign({},this.completion),{label:"</"+this.name+">",boost:2}),this.closeNameCompletion=Object.assign(Object.assign({},this.completion),{label:this.name+">"}),this.text=t.textContent?t.textContent.map(t=>({label:t,type:"text"})):[]}}const C=/^[:\-\.\w\u00b7-\uffff]*$/;function A(t){return Object.assign(Object.assign({type:"property"},t.completion||{}),{label:t.name})}function T(t){return"string"==typeof t?{label:`"${t}"`,type:"constant"}:/^"/.test(t.label)?t:Object.assign(Object.assign({},t),{label:`"${t.label}"`})}function P(t,e){let n=[],i=[],r=Object.create(null);for(let t of e){let e=A(t);n.push(e),t.global&&i.push(e),t.values&&(r[t.name]=t.values.map(T))}let o=[],s=[],a=Object.create(null);for(let e of t){let t=i,l=r;e.attributes&&(t=t.concat(e.attributes.map(t=>"string"==typeof t?n.find(e=>e.label==t)||{label:t,type:"property"}:(t.values&&(l==r&&(l=Object.create(l)),l[t.name]=t.values.map(T)),A(t)))));let c=new E(e,t,l);a[c.name]=c,o.push(c),e.top&&s.push(c)}s.length||(s=o);for(let e=0;e<o.length;e++){let n=t[e],i=o[e];if(n.children)for(let t of n.children)a[t]&&i.children.push(a[t]);else i.children=o}return t=>{var e;let{doc:n}=t.state,l=function(t,e){var n;let i=(0,x.mv)(t).resolveInner(e,-1),r=null;for(let t=i;!r&&t.parent;t=t.parent)"OpenTag"!=t.name&&"CloseTag"!=t.name&&"SelfClosingTag"!=t.name&&"MismatchedCloseTag"!=t.name||(r=t);if(r&&(r.to>e||r.lastChild.type.isError)){let t=r.parent;if("TagName"==i.name)return"CloseTag"==r.name||"MismatchedCloseTag"==r.name?{type:"closeTag",from:i.from,context:t}:{type:"openTag",from:i.from,context:S(t)};if("AttributeName"==i.name)return{type:"attrName",from:i.from,context:r};if("AttributeValue"==i.name)return{type:"attrValue",from:i.from,context:r};let n=i==r||"Attribute"==i.name?i.childBefore(e):i;return"StartTag"==(null==n?void 0:n.name)?{type:"openTag",from:e,context:S(t)}:"StartCloseTag"==(null==n?void 0:n.name)&&n.to<=e?{type:"closeTag",from:e,context:t}:"Is"==(null==n?void 0:n.name)?{type:"attrValue",from:e,context:r}:n?{type:"attrName",from:e,context:r}:null}if("StartCloseTag"==i.name)return{type:"closeTag",from:e,context:i.parent};for(;i.parent&&i.to==e&&!(null===(n=i.lastChild)||void 0===n?void 0:n.type.isError);)i=i.parent;return"Element"==i.name||"Text"==i.name||"Document"==i.name?{type:"tag",from:e,context:"Element"==i.name?i:S(i)}:null}(t.state,t.pos);if(!l||"tag"==l.type&&!t.explicit)return null;let{type:c,from:h,context:u}=l;if("openTag"==c){let t=s,e=k(n,u);if(e){let n=a[e];t=(null==n?void 0:n.children)||o}return{from:h,options:t.map(t=>t.completion),validFor:C}}if("closeTag"==c){let i=k(n,u);return i?{from:h,to:t.pos+(">"==n.sliceString(t.pos,t.pos+1)?1:0),options:[(null===(e=a[i])||void 0===e?void 0:e.closeNameCompletion)||{label:i+">",type:"type"}],validFor:C}:null}if("attrName"==c){let t=a[O(n,u)];return{from:h,options:(null==t?void 0:t.attrs)||i,validFor:C}}if("attrValue"==c){let e=function(t,e,n){let i=e&&e.getChildren("Attribute").find(t=>t.from<=n&&t.to>=n),r=i&&i.getChild("AttributeName");return r?t.sliceString(r.from,r.to):""}(n,u,h);if(!e)return null;let i=a[O(n,u)],o=((null==i?void 0:i.attrValues)||r)[e];return o&&o.length?{from:h,to:t.pos+('"'==n.sliceString(t.pos,t.pos+1)?1:0),options:o,validFor:/^"[^"]*"?$/}:null}if("tag"==c){let e=k(n,u),i=a[e],r=[],l=u&&u.lastChild;!e||l&&"CloseTag"==l.name&&O(n,l)==e||r.push(i?i.closeCompletion:{label:"</"+e+">",type:"type",boost:2});let c=r.concat(((null==i?void 0:i.children)||(u?o:s)).map(t=>t.openCompletion));if(u&&(null==i?void 0:i.text.length)){let e=u.firstChild;e.to>t.pos-20&&!/\S/.test(t.state.sliceDoc(e.to,t.pos))&&(c=c.concat(i.text))}return{from:h,options:c,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}return null}}const M=x.bj.define({name:"xml",parser:b.configure({props:[x.Oh.add({Element(t){let e=/^\s*<\//.test(t.textAfter);return t.lineIndent(t.node.from)+(e?0:t.unit)},"OpenTag CloseTag SelfClosingTag":t=>t.column(t.node.from)+t.unit}),x.b_.add({Element(t){let e=t.firstChild,n=t.lastChild;return e&&"OpenTag"==e.name?{from:e.to,to:"CloseTag"==n.name?n.from:t.to}:null}}),x.Q_.add({"OpenTag CloseTag":t=>t.getChild("TagName")})]}),languageData:{commentTokens:{block:{open:"\x3c!--",close:"--\x3e"}},indentOnInput:/^\s*<\/$/}});function N(t={}){let e=[M.data.of({autocomplete:P(t.elements||[],t.attributes||[])})];return!1!==t.autoCloseTags&&e.push(D),new x.Yy(M,e)}function R(t,e,n=t.length){if(!e)return"";let i=e.firstChild,r=i&&i.getChild("TagName");return r?t.sliceString(r.from,Math.min(r.to,n)):""}const D=_.Lz.inputHandler.of((t,e,n,i,r)=>{if(t.composing||t.state.readOnly||e!=n||">"!=i&&"/"!=i||!M.isActiveAt(t.state,e,-1))return!1;let o=r(),{state:s}=o,a=s.changeByRange(t=>{var e,n,r;let o,{head:a}=t,l=s.doc.sliceString(a-1,a)==i,c=(0,x.mv)(s).resolveInner(a,-1);if(l&&">"==i&&"EndTag"==c.name){let i=c.parent;if("CloseTag"!=(null===(n=null===(e=i.parent)||void 0===e?void 0:e.lastChild)||void 0===n?void 0:n.name)&&(o=R(s.doc,i.parent,a)))return{range:t,changes:{from:a,to:a+(">"===s.doc.sliceString(a,a+1)?1:0),insert:`</${o}>`}}}else if(l&&"/"==i&&"StartCloseTag"==c.name){let t=c.parent;if(c.from==a-2&&"CloseTag"!=(null===(r=t.lastChild)||void 0===r?void 0:r.name)&&(o=R(s.doc,t,a))){let t=a+(">"===s.doc.sliceString(a,a+1)?1:0),e=`${o}>`;return{range:w.OF.cursor(a+e.length,-1),changes:{from:a,to:t,insert:e}}}}return{range:t}});return!a.changes.empty&&(t.dispatch([o,s.update(a,{userEvent:"input.complete",scrollIntoView:!0})]),!0)})},94545(t,e,n){"use strict";n.d(e,{Wn:()=>Ut});var i=n(56182),r=n(62019),o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function a(t,e){var n=t[0],i=t[1];return[n*Math.cos(e)-i*Math.sin(e),n*Math.sin(e)+i*Math.cos(e)]}function l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;n++)if("number"!=typeof t[n])throw new Error("assertNumbers arguments["+n+"] is not a number. "+typeof t[n]+" == typeof "+t[n]);return!0}var c=Math.PI;function h(t,e,n){t.lArcFlag=0===t.lArcFlag?0:1,t.sweepFlag=0===t.sweepFlag?0:1;var i=t.rX,r=t.rY,o=t.x,s=t.y;i=Math.abs(t.rX),r=Math.abs(t.rY);var l=a([(e-o)/2,(n-s)/2],-t.xRot/180*c),h=l[0],u=l[1],d=Math.pow(h,2)/Math.pow(i,2)+Math.pow(u,2)/Math.pow(r,2);1<d&&(i*=Math.sqrt(d),r*=Math.sqrt(d)),t.rX=i,t.rY=r;var p=Math.pow(i,2)*Math.pow(u,2)+Math.pow(r,2)*Math.pow(h,2),f=(t.lArcFlag!==t.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(i,2)*Math.pow(r,2)-p)/p)),g=i*u/r*f,m=-r*h/i*f,v=a([g,m],t.xRot/180*c);t.cX=v[0]+(e+o)/2,t.cY=v[1]+(n+s)/2,t.phi1=Math.atan2((u-m)/r,(h-g)/i),t.phi2=Math.atan2((-u-m)/r,(-h-g)/i),0===t.sweepFlag&&t.phi2>t.phi1&&(t.phi2-=2*c),1===t.sweepFlag&&t.phi2<t.phi1&&(t.phi2+=2*c),t.phi1*=180/c,t.phi2*=180/c}function u(t,e,n){l(t,e,n);var i=t*t+e*e-n*n;if(0>i)return[];if(0===i)return[[t*n/(t*t+e*e),e*n/(t*t+e*e)]];var r=Math.sqrt(i);return[[(t*n+e*r)/(t*t+e*e),(e*n-t*r)/(t*t+e*e)],[(t*n-e*r)/(t*t+e*e),(e*n+t*r)/(t*t+e*e)]]}var d,p=Math.PI/180;function f(t,e,n){return(1-n)*t+n*e}function g(t,e,n,i){return t+Math.cos(i/180*c)*e+Math.sin(i/180*c)*n}function m(t,e,n,i){var r=1e-6,o=e-t,s=n-e,a=3*o+3*(i-n)-6*s,l=6*(s-o),c=3*o;return Math.abs(a)<r?[-c/l]:function(t,e,n){void 0===n&&(n=1e-6);var i=t*t/4-e;if(i<-n)return[];if(i<=n)return[-t/2];var r=Math.sqrt(i);return[-t/2-r,-t/2+r]}(l/a,c/a,r)}function v(t,e,n,i,r){var o=1-r;return t*(o*o*o)+e*(3*o*o*r)+n*(3*o*r*r)+i*(r*r*r)}!function(t){function e(){return r(function(t,e,n){return t.relative&&(void 0!==t.x1&&(t.x1+=e),void 0!==t.y1&&(t.y1+=n),void 0!==t.x2&&(t.x2+=e),void 0!==t.y2&&(t.y2+=n),void 0!==t.x&&(t.x+=e),void 0!==t.y&&(t.y+=n),t.relative=!1),t})}function n(){var t=NaN,e=NaN,n=NaN,i=NaN;return r(function(r,o,s){return r.type&O.SMOOTH_CURVE_TO&&(r.type=O.CURVE_TO,t=isNaN(t)?o:t,e=isNaN(e)?s:e,r.x1=r.relative?o-t:2*o-t,r.y1=r.relative?s-e:2*s-e),r.type&O.CURVE_TO?(t=r.relative?o+r.x2:r.x2,e=r.relative?s+r.y2:r.y2):(t=NaN,e=NaN),r.type&O.SMOOTH_QUAD_TO&&(r.type=O.QUAD_TO,n=isNaN(n)?o:n,i=isNaN(i)?s:i,r.x1=r.relative?o-n:2*o-n,r.y1=r.relative?s-i:2*s-i),r.type&O.QUAD_TO?(n=r.relative?o+r.x1:r.x1,i=r.relative?s+r.y1:r.y1):(n=NaN,i=NaN),r})}function i(){var t=NaN,e=NaN;return r(function(n,i,r){if(n.type&O.SMOOTH_QUAD_TO&&(n.type=O.QUAD_TO,t=isNaN(t)?i:t,e=isNaN(e)?r:e,n.x1=n.relative?i-t:2*i-t,n.y1=n.relative?r-e:2*r-e),n.type&O.QUAD_TO){t=n.relative?i+n.x1:n.x1,e=n.relative?r+n.y1:n.y1;var o=n.x1,s=n.y1;n.type=O.CURVE_TO,n.x1=((n.relative?0:i)+2*o)/3,n.y1=((n.relative?0:r)+2*s)/3,n.x2=(n.x+2*o)/3,n.y2=(n.y+2*s)/3}else t=NaN,e=NaN;return n})}function r(t){var e=0,n=0,i=NaN,r=NaN;return function(o){if(isNaN(i)&&!(o.type&O.MOVE_TO))throw new Error("path must start with moveto");var s=t(o,e,n,i,r);return o.type&O.CLOSE_PATH&&(e=i,n=r),void 0!==o.x&&(e=o.relative?e+o.x:o.x),void 0!==o.y&&(n=o.relative?n+o.y:o.y),o.type&O.MOVE_TO&&(i=e,r=n),s}}function o(t,e,n,i,o,s){return l(t,e,n,i,o,s),r(function(r,a,l,c){var h=r.x1,u=r.x2,d=r.relative&&!isNaN(c),p=void 0!==r.x?r.x:d?0:a,f=void 0!==r.y?r.y:d?0:l;function g(t){return t*t}r.type&O.HORIZ_LINE_TO&&0!==e&&(r.type=O.LINE_TO,r.y=r.relative?0:l),r.type&O.VERT_LINE_TO&&0!==n&&(r.type=O.LINE_TO,r.x=r.relative?0:a),void 0!==r.x&&(r.x=r.x*t+f*n+(d?0:o)),void 0!==r.y&&(r.y=p*e+r.y*i+(d?0:s)),void 0!==r.x1&&(r.x1=r.x1*t+r.y1*n+(d?0:o)),void 0!==r.y1&&(r.y1=h*e+r.y1*i+(d?0:s)),void 0!==r.x2&&(r.x2=r.x2*t+r.y2*n+(d?0:o)),void 0!==r.y2&&(r.y2=u*e+r.y2*i+(d?0:s));var m=t*i-e*n;if(void 0!==r.xRot&&(1!==t||0!==e||0!==n||1!==i))if(0===m)delete r.rX,delete r.rY,delete r.xRot,delete r.lArcFlag,delete r.sweepFlag,r.type=O.LINE_TO;else{var v=r.xRot*Math.PI/180,y=Math.sin(v),b=Math.cos(v),x=1/g(r.rX),w=1/g(r.rY),_=g(b)*x+g(y)*w,k=2*y*b*(x-w),S=g(y)*x+g(b)*w,E=_*i*i-k*e*i+S*e*e,C=k*(t*i+e*n)-2*(_*n*i+S*t*e),A=_*n*n-k*t*n+S*t*t,T=(Math.atan2(C,E-A)+Math.PI)%Math.PI/2,P=Math.sin(T),M=Math.cos(T);r.rX=Math.abs(m)/Math.sqrt(E*g(M)+C*P*M+A*g(P)),r.rY=Math.abs(m)/Math.sqrt(E*g(P)-C*P*M+A*g(M)),r.xRot=180*T/Math.PI}return void 0!==r.sweepFlag&&0>m&&(r.sweepFlag=+!r.sweepFlag),r})}t.ROUND=function(t){function e(e){return Math.round(e*t)/t}return void 0===t&&(t=1e13),l(t),function(t){return void 0!==t.x1&&(t.x1=e(t.x1)),void 0!==t.y1&&(t.y1=e(t.y1)),void 0!==t.x2&&(t.x2=e(t.x2)),void 0!==t.y2&&(t.y2=e(t.y2)),void 0!==t.x&&(t.x=e(t.x)),void 0!==t.y&&(t.y=e(t.y)),void 0!==t.rX&&(t.rX=e(t.rX)),void 0!==t.rY&&(t.rY=e(t.rY)),t}},t.TO_ABS=e,t.TO_REL=function(){return r(function(t,e,n){return t.relative||(void 0!==t.x1&&(t.x1-=e),void 0!==t.y1&&(t.y1-=n),void 0!==t.x2&&(t.x2-=e),void 0!==t.y2&&(t.y2-=n),void 0!==t.x&&(t.x-=e),void 0!==t.y&&(t.y-=n),t.relative=!0),t})},t.NORMALIZE_HVZ=function(t,e,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),r(function(i,r,o,s,a){if(isNaN(s)&&!(i.type&O.MOVE_TO))throw new Error("path must start with moveto");return e&&i.type&O.HORIZ_LINE_TO&&(i.type=O.LINE_TO,i.y=i.relative?0:o),n&&i.type&O.VERT_LINE_TO&&(i.type=O.LINE_TO,i.x=i.relative?0:r),t&&i.type&O.CLOSE_PATH&&(i.type=O.LINE_TO,i.x=i.relative?s-r:s,i.y=i.relative?a-o:a),i.type&O.ARC&&(0===i.rX||0===i.rY)&&(i.type=O.LINE_TO,delete i.rX,delete i.rY,delete i.xRot,delete i.lArcFlag,delete i.sweepFlag),i})},t.NORMALIZE_ST=n,t.QT_TO_C=i,t.INFO=r,t.SANITIZE=function(t){void 0===t&&(t=0),l(t);var e=NaN,n=NaN,i=NaN,o=NaN;return r(function(r,s,a,l,c){var h=Math.abs,u=!1,d=0,p=0;if(r.type&O.SMOOTH_CURVE_TO&&(d=isNaN(e)?0:s-e,p=isNaN(n)?0:a-n),r.type&(O.CURVE_TO|O.SMOOTH_CURVE_TO)?(e=r.relative?s+r.x2:r.x2,n=r.relative?a+r.y2:r.y2):(e=NaN,n=NaN),r.type&O.SMOOTH_QUAD_TO?(i=isNaN(i)?s:2*s-i,o=isNaN(o)?a:2*a-o):r.type&O.QUAD_TO?(i=r.relative?s+r.x1:r.x1,o=r.relative?a+r.y1:r.y2):(i=NaN,o=NaN),r.type&O.LINE_COMMANDS||r.type&O.ARC&&(0===r.rX||0===r.rY||!r.lArcFlag)||r.type&O.CURVE_TO||r.type&O.SMOOTH_CURVE_TO||r.type&O.QUAD_TO||r.type&O.SMOOTH_QUAD_TO){var f=void 0===r.x?0:r.relative?r.x:r.x-s,g=void 0===r.y?0:r.relative?r.y:r.y-a;d=isNaN(i)?void 0===r.x1?d:r.relative?r.x:r.x1-s:i-s,p=isNaN(o)?void 0===r.y1?p:r.relative?r.y:r.y1-a:o-a;var m=void 0===r.x2?0:r.relative?r.x:r.x2-s,v=void 0===r.y2?0:r.relative?r.y:r.y2-a;h(f)<=t&&h(g)<=t&&h(d)<=t&&h(p)<=t&&h(m)<=t&&h(v)<=t&&(u=!0)}return r.type&O.CLOSE_PATH&&h(s-l)<=t&&h(a-c)<=t&&(u=!0),u?[]:r})},t.MATRIX=o,t.ROTATE=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0),l(t,e,n);var i=Math.sin(t),r=Math.cos(t);return o(r,i,-i,r,e-e*r+n*i,n-e*i-n*r)},t.TRANSLATE=function(t,e){return void 0===e&&(e=0),l(t,e),o(1,0,0,1,t,e)},t.SCALE=function(t,e){return void 0===e&&(e=t),l(t,e),o(t,0,0,e,0,0)},t.SKEW_X=function(t){return l(t),o(1,0,Math.atan(t),1,0,0)},t.SKEW_Y=function(t){return l(t),o(1,Math.atan(t),0,1,0,0)},t.X_AXIS_SYMMETRY=function(t){return void 0===t&&(t=0),l(t),o(-1,0,0,1,t,0)},t.Y_AXIS_SYMMETRY=function(t){return void 0===t&&(t=0),l(t),o(1,0,0,-1,0,t)},t.A_TO_C=function(){return r(function(t,e,n){return O.ARC===t.type?function(t,e,n){var i,r,o,s;t.cX||h(t,e,n);for(var l=Math.min(t.phi1,t.phi2),c=Math.max(t.phi1,t.phi2)-l,u=Math.ceil(c/90),d=new Array(u),g=e,m=n,v=0;v<u;v++){var y=f(t.phi1,t.phi2,v/u),b=f(t.phi1,t.phi2,(v+1)/u),x=b-y,w=4/3*Math.tan(x*p/4),_=[Math.cos(y*p)-w*Math.sin(y*p),Math.sin(y*p)+w*Math.cos(y*p)],k=_[0],S=_[1],E=[Math.cos(b*p),Math.sin(b*p)],C=E[0],A=E[1],T=[C+w*Math.sin(b*p),A-w*Math.cos(b*p)],P=T[0],M=T[1];d[v]={relative:t.relative,type:O.CURVE_TO};var N=function(e,n){var i=a([e*t.rX,n*t.rY],t.xRot),r=i[0],o=i[1];return[t.cX+r,t.cY+o]};i=N(k,S),d[v].x1=i[0],d[v].y1=i[1],r=N(P,M),d[v].x2=r[0],d[v].y2=r[1],o=N(C,A),d[v].x=o[0],d[v].y=o[1],t.relative&&(d[v].x1-=g,d[v].y1-=m,d[v].x2-=g,d[v].y2-=m,d[v].x-=g,d[v].y-=m),g=(s=[d[v].x,d[v].y])[0],m=s[1]}return d}(t,t.relative?0:e,t.relative?0:n):t})},t.ANNOTATE_ARCS=function(){return r(function(t,e,n){return t.relative&&(e=0,n=0),O.ARC===t.type&&h(t,e,n),t})},t.CLONE=function(){return function(t){var e={};for(var n in t)e[n]=t[n];return e}},t.CALCULATE_BOUNDS=function(){var t=e(),o=i(),s=n(),a=r(function(e,n,i){var r=s(o(t(function(t){var e={};for(var n in t)e[n]=t[n];return e}(e))));function l(t){t>a.maxX&&(a.maxX=t),t<a.minX&&(a.minX=t)}function c(t){t>a.maxY&&(a.maxY=t),t<a.minY&&(a.minY=t)}if(r.type&O.DRAWING_COMMANDS&&(l(n),c(i)),r.type&O.HORIZ_LINE_TO&&l(r.x),r.type&O.VERT_LINE_TO&&c(r.y),r.type&O.LINE_TO&&(l(r.x),c(r.y)),r.type&O.CURVE_TO){l(r.x),c(r.y);for(var d=0,p=m(n,r.x1,r.x2,r.x);d<p.length;d++)0<(R=p[d])&&1>R&&l(v(n,r.x1,r.x2,r.x,R));for(var f=0,y=m(i,r.y1,r.y2,r.y);f<y.length;f++)0<(R=y[f])&&1>R&&c(v(i,r.y1,r.y2,r.y,R))}if(r.type&O.ARC){l(r.x),c(r.y),h(r,n,i);for(var b=r.xRot/180*Math.PI,x=Math.cos(b)*r.rX,w=Math.sin(b)*r.rX,_=-Math.sin(b)*r.rY,k=Math.cos(b)*r.rY,S=r.phi1<r.phi2?[r.phi1,r.phi2]:-180>r.phi2?[r.phi2+360,r.phi1+360]:[r.phi2,r.phi1],E=S[0],C=S[1],A=function(t){var e=t[0],n=t[1],i=180*Math.atan2(n,e)/Math.PI;return i<E?i+360:i},T=0,P=u(_,-x,0).map(A);T<P.length;T++)(R=P[T])>E&&R<C&&l(g(r.cX,x,_,R));for(var M=0,N=u(k,-w,0).map(A);M<N.length;M++){var R;(R=N[M])>E&&R<C&&c(g(r.cY,w,k,R))}}return e});return a.minX=1/0,a.maxX=-1/0,a.minY=1/0,a.maxY=-1/0,a}}(d||(d={}));var y,b=function(){function t(){}return t.prototype.round=function(t){return this.transform(d.ROUND(t))},t.prototype.toAbs=function(){return this.transform(d.TO_ABS())},t.prototype.toRel=function(){return this.transform(d.TO_REL())},t.prototype.normalizeHVZ=function(t,e,n){return this.transform(d.NORMALIZE_HVZ(t,e,n))},t.prototype.normalizeST=function(){return this.transform(d.NORMALIZE_ST())},t.prototype.qtToC=function(){return this.transform(d.QT_TO_C())},t.prototype.aToC=function(){return this.transform(d.A_TO_C())},t.prototype.sanitize=function(t){return this.transform(d.SANITIZE(t))},t.prototype.translate=function(t,e){return this.transform(d.TRANSLATE(t,e))},t.prototype.scale=function(t,e){return this.transform(d.SCALE(t,e))},t.prototype.rotate=function(t,e,n){return this.transform(d.ROTATE(t,e,n))},t.prototype.matrix=function(t,e,n,i,r,o){return this.transform(d.MATRIX(t,e,n,i,r,o))},t.prototype.skewX=function(t){return this.transform(d.SKEW_X(t))},t.prototype.skewY=function(t){return this.transform(d.SKEW_Y(t))},t.prototype.xSymmetry=function(t){return this.transform(d.X_AXIS_SYMMETRY(t))},t.prototype.ySymmetry=function(t){return this.transform(d.Y_AXIS_SYMMETRY(t))},t.prototype.annotateArcs=function(){return this.transform(d.ANNOTATE_ARCS())},t}(),x=function(t){return" "===t||"\t"===t||"\r"===t||"\n"===t},w=function(t){return"0".charCodeAt(0)<=t.charCodeAt(0)&&t.charCodeAt(0)<="9".charCodeAt(0)},_=function(t){function e(){var e=t.call(this)||this;return e.curNumber="",e.curCommandType=-1,e.curCommandRelative=!1,e.canParseCommandOrComma=!0,e.curNumberHasExp=!1,e.curNumberHasExpDigits=!1,e.curNumberHasDecimal=!1,e.curArgs=[],e}return s(e,t),e.prototype.finish=function(t){if(void 0===t&&(t=[]),this.parse(" ",t),0!==this.curArgs.length||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return t},e.prototype.parse=function(t,e){var n=this;void 0===e&&(e=[]);for(var i=function(t){e.push(t),n.curArgs.length=0,n.canParseCommandOrComma=!0},r=0;r<t.length;r++){var o=t[r],s=!(this.curCommandType!==O.ARC||3!==this.curArgs.length&&4!==this.curArgs.length||1!==this.curNumber.length||"0"!==this.curNumber&&"1"!==this.curNumber),a=w(o)&&("0"===this.curNumber&&"0"===o||s);if(!w(o)||a)if("e"!==o&&"E"!==o)if("-"!==o&&"+"!==o||!this.curNumberHasExp||this.curNumberHasExpDigits)if("."!==o||this.curNumberHasExp||this.curNumberHasDecimal||s){if(this.curNumber&&-1!==this.curCommandType){var l=Number(this.curNumber);if(isNaN(l))throw new SyntaxError("Invalid number ending at "+r);if(this.curCommandType===O.ARC)if(0===this.curArgs.length||1===this.curArgs.length){if(0>l)throw new SyntaxError('Expected positive number, got "'+l+'" at index "'+r+'"')}else if((3===this.curArgs.length||4===this.curArgs.length)&&"0"!==this.curNumber&&"1"!==this.curNumber)throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+r+'"');this.curArgs.push(l),this.curArgs.length===k[this.curCommandType]&&(O.HORIZ_LINE_TO===this.curCommandType?i({type:O.HORIZ_LINE_TO,relative:this.curCommandRelative,x:l}):O.VERT_LINE_TO===this.curCommandType?i({type:O.VERT_LINE_TO,relative:this.curCommandRelative,y:l}):this.curCommandType===O.MOVE_TO||this.curCommandType===O.LINE_TO||this.curCommandType===O.SMOOTH_QUAD_TO?(i({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),O.MOVE_TO===this.curCommandType&&(this.curCommandType=O.LINE_TO)):this.curCommandType===O.CURVE_TO?i({type:O.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===O.SMOOTH_CURVE_TO?i({type:O.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===O.QUAD_TO?i({type:O.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===O.ARC&&i({type:O.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!x(o))if(","===o&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if("+"!==o&&"-"!==o&&"."!==o)if(a)this.curNumber=o,this.curNumberHasDecimal=!1;else{if(0!==this.curArgs.length)throw new SyntaxError("Unterminated command at index "+r+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+o+'" at index '+r+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,"z"!==o&&"Z"!==o)if("h"===o||"H"===o)this.curCommandType=O.HORIZ_LINE_TO,this.curCommandRelative="h"===o;else if("v"===o||"V"===o)this.curCommandType=O.VERT_LINE_TO,this.curCommandRelative="v"===o;else if("m"===o||"M"===o)this.curCommandType=O.MOVE_TO,this.curCommandRelative="m"===o;else if("l"===o||"L"===o)this.curCommandType=O.LINE_TO,this.curCommandRelative="l"===o;else if("c"===o||"C"===o)this.curCommandType=O.CURVE_TO,this.curCommandRelative="c"===o;else if("s"===o||"S"===o)this.curCommandType=O.SMOOTH_CURVE_TO,this.curCommandRelative="s"===o;else if("q"===o||"Q"===o)this.curCommandType=O.QUAD_TO,this.curCommandRelative="q"===o;else if("t"===o||"T"===o)this.curCommandType=O.SMOOTH_QUAD_TO,this.curCommandRelative="t"===o;else{if("a"!==o&&"A"!==o)throw new SyntaxError('Unexpected character "'+o+'" at index '+r+".");this.curCommandType=O.ARC,this.curCommandRelative="a"===o}else e.push({type:O.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=o,this.curNumberHasDecimal="."===o}else this.curNumber+=o,this.curNumberHasDecimal=!0;else this.curNumber+=o;else this.curNumber+=o,this.curNumberHasExp=!0;else this.curNumber+=o,this.curNumberHasExpDigits=this.curNumberHasExp}return e},e.prototype.transform=function(t){return Object.create(this,{parse:{value:function(e,n){void 0===n&&(n=[]);for(var i=0,r=Object.getPrototypeOf(this).parse.call(this,e);i<r.length;i++){var o=r[i],s=t(o);Array.isArray(s)?n.push.apply(n,s):n.push(s)}return n}}})},e}(b),O=function(t){function e(n){var i=t.call(this)||this;return i.commands="string"==typeof n?e.parse(n):n,i}return s(e,t),e.prototype.encode=function(){return e.encode(this.commands)},e.prototype.getBounds=function(){var t=d.CALCULATE_BOUNDS();return this.transform(t),t},e.prototype.transform=function(t){for(var e=[],n=0,i=this.commands;n<i.length;n++){var r=t(i[n]);Array.isArray(r)?e.push.apply(e,r):e.push(r)}return this.commands=e,this},e.encode=function(t){return function(t){var e="";Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];if(i.type===O.CLOSE_PATH)e+="z";else if(i.type===O.HORIZ_LINE_TO)e+=(i.relative?"h":"H")+i.x;else if(i.type===O.VERT_LINE_TO)e+=(i.relative?"v":"V")+i.y;else if(i.type===O.MOVE_TO)e+=(i.relative?"m":"M")+i.x+" "+i.y;else if(i.type===O.LINE_TO)e+=(i.relative?"l":"L")+i.x+" "+i.y;else if(i.type===O.CURVE_TO)e+=(i.relative?"c":"C")+i.x1+" "+i.y1+" "+i.x2+" "+i.y2+" "+i.x+" "+i.y;else if(i.type===O.SMOOTH_CURVE_TO)e+=(i.relative?"s":"S")+i.x2+" "+i.y2+" "+i.x+" "+i.y;else if(i.type===O.QUAD_TO)e+=(i.relative?"q":"Q")+i.x1+" "+i.y1+" "+i.x+" "+i.y;else if(i.type===O.SMOOTH_QUAD_TO)e+=(i.relative?"t":"T")+i.x+" "+i.y;else{if(i.type!==O.ARC)throw new Error('Unexpected command type "'+i.type+'" at index '+n+".");e+=(i.relative?"a":"A")+i.rX+" "+i.rY+" "+i.xRot+" "+ +i.lArcFlag+" "+ +i.sweepFlag+" "+i.x+" "+i.y}}return e}(t)},e.parse=function(t){var e=new _,n=[];return e.parse(t,n),e.finish(n),n},e.CLOSE_PATH=1,e.MOVE_TO=2,e.HORIZ_LINE_TO=4,e.VERT_LINE_TO=8,e.LINE_TO=16,e.CURVE_TO=32,e.SMOOTH_CURVE_TO=64,e.QUAD_TO=128,e.SMOOTH_QUAD_TO=256,e.ARC=512,e.LINE_COMMANDS=e.LINE_TO|e.HORIZ_LINE_TO|e.VERT_LINE_TO,e.DRAWING_COMMANDS=e.HORIZ_LINE_TO|e.VERT_LINE_TO|e.LINE_TO|e.CURVE_TO|e.SMOOTH_CURVE_TO|e.QUAD_TO|e.SMOOTH_QUAD_TO|e.ARC,e}(b),k=((y={})[O.MOVE_TO]=2,y[O.LINE_TO]=2,y[O.HORIZ_LINE_TO]=1,y[O.VERT_LINE_TO]=1,y[O.CLOSE_PATH]=0,y[O.QUAD_TO]=4,y[O.SMOOTH_QUAD_TO]=2,y[O.CURVE_TO]=6,y[O.SMOOTH_CURVE_TO]=4,y[O.ARC]=7,y);function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}var E=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],C=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function A(t,e,n,i,r,o){if(!(isNaN(o)||o<1)){o|=0;var s=function(t,e,n,i,r){if("string"==typeof t&&(t=document.getElementById(t)),!t||"object"!==S(t)||!("getContext"in t))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var o=t.getContext("2d");try{return o.getImageData(e,n,i,r)}catch(t){throw new Error("unable to access image data: "+t)}}(t,e,n,i,r);s=function(t,e,n,i,r,o){for(var s,a=t.data,l=2*o+1,c=i-1,h=r-1,u=o+1,d=u*(u+1)/2,p=new T,f=p,g=1;g<l;g++)f=f.next=new T,g===u&&(s=f);f.next=p;for(var m=null,v=null,y=0,b=0,x=E[o],w=C[o],_=0;_<r;_++){f=p;for(var O=a[b],k=a[b+1],S=a[b+2],A=a[b+3],P=0;P<u;P++)f.r=O,f.g=k,f.b=S,f.a=A,f=f.next;for(var M=0,N=0,R=0,D=0,B=u*O,$=u*k,L=u*S,I=u*A,q=d*O,F=d*k,V=d*S,j=d*A,H=1;H<u;H++){var z=b+((c<H?c:H)<<2),Q=a[z],W=a[z+1],X=a[z+2],U=a[z+3],G=u-H;q+=(f.r=Q)*G,F+=(f.g=W)*G,V+=(f.b=X)*G,j+=(f.a=U)*G,M+=Q,N+=W,R+=X,D+=U,f=f.next}m=p,v=s;for(var Y=0;Y<i;Y++){var Z=j*x>>>w;if(a[b+3]=Z,0!==Z){var K=255/Z;a[b]=(q*x>>>w)*K,a[b+1]=(F*x>>>w)*K,a[b+2]=(V*x>>>w)*K}else a[b]=a[b+1]=a[b+2]=0;q-=B,F-=$,V-=L,j-=I,B-=m.r,$-=m.g,L-=m.b,I-=m.a;var J=Y+o+1;J=y+(J<c?J:c)<<2,q+=M+=m.r=a[J],F+=N+=m.g=a[J+1],V+=R+=m.b=a[J+2],j+=D+=m.a=a[J+3],m=m.next;var tt=v,et=tt.r,nt=tt.g,it=tt.b,rt=tt.a;B+=et,$+=nt,L+=it,I+=rt,M-=et,N-=nt,R-=it,D-=rt,v=v.next,b+=4}y+=i}for(var ot=0;ot<i;ot++){var st=a[b=ot<<2],at=a[b+1],lt=a[b+2],ct=a[b+3],ht=u*st,ut=u*at,dt=u*lt,pt=u*ct,ft=d*st,gt=d*at,mt=d*lt,vt=d*ct;f=p;for(var yt=0;yt<u;yt++)f.r=st,f.g=at,f.b=lt,f.a=ct,f=f.next;for(var bt=i,xt=0,wt=0,_t=0,Ot=0,kt=1;kt<=o;kt++){b=bt+ot<<2;var St=u-kt;ft+=(f.r=st=a[b])*St,gt+=(f.g=at=a[b+1])*St,mt+=(f.b=lt=a[b+2])*St,vt+=(f.a=ct=a[b+3])*St,Ot+=st,xt+=at,wt+=lt,_t+=ct,f=f.next,kt<h&&(bt+=i)}b=ot,m=p,v=s;for(var Et=0;Et<r;Et++){var Ct=b<<2;a[Ct+3]=ct=vt*x>>>w,ct>0?(ct=255/ct,a[Ct]=(ft*x>>>w)*ct,a[Ct+1]=(gt*x>>>w)*ct,a[Ct+2]=(mt*x>>>w)*ct):a[Ct]=a[Ct+1]=a[Ct+2]=0,ft-=ht,gt-=ut,mt-=dt,vt-=pt,ht-=m.r,ut-=m.g,dt-=m.b,pt-=m.a,Ct=ot+((Ct=Et+u)<h?Ct:h)*i<<2,ft+=Ot+=m.r=a[Ct],gt+=xt+=m.g=a[Ct+1],mt+=wt+=m.b=a[Ct+2],vt+=_t+=m.a=a[Ct+3],m=m.next,ht+=st=v.r,ut+=at=v.g,dt+=lt=v.b,pt+=ct=v.a,Ot-=st,xt-=at,wt-=lt,_t-=ct,v=v.next,b+=i}}return t}(s,0,0,i,r,o),t.getContext("2d").putImageData(s,e,n)}}var T=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};function P(t){return t.replace(/(?!\u3000)\s+/gm," ")}function M(t){const e=t.match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm);return e?e.map(parseFloat):[]}const N=/^[A-Z-]+$/;function R(t){const e=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(t);return e&&(e[2]||e[3]||e[4])||""}const D=/(\[[^\]]+\])/g,B=/(#[^\s+>~.[:]+)/g,$=/(\.[^\s+>~.[:]+)/g,L=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,I=/(:[\w-]+\([^)]*\))/gi,q=/(:[^\s+>~.[:]+)/g,F=/([^\s+>~.[:]+)/g;function V(t,e){const n=e.exec(t);return n?[t.replace(e," "),n.length]:[t,0]}const j=1e-8;function H(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))}function z(t,e){return(t[0]*e[0]+t[1]*e[1])/(H(t)*H(e))}function Q(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(z(t,e))}function W(t){return t*t*t}function X(t){return 3*t*t*(1-t)}function U(t){return 3*t*(1-t)*(1-t)}function G(t){return(1-t)*(1-t)*(1-t)}function Y(t){return t*t}function Z(t){return 2*t*(1-t)}function K(t){return(1-t)*(1-t)}class J{static empty(t){return new J(t,"EMPTY","")}split(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:" ";const{document:e,name:n}=this;return P(this.getString()).trim().split(t).map(t=>new J(e,n,t))}hasValue(t){const e=this.value;return null!==e&&""!==e&&(t||0!==e)&&void 0!==e}isString(t){const{value:e}=this,n="string"==typeof e;return n&&t?t.test(e):n}isUrlDefinition(){return this.isString(/^url\(/)}isPixels(){if(!this.hasValue())return!1;const t=this.getString();switch(!0){case t.endsWith("px"):case/^[0-9]+$/.test(t):return!0;default:return!1}}setValue(t){return this.value=t,this}getValue(t){return void 0===t||this.hasValue()?this.value:t}getNumber(t){if(!this.hasValue())return void 0===t?0:parseFloat(t);const{value:e}=this;let n=parseFloat(e);return this.isString(/%$/)&&(n/=100),n}getString(t){return void 0===t||this.hasValue()?void 0===this.value?"":String(this.value):String(t)}getColor(t){let e=this.getString(t);return this.isNormalizedColor||(this.isNormalizedColor=!0,e=function(t){if(!t.startsWith("rgb"))return t;let e=3;return t.replace(/\d+(\.\d+)?/g,(t,n)=>e--&&n?String(Math.round(parseFloat(t))):t)}(e),this.value=e),e}getDpi(){return 96}getRem(){return this.document.rootEmSize}getEm(){return this.document.emSize}getUnits(){return this.getString().replace(/[0-9.-]/g,"")}getPixels(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.hasValue())return 0;const[n,i]="boolean"==typeof t?[void 0,t]:[t],{viewPort:r}=this.document.screen;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(r.computeSize("x"),r.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(r.computeSize("x"),r.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*r.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*r.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return 15*this.getNumber();case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case this.isString(/%$/)&&i:return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*r.computeSize(n);default:{const t=this.getNumber();return e&&t<1?t*r.computeSize(n):t}}}getMilliseconds(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():1e3*this.getNumber():0}getRadians(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}getDefinition(){const t=this.getString(),e=/#([^)'"]+)/.exec(t),n=(null==e?void 0:e[1])||t;return this.document.definitions.get(n)}getFillStyleDefinition(t,e){let n=this.getDefinition();if(!n)return null;if("function"==typeof n.createGradient&&"getBoundingBox"in t)return n.createGradient(this.document.ctx,t,e);if("function"==typeof n.createPattern){if(n.getHrefAttribute().hasValue()){const t=n.getAttribute("patternTransform");n=n.getHrefAttribute().getDefinition(),n&&t.hasValue()&&n.getAttribute("patternTransform",!0).setValue(t.value)}if(n)return n.createPattern(this.document.ctx,t,e)}return null}getTextBaseline(){if(!this.hasValue())return null;const t=this.getString();return J.textBaselineMapping[t]||null}addOpacity(t){let e=this.getColor();const n=e.length;let i=0;for(let t=0;t<n&&(","===e[t]&&i++,3!==i);t++);if(t.hasValue()&&this.isString()&&3!==i){const n=new r(e);n.ok&&(n.alpha=t.getNumber(),e=n.toRGBA())}return new J(this.document,this.name,e)}constructor(t,e,n){this.document=t,this.name=e,this.value=n,this.isNormalizedColor=!1}}J.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};class tt{clear(){this.viewPorts=[]}setCurrent(t,e){this.viewPorts.push({width:t,height:e})}removeCurrent(){this.viewPorts.pop()}getRoot(){const[t]=this.viewPorts;return t||et()}getCurrent(){const{viewPorts:t}=this;return t[t.length-1]||et()}get width(){return this.getCurrent().width}get height(){return this.getCurrent().height}computeSize(t){return"number"==typeof t?t:"x"===t?this.width:"y"===t?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}constructor(){this.viewPorts=[]}}function et(){return{width:tt.DEFAULT_VIEWPORT_WIDTH,height:tt.DEFAULT_VIEWPORT_HEIGHT}}tt.DEFAULT_VIEWPORT_WIDTH=800,tt.DEFAULT_VIEWPORT_HEIGHT=600;class nt{static parse(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const[n=e,i=e]=M(t);return new nt(n,i)}static parseScale(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const[n=e,i=n]=M(t);return new nt(n,i)}static parsePath(t){const e=M(t),n=e.length,i=[];for(let t=0;t<n;t+=2)i.push(new nt(e[t],e[t+1]));return i}angleTo(t){return Math.atan2(t.y-this.y,t.x-this.x)}applyTransform(t){const{x:e,y:n}=this,i=e*t[0]+n*t[2]+t[4],r=e*t[1]+n*t[3]+t[5];this.x=i,this.y=r}constructor(t,e){this.x=t,this.y=e}}class it{isWorking(){return this.working}start(){if(this.working)return;const{screen:t,onClick:e,onMouseMove:n}=this,i=t.ctx.canvas;i.onclick=e,i.onmousemove=n,this.working=!0}stop(){if(!this.working)return;const t=this.screen.ctx.canvas;this.working=!1,t.onclick=null,t.onmousemove=null}hasEvents(){return this.working&&this.events.length>0}runEvents(){if(!this.working)return;const{screen:t,events:e,eventElements:n}=this,{style:i}=t.ctx.canvas;let r;i&&(i.cursor=""),e.forEach((t,e)=>{let{run:i}=t;for(r=n[e];r;)i(r),r=r.parent}),this.events=[],this.eventElements=[]}checkPath(t,e){if(!this.working||!e)return;const{events:n,eventElements:i}=this;n.forEach((n,r)=>{let{x:o,y:s}=n;!i[r]&&e.isPointInPath&&e.isPointInPath(o,s)&&(i[r]=t)})}checkBoundingBox(t,e){if(!this.working||!e)return;const{events:n,eventElements:i}=this;n.forEach((n,r)=>{let{x:o,y:s}=n;!i[r]&&e.isPointInBox(o,s)&&(i[r]=t)})}mapXY(t,e){const{window:n,ctx:i}=this.screen,r=new nt(t,e);let o=i.canvas;for(;o;)r.x-=o.offsetLeft,r.y-=o.offsetTop,o=o.offsetParent;return(null==n?void 0:n.scrollX)&&(r.x+=n.scrollX),(null==n?void 0:n.scrollY)&&(r.y+=n.scrollY),r}onClick(t){const{x:e,y:n}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onclick",x:e,y:n,run(t){t.onClick&&t.onClick()}})}onMouseMove(t){const{x:e,y:n}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onmousemove",x:e,y:n,run(t){t.onMouseMove&&t.onMouseMove()}})}constructor(t){this.screen=t,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}}const rt="undefined"!=typeof window?window:null,ot="undefined"!=typeof fetch?fetch.bind(void 0):void 0;class st{wait(t){this.waits.push(t)}ready(){return this.readyPromise?this.readyPromise:Promise.resolve()}isReady(){if(this.isReadyLock)return!0;const t=this.waits.every(t=>t());return t&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=t,t}setDefaults(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4}setViewBox(t){let{document:e,ctx:n,aspectRatio:i,width:r,desiredWidth:o,height:s,desiredHeight:a,minX:l=0,minY:c=0,refX:h,refY:u,clip:d=!1,clipX:p=0,clipY:f=0}=t;const g=P(i).replace(/^defer\s/,""),[m,v]=g.split(" "),y=m||"xMidYMid",b=v||"meet",x=r/o,w=s/a,_=Math.min(x,w),O=Math.max(x,w);let k=o,S=a;"meet"===b&&(k*=_,S*=_),"slice"===b&&(k*=O,S*=O);const E=new J(e,"refX",h),C=new J(e,"refY",u),A=E.hasValue()&&C.hasValue();if(A&&n.translate(-_*E.getPixels("x"),-_*C.getPixels("y")),d){const t=_*p,e=_*f;n.beginPath(),n.moveTo(t,e),n.lineTo(r,e),n.lineTo(r,s),n.lineTo(t,s),n.closePath(),n.clip()}if(!A){const t="meet"===b&&_===w,e="slice"===b&&O===w,i="meet"===b&&_===x,o="slice"===b&&O===x;y.startsWith("xMid")&&(t||e)&&n.translate(r/2-k/2,0),y.endsWith("YMid")&&(i||o)&&n.translate(0,s/2-S/2),y.startsWith("xMax")&&(t||e)&&n.translate(r-k,0),y.endsWith("YMax")&&(i||o)&&n.translate(0,s-S)}switch(!0){case"none"===y:n.scale(x,w);break;case"meet"===b:n.scale(_,_);break;case"slice"===b:n.scale(O,O)}n.translate(-l,-c)}start(t){let{enableRedraw:e=!1,ignoreMouse:n=!1,ignoreAnimation:r=!1,ignoreDimensions:o=!1,ignoreClear:s=!1,forceRedraw:a,scaleWidth:l,scaleHeight:c,offsetX:h,offsetY:u}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{mouse:d}=this,p=1e3/st.FRAMERATE;if(this.isReadyLock=!1,this.frameDuration=p,this.readyPromise=new Promise(t=>{this.resolveReady=t}),this.isReady()&&this.render(t,o,s,l,c,h,u),!e)return;let f=Date.now(),g=f,m=0;const v=()=>{f=Date.now(),m=f-g,m>=p&&(g=f-m%p,this.shouldUpdate(r,a)&&(this.render(t,o,s,l,c,h,u),d.runEvents())),this.intervalId=i(v)};n||d.start(),this.intervalId=i(v)}stop(){this.intervalId&&(i.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}shouldUpdate(t,e){if(!t){const{frameDuration:t}=this;if(this.animations.reduce((e,n)=>n.update(t)||e,!1))return!0}return!("function"!=typeof e||!e())||!(this.isReadyLock||!this.isReady())||!!this.mouse.hasEvents()}render(t,e,n,i,r,o,s){const{viewPort:a,ctx:l,isFirstRender:c}=this,h=l.canvas;a.clear(),h.width&&h.height&&a.setCurrent(h.width,h.height);const u=t.getStyle("width"),d=t.getStyle("height");!e&&(c||"number"!=typeof i&&"number"!=typeof r)&&(u.hasValue()&&(h.width=u.getPixels("x"),h.style&&(h.style.width="".concat(h.width,"px"))),d.hasValue()&&(h.height=d.getPixels("y"),h.style&&(h.style.height="".concat(h.height,"px"))));let p=h.clientWidth||h.width,f=h.clientHeight||h.height;if(e&&u.hasValue()&&d.hasValue()&&(p=u.getPixels("x"),f=d.getPixels("y")),a.setCurrent(p,f),"number"==typeof o&&t.getAttribute("x",!0).setValue(o),"number"==typeof s&&t.getAttribute("y",!0).setValue(s),"number"==typeof i||"number"==typeof r){const e=M(t.getAttribute("viewBox").getString());let n=0,o=0;if("number"==typeof i){const r=t.getStyle("width");r.hasValue()?n=r.getPixels("x")/i:e[2]&&!isNaN(e[2])&&(n=e[2]/i)}if("number"==typeof r){const n=t.getStyle("height");n.hasValue()?o=n.getPixels("y")/r:e[3]&&!isNaN(e[3])&&(o=e[3]/r)}n||(n=o),o||(o=n),t.getAttribute("width",!0).setValue(i),t.getAttribute("height",!0).setValue(r);const s=t.getStyle("transform",!0,!0);s.setValue("".concat(s.getString()," scale(").concat(1/n,", ").concat(1/o,")"))}n||l.clearRect(0,0,p,f),t.render(l),c&&(this.isFirstRender=!1)}constructor(t,{fetch:e=ot,window:n=rt}={}){if(this.ctx=t,this.viewPort=new tt,this.mouse=new it(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=n,!e)throw new Error("Can't find 'fetch' in 'globalThis', please provide it via options");this.fetch=e}}st.defaultWindow=rt,st.defaultFetch=ot,st.FRAMERATE=30,st.MAX_VIRTUAL_PIXELS=3e4;const{defaultFetch:at}=st,lt="undefined"!=typeof DOMParser?DOMParser:void 0;class ct{async parse(t){return t.startsWith("<")?this.parseFromString(t):this.load(t)}parseFromString(t){const e=new this.DOMParser;try{return this.checkDocument(e.parseFromString(t,"image/svg+xml"))}catch(n){return this.checkDocument(e.parseFromString(t,"text/xml"))}}checkDocument(t){const e=t.getElementsByTagName("parsererror")[0];if(e)throw new Error(e.textContent||"Unknown parse error");return t}async load(t){const e=await this.fetch(t),n=await e.text();return this.parseFromString(n)}constructor({fetch:t=at,DOMParser:e=lt}={}){if(!t)throw new Error("Can't find 'fetch' in 'globalThis', please provide it via options");if(!e)throw new Error("Can't find 'DOMParser' in 'globalThis', please provide it via options");this.fetch=t,this.DOMParser=e}}class ht{apply(t){const{originX:e,originY:n,matrix:i}=this,r=e.getPixels("x"),o=n.getPixels("y");t.translate(r,o),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),t.translate(-r,-o)}unapply(t){const{originX:e,originY:n,matrix:i}=this,r=i[0],o=i[2],s=i[4],a=i[1],l=i[3],c=i[5],h=1/(r*(1*l-0*c)-o*(1*a-0*c)+s*(0*a-0*l)),u=e.getPixels("x"),d=n.getPixels("y");t.translate(u,d),t.transform(h*(1*l-0*c),h*(0*c-1*a),h*(0*s-1*o),h*(1*r-0*s),h*(o*c-s*l),h*(s*a-r*c)),t.translate(-u,-d)}applyToPoint(t){t.applyTransform(this.matrix)}constructor(t,e,n){this.type="matrix",this.matrix=function(t){const e=M(t);return[e[0]||0,e[1]||0,e[2]||0,e[3]||0,e[4]||0,e[5]||0]}(e),this.originX=n[0],this.originY=n[1]}}class ut extends ht{constructor(t,e,n){super(t,e,n),this.type="skew",this.angle=new J(t,"angle",e)}}class dt{static fromElement(t,e){const n=e.getStyle("transform",!1,!0);if(n.hasValue()){const[i,r=i]=e.getStyle("transform-origin",!1,!0).split();if(i&&r){const e=[i,r];return new dt(t,n.getString(),e)}}return null}apply(t){this.transforms.forEach(e=>e.apply(t))}unapply(t){this.transforms.forEach(e=>e.unapply(t))}applyToPoint(t){this.transforms.forEach(e=>e.applyToPoint(t))}constructor(t,e,n){this.document=t,this.transforms=[],P(e).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/).forEach(t=>{if("none"===t)return;const[e,i]=function(t){const[e="",n=""]=t.split("(");return[e.trim(),n.trim().replace(")","")]}(t),r=dt.transformTypes[e];r&&this.transforms.push(new r(this.document,i,n))})}}dt.transformTypes={translate:class{apply(t){const{x:e,y:n}=this.point;t.translate(e||0,n||0)}unapply(t){const{x:e,y:n}=this.point;t.translate(-1*e||0,-1*n||0)}applyToPoint(t){const{x:e,y:n}=this.point;t.applyTransform([1,0,0,1,e||0,n||0])}constructor(t,e){this.type="translate",this.point=nt.parse(e)}},rotate:class{apply(t){const{cx:e,cy:n,originX:i,originY:r,angle:o}=this,s=e+i.getPixels("x"),a=n+r.getPixels("y");t.translate(s,a),t.rotate(o.getRadians()),t.translate(-s,-a)}unapply(t){const{cx:e,cy:n,originX:i,originY:r,angle:o}=this,s=e+i.getPixels("x"),a=n+r.getPixels("y");t.translate(s,a),t.rotate(-1*o.getRadians()),t.translate(-s,-a)}applyToPoint(t){const{cx:e,cy:n,angle:i}=this,r=i.getRadians();t.applyTransform([1,0,0,1,e||0,n||0]),t.applyTransform([Math.cos(r),Math.sin(r),-Math.sin(r),Math.cos(r),0,0]),t.applyTransform([1,0,0,1,-e||0,-n||0])}constructor(t,e,n){this.type="rotate";const i=M(e);this.angle=new J(t,"angle",i[0]),this.originX=n[0],this.originY=n[1],this.cx=i[1]||0,this.cy=i[2]||0}},scale:class{apply(t){const{scale:{x:e,y:n},originX:i,originY:r}=this,o=i.getPixels("x"),s=r.getPixels("y");t.translate(o,s),t.scale(e,n||e),t.translate(-o,-s)}unapply(t){const{scale:{x:e,y:n},originX:i,originY:r}=this,o=i.getPixels("x"),s=r.getPixels("y");t.translate(o,s),t.scale(1/e,1/n||e),t.translate(-o,-s)}applyToPoint(t){const{x:e,y:n}=this.scale;t.applyTransform([e||0,0,0,n||0,0,0])}constructor(t,e,n){this.type="scale";const i=nt.parseScale(e);0!==i.x&&0!==i.y||(i.x=j,i.y=j),this.scale=i,this.originX=n[0],this.originY=n[1]}},matrix:ht,skewX:class extends ut{constructor(t,e,n){super(t,e,n),this.type="skewX",this.matrix=[1,0,Math.tan(this.angle.getRadians()),1,0,0]}},skewY:class extends ut{constructor(t,e,n){super(t,e,n),this.type="skewY",this.matrix=[1,Math.tan(this.angle.getRadians()),0,1,0,0]}}};class pt{getAttribute(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.attributes.get(t);if(!n&&e){const e=new J(this.document,t,"");return this.attributes.set(t,e),e}return n||J.empty(this.document)}getHrefAttribute(){let t;for(const[e,n]of this.attributes)if("href"===e||e.endsWith(":href")){t=n;break}return t||J.empty(this.document)}getStyle(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.styles.get(t);if(i)return i;const r=this.getAttribute(t);if(r.hasValue())return this.styles.set(t,r),r;if(!n){const{parent:e}=this;if(e){const n=e.getStyle(t);if(n.hasValue())return n}}if(e){const e=new J(this.document,t,"");return this.styles.set(t,e),e}return J.empty(this.document)}render(t){if("none"!==this.getStyle("display").getString()&&"hidden"!==this.getStyle("visibility").getString()){if(t.save(),this.getStyle("mask").hasValue()){const e=this.getStyle("mask").getDefinition();e&&(this.applyEffects(t),e.apply(t,this))}else if("none"!==this.getStyle("filter").getValue("none")){const e=this.getStyle("filter").getDefinition();e&&(this.applyEffects(t),e.apply(t,this))}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}}setContext(t){}applyEffects(t){const e=dt.fromElement(this.document,this);e&&e.apply(t);const n=this.getStyle("clip-path",!1,!0);if(n.hasValue()){const e=n.getDefinition();e&&e.apply(t)}}clearContext(t){}renderChildren(t){this.children.forEach(e=>{e.render(t)})}addChild(t){const e=t instanceof pt?t:this.document.createElement(t);e.parent=this,pt.ignoreChildTypes.includes(e.type)||this.children.push(e)}matchesSelector(t){var e;const{node:n}=this;if("function"==typeof n.matches)return n.matches(t);const i=null===(e=n.getAttribute)||void 0===e?void 0:e.call(n,"class");return!(!i||""===i)&&i.split(" ").some(e=>".".concat(e)===t)}addStylesFromStyleDefinition(){const{styles:t,stylesSpecificity:e}=this.document;for(const[n,i]of t)if(!n.startsWith("@")&&this.matchesSelector(n)){const t=e.get(n);if(i)for(const[e,n]of i){let i=this.stylesSpecificity.get(e);void 0===i&&(i="000"),t&&t>=i&&(n&&this.styles.set(e,n),this.stylesSpecificity.set(e,t))}}}removeStyles(t,e){return e.reduce((e,n)=>{const i=t.getStyle(n);if(!i.hasValue())return e;const r=i.getString();return i.setValue(""),[...e,[n,r]]},[])}restoreStyles(t,e){e.forEach(e=>{let[n,i]=e;t.getStyle(n,!0).setValue(i)})}isFirstChild(){var t;return 0===(null===(t=this.parent)||void 0===t?void 0:t.children.indexOf(this))}constructor(t,e,n=!1){if(this.document=t,this.node=e,this.captureTextNodes=n,this.type="",this.attributes=new Map,this.styles=new Map,this.stylesSpecificity=new Map,this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],!e||1!==e.nodeType)return;if(Array.from(e.attributes).forEach(e=>{const n=(i=e.nodeName,N.test(i)?i.toLowerCase():i);var i;this.attributes.set(n,new J(t,n,e.value))}),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()){const e=this.getAttribute("style").getString().split(";").map(t=>t.trim());e.forEach(e=>{if(!e)return;const[n,i]=e.split(":").map(t=>t.trim());n&&this.styles.set(n,new J(t,n,i))})}const{definitions:i}=t,r=this.getAttribute("id");r.hasValue()&&(i.has(r.getString())||i.set(r.getString(),this)),Array.from(e.childNodes).forEach(e=>{if(1===e.nodeType)this.addChild(e);else if(n&&(3===e.nodeType||4===e.nodeType)){const n=t.createTextNode(e);n.getText().length>0&&this.addChild(n)}})}}pt.ignoreChildTypes=["title"];class ft extends pt{constructor(t,e,n){super(t,e,n)}}function gt(t){const e=t.trim();return/^('|")/.test(e)?e:'"'.concat(e,'"')}function mt(t){if(!t)return"";const e=t.trim().toLowerCase();switch(e){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return e;default:return/^oblique\s+(-|)\d+deg$/.test(e)?e:""}}function vt(t){if(!t)return"";const e=t.trim().toLowerCase();switch(e){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return e;default:return/^[\d.]+$/.test(e)?e:""}}class yt{static parse(){let t=arguments.length>1?arguments[1]:void 0,e="",n="",i="",r="",o="";const s=P(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim().split(" "),a={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return s.forEach(t=>{switch(!0){case!a.fontStyle&&yt.styles.includes(t):"inherit"!==t&&(e=t),a.fontStyle=!0;break;case!a.fontVariant&&yt.variants.includes(t):"inherit"!==t&&(n=t),a.fontStyle=!0,a.fontVariant=!0;break;case!a.fontWeight&&yt.weights.includes(t):"inherit"!==t&&(i=t),a.fontStyle=!0,a.fontVariant=!0,a.fontWeight=!0;break;case!a.fontSize:"inherit"!==t&&(r=t.split("/")[0]||""),a.fontStyle=!0,a.fontVariant=!0,a.fontWeight=!0,a.fontSize=!0;break;default:"inherit"!==t&&(o+=t)}}),new yt(e,n,i,r,o,t)}toString(){return[mt(this.fontStyle),this.fontVariant,vt(this.fontWeight),this.fontSize,(t=this.fontFamily,"undefined"==typeof process?t:t.trim().split(",").map(gt).join(","))].join(" ").trim();var t}constructor(t,e,n,i,r,o){const s=o?"string"==typeof o?yt.parse(o):o:{};this.fontFamily=r||s.fontFamily,this.fontSize=i||s.fontSize,this.fontStyle=t||s.fontStyle,this.fontWeight=n||s.fontWeight,this.fontVariant=e||s.fontVariant}}yt.styles="normal|italic|oblique|inherit",yt.variants="normal|small-caps|inherit",yt.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";class bt{get x(){return this.x1}get y(){return this.y1}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}addPoint(t,e){void 0!==t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),void 0!==e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))}addX(t){this.addPoint(t,0)}addY(t){this.addPoint(0,t)}addBoundingBox(t){if(!t)return;const{x1:e,y1:n,x2:i,y2:r}=t;this.addPoint(e,n),this.addPoint(i,r)}sumCubic(t,e,n,i,r){return Math.pow(1-t,3)*e+3*Math.pow(1-t,2)*t*n+3*(1-t)*Math.pow(t,2)*i+Math.pow(t,3)*r}bezierCurveAdd(t,e,n,i,r){const o=6*e-12*n+6*i,s=-3*e+9*n-9*i+3*r,a=3*n-3*e;if(0===s){if(0===o)return;const s=-a/o;return void(0<s&&s<1&&(t?this.addX(this.sumCubic(s,e,n,i,r)):this.addY(this.sumCubic(s,e,n,i,r))))}const l=Math.pow(o,2)-4*a*s;if(l<0)return;const c=(-o+Math.sqrt(l))/(2*s);0<c&&c<1&&(t?this.addX(this.sumCubic(c,e,n,i,r)):this.addY(this.sumCubic(c,e,n,i,r)));const h=(-o-Math.sqrt(l))/(2*s);0<h&&h<1&&(t?this.addX(this.sumCubic(h,e,n,i,r)):this.addY(this.sumCubic(h,e,n,i,r)))}addBezierCurve(t,e,n,i,r,o,s,a){this.addPoint(t,e),this.addPoint(s,a),this.bezierCurveAdd(!0,t,n,r,s),this.bezierCurveAdd(!1,e,i,o,a)}addQuadraticCurve(t,e,n,i,r,o){const s=t+2/3*(n-t),a=e+2/3*(i-e),l=s+1/3*(r-t),c=a+1/3*(o-e);this.addBezierCurve(t,e,s,l,a,c,r,o)}isPointInBox(t,e){const{x1:n,y1:i,x2:r,y2:o}=this;return n<=t&&t<=r&&i<=e&&e<=o}constructor(t=Number.NaN,e=Number.NaN,n=Number.NaN,i=Number.NaN){this.x1=t,this.y1=e,this.x2=n,this.y2=i,this.addPoint(t,e),this.addPoint(n,i)}}class xt extends pt{calculateOpacity(){let t=1,e=this;for(;e;){const n=e.getStyle("opacity",!1,!0);n.hasValue(!0)&&(t*=n.getNumber()),e=e.parent}return t}setContext(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e){const e=this.getStyle("fill"),n=this.getStyle("fill-opacity"),i=this.getStyle("stroke"),r=this.getStyle("stroke-opacity");if(e.isUrlDefinition()){const i=e.getFillStyleDefinition(this,n);i&&(t.fillStyle=i)}else if(e.hasValue()){"currentColor"===e.getString()&&e.setValue(this.getStyle("color").getColor());const n=e.getColor();"inherit"!==n&&(t.fillStyle="none"===n?"rgba(0,0,0,0)":n)}if(n.hasValue()){const e=new J(this.document,"fill",t.fillStyle).addOpacity(n).getColor();t.fillStyle=e}if(i.isUrlDefinition()){const e=i.getFillStyleDefinition(this,r);e&&(t.strokeStyle=e)}else if(i.hasValue()){"currentColor"===i.getString()&&i.setValue(this.getStyle("color").getColor());const e=i.getString();"inherit"!==e&&(t.strokeStyle="none"===e?"rgba(0,0,0,0)":e)}if(r.hasValue()){const e=new J(this.document,"stroke",t.strokeStyle).addOpacity(r).getString();t.strokeStyle=e}const o=this.getStyle("stroke-width");if(o.hasValue()){const e=o.getPixels();t.lineWidth=e||j}const s=this.getStyle("stroke-linecap"),a=this.getStyle("stroke-linejoin"),l=this.getStyle("stroke-miterlimit"),c=this.getStyle("stroke-dasharray"),h=this.getStyle("stroke-dashoffset");if(s.hasValue()&&(t.lineCap=s.getString()),a.hasValue()&&(t.lineJoin=a.getString()),l.hasValue()&&(t.miterLimit=l.getNumber()),c.hasValue()&&"none"!==c.getString()){const e=M(c.getString());void 0!==t.setLineDash?t.setLineDash(e):void 0!==t.webkitLineDash?t.webkitLineDash=e:void 0===t.mozDash||1===e.length&&0===e[0]||(t.mozDash=e);const n=h.getPixels();void 0!==t.lineDashOffset?t.lineDashOffset=n:void 0!==t.webkitLineDashOffset?t.webkitLineDashOffset=n:void 0!==t.mozDashOffset&&(t.mozDashOffset=n)}}if(this.modifiedEmSizeStack=!1,void 0!==t.font){const e=this.getStyle("font"),n=this.getStyle("font-style"),i=this.getStyle("font-variant"),r=this.getStyle("font-weight"),o=this.getStyle("font-size"),s=this.getStyle("font-family"),a=new yt(n.getString(),i.getString(),r.getString(),o.hasValue()?"".concat(o.getPixels(!0),"px"):"",s.getString(),yt.parse(e.getString(),t.font));n.setValue(a.fontStyle),i.setValue(a.fontVariant),r.setValue(a.fontWeight),o.setValue(a.fontSize),s.setValue(a.fontFamily),t.font=a.toString(),o.isPixels()&&(this.document.emSize=o.getPixels(),this.modifiedEmSizeStack=!0)}e||(this.applyEffects(t),t.globalAlpha=this.calculateOpacity())}clearContext(t){super.clearContext(t),this.modifiedEmSizeStack&&this.document.popEmSize()}constructor(...t){super(...t),this.modifiedEmSizeStack=!1}}class wt extends xt{setContext(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.setContext(t,e);const n=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();n&&(t.textBaseline=n)}initializeCoordinates(){this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY}getBoundingBox(t){if("text"!==this.type)return this.getTElementBoundingBox(t);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t);let e=null;return this.children.forEach((n,i)=>{const r=this.getChildBoundingBox(t,this,this,i);e?e.addBoundingBox(r):e=r}),e}getFontSize(){const{document:t,parent:e}=this,n=yt.parse(t.ctx.font).fontSize;return e.getStyle("font-size").getNumber(n)}getTElementBoundingBox(t){const e=this.getFontSize();return new bt(this.x,this.y-e,this.x+this.measureText(t),this.y)}getGlyph(t,e,n){const i=e[n];let r;if(t.isArabic){var o;const s=e.length,a=e[n-1],l=e[n+1];let c="isolated";(0===n||" "===a)&&n<s-1&&" "!==l&&(c="terminal"),n>0&&" "!==a&&n<s-1&&" "!==l&&(c="medial"),n>0&&" "!==a&&(n===s-1||" "===l)&&(c="initial"),r=(null===(o=t.arabicGlyphs.get(i))||void 0===o?void 0:o.get(c))||t.glyphs.get(i)}else r=t.glyphs.get(i);return r||(r=t.missingGlyph),r}getText(){return""}getTextFromNode(t){const e=t||this.node,n=Array.from(e.parentNode.childNodes),i=n.indexOf(e),r=n.length-1;let o=P(e.textContent||"");return 0===i&&(o=o.replace(/^[\n \t]+/,"")),i===r&&(o=o.replace(/[\n \t]+$/,"")),o}renderChildren(t){if("text"!==this.type)return void this.renderTElementChildren(t);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t),this.children.forEach((e,n)=>{this.renderChild(t,this,this,n)});const{mouse:e}=this.document.screen;e.isWorking()&&e.checkBoundingBox(this,this.getBoundingBox(t))}renderTElementChildren(t){const{document:e,parent:n}=this,i=this.getText(),r=n.getStyle("font-family").getDefinition();if(r){const{unitsPerEm:o}=r.fontFace,s=yt.parse(e.ctx.font),a=n.getStyle("font-size").getNumber(s.fontSize),l=n.getStyle("font-style").getString(s.fontStyle),c=a/o,h=r.isRTL?i.split("").reverse().join(""):i,u=M(n.getAttribute("dx").getString()),d=h.length;for(let e=0;e<d;e++){const n=this.getGlyph(r,h,e);t.translate(this.x,this.y),t.scale(c,-c);const i=t.lineWidth;t.lineWidth=t.lineWidth*o/a,"italic"===l&&t.transform(1,0,.4,1,0,0),n.render(t),"italic"===l&&t.transform(1,0,-.4,1,0,0),t.lineWidth=i,t.scale(1/c,-1/c),t.translate(-this.x,-this.y),this.x+=a*(n.horizAdvX||r.horizAdvX)/o,void 0===u[e]||isNaN(u[e])||(this.x+=u[e])}return}const{x:o,y:s}=this;t.fillStyle&&t.fillText(i,o,s),t.strokeStyle&&t.strokeText(i,o,s)}applyAnchoring(){if(this.textChunkStart>=this.leafTexts.length)return;const t=this.leafTexts[this.textChunkStart],e=t.getStyle("text-anchor").getString("start");let n=0;n="start"===e?t.x-this.minX:"end"===e?t.x-this.maxX:t.x-(this.minX+this.maxX)/2;for(let t=this.textChunkStart;t<this.leafTexts.length;t++)this.leafTexts[t].x+=n;this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.textChunkStart=this.leafTexts.length}adjustChildCoordinatesRecursive(t){this.children.forEach((e,n)=>{this.adjustChildCoordinatesRecursiveCore(t,this,this,n)}),this.applyAnchoring()}adjustChildCoordinatesRecursiveCore(t,e,n,i){const r=n.children[i];r.children.length>0?r.children.forEach((n,i)=>{e.adjustChildCoordinatesRecursiveCore(t,e,r,i)}):this.adjustChildCoordinates(t,e,n,i)}adjustChildCoordinates(t,e,n,i){const r=n.children[i];if("function"!=typeof r.measureText)return r;t.save(),r.setContext(t,!0);const o=r.getAttribute("x"),s=r.getAttribute("y"),a=r.getAttribute("dx"),l=r.getAttribute("dy"),c=r.getStyle("font-family").getDefinition(),h=Boolean(null==c?void 0:c.isRTL);0===i&&(o.hasValue()||o.setValue(r.getInheritedAttribute("x")),s.hasValue()||s.setValue(r.getInheritedAttribute("y")),a.hasValue()||a.setValue(r.getInheritedAttribute("dx")),l.hasValue()||l.setValue(r.getInheritedAttribute("dy")));const u=r.measureText(t);return h&&(e.x-=u),o.hasValue()?(e.applyAnchoring(),r.x=o.getPixels("x"),a.hasValue()&&(r.x+=a.getPixels("x"))):(a.hasValue()&&(e.x+=a.getPixels("x")),r.x=e.x),e.x=r.x,h||(e.x+=u),s.hasValue()?(r.y=s.getPixels("y"),l.hasValue()&&(r.y+=l.getPixels("y"))):(l.hasValue()&&(e.y+=l.getPixels("y")),r.y=e.y),e.y=r.y,e.leafTexts.push(r),e.minX=Math.min(e.minX,r.x,r.x+u),e.maxX=Math.max(e.maxX,r.x,r.x+u),r.clearContext(t),t.restore(),r}getChildBoundingBox(t,e,n,i){const r=n.children[i];if("function"!=typeof r.getBoundingBox)return null;const o=r.getBoundingBox(t);return o&&r.children.forEach((n,i)=>{const s=e.getChildBoundingBox(t,e,r,i);o.addBoundingBox(s)}),o}renderChild(t,e,n,i){const r=n.children[i];r.render(t),r.children.forEach((n,i)=>{e.renderChild(t,e,r,i)})}measureText(t){const{measureCache:e}=this;if(~e)return e;const n=this.getText(),i=this.measureTargetText(t,n);return this.measureCache=i,i}measureTargetText(t,e){if(!e.length)return 0;const{parent:n}=this,i=n.getStyle("font-family").getDefinition();if(i){const t=this.getFontSize(),r=i.isRTL?e.split("").reverse().join(""):e,o=M(n.getAttribute("dx").getString()),s=r.length;let a=0;for(let e=0;e<s;e++)a+=(this.getGlyph(i,r,e).horizAdvX||i.horizAdvX)*t/i.fontFace.unitsPerEm,void 0===o[e]||isNaN(o[e])||(a+=o[e]);return a}if(!t.measureText)return 10*e.length;t.save(),this.setContext(t,!0);const{width:r}=t.measureText(e);return this.clearContext(t),t.restore(),r}getInheritedAttribute(t){let e=this;for(;e instanceof wt&&e.isFirstChild()&&e.parent;){const n=e.parent.getAttribute(t);if(n.hasValue(!0))return n.getString("0");e=e.parent}return null}constructor(t,e,n){super(t,e,new.target===wt||n),this.type="text",this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.measureCache=-1}}class _t extends wt{getText(){return this.text}constructor(t,e,n){super(t,e,new.target===_t||n),this.type="tspan",this.text=this.children.length>0?"":this.getTextFromNode()}}class Ot extends _t{constructor(...t){super(...t),this.type="textNode"}}class kt extends O{reset(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new nt(0,0),this.control=new nt(0,0),this.current=new nt(0,0),this.points=[],this.angles=[]}isEnd(){const{i:t,commands:e}=this;return t>=e.length-1}next(){const t=this.commands[++this.i];return this.previousCommand=this.command,this.command=t,t}getPoint(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"x",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"y";const n=new nt(this.command[t],this.command[e]);return this.makeAbsolute(n)}getAsControlPoint(t,e){const n=this.getPoint(t,e);return this.control=n,n}getAsCurrentPoint(t,e){const n=this.getPoint(t,e);return this.current=n,n}getReflectedControlPoint(){const t=this.previousCommand.type;if(t!==O.CURVE_TO&&t!==O.SMOOTH_CURVE_TO&&t!==O.QUAD_TO&&t!==O.SMOOTH_QUAD_TO)return this.current;const{current:{x:e,y:n},control:{x:i,y:r}}=this;return new nt(2*e-i,2*n-r)}makeAbsolute(t){if(this.command.relative){const{x:e,y:n}=this.current;t.x+=e,t.y+=n}return t}addMarker(t,e,n){const{points:i,angles:r}=this;n&&r.length>0&&!r[r.length-1]&&(r[r.length-1]=i[i.length-1].angleTo(n)),this.addMarkerAngle(t,e?e.angleTo(t):null)}addMarkerAngle(t,e){this.points.push(t),this.angles.push(e)}getMarkerPoints(){return this.points}getMarkerAngles(){const{angles:t}=this,e=t.length;for(let n=0;n<e;n++)if(!t[n])for(let i=n+1;i<e;i++)if(t[i]){t[n]=t[i];break}return t}constructor(t){super(t.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,"")),this.control=new nt(0,0),this.start=new nt(0,0),this.current=new nt(0,0),this.command=null,this.commands=this.commands,this.i=-1,this.previousCommand=null,this.points=[],this.angles=[]}}class St extends xt{path(t){const{pathParser:e}=this,n=new bt;for(e.reset(),t&&t.beginPath();!e.isEnd();)switch(e.next().type){case kt.MOVE_TO:this.pathM(t,n);break;case kt.LINE_TO:this.pathL(t,n);break;case kt.HORIZ_LINE_TO:this.pathH(t,n);break;case kt.VERT_LINE_TO:this.pathV(t,n);break;case kt.CURVE_TO:this.pathC(t,n);break;case kt.SMOOTH_CURVE_TO:this.pathS(t,n);break;case kt.QUAD_TO:this.pathQ(t,n);break;case kt.SMOOTH_QUAD_TO:this.pathT(t,n);break;case kt.ARC:this.pathA(t,n);break;case kt.CLOSE_PATH:this.pathZ(t,n)}return n}getBoundingBox(t){return this.path()}getMarkers(){const{pathParser:t}=this,e=t.getMarkerPoints(),n=t.getMarkerAngles(),i=e.map((t,e)=>[t,n[e]]);return i}renderChildren(t){this.path(t),this.document.screen.mouse.checkPath(this,t);const e=this.getStyle("fill-rule");""!==t.fillStyle&&("inherit"!==e.getString("inherit")?t.fill(e.getString()):t.fill()),""!==t.strokeStyle&&("non-scaling-stroke"===this.getAttribute("vector-effect").getString()?(t.save(),t.setTransform(1,0,0,1,0,0),t.stroke(),t.restore()):t.stroke());const n=this.getMarkers();if(n){const e=n.length-1,i=this.getStyle("marker-start"),r=this.getStyle("marker-mid"),o=this.getStyle("marker-end");if(i.isUrlDefinition()){const e=i.getDefinition(),[r,o]=n[0];e.render(t,r,o)}if(r.isUrlDefinition()){const i=r.getDefinition();for(let r=1;r<e;r++){const[e,o]=n[r];i.render(t,e,o)}}if(o.isUrlDefinition()){const i=o.getDefinition(),[r,s]=n[e];i.render(t,r,s)}}}static pathM(t){const e=t.getAsCurrentPoint();return t.start=t.current,{point:e}}pathM(t,e){const{pathParser:n}=this,{point:i}=St.pathM(n),{x:r,y:o}=i;n.addMarker(i),e.addPoint(r,o),t&&t.moveTo(r,o)}static pathL(t){const{current:e}=t;return{current:e,point:t.getAsCurrentPoint()}}pathL(t,e){const{pathParser:n}=this,{current:i,point:r}=St.pathL(n),{x:o,y:s}=r;n.addMarker(r,i),e.addPoint(o,s),t&&t.lineTo(o,s)}static pathH(t){const{current:e,command:n}=t,i=new nt((n.relative?e.x:0)+n.x,e.y);return t.current=i,{current:e,point:i}}pathH(t,e){const{pathParser:n}=this,{current:i,point:r}=St.pathH(n),{x:o,y:s}=r;n.addMarker(r,i),e.addPoint(o,s),t&&t.lineTo(o,s)}static pathV(t){const{current:e,command:n}=t,i=new nt(e.x,(n.relative?e.y:0)+n.y);return t.current=i,{current:e,point:i}}pathV(t,e){const{pathParser:n}=this,{current:i,point:r}=St.pathV(n),{x:o,y:s}=r;n.addMarker(r,i),e.addPoint(o,s),t&&t.lineTo(o,s)}static pathC(t){const{current:e}=t;return{current:e,point:t.getPoint("x1","y1"),controlPoint:t.getAsControlPoint("x2","y2"),currentPoint:t.getAsCurrentPoint()}}pathC(t,e){const{pathParser:n}=this,{current:i,point:r,controlPoint:o,currentPoint:s}=St.pathC(n);n.addMarker(s,o,r),e.addBezierCurve(i.x,i.y,r.x,r.y,o.x,o.y,s.x,s.y),t&&t.bezierCurveTo(r.x,r.y,o.x,o.y,s.x,s.y)}static pathS(t){const{current:e}=t;return{current:e,point:t.getReflectedControlPoint(),controlPoint:t.getAsControlPoint("x2","y2"),currentPoint:t.getAsCurrentPoint()}}pathS(t,e){const{pathParser:n}=this,{current:i,point:r,controlPoint:o,currentPoint:s}=St.pathS(n);n.addMarker(s,o,r),e.addBezierCurve(i.x,i.y,r.x,r.y,o.x,o.y,s.x,s.y),t&&t.bezierCurveTo(r.x,r.y,o.x,o.y,s.x,s.y)}static pathQ(t){const{current:e}=t;return{current:e,controlPoint:t.getAsControlPoint("x1","y1"),currentPoint:t.getAsCurrentPoint()}}pathQ(t,e){const{pathParser:n}=this,{current:i,controlPoint:r,currentPoint:o}=St.pathQ(n);n.addMarker(o,r,r),e.addQuadraticCurve(i.x,i.y,r.x,r.y,o.x,o.y),t&&t.quadraticCurveTo(r.x,r.y,o.x,o.y)}static pathT(t){const{current:e}=t,n=t.getReflectedControlPoint();return t.control=n,{current:e,controlPoint:n,currentPoint:t.getAsCurrentPoint()}}pathT(t,e){const{pathParser:n}=this,{current:i,controlPoint:r,currentPoint:o}=St.pathT(n);n.addMarker(o,r,r),e.addQuadraticCurve(i.x,i.y,r.x,r.y,o.x,o.y),t&&t.quadraticCurveTo(r.x,r.y,o.x,o.y)}static pathA(t){const{current:e,command:n}=t;let{rX:i,rY:r,xRot:o,lArcFlag:s,sweepFlag:a}=n;const l=o*(Math.PI/180),c=t.getAsCurrentPoint(),h=new nt(Math.cos(l)*(e.x-c.x)/2+Math.sin(l)*(e.y-c.y)/2,-Math.sin(l)*(e.x-c.x)/2+Math.cos(l)*(e.y-c.y)/2),u=Math.pow(h.x,2)/Math.pow(i,2)+Math.pow(h.y,2)/Math.pow(r,2);u>1&&(i*=Math.sqrt(u),r*=Math.sqrt(u));let d=(s===a?-1:1)*Math.sqrt((Math.pow(i,2)*Math.pow(r,2)-Math.pow(i,2)*Math.pow(h.y,2)-Math.pow(r,2)*Math.pow(h.x,2))/(Math.pow(i,2)*Math.pow(h.y,2)+Math.pow(r,2)*Math.pow(h.x,2)));isNaN(d)&&(d=0);const p=new nt(d*i*h.y/r,d*-r*h.x/i),f=new nt((e.x+c.x)/2+Math.cos(l)*p.x-Math.sin(l)*p.y,(e.y+c.y)/2+Math.sin(l)*p.x+Math.cos(l)*p.y),g=Q([1,0],[(h.x-p.x)/i,(h.y-p.y)/r]),m=[(h.x-p.x)/i,(h.y-p.y)/r],v=[(-h.x-p.x)/i,(-h.y-p.y)/r];let y=Q(m,v);return z(m,v)<=-1&&(y=Math.PI),z(m,v)>=1&&(y=0),{currentPoint:c,rX:i,rY:r,sweepFlag:a,xAxisRotation:l,centp:f,a1:g,ad:y}}pathA(t,e){const{pathParser:n}=this,{currentPoint:i,rX:r,rY:o,sweepFlag:s,xAxisRotation:a,centp:l,a1:c,ad:h}=St.pathA(n),u=1-s?1:-1,d=c+u*(h/2),p=new nt(l.x+r*Math.cos(d),l.y+o*Math.sin(d));if(n.addMarkerAngle(p,d-u*Math.PI/2),n.addMarkerAngle(i,d-u*Math.PI),e.addPoint(i.x,i.y),t&&!isNaN(c)&&!isNaN(h)){const e=r>o?r:o,n=r>o?1:r/o,i=r>o?o/r:1;t.translate(l.x,l.y),t.rotate(a),t.scale(n,i),t.arc(0,0,e,c,c+h,Boolean(1-s)),t.scale(1/n,1/i),t.rotate(-a),t.translate(-l.x,-l.y)}}static pathZ(t){t.current=t.start}pathZ(t,e){St.pathZ(this.pathParser),t&&e.x1!==e.x2&&e.y1!==e.y2&&t.closePath()}constructor(t,e,n){super(t,e,n),this.type="path",this.pathParser=new kt(this.getAttribute("d").getString())}}class Et extends xt{setContext(t){var e;const{document:n}=this,{screen:i,window:r}=n,o=t.canvas;if(i.setDefaults(t),"style"in o&&void 0!==t.font&&r&&void 0!==r.getComputedStyle){t.font=r.getComputedStyle(o).getPropertyValue("font");const e=new J(n,"fontSize",yt.parse(t.font).fontSize);e.hasValue()&&(n.rootEmSize=e.getPixels("y"),n.emSize=n.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);let{width:s,height:a}=i.viewPort;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");const l=this.getAttribute("refX"),c=this.getAttribute("refY"),h=this.getAttribute("viewBox"),u=h.hasValue()?M(h.getString()):null,d=!this.root&&"visible"!==this.getStyle("overflow").getValue("hidden");let p=0,f=0,g=0,m=0;u&&(p=u[0],f=u[1]),this.root||(s=this.getStyle("width").getPixels("x"),a=this.getStyle("height").getPixels("y"),"marker"===this.type&&(g=p,m=f,p=0,f=0)),i.viewPort.setCurrent(s,a),!this.node||this.parent&&"foreignObject"!==(null===(e=this.node.parentNode)||void 0===e?void 0:e.nodeName)||!this.getStyle("transform",!1,!0).hasValue()||this.getStyle("transform-origin",!1,!0).hasValue()||this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),super.setContext(t),t.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),u&&(s=u[2],a=u[3]),n.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:i.viewPort.width,desiredWidth:s,height:i.viewPort.height,desiredHeight:a,minX:p,minY:f,refX:l.getValue(),refY:c.getValue(),clip:d,clipX:g,clipY:m}),u&&(i.viewPort.removeCurrent(),i.viewPort.setCurrent(s,a))}clearContext(t){super.clearContext(t),this.document.screen.viewPort.removeCurrent()}resize(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.getAttribute("width",!0),r=this.getAttribute("height",!0),o=this.getAttribute("viewBox"),s=this.getAttribute("style"),a=i.getNumber(0),l=r.getNumber(0);if(n)if("string"==typeof n)this.getAttribute("preserveAspectRatio",!0).setValue(n);else{const t=this.getAttribute("preserveAspectRatio");t.hasValue()&&t.setValue(t.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(i.setValue(t),r.setValue(e),o.hasValue()||o.setValue("0 0 ".concat(a||t," ").concat(l||e)),s.hasValue()){const n=this.getStyle("width"),i=this.getStyle("height");n.hasValue()&&n.setValue("".concat(t,"px")),i.hasValue()&&i.setValue("".concat(e,"px"))}}constructor(...t){super(...t),this.type="svg",this.root=!1}}class Ct extends St{path(t){const e=this.getAttribute("x").getPixels("x"),n=this.getAttribute("y").getPixels("y"),i=this.getStyle("width",!1,!0).getPixels("x"),r=this.getStyle("height",!1,!0).getPixels("y"),o=this.getAttribute("rx"),s=this.getAttribute("ry");let a=o.getPixels("x"),l=s.getPixels("y");if(o.hasValue()&&!s.hasValue()&&(l=a),s.hasValue()&&!o.hasValue()&&(a=l),a=Math.min(a,i/2),l=Math.min(l,r/2),t){const o=(Math.sqrt(2)-1)/3*4;t.beginPath(),r>0&&i>0&&(t.moveTo(e+a,n),t.lineTo(e+i-a,n),t.bezierCurveTo(e+i-a+o*a,n,e+i,n+l-o*l,e+i,n+l),t.lineTo(e+i,n+r-l),t.bezierCurveTo(e+i,n+r-l+o*l,e+i-a+o*a,n+r,e+i-a,n+r),t.lineTo(e+a,n+r),t.bezierCurveTo(e+a-o*a,n+r,e,n+r-l+o*l,e,n+r-l),t.lineTo(e,n+l),t.bezierCurveTo(e,n+l-o*l,e+a-o*a,n,e+a,n),t.closePath())}return new bt(e,n,e+i,n+r)}getMarkers(){return null}constructor(...t){super(...t),this.type="rect"}}class At extends St{path(t){const{points:e}=this,[{x:n,y:i}]=e,r=new bt(n,i);return t&&(t.beginPath(),t.moveTo(n,i)),e.forEach(e=>{let{x:n,y:i}=e;r.addPoint(n,i),t&&t.lineTo(n,i)}),r}getMarkers(){const{points:t}=this,e=t.length-1,n=[];return t.forEach((i,r)=>{r!==e&&n.push([i,i.angleTo(t[r+1])])}),n.length>0&&n.push([t[t.length-1],n[n.length-1][1]]),n}constructor(t,e,n){super(t,e,n),this.type="polyline",this.points=[],this.points=nt.parsePath(this.getAttribute("points").getString())}}class Tt extends xt{getBoundingBox(t){const e=new bt;return this.children.forEach(n=>{e.addBoundingBox(n.getBoundingBox(t))}),e}constructor(...t){super(...t),this.type="g"}}class Pt extends pt{getGradientUnits(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}createGradient(t,e,n){let i=this;this.getHrefAttribute().hasValue()&&(i=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(i));const{stops:r}=i,o=this.getGradient(t,e);if(!o)return this.addParentOpacity(n,r[r.length-1].color);if(r.forEach(t=>{o.addColorStop(t.offset,this.addParentOpacity(n,t.color))}),this.getAttribute("gradientTransform").hasValue()){const{document:t}=this,{MAX_VIRTUAL_PIXELS:e}=st,{viewPort:n}=t.screen,i=n.getRoot(),r=new Ct(t);r.attributes.set("x",new J(t,"x",-e/3)),r.attributes.set("y",new J(t,"y",-e/3)),r.attributes.set("width",new J(t,"width",e)),r.attributes.set("height",new J(t,"height",e));const s=new Tt(t);s.attributes.set("transform",new J(t,"transform",this.getAttribute("gradientTransform").getValue())),s.children=[r];const a=new Et(t);a.attributes.set("x",new J(t,"x",0)),a.attributes.set("y",new J(t,"y",0)),a.attributes.set("width",new J(t,"width",i.width)),a.attributes.set("height",new J(t,"height",i.height)),a.children=[s];const l=t.createCanvas(i.width,i.height),c=l.getContext("2d");return c.fillStyle=o,a.render(c),c.createPattern(l,"no-repeat")}return o}inheritStopContainer(t){this.attributesToInherit.forEach(e=>{!this.getAttribute(e).hasValue()&&t.getAttribute(e).hasValue()&&this.getAttribute(e,!0).setValue(t.getAttribute(e).getValue())})}addParentOpacity(t,e){return t.hasValue()?new J(this.document,"color",e).addOpacity(t).getColor():e}constructor(t,e,n){super(t,e,n),this.attributesToInherit=["gradientUnits"],this.stops=[];const{stops:i,children:r}=this;r.forEach(t=>{"stop"===t.type&&i.push(t)})}}class Mt extends pt{getProperty(){const t=this.getAttribute("attributeType").getString(),e=this.getAttribute("attributeName").getString();return"CSS"===t?this.parent.getStyle(e,!0):this.parent.getAttribute(e,!0)}calcValue(){const{initialUnits:t}=this,{progress:e,from:n,to:i}=this.getProgress();let r=n.getNumber()+(i.getNumber()-n.getNumber())*e;return"%"===t&&(r*=100),"".concat(r).concat(t)}update(t){const{parent:e}=this,n=this.getProperty();if(this.initialValue||(this.initialValue=n.getString(),this.initialUnits=n.getUnits()),this.duration>this.maxDuration){const t=this.getAttribute("fill").getString("remove");if("indefinite"===this.getAttribute("repeatCount").getString()||"indefinite"===this.getAttribute("repeatDur").getString())this.duration=0;else if("freeze"!==t||this.frozen){if("remove"===t&&!this.removed)return this.removed=!0,e&&n&&n.setValue(e.animationFrozen?e.animationFrozenValue:this.initialValue),!0}else this.frozen=!0,e&&n&&(e.animationFrozen=!0,e.animationFrozenValue=n.getString());return!1}this.duration+=t;let i=!1;if(this.begin<this.duration){let t=this.calcValue();const e=this.getAttribute("type");if(e.hasValue()){const n=e.getString();t="".concat(n,"(").concat(t,")")}n.setValue(t),i=!0}return i}getProgress(){const{document:t,values:e}=this;let n,i,r=(this.duration-this.begin)/(this.maxDuration-this.begin);if(e.hasValue()){const o=r*(e.getValue().length-1),s=Math.floor(o),a=Math.ceil(o);let l;l=e.getValue()[s],n=new J(t,"from",l?parseFloat(l):0),l=e.getValue()[a],i=new J(t,"to",l?parseFloat(l):0),r=(o-s)/(a-s)}else n=this.from,i=this.to;return{progress:r,from:n,to:i}}constructor(t,e,n){super(t,e,n),this.type="animate",this.duration=0,this.initialUnits="",this.removed=!1,this.frozen=!1,t.screen.animations.push(this),this.begin=this.getAttribute("begin").getMilliseconds(),this.maxDuration=this.begin+this.getAttribute("dur").getMilliseconds(),this.from=this.getAttribute("from"),this.to=this.getAttribute("to"),this.values=new J(t,"values",null);const i=this.getAttribute("values");i.hasValue()&&this.values.setValue(i.getString().split(";"))}}class Nt extends pt{constructor(t,e,n){super(t,e,n),this.type="font-face",this.ascent=this.getAttribute("ascent").getNumber(),this.descent=this.getAttribute("descent").getNumber(),this.unitsPerEm=this.getAttribute("units-per-em").getNumber()}}class Rt extends St{constructor(t,e,n){super(t,e,n),this.type="glyph",this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber(),this.unicode=this.getAttribute("unicode").getString(),this.arabicForm=this.getAttribute("arabic-form").getString()}}class Dt extends Rt{constructor(...t){super(...t),this.type="missing-glyph",this.horizAdvX=0}}const Bt=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i;class $t{async load(t,e){try{const{document:n}=this,i=(await n.canvg.parser.load(e)).getElementsByTagName("font");Array.from(i).forEach(e=>{const i=n.createElement(e);n.definitions.set(t,i)})}catch(t){console.error('Error while loading font "'.concat(e,'":'),t)}this.loaded=!0}constructor(t){this.document=t,this.loaded=!1,t.fonts.push(this)}}class Lt extends pt{constructor(t,e,n){super(t,e,n),this.type="style";const i=P(Array.from(e.childNodes).map(t=>t.textContent).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,""));i.split("}").forEach(e=>{const n=e.trim();if(!n)return;const i=n.split("{"),r=i[0].split(","),o=i[1].split(";");r.forEach(e=>{const n=e.trim();if(!n)return;const i=t.styles.get(n)||new Map;if(o.forEach(e=>{const n=e.indexOf(":"),r=e.substr(0,n).trim(),o=e.substr(n+1,e.length-n).trim();r&&o&&i.set(r,new J(t,r,o))}),t.styles.set(n,i),t.stylesSpecificity.set(n,function(t){const e=[0,0,0];let n=t.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),i=0;return[n,i]=V(n,D),e[1]+=i,[n,i]=V(n,B),e[0]+=i,[n,i]=V(n,$),e[1]+=i,[n,i]=V(n,L),e[2]+=i,[n,i]=V(n,I),e[1]+=i,[n,i]=V(n,q),e[1]+=i,n=n.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),[n,i]=V(n,F),e[2]+=i,e.join("")}(n)),"@font-face"===n){const e=i.get("font-family").getString().replace(/"|'/g,"");i.get("src").getString().split(",").forEach(n=>{if(n.indexOf('format("svg")')>0){const i=R(n);i&&new $t(t).load(e,i)}})}})})}}function It(t,e,n,i,r,o){return t[n*i*4+4*e+o]}function qt(t,e,n,i,r,o,s){t[n*i*4+4*e+o]=s}function Ft(t,e,n){return t[e]*n}function Vt(t,e,n,i){return e+Math.cos(t)*n+Math.sin(t)*i}Lt.parseExternalUrl=R;class jt extends pt{apply(t,e,n,i,r){const{includeOpacity:o,matrix:s}=this,a=t.getImageData(0,0,i,r);for(let t=0;t<r;t++)for(let e=0;e<i;e++){const n=It(a.data,e,t,i,0,0),r=It(a.data,e,t,i,0,1),l=It(a.data,e,t,i,0,2),c=It(a.data,e,t,i,0,3);let h=Ft(s,0,n)+Ft(s,1,r)+Ft(s,2,l)+Ft(s,3,c)+Ft(s,4,1),u=Ft(s,5,n)+Ft(s,6,r)+Ft(s,7,l)+Ft(s,8,c)+Ft(s,9,1),d=Ft(s,10,n)+Ft(s,11,r)+Ft(s,12,l)+Ft(s,13,c)+Ft(s,14,1),p=Ft(s,15,n)+Ft(s,16,r)+Ft(s,17,l)+Ft(s,18,c)+Ft(s,19,1);o&&(h=0,u=0,d=0,p*=c/255),qt(a.data,e,t,i,0,0,h),qt(a.data,e,t,i,0,1,u),qt(a.data,e,t,i,0,2,d),qt(a.data,e,t,i,0,3,p)}t.clearRect(0,0,i,r),t.putImageData(a,0,0)}constructor(t,e,n){super(t,e,n),this.type="feColorMatrix";let i=M(this.getAttribute("values").getString());switch(this.getAttribute("type").getString("matrix")){case"saturate":{const t=i[0];i=[.213+.787*t,.715-.715*t,.072-.072*t,0,0,.213-.213*t,.715+.285*t,.072-.072*t,0,0,.213-.213*t,.715-.715*t,.072+.928*t,0,0,0,0,0,1,0,0,0,0,0,1];break}case"hueRotate":{const t=i[0]*Math.PI/180;i=[Vt(t,.213,.787,-.213),Vt(t,.715,-.715,-.715),Vt(t,.072,-.072,.928),0,0,Vt(t,.213,-.213,.143),Vt(t,.715,.285,.14),Vt(t,.072,-.072,-.283),0,0,Vt(t,.213,-.213,-.787),Vt(t,.715,-.715,.715),Vt(t,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break}case"luminanceToAlpha":i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.matrix=i,this.includeOpacity=this.getAttribute("includeOpacity").hasValue()}}class Ht extends pt{apply(t,e){const{document:n}=this;let i=this.getAttribute("x").getPixels("x"),r=this.getAttribute("y").getPixels("y"),o=this.getStyle("width").getPixels("x"),s=this.getStyle("height").getPixels("y");if(!o&&!s){const e=new bt;this.children.forEach(n=>{e.addBoundingBox(n.getBoundingBox(t))}),i=Math.floor(e.x1),r=Math.floor(e.y1),o=Math.floor(e.width),s=Math.floor(e.height)}const a=this.removeStyles(e,Ht.ignoreStyles),l=n.createCanvas(i+o,r+s),c=l.getContext("2d");n.screen.setDefaults(c),this.renderChildren(c),new jt(n,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(c,0,0,i+o,r+s);const h=n.createCanvas(i+o,r+s),u=h.getContext("2d");n.screen.setDefaults(u),e.render(u),u.globalCompositeOperation="destination-in",u.fillStyle=c.createPattern(l,"no-repeat"),u.fillRect(0,0,i+o,r+s),t.fillStyle=u.createPattern(h,"no-repeat"),t.fillRect(0,0,i+o,r+s),this.restoreStyles(e,a)}render(t){}constructor(...t){super(...t),this.type="mask"}}Ht.ignoreStyles=["mask","transform","clip-path"];const zt=()=>{};class Qt extends pt{apply(t,e){const{document:n,children:i}=this,r="getBoundingBox"in e?e.getBoundingBox(t):null;if(!r)return;let o=0,s=0;i.forEach(t=>{const e=t.extraFilterDistance||0;o=Math.max(o,e),s=Math.max(s,e)});const a=Math.floor(r.width),l=Math.floor(r.height),c=a+2*o,h=l+2*s;if(c<1||h<1)return;const u=Math.floor(r.x),d=Math.floor(r.y),p=this.removeStyles(e,Qt.ignoreStyles),f=n.createCanvas(c,h),g=f.getContext("2d");n.screen.setDefaults(g),g.translate(-u+o,-d+s),e.render(g),i.forEach(t=>{"function"==typeof t.apply&&t.apply(g,0,0,c,h)}),t.drawImage(f,0,0,c,h,u-o,d-s,c,h),this.restoreStyles(e,p)}render(t){}constructor(...t){super(...t),this.type="filter"}}Qt.ignoreStyles=["filter","transform","clip-path"];const Wt={svg:Et,rect:Ct,circle:class extends St{path(t){const e=this.getAttribute("cx").getPixels("x"),n=this.getAttribute("cy").getPixels("y"),i=this.getAttribute("r").getPixels();return t&&i>0&&(t.beginPath(),t.arc(e,n,i,0,2*Math.PI,!1),t.closePath()),new bt(e-i,n-i,e+i,n+i)}getMarkers(){return null}constructor(...t){super(...t),this.type="circle"}},ellipse:class extends St{path(t){const e=(Math.sqrt(2)-1)/3*4,n=this.getAttribute("rx").getPixels("x"),i=this.getAttribute("ry").getPixels("y"),r=this.getAttribute("cx").getPixels("x"),o=this.getAttribute("cy").getPixels("y");return t&&n>0&&i>0&&(t.beginPath(),t.moveTo(r+n,o),t.bezierCurveTo(r+n,o+e*i,r+e*n,o+i,r,o+i),t.bezierCurveTo(r-e*n,o+i,r-n,o+e*i,r-n,o),t.bezierCurveTo(r-n,o-e*i,r-e*n,o-i,r,o-i),t.bezierCurveTo(r+e*n,o-i,r+n,o-e*i,r+n,o),t.closePath()),new bt(r-n,o-i,r+n,o+i)}getMarkers(){return null}constructor(...t){super(...t),this.type="ellipse"}},line:class extends St{getPoints(){return[new nt(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new nt(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}path(t){const[{x:e,y:n},{x:i,y:r}]=this.getPoints();return t&&(t.beginPath(),t.moveTo(e,n),t.lineTo(i,r)),new bt(e,n,i,r)}getMarkers(){const[t,e]=this.getPoints(),n=t.angleTo(e);return[[t,n],[e,n]]}constructor(...t){super(...t),this.type="line"}},polyline:At,polygon:class extends At{path(t){const e=super.path(t),[{x:n,y:i}]=this.points;return t&&(t.lineTo(n,i),t.closePath()),e}constructor(...t){super(...t),this.type="polygon"}},path:St,pattern:class extends pt{createPattern(t,e,n){const i=this.getStyle("width").getPixels("x",!0),r=this.getStyle("height").getPixels("y",!0),o=new Et(this.document,null);o.attributes.set("viewBox",new J(this.document,"viewBox",this.getAttribute("viewBox").getValue())),o.attributes.set("width",new J(this.document,"width","".concat(i,"px"))),o.attributes.set("height",new J(this.document,"height","".concat(r,"px"))),o.attributes.set("transform",new J(this.document,"transform",this.getAttribute("patternTransform").getValue())),o.children=this.children;const s=this.document.createCanvas(i,r),a=s.getContext("2d"),l=this.getAttribute("x"),c=this.getAttribute("y");l.hasValue()&&c.hasValue()&&a.translate(l.getPixels("x",!0),c.getPixels("y",!0)),n.hasValue()?this.styles.set("fill-opacity",n):this.styles.delete("fill-opacity");for(let t=-1;t<=1;t++)for(let e=-1;e<=1;e++)a.save(),o.attributes.set("x",new J(this.document,"x",t*s.width)),o.attributes.set("y",new J(this.document,"y",e*s.height)),o.render(a),a.restore();return t.createPattern(s,"repeat")}constructor(...t){super(...t),this.type="pattern"}},marker:class extends pt{render(t,e,n){if(!e)return;const{x:i,y:r}=e,o=this.getAttribute("orient").getString("auto"),s=this.getAttribute("markerUnits").getString("strokeWidth");t.translate(i,r),"auto"===o&&t.rotate(n),"strokeWidth"===s&&t.scale(t.lineWidth,t.lineWidth),t.save();const a=new Et(this.document);a.type=this.type,a.attributes.set("viewBox",new J(this.document,"viewBox",this.getAttribute("viewBox").getValue())),a.attributes.set("refX",new J(this.document,"refX",this.getAttribute("refX").getValue())),a.attributes.set("refY",new J(this.document,"refY",this.getAttribute("refY").getValue())),a.attributes.set("width",new J(this.document,"width",this.getAttribute("markerWidth").getValue())),a.attributes.set("height",new J(this.document,"height",this.getAttribute("markerHeight").getValue())),a.attributes.set("overflow",new J(this.document,"overflow",this.getAttribute("overflow").getValue())),a.attributes.set("fill",new J(this.document,"fill",this.getAttribute("fill").getColor("black"))),a.attributes.set("stroke",new J(this.document,"stroke",this.getAttribute("stroke").getValue("none"))),a.children=this.children,a.render(t),t.restore(),"strokeWidth"===s&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"===o&&t.rotate(-n),t.translate(-i,-r)}constructor(...t){super(...t),this.type="marker"}},defs:class extends pt{render(){}constructor(...t){super(...t),this.type="defs"}},linearGradient:class extends Pt{getGradient(t,e){const n="objectBoundingBox"===this.getGradientUnits(),i=n?e.getBoundingBox(t):null;if(n&&!i)return null;this.getAttribute("x1").hasValue()||this.getAttribute("y1").hasValue()||this.getAttribute("x2").hasValue()||this.getAttribute("y2").hasValue()||(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));const r=n?i.x+i.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),o=n?i.y+i.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),s=n?i.x+i.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),a=n?i.y+i.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return r===s&&o===a?null:t.createLinearGradient(r,o,s,a)}constructor(t,e,n){super(t,e,n),this.type="linearGradient",this.attributesToInherit.push("x1","y1","x2","y2")}},radialGradient:class extends Pt{getGradient(t,e){const n="objectBoundingBox"===this.getGradientUnits(),i=e.getBoundingBox(t);if(n&&!i)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");const r=n?i.x+i.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),o=n?i.y+i.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y");let s=r,a=o;this.getAttribute("fx").hasValue()&&(s=n?i.x+i.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(a=n?i.y+i.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));const l=n?(i.width+i.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),c=this.getAttribute("fr").getPixels();return t.createRadialGradient(s,a,c,r,o,l)}constructor(t,e,n){super(t,e,n),this.type="radialGradient",this.attributesToInherit.push("cx","cy","r","fx","fy","fr")}},stop:class extends pt{constructor(t,e,n){super(t,e,n),this.type="stop";const i=Math.max(0,Math.min(1,this.getAttribute("offset").getNumber())),r=this.getStyle("stop-opacity");let o=this.getStyle("stop-color",!0);""===o.getString()&&o.setValue("#000"),r.hasValue()&&(o=o.addOpacity(r)),this.offset=i,this.color=o.getColor()}},animate:Mt,animateColor:class extends Mt{calcValue(){const{progress:t,from:e,to:n}=this.getProgress(),i=new r(e.getColor()),o=new r(n.getColor());if(i.ok&&o.ok){const e=i.r+(o.r-i.r)*t,n=i.g+(o.g-i.g)*t,r=i.b+(o.b-i.b)*t;return"rgb(".concat(Math.floor(e),", ").concat(Math.floor(n),", ").concat(Math.floor(r),")")}return this.getAttribute("from").getColor()}constructor(...t){super(...t),this.type="animateColor"}},animateTransform:class extends Mt{calcValue(){const{progress:t,from:e,to:n}=this.getProgress(),i=M(e.getString()),r=M(n.getString()),o=i.map((e,n)=>e+(r[n]-e)*t).join(" ");return o}constructor(...t){super(...t),this.type="animateTransform"}},font:class extends pt{render(){}constructor(t,e,n){super(t,e,n),this.type="font",this.isArabic=!1,this.glyphs=new Map,this.arabicGlyphs=new Map,this.isRTL=!1,this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber();const{definitions:i}=t,{children:r}=this;for(const t of r)if(t instanceof Nt){this.fontFace=t;const e=t.getStyle("font-family");e.hasValue()&&i.set(e.getString(),this)}else if(t instanceof Dt)this.missingGlyph=t;else if(t instanceof Rt)if(t.arabicForm){this.isRTL=!0,this.isArabic=!0;let e=this.arabicGlyphs.get(t.unicode);void 0===e&&(e=new Map,this.arabicGlyphs.set(t.unicode,e)),e.set(t.arabicForm,t)}else this.glyphs.set(t.unicode,t)}},"font-face":Nt,"missing-glyph":Dt,glyph:Rt,text:wt,tspan:_t,tref:class extends wt{getText(){const t=this.getHrefAttribute().getDefinition();if(t){const e=t.children[0];if(e)return e.getText()}return""}constructor(...t){super(...t),this.type="tref"}},a:class extends wt{getText(){return this.text}renderChildren(t){if(this.hasText){super.renderChildren(t);const{document:e,x:n,y:i}=this,{mouse:r}=e.screen,o=new J(e,"fontSize",yt.parse(e.ctx.font).fontSize);r.isWorking()&&r.checkBoundingBox(this,new bt(n,i-o.getPixels("y"),n+this.measureText(t),i))}else if(this.children.length>0){const e=new Tt(this.document);e.children=this.children,e.parent=this,e.render(t)}}onClick(){const{window:t}=this.document;t&&t.open(this.getHrefAttribute().getString())}onMouseMove(){this.document.ctx.canvas.style.cursor="pointer"}constructor(t,e,n){super(t,e,n),this.type="a";const{childNodes:i}=e,r=i[0],o=i.length>0&&Array.from(i).every(t=>3===t.nodeType);this.hasText=o,this.text=o?this.getTextFromNode(r):""}},textPath:class extends wt{getText(){return this.text}path(t){const{dataArray:e}=this;t&&t.beginPath(),e.forEach(e=>{let{type:n,points:i}=e;switch(n){case kt.LINE_TO:t&&t.lineTo(i[0],i[1]);break;case kt.MOVE_TO:t&&t.moveTo(i[0],i[1]);break;case kt.CURVE_TO:t&&t.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]);break;case kt.QUAD_TO:t&&t.quadraticCurveTo(i[0],i[1],i[2],i[3]);break;case kt.ARC:{const[e,n,r,o,s,a,l,c]=i,h=r>o?r:o,u=r>o?1:r/o,d=r>o?o/r:1;t&&(t.translate(e,n),t.rotate(l),t.scale(u,d),t.arc(0,0,h,s,s+a,Boolean(1-c)),t.scale(1/u,1/d),t.rotate(-l),t.translate(-e,-n));break}case kt.CLOSE_PATH:t&&t.closePath()}})}renderChildren(t){this.setTextData(t),t.save();const e=this.parent.getStyle("text-decoration").getString(),n=this.getFontSize(),{glyphInfo:i}=this,r=t.fillStyle;"underline"===e&&t.beginPath(),i.forEach((i,r)=>{const{p0:o,p1:s,rotation:a,text:l}=i;t.save(),t.translate(o.x,o.y),t.rotate(a),t.fillStyle&&t.fillText(l,0,0),t.strokeStyle&&t.strokeText(l,0,0),t.restore(),"underline"===e&&(0===r&&t.moveTo(o.x,o.y+n/8),t.lineTo(s.x,s.y+n/5))}),"underline"===e&&(t.lineWidth=n/20,t.strokeStyle=r,t.stroke(),t.closePath()),t.restore()}getLetterSpacingAt(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.letterSpacingCache[t]||0}findSegmentToFitChar(t,e,n,i,r,o,s,a,l){let c=o,h=this.measureText(t,a);" "===a&&"justify"===e&&n<i&&(h+=(i-n)/r),l>-1&&(c+=this.getLetterSpacingAt(l));const u=this.textHeight/20,d=this.getEquidistantPointOnPath(c,u,0),p=this.getEquidistantPointOnPath(c+h,u,0),f={p0:d,p1:p},g=d&&p?Math.atan2(p.y-d.y,p.x-d.x):0;if(s){const t=Math.cos(Math.PI/2+g)*s,e=Math.cos(-g)*s;f.p0={...d,x:d.x+t,y:d.y+e},f.p1={...p,x:p.x+t,y:p.y+e}}return c+=h,{offset:c,segment:f,rotation:g}}measureText(t,e){const{measuresCache:n}=this,i=e||this.getText();if(n.has(i))return n.get(i);const r=this.measureTargetText(t,i);return n.set(i,r),r}setTextData(t){if(this.glyphInfo)return;const e=this.getText(),n=e.split(""),i=e.split(" ").length-1,r=this.parent.getAttribute("dx").split().map(t=>t.getPixels("x")),o=this.parent.getAttribute("dy").getPixels("y"),s=this.parent.getStyle("text-anchor").getString("start"),a=this.getStyle("letter-spacing"),l=this.parent.getStyle("letter-spacing");let c=0;a.hasValue()&&"inherit"!==a.getValue()?a.hasValue()&&"initial"!==a.getValue()&&"unset"!==a.getValue()&&(c=a.getPixels()):c=l.getPixels();const h=[],u=e.length;this.letterSpacingCache=h;for(let t=0;t<u;t++)h.push(void 0!==r[t]?r[t]:c);const d=h.reduce((t,e,n)=>0===n?0:t+e||0,0),p=this.measureText(t),f=Math.max(p+d,0);this.textWidth=p,this.textHeight=this.getFontSize(),this.glyphInfo=[];const g=this.getPathLength(),m=this.getStyle("startOffset").getNumber(0)*g;let v=0;"middle"!==s&&"center"!==s||(v=-f/2),"end"!==s&&"right"!==s||(v=-f),v+=m,n.forEach((e,r)=>{const{offset:a,segment:l,rotation:c}=this.findSegmentToFitChar(t,s,f,g,i,v,o,e,r);v=a,l.p0&&l.p1&&this.glyphInfo.push({text:n[r],p0:l.p0,p1:l.p1,rotation:c})})}parsePathData(t){if(this.pathLength=-1,!t)return[];const e=[],{pathParser:n}=t;for(n.reset();!n.isEnd();){const{current:t}=n,i=t?t.x:0,r=t?t.y:0,o=n.next();let s=o.type,a=[];switch(o.type){case kt.MOVE_TO:this.pathM(n,a);break;case kt.LINE_TO:s=this.pathL(n,a);break;case kt.HORIZ_LINE_TO:s=this.pathH(n,a);break;case kt.VERT_LINE_TO:s=this.pathV(n,a);break;case kt.CURVE_TO:this.pathC(n,a);break;case kt.SMOOTH_CURVE_TO:s=this.pathS(n,a);break;case kt.QUAD_TO:this.pathQ(n,a);break;case kt.SMOOTH_QUAD_TO:s=this.pathT(n,a);break;case kt.ARC:a=this.pathA(n);break;case kt.CLOSE_PATH:St.pathZ(n)}o.type!==kt.CLOSE_PATH?e.push({type:s,points:a,start:{x:i,y:r},pathLength:this.calcLength(i,r,s,a)}):e.push({type:kt.CLOSE_PATH,points:[],pathLength:0})}return e}pathM(t,e){const{x:n,y:i}=St.pathM(t).point;e.push(n,i)}pathL(t,e){const{x:n,y:i}=St.pathL(t).point;return e.push(n,i),kt.LINE_TO}pathH(t,e){const{x:n,y:i}=St.pathH(t).point;return e.push(n,i),kt.LINE_TO}pathV(t,e){const{x:n,y:i}=St.pathV(t).point;return e.push(n,i),kt.LINE_TO}pathC(t,e){const{point:n,controlPoint:i,currentPoint:r}=St.pathC(t);e.push(n.x,n.y,i.x,i.y,r.x,r.y)}pathS(t,e){const{point:n,controlPoint:i,currentPoint:r}=St.pathS(t);return e.push(n.x,n.y,i.x,i.y,r.x,r.y),kt.CURVE_TO}pathQ(t,e){const{controlPoint:n,currentPoint:i}=St.pathQ(t);e.push(n.x,n.y,i.x,i.y)}pathT(t,e){const{controlPoint:n,currentPoint:i}=St.pathT(t);return e.push(n.x,n.y,i.x,i.y),kt.QUAD_TO}pathA(t){let{rX:e,rY:n,sweepFlag:i,xAxisRotation:r,centp:o,a1:s,ad:a}=St.pathA(t);return 0===i&&a>0&&(a-=2*Math.PI),1===i&&a<0&&(a+=2*Math.PI),[o.x,o.y,e,n,s,a,r,i]}calcLength(t,e,n,i){let r=0,o=null,s=null,a=0;switch(n){case kt.LINE_TO:return this.getLineLength(t,e,i[0],i[1]);case kt.CURVE_TO:for(r=0,o=this.getPointOnCubicBezier(0,t,e,i[0],i[1],i[2],i[3],i[4],i[5]),a=.01;a<=1;a+=.01)s=this.getPointOnCubicBezier(a,t,e,i[0],i[1],i[2],i[3],i[4],i[5]),r+=this.getLineLength(o.x,o.y,s.x,s.y),o=s;return r;case kt.QUAD_TO:for(r=0,o=this.getPointOnQuadraticBezier(0,t,e,i[0],i[1],i[2],i[3]),a=.01;a<=1;a+=.01)s=this.getPointOnQuadraticBezier(a,t,e,i[0],i[1],i[2],i[3]),r+=this.getLineLength(o.x,o.y,s.x,s.y),o=s;return r;case kt.ARC:{r=0;const t=i[4],e=i[5],n=i[4]+e;let l=Math.PI/180;if(Math.abs(t-n)<l&&(l=Math.abs(t-n)),o=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],t,0),e<0)for(a=t-l;a>n;a-=l)s=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],a,0),r+=this.getLineLength(o.x,o.y,s.x,s.y),o=s;else for(a=t+l;a<n;a+=l)s=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],a,0),r+=this.getLineLength(o.x,o.y,s.x,s.y),o=s;return s=this.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],n,0),r+=this.getLineLength(o.x,o.y,s.x,s.y),r}}return 0}getPointOnLine(t,e,n,i,r){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:n;const a=(r-n)/(i-e+j);let l=Math.sqrt(t*t/(1+a*a));i<e&&(l*=-1);let c=a*l,h=null;if(i===e)h={x:o,y:s+c};else if((s-n)/(o-e+j)===a)h={x:o+l,y:s+c};else{let u=0,d=0;const p=this.getLineLength(e,n,i,r);if(p<j)return null;let f=(o-e)*(i-e)+(s-n)*(r-n);f/=p*p,u=e+f*(i-e),d=n+f*(r-n);const g=this.getLineLength(o,s,u,d),m=Math.sqrt(t*t-g*g);l=Math.sqrt(m*m/(1+a*a)),i<e&&(l*=-1),c=a*l,h={x:u+l,y:d+c}}return h}getPointOnPath(t){const e=this.getPathLength();let n=0,i=null;if(t<-5e-5||t-5e-5>e)return null;const{dataArray:r}=this;for(const e of r){if(e&&(e.pathLength<5e-5||n+e.pathLength+5e-5<t)){n+=e.pathLength;continue}const r=t-n;let o=0;switch(e.type){case kt.LINE_TO:i=this.getPointOnLine(r,e.start.x,e.start.y,e.points[0],e.points[1],e.start.x,e.start.y);break;case kt.ARC:{const t=e.points[4],n=e.points[5],s=e.points[4]+n;if(o=t+r/e.pathLength*n,n<0&&o<s||n>=0&&o>s)break;i=this.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],o,e.points[6]);break}case kt.CURVE_TO:o=r/e.pathLength,o>1&&(o=1),i=this.getPointOnCubicBezier(o,e.start.x,e.start.y,e.points[0],e.points[1],e.points[2],e.points[3],e.points[4],e.points[5]);break;case kt.QUAD_TO:o=r/e.pathLength,o>1&&(o=1),i=this.getPointOnQuadraticBezier(o,e.start.x,e.start.y,e.points[0],e.points[1],e.points[2],e.points[3])}if(i)return i;break}return null}getLineLength(t,e,n,i){return Math.sqrt((n-t)*(n-t)+(i-e)*(i-e))}getPathLength(){return-1===this.pathLength&&(this.pathLength=this.dataArray.reduce((t,e)=>e.pathLength>0?t+e.pathLength:t,0)),this.pathLength}getPointOnCubicBezier(t,e,n,i,r,o,s,a,l){return{x:a*W(t)+o*X(t)+i*U(t)+e*G(t),y:l*W(t)+s*X(t)+r*U(t)+n*G(t)}}getPointOnQuadraticBezier(t,e,n,i,r,o,s){return{x:o*Y(t)+i*Z(t)+e*K(t),y:s*Y(t)+r*Z(t)+n*K(t)}}getPointOnEllipticalArc(t,e,n,i,r,o){const s=Math.cos(o),a=Math.sin(o),l=n*Math.cos(r),c=i*Math.sin(r);return{x:t+(l*s-c*a),y:e+(l*a+c*s)}}buildEquidistantCache(t,e){const n=this.getPathLength(),i=e||.25,r=t||n/100;if(!this.equidistantCache||this.equidistantCache.step!==r||this.equidistantCache.precision!==i){this.equidistantCache={step:r,precision:i,points:[]};let t=0;for(let e=0;e<=n;e+=i){const n=this.getPointOnPath(e),o=this.getPointOnPath(e+i);n&&o&&(t+=this.getLineLength(n.x,n.y,o.x,o.y),t>=r&&(this.equidistantCache.points.push({x:n.x,y:n.y,distance:e}),t-=r))}}}getEquidistantPointOnPath(t,e,n){if(this.buildEquidistantCache(e,n),t<0||t-this.getPathLength()>5e-5)return null;const i=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[i]||null}constructor(t,e,n){super(t,e,n),this.type="textPath",this.textWidth=0,this.textHeight=0,this.pathLength=-1,this.glyphInfo=null,this.letterSpacingCache=[],this.measuresCache=new Map([["",0]]);const i=this.getHrefAttribute().getDefinition();this.text=this.getTextFromNode(),this.dataArray=this.parsePathData(i)}},image:class extends xt{async loadImage(t){try{const e=await this.document.createImage(t);this.image=e}catch(e){console.error('Error while loading image "'.concat(t,'":'),e)}this.loaded=!0}async loadSvg(t){const e=Bt.exec(t);if(e){const t=e[5];t&&("base64"===e[4]?this.image=atob(t):this.image=decodeURIComponent(t))}else try{const e=await this.document.fetch(t),n=await e.text();this.image=n}catch(e){console.error('Error while loading image "'.concat(t,'":'),e)}this.loaded=!0}renderChildren(t){const{document:e,image:n,loaded:i}=this,r=this.getAttribute("x").getPixels("x"),o=this.getAttribute("y").getPixels("y"),s=this.getStyle("width").getPixels("x"),a=this.getStyle("height").getPixels("y");if(i&&n&&s&&a){if(t.save(),t.translate(r,o),"string"==typeof n){const i=e.canvg.forkString(t,n,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:s,scaleHeight:a}),{documentElement:r}=i.document;r&&(r.parent=this),i.render()}else e.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:s,desiredWidth:n.width,height:a,desiredHeight:n.height}),this.loaded&&("complete"in n&&!n.complete||t.drawImage(n,0,0));t.restore()}}getBoundingBox(){const t=this.getAttribute("x").getPixels("x"),e=this.getAttribute("y").getPixels("y"),n=this.getStyle("width").getPixels("x"),i=this.getStyle("height").getPixels("y");return new bt(t,e,t+n,e+i)}constructor(t,e,n){super(t,e,n),this.type="image",this.loaded=!1;const i=this.getHrefAttribute().getString();if(!i)return;const r=i.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(i);t.images.push(this),r?this.loadSvg(i):this.loadImage(i)}},g:Tt,symbol:class extends xt{render(t){}constructor(...t){super(...t),this.type="symbol"}},style:Lt,use:class extends xt{setContext(t){super.setContext(t);const e=this.getAttribute("x"),n=this.getAttribute("y");e.hasValue()&&t.translate(e.getPixels("x"),0),n.hasValue()&&t.translate(0,n.getPixels("y"))}path(t){const{element:e}=this;e&&e.path(t)}renderChildren(t){const{document:e,element:n}=this;if(n){let i=n;if("symbol"===n.type&&(i=new Et(e),i.attributes.set("viewBox",new J(e,"viewBox",n.getAttribute("viewBox").getString())),i.attributes.set("preserveAspectRatio",new J(e,"preserveAspectRatio",n.getAttribute("preserveAspectRatio").getString())),i.attributes.set("overflow",new J(e,"overflow",n.getAttribute("overflow").getString())),i.children=n.children,n.styles.set("opacity",new J(e,"opacity",this.calculateOpacity()))),"svg"===i.type){const t=this.getStyle("width",!1,!0),n=this.getStyle("height",!1,!0);t.hasValue()&&i.attributes.set("width",new J(e,"width",t.getString())),n.hasValue()&&i.attributes.set("height",new J(e,"height",n.getString()))}const r=i.parent;i.parent=this,i.render(t),i.parent=r}}getBoundingBox(t){const{element:e}=this;return e?e.getBoundingBox(t):null}elementTransform(){const{document:t,element:e}=this;return e?dt.fromElement(t,e):null}get element(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}constructor(...t){super(...t),this.type="use"}},mask:Ht,clipPath:class extends pt{apply(t){const{document:e}=this,n=Reflect.getPrototypeOf(t),{beginPath:i,closePath:r}=t;n&&(n.beginPath=zt,n.closePath=zt),Reflect.apply(i,t,[]),this.children.forEach(i=>{if(!("path"in i))return;let o="elementTransform"in i?i.elementTransform():null;o||(o=dt.fromElement(e,i)),o&&o.apply(t),i.path(t),n&&(n.closePath=r),o&&o.unapply(t)}),Reflect.apply(r,t,[]),t.clip(),n&&(n.beginPath=i,n.closePath=r)}render(t){}constructor(...t){super(...t),this.type="clipPath"}},filter:Qt,feDropShadow:class extends pt{apply(t,e,n,i,r){}constructor(t,e,n){super(t,e,n),this.type="feDropShadow",this.addStylesFromStyleDefinition()}},feMorphology:class extends pt{apply(t,e,n,i,r){}constructor(...t){super(...t),this.type="feMorphology"}},feComposite:class extends pt{apply(t,e,n,i,r){}constructor(...t){super(...t),this.type="feComposite"}},feColorMatrix:jt,feGaussianBlur:class extends pt{apply(t,e,n,i,r){const{document:o,blurRadius:s}=this,a=o.window?o.window.document.body:null,l=t.canvas;l.id=o.getUniqueId(),a&&(l.style.display="none",a.appendChild(l)),A(l,e,n,i,r,s),a&&a.removeChild(l)}constructor(t,e,n){super(t,e,n),this.type="feGaussianBlur",this.blurRadius=Math.floor(this.getAttribute("stdDeviation").getNumber()),this.extraFilterDistance=this.blurRadius}},title:class extends pt{constructor(...t){super(...t),this.type="title"}},desc:class extends pt{constructor(...t){super(...t),this.type="desc"}}};class Xt{bindCreateImage(t,e){return"boolean"==typeof e?(n,i)=>t(n,"boolean"==typeof i?i:e):t}get window(){return this.screen.window}get fetch(){return this.screen.fetch}get ctx(){return this.screen.ctx}get emSize(){const{emSizeStack:t}=this;return t[t.length-1]||12}set emSize(t){const{emSizeStack:e}=this;e.push(t)}popEmSize(){const{emSizeStack:t}=this;t.pop()}getUniqueId(){return"canvg".concat(++this.uniqueId)}isImagesLoaded(){return this.images.every(t=>t.loaded)}isFontsLoaded(){return this.fonts.every(t=>t.loaded)}createDocumentElement(t){const e=this.createElement(t.documentElement);return e.root=!0,e.addStylesFromStyleDefinition(),this.documentElement=e,e}createElement(t){const e=t.nodeName.replace(/^[^:]+:/,""),n=Xt.elementTypes[e];return n?new n(this,t):new ft(this,t)}createTextNode(t){return new Ot(this,t)}setViewBox(t){this.screen.setViewBox({document:this,...t})}constructor(t,{rootEmSize:e=12,emSize:n=12,createCanvas:i=Xt.createCanvas,createImage:r=Xt.createImage,anonymousCrossOrigin:o}={}){this.canvg=t,this.definitions=new Map,this.styles=new Map,this.stylesSpecificity=new Map,this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=t.screen,this.rootEmSize=e,this.emSize=n,this.createCanvas=i,this.createImage=this.bindCreateImage(r,o),this.screen.wait(()=>this.isImagesLoaded()),this.screen.wait(()=>this.isFontsLoaded())}}Xt.createCanvas=function(t,e){const n=document.createElement("canvas");return n.width=t,n.height=e,n},Xt.createImage=async function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=document.createElement("img");return e&&(n.crossOrigin="Anonymous"),new Promise((e,i)=>{n.onload=()=>{e(n)},n.onerror=(t,e,n,r,o)=>{i(o)},n.src=t})},Xt.elementTypes=Wt;class Ut{static async from(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=new ct(n),r=await i.parse(e);return new Ut(t,r,n)}static fromString(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=new ct(n).parseFromString(e);return new Ut(t,i,n)}fork(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Ut.from(t,e,{...this.options,...n})}forkString(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Ut.fromString(t,e,{...this.options,...n})}ready(){return this.screen.ready()}isReady(){return this.screen.isReady()}async render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.start({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0,...t}),await this.ready(),this.stop()}start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{documentElement:e,screen:n,options:i}=this;n.start(e,{enableRedraw:!0,...i,...t})}stop(){this.screen.stop()}resize(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.documentElement.resize(t,e,n)}constructor(t,e,n={}){this.parser=new ct(n),this.screen=new st(t,n),this.options=n;const i=new Xt(this,n),r=i.createDocumentElement(e);this.document=i,this.documentElement=r}}},11750(t,e,n){"use strict";function i(t){var e,n,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t)if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(n=i(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}n.d(e,{A:()=>r});const r=function(){for(var t,e,n=0,r="",o=arguments.length;n<o;n++)(t=arguments[n])&&(e=i(t))&&(r&&(r+=" "),r+=e);return r}},11719(t,e,n){"use strict";n.d(e,{zZ:()=>u});const i=/^class[ {]/;function r(t){return Array.isArray(t)}function o(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function s(...t){1===t.length&&r(t[0])&&(t=t[0]);const e=(t=[...t]).pop();return e.$inject=t,e}const a=/constructor\s*[^(]*\(\s*([^)]*)\)/m,l=/^(?:async\s+)?(?:function\s*[^(]*)?(?:\(\s*([^)]*)\)|(\w+))/m,c=/\/\*([^*]*)\*\//m;function h(t){if("function"!=typeof t)throw new Error(`Cannot annotate "${t}". Expected a function!`);const e=t.toString().match(function(t){return i.test(t.toString())}(t)?a:l);if(!e)return[];const n=e[1]||e[2];return n&&n.split(",").map(t=>{const e=t.match(c);return(e&&e[1]||t).trim()})||[]}function u(t,e){const n=e||{get:function(t,e){if(i.push(t),!1===e)return null;throw p(`No provider for "${t}"!`)}},i=[],a=this._providers=Object.create(n._providers||null),l=this._instances=Object.create(null),c=l.injector=this,p=function(t){const e=i.join(" -> ");return i.length=0,new Error(e?`${t} (Resolving: ${e})`:t)};function f(t,e){if(!a[t]&&t.includes(".")){const e=t.split(".");let n=f(e.shift());for(;e.length;)n=n[e.shift()];return n}if(o(l,t))return l[t];if(o(a,t)){if(-1!==i.indexOf(t))throw i.push(t),p("Cannot resolve circular dependency!");return i.push(t),l[t]=a[t][0](a[t][1]),i.pop(),l[t]}return n.get(t,e)}function g(t,e){if(void 0===e&&(e={}),"function"!=typeof t){if(!r(t))throw p(`Cannot invoke "${t}". Expected a function!`);t=s(t.slice())}return{fn:t,dependencies:(t.$inject||h(t)).map(t=>o(e,t)?e[t]:f(t))}}function m(t){const{fn:e,dependencies:n}=g(t);return new(Function.prototype.bind.call(e,null,...n))}function v(t,e,n){const{fn:i,dependencies:r}=g(t,n);return i.apply(e,r)}function y(t){return s(e=>t.get(e))}function b(t,e){if(e&&e.length){const n=Object.create(null),i=Object.create(null),r=[],o=[],s=[];let l,c,h,u;for(let t in a)l=a[t],-1!==e.indexOf(t)&&("private"===l[2]?(c=r.indexOf(l[3]),-1===c?(h=l[3].createChild([],e),u=y(h),r.push(l[3]),o.push(h),s.push(u),n[t]=[u,t,"private",h]):n[t]=[s[c],t,"private",o[c]]):n[t]=[l[2],l[1]],i[t]=!0),"factory"!==l[2]&&"type"!==l[2]||!l[1].$scope||e.forEach(e=>{-1!==l[1].$scope.indexOf(e)&&(n[t]=[l[2],l[1]],i[e]=!0)});e.forEach(t=>{if(!i[t])throw new Error('No provider for "'+t+'". Cannot use provider from the parent!')}),t.unshift(n)}return new u(t,c)}const x={factory:v,type:m,value:function(t){return t}};function w(t,e){const n=t.__init__||[];return function(){n.forEach(t=>{"string"==typeof t?e.get(t):e.invoke(t)})}}function _(t){const e=t.__exports__;if(e){const n=t.__modules__,i=Object.keys(t).reduce((e,n)=>("__exports__"!==n&&"__modules__"!==n&&"__init__"!==n&&"__depends__"!==n&&(e[n]=t[n]),e),Object.create(null)),r=b((n||[]).concat(i)),o=s(function(t){return r.get(t)});e.forEach(function(t){a[t]=[o,t,"private",r]});const l=(t.__init__||[]).slice();return l.unshift(function(){r.init()}),w(t=Object.assign({},t,{__init__:l}),r)}return Object.keys(t).forEach(function(e){if("__init__"===e||"__depends__"===e)return;const n=t[e];if("private"===n[2])return void(a[e]=n);const i=n[0],r=n[1];a[e]=[x[i],d(i,r),i]}),w(t,c)}function O(t,e){return-1!==t.indexOf(e)||-1!==(t=(e.__depends__||[]).reduce(O,t)).indexOf(e)?t:t.concat(e)}this.get=f,this.invoke=v,this.instantiate=m,this.createChild=b,this.init=function(t){const e=t.reduce(O,[]).map(_);let n=!1;return function(){n||(n=!0,e.forEach(t=>t()))}}(t)}function d(t,e){return"value"!==t&&r(e)&&(e=s(e.slice())),e}},33732(t,e,n){"use strict";n.d(e,{A:()=>S});var i=/,?([a-z]),?/gi,r=parseFloat,o=Math,s=o.PI,a=o.min,l=o.max,c=o.pow,h=o.abs,u=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/gi,d=/(-?\d*\.?\d*(?:e[-+]?\d+)?)[\s]*,?[\s]*/gi,p=Array.isArray||function(t){return t instanceof Array};function f(t){if(!t)return null;var e={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},n=[];return String(t).replace(u,function(t,i,r){var o=[],s=i.toLowerCase();for(r.replace(d,function(t,e){e&&o.push(+e)}),"m"==s&&o.length>2&&(n.push([i,...o.splice(0,2)]),s="l",i="m"==i?"l":"L");o.length>=e[s]&&(n.push([i,...o.splice(0,e[s])]),e[s]););}),n.toString=m,n}function g(t,e,n,i){return 1===arguments.length&&(e=t.y,n=t.width,i=t.height,t=t.x),{x:t,y:e,width:n,height:i,x2:t+n,y2:e+i}}function m(){return this.join(",").replace(i,"$1")}function v(t,e,n,i,r,o,s,a,l){var h=1-l,u=c(h,3),d=c(h,2),p=l*l*l,f=u*e+3*d*l*i+3*h*l*l*o+p*a;return{x:O(u*t+3*d*l*n+3*h*l*l*r+p*s),y:O(f)}}function y(t){var e=function(t,e,n,i,r,s,c,u){for(var d,p,f,g,m,v,y,b,x=[],w=[[],[]],_=0;_<2;++_)if(0==_?(p=6*t-12*n+6*r,d=-3*t+9*n-9*r+3*c,f=3*n-3*t):(p=6*e-12*i+6*s,d=-3*e+9*i-9*s+3*u,f=3*i-3*e),h(d)<1e-12){if(h(p)<1e-12)continue;0<(g=-f/p)&&g<1&&x.push(g)}else y=p*p-4*f*d,b=o.sqrt(y),y<0||(0<(m=(-p+b)/(2*d))&&m<1&&x.push(m),0<(v=(-p-b)/(2*d))&&v<1&&x.push(v));for(var O,k=x.length,S=k;k--;)O=1-(g=x[k]),w[0][k]=O*O*O*t+3*O*O*g*n+3*O*g*g*r+g*g*g*c,w[1][k]=O*O*O*e+3*O*O*g*i+3*O*g*g*s+g*g*g*u;return w[0][S]=t,w[1][S]=e,w[0][S+1]=c,w[1][S+1]=u,w[0].length=w[1].length=S+2,{x0:a(...w[0]),y0:a(...w[1]),x1:l(...w[0]),y1:l(...w[1])}}(...t);return g(e.x0,e.y0,e.x1-e.x0,e.y1-e.y0)}function b(t,e,n){return e>=t.x&&e<=t.x+t.width&&n>=t.y&&n<=t.y+t.height}function x(t,e,n,i,r){return t*(t*(-3*e+9*n-9*i+3*r)+6*e-12*n+6*i)-3*e+3*n}function w(t,e,n,i,r,s,a,l,c){null==c&&(c=1);for(var h=(c=c>1?1:c<0?0:c)/2,u=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],d=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],p=0,f=0;f<12;f++){var g=h*u[f]+h,m=x(g,t,n,r,a),v=x(g,e,i,s,l),y=m*m+v*v;p+=d[f]*o.sqrt(y)}return h*p}function _(t,e,n,i,r,o,s,c){if(!(l(t,n)<a(r,s)||a(t,n)>l(r,s)||l(e,i)<a(o,c)||a(e,i)>l(o,c))){var h=(t*i-e*n)*(o-c)-(e-i)*(r*c-o*s),u=(t-n)*(o-c)-(e-i)*(r-s);if(u){var d=O(((t*i-e*n)*(r-s)-(t-n)*(r*c-o*s))/u),p=O(h/u),f=+d.toFixed(2),g=+p.toFixed(2);if(!(f<+a(t,n).toFixed(2)||f>+l(t,n).toFixed(2)||f<+a(r,s).toFixed(2)||f>+l(r,s).toFixed(2)||g<+a(e,i).toFixed(2)||g>+l(e,i).toFixed(2)||g<+a(o,c).toFixed(2)||g>+l(o,c).toFixed(2)))return{x:d,y:p}}}}function O(t){return Math.round(1e11*t)/1e11}function k(t,e,n){if(i=y(t),r=y(e),i=g(i),!(b(r=g(r),i.x,i.y)||b(r,i.x2,i.y)||b(r,i.x,i.y2)||b(r,i.x2,i.y2)||b(i,r.x,r.y)||b(i,r.x2,r.y)||b(i,r.x,r.y2)||b(i,r.x2,r.y2)||(i.x<r.x2&&i.x>r.x||r.x<i.x2&&r.x>i.x)&&(i.y<r.y2&&i.y>r.y||r.y<i.y2&&r.y>i.y)))return n?0:[];var i,r,o,s,a=w(...t),l=w(...e),c=E(t)?1:~~(a/5)||1,u=E(e)?1:~~(l/5)||1,d=new Array(c+1),p=new Array(u+1),f={},m=n?0:[];for(o=0;o<c+1;o++){var x=v(...t,o/c);d[o]={x:x.x,y:x.y,t:o/c}}for(o=0;o<u+1;o++)x=v(...e,o/u),p[o]={x:x.x,y:x.y,t:o/u};for(o=0;o<c;o++)for(s=0;s<u;s++){var O,k=d[o],S=d[o+1],C=p[s],A=p[s+1],T=h(S.x-k.x)<.01?"y":"x",P=h(A.x-C.x)<.01?"y":"x",M=_(k.x,k.y,S.x,S.y,C.x,C.y,A.x,A.y);if(M){if(f[O=M.x.toFixed(9)+"#"+M.y.toFixed(9)])continue;f[O]=!0;var N=k.t+h((M[T]-k[T])/(S[T]-k[T]))*(S.t-k.t),R=C.t+h((M[P]-C[P])/(A[P]-C[P]))*(A.t-C.t);N>=0&&N<=1&&R>=0&&R<=1&&(n?m++:m.push({x:M.x,y:M.y,t1:N,t2:R}))}}return m}function S(t,e,n){t=P(t),e=P(e);for(var i,r,o,s,a,l,c,h,u,d,p=n?0:[],f=0,g=t.length;f<g;f++){var m=t[f];if("M"==m[0])i=a=m[1],r=l=m[2];else{"C"==m[0]?(i=(u=[i,r,...m.slice(1)])[6],r=u[7]):(u=[i,r,i,r,a,l,a,l],i=a,r=l);for(var v=0,y=e.length;v<y;v++){var b=e[v];if("M"==b[0])o=c=b[1],s=h=b[2];else{"C"==b[0]?(o=(d=[o,s,...b.slice(1)])[6],s=d[7]):(d=[o,s,o,s,c,h,c,h],o=c,s=h);var x=k(u,d,n);if(n)p+=x;else{for(var w=0,_=x.length;w<_;w++)x[w].segment1=f,x[w].segment2=v,x[w].bez1=u,x[w].bez2=d;p=p.concat(x)}}}}}return p}function E(t){return t[0]===t[2]&&t[1]===t[3]&&t[4]===t[6]&&t[5]===t[7]}function C(t,e,n,i){return[t,e,n,i,n,i]}function A(t,e,n,i,r,o){var s=1/3,a=2/3;return[s*t+a*n,s*e+a*i,s*r+a*n,s*o+a*i,r,o]}function T(t,e,n,i,r,a,l,c,u,d){var p,f,g=120*s/180,m=s/180*(+r||0),v=[],y=(f=function(t,e,n){return{x:t*o.cos(n)-e*o.sin(n),y:t*o.sin(n)+e*o.cos(n)}},function t(){var e,n,i=Array.prototype.slice.call(arguments,0).join(""),r=t.cache=t.cache||{},o=t.count=t.count||[];return e=r,n=i,Object.prototype.hasOwnProperty.call(e,n)?(function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return t.push(t.splice(n,1)[0])}(o,i),r[i]):(o.length>=1e3&&delete r[o.shift()],o.push(i),r[i]=f(...arguments),r[i])});if(d)C=d[0],A=d[1],S=d[2],E=d[3];else{t=(p=y(t,e,-m)).x,e=p.y;var b=(t-(c=(p=y(c,u,-m)).x))/2,x=(e-(u=p.y))/2,w=b*b/(n*n)+x*x/(i*i);w>1&&(n*=w=o.sqrt(w),i*=w);var _=n*n,O=i*i,k=(a==l?-1:1)*o.sqrt(h((_*O-_*x*x-O*b*b)/(_*x*x+O*b*b))),S=k*n*x/i+(t+c)/2,E=k*-i*b/n+(e+u)/2,C=o.asin(((e-E)/i).toFixed(9)),A=o.asin(((u-E)/i).toFixed(9));(C=t<S?s-C:C)<0&&(C=2*s+C),(A=c<S?s-A:A)<0&&(A=2*s+A),l&&C>A&&(C-=2*s),!l&&A>C&&(A-=2*s)}var P=A-C;if(h(P)>g){var M=A,N=c,R=u;A=C+g*(l&&A>C?1:-1),v=T(c=S+n*o.cos(A),u=E+i*o.sin(A),n,i,r,0,l,N,R,[A,M,S,E])}P=A-C;var D=o.cos(C),B=o.sin(C),$=o.cos(A),L=o.sin(A),I=o.tan(P/4),q=4/3*n*I,F=4/3*i*I,V=[t,e],j=[t+q*B,e-F*D],H=[c+q*L,u-F*$],z=[c,u];if(j[0]=2*V[0]-j[0],j[1]=2*V[1]-j[1],d)return[j,H,z].concat(v);for(var Q=[],W=0,X=(v=[j,H,z].concat(v).join().split(",")).length;W<X;W++)Q[W]=W%2?y(v[W-1],v[W],m).y:y(v[W],v[W+1],m).x;return Q}function P(t){if(function(t){return p(t)&&p(t[0])}(t)||(t=f(t)),function(t){for(var e=0,n=t.length;e<n;e++){var i=t[e][0];if("M"!==i&&"C"!==i)return!1}return!0}(t))return t;for(var e=function(t){for(var e=new Array(t.length),n=0,i=t.length;n<i;n++)for(var r=t[n],o=e[n]=new Array(r.length),s=0,a=r.length;s<a;s++)o[s]=r[s];return e.toString=m,e}(function(t){if(function(t){for(var e=0,n=t.length;e<n;e++){var i=t[e][0];if("string"==typeof i&&i!==i.toUpperCase())return!1}return!0}(t))return t;var e,n=new Array(t.length),i=0,r=0,o=0,s=0,a=0;"M"==t[0][0]&&(o=i=+t[0][1],s=r=+t[0][2],a++,n[0]=["M",i,r]);for(var l,c,h=a,u=t.length;h<u;h++){if(e=(c=t[h])[0],n[h]=l=new Array(c.length),e!=e.toUpperCase())switch(l[0]=e.toUpperCase(),l[0]){case"A":l[1]=c[1],l[2]=c[2],l[3]=c[3],l[4]=c[4],l[5]=c[5],l[6]=+c[6]+i,l[7]=+c[7]+r;break;case"V":l[1]=+c[1]+r;break;case"H":l[1]=+c[1]+i;break;case"M":o=+c[1]+i,s=+c[2]+r;default:for(var d=1,p=c.length;d<p;d++)l[d]=+c[d]+(d%2?i:r)}else for(var f=0,g=c.length;f<g;f++)l[f]=c[f];switch(e=e.toUpperCase(),l[0]){case"Z":i=+o,r=+s;break;case"H":i=l[1];break;case"V":r=l[1];break;case"M":o=l[l.length-2],s=l[l.length-1];default:i=l[l.length-2],r=l[l.length-1]}}return n.toString=m,n}(t)),n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},i=function(t,e,n){var i,r;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C",...T(e.x,e.y,...t.slice(1))];break;case"S":"C"==n||"S"==n?(i=2*e.x-e.bx,r=2*e.y-e.by):(i=e.x,r=e.y),t=["C",i,r,...t.slice(1)];break;case"T":"Q"==n||"T"==n?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C",...A(e.x,e.y,e.qx,e.qy,t[1],t[2])];break;case"Q":e.qx=t[1],e.qy=t[2],t=["C",...A(e.x,e.y,t[1],t[2],t[3],t[4])];break;case"L":t=["C",...C(e.x,e.y,t[1],t[2])];break;case"H":t=["C",...C(e.x,e.y,t[1],e.y)];break;case"V":t=["C",...C(e.x,e.y,e.x,t[1])];break;case"Z":t=["C",...C(e.x,e.y,e.X,e.Y)]}return t},o=function(t,n){if(t[n].length>7){t[n].shift();for(var i=t[n];i.length;)s[n]="A",t.splice(n++,0,["C",...i.splice(0,6)]);t.splice(n,1),h=e.length}},s=[],a="",l="",c=0,h=e.length;c<h;c++){e[c]&&(a=e[c][0]),"C"!=a&&(s[c]=a,c&&(l=s[c-1])),e[c]=i(e[c],n,l),"A"!=s[c]&&"C"==a&&(s[c]="C"),o(e,c);var u=e[c],d=u.length;n.x=u[d-2],n.y=u[d-1],n.bx=r(u[d-4])||n.x,n.by=r(u[d-3])||n.y}return e}},27828(t,e,n){"use strict";function i(t,e){return e.appendChild(function(t,e){if(t.ownerDocument!==e.ownerDocument)try{return e.ownerDocument.importNode(t,!0)}catch(t){}return t}(t,e))}function r(t,e){return i(e,t),t}n.d(e,{BC:()=>r,CF:()=>a,IU:()=>u,LI:()=>C,Ly:()=>c,TF:()=>A,l1:()=>w,o8:()=>d,pd:()=>P,uK:()=>x,vt:()=>m});var o={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":2,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":2,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function s(t,e,n){var i=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=o[i];r?(2===r&&"number"==typeof n&&(n=String(n)+"px"),t.style[i]=n):t.setAttributeNS(null,e,n)}function a(t,e,n){if("string"==typeof e){if(void 0===n)return function(t,e){return o[e]?t.style[e]:t.getAttributeNS(null,e)}(t,e);s(t,e,n)}else!function(t,e){var n,i,r=Object.keys(e);for(n=0;i=r[n];n++)s(t,i,e[i])}(t,e);return t}const l=Object.prototype.toString;function c(t){return new h(t)}function h(t){if(!t||!t.nodeType)throw new Error("A DOM element reference is required");this.el=t,this.list=t.classList}function u(t){for(var e;e=t.firstChild;)t.removeChild(e);return t}function d(t){return t.cloneNode(!0)}h.prototype.add=function(t){return this.list.add(t),this},h.prototype.remove=function(t){return"[object RegExp]"==l.call(t)?this.removeMatching(t):(this.list.remove(t),this)},h.prototype.removeMatching=function(t){const e=this.array();for(let n=0;n<e.length;n++)t.test(e[n])&&this.remove(e[n]);return this},h.prototype.toggle=function(t,e){return void 0!==e?e!==this.list.toggle(t,e)&&this.list.toggle(t):this.list.toggle(t),this},h.prototype.array=function(){return Array.from(this.list)},h.prototype.has=h.prototype.contains=function(t){return this.list.contains(t)};var p="http://www.w3.org/2000/svg",f='<svg xmlns="'+p+'"';function g(t){var e=!1;"<svg"===t.substring(0,4)?-1===t.indexOf(p)&&(t=f+t.substring(4)):(t=f+">"+t+"</svg>",e=!0);var n=function(t){var e;return(e=new DOMParser).async=!1,e.parseFromString(t,"text/xml")}(t);if(!e)return n;for(var i=document.createDocumentFragment(),r=n.firstChild;r.firstChild;)i.appendChild(r.firstChild);return i}function m(t,e){var n;return"<"===(t=t.trim()).charAt(0)?(n=g(t).firstChild,n=document.importNode(n,!0)):n=document.createElementNS(p,t),e&&a(n,e),n}var v=null;function y(){return null===v&&(v=m("svg")),v}function b(t,e){var n,i,r=Object.keys(e);for(n=0;i=r[n];n++)t[i]=e[i];return t}function x(t,e,n,i,r,o){var s=y().createSVGMatrix();switch(arguments.length){case 0:return s;case 1:return b(s,t);case 6:return b(s,{a:t,b:e,c:n,d:i,e:r,f:o})}}function w(t){return t?y().createSVGTransformFromMatrix(t):y().createSVGTransform()}var _=/([&<>]{1})/g,O=/([&<>\n\r"]{1})/g,k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"'"};function S(t,e){return t.replace(e,function(t,e){return k[e]||e})}function E(t,e){var n,i,r,o,s;switch(t.nodeType){case 3:e.push(S(t.textContent,_));break;case 1:if(e.push("<",t.tagName),t.hasAttributes())for(n=0,i=(r=t.attributes).length;n<i;++n)o=r.item(n),e.push(" ",o.name,'="',S(o.value,O),'"');if(t.hasChildNodes()){for(e.push(">"),n=0,i=(s=t.childNodes).length;n<i;++n)E(s.item(n),e);e.push("</",t.tagName,">")}else e.push("/>");break;case 8:e.push("\x3c!--",S(t.nodeValue,_),"--\x3e");break;case 4:e.push("<![CDATA[",t.nodeValue,"]]>");break;default:throw new Error("unable to handle node "+t.nodeType)}return e}function C(t,e){if(void 0!==e){try{!function(t,e){var n=g(e);if(u(t),e){(function(t){return"#document-fragment"===t.nodeName})(n)||(n=n.documentElement);for(var r,o=(r=n.childNodes,Array.prototype.slice.call(r)),s=0;s<o.length;s++)i(o[s],t)}}(t,e)}catch(t){throw new Error("error parsing SVG: "+t.message)}return t}return function(t){for(var e=t.firstChild,n=[];e;)E(e,n),e=e.nextSibling;return n.join("")}(t)}function A(t){var e=t.parentNode;return e&&e.removeChild(t),t}function T(t,e){return e instanceof SVGMatrix?t.createSVGTransformFromMatrix(e):e}function P(t,e){var n=t.transform.baseVal;return e&&(Array.isArray(e)||(e=[e]),function(t,e){var n,i;for(t.clear(),n=0;i=e[n];n++)t.appendItem(T(t,i))}(n,e)),n.consolidate()}}}]);
//# sourceMappingURL=6570.js.map