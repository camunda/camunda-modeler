"use strict";(self.webpackChunkcamunda_modeler_client=self.webpackChunkcamunda_modeler_client||[]).push([[5297],{49281(e,t,n){n.d(t,{A:()=>i});const i={__init__:[n(93366).A]}},72794(e,t,n){n.d(t,{A:()=>i});class i{constructor(e){this._variableResolver=e,this.register()}getVariables(e){}register(){this._variableResolver.registerProvider(this)}}i.$inject=["variableResolver"]},28148(e,t,n){n.d(t,{e1:()=>te,wN:()=>ee});var i=n(57094);function a(e,t,n){var a=function(e,t){var n=[],a=e.get("extensionElements");if(void 0!==a){var r=a.get("values");void 0!==r&&(n=(0,i.filter)(r,function(e){return function(e,t){return e&&"function"==typeof e.$instanceOf&&e.$instanceOf(t)}(e,t)}))}return n}(e,t);return a}function r(e,t){var n=function(e){return(a(e,"camunda:InputOutput")||[])[0]}(e);return n&&n.get(t)||[]}function o(e,t,n){n=n||0,(0,i.isArray)(e)||(e=[e]),(0,i.forEach)(e,function(e,a){var r=t(e,a,n);(0,i.isArray)(r)&&r.length&&o(r,t,n+1)})}function s(e,t,n){var i=!n||-1===e.indexOf(t);return i&&e.push(t),i}function c(e,t,n){var i=[],a=[];return o(e,function(e,n,r){s(i,e,t);var o=e.flowElements;if(o&&s(a,o,t))return o}),i}function p(e,t){var n,a,r=(0,i.findIndex)(e,function(e){return e.name===t.name&&e.scope===t.scope});r>=0?e[r].origin=(n=e[r].origin,a=t.origin,n.concat(a)):e.push(t)}function l(e,t,n){var a,o,s,c,p=(a=n,o=t,s=function(e){for(var t=[],n=e;n.$parent;)t.push(n.$parent),n=n.$parent;return t}(e),c=(0,i.find)(s,function(e){return(t=e)&&"function"==typeof t.$instanceOf&&t.$instanceOf("bpmn:SubProcess")&&function(e,t){return(0,i.find)(function(e){return r(e,"inputParameters")}(e),function(e){return e.name===t})}(e,o);var t}),c||a);return{name:t,origin:[e],scope:p}}function m(e,t){var n=e.eventDefinitions;return n&&t?(0,i.filter)(n,function(e){return function(e,t){return e&&"function"==typeof e.$instanceOf&&e.$instanceOf(t)}(e,t)}):n}var u=[function(e){var t=e.elements,n=e.containerElement,a=e.processVariables;return(0,i.isArray)(t)||(t=[t]),(0,i.forEach)(t,function(e){var t=function(e){return r(e,"outputParameters")}(e);(0,i.forEach)(t,function(t){var i=l(e,t.name,n);p(a,i)})}),a},function(e){var t=e.elements,n=e.containerElement,a=e.processVariables;return(0,i.isArray)(t)||(t=[t]),(0,i.forEach)(t,function(e){var t=function(e){return e.get("camunda:resultVariable")}(e);if(t){var i=l(e,t,n);p(a,i)}}),a},function(e){var t=e.elements,n=e.containerElement,r=e.processVariables;return(0,i.isArray)(t)||(t=[t]),(0,i.forEach)(t,function(e){var t=function(e){var t=function(e){return a(e,"camunda:FormData")[0]}(e);return t&&t.get("fields")||[]}(e);(0,i.forEach)(t,function(t){var i=l(e,t.id,n);p(r,i)})}),r},function(e){var t=e.elements,n=e.containerElement,r=e.processVariables;return(0,i.isArray)(t)||(t=[t]),(0,i.forEach)(t,function(e){var t=function(e){return a(e,"camunda:Out")}(e);(0,i.forEach)(t,function(t){if(!t.local){var i=l(e,t.target,n);p(r,i)}})}),r},function(e){var t=e.elements,n=e.containerElement,a=e.processVariables,r=function(e,t){var i=l(e,t,n);p(a,i)};return(0,i.isArray)(t)||(t=[t]),(0,i.forEach)(t,function(e){var t=function(e){return m(e,"bpmn:ErrorEventDefinition")}(e);(0,i.forEach)(t,function(t){var n=t.get("errorCodeVariable"),i=t.get("errorMessageVariable");n&&r(e,n),i&&r(e,i)});var n=function(e){return m(e,"bpmn:EscalationEventDefinition")}(e);(0,i.forEach)(n,function(t){var n=t.get("escalationCodeVariable");n&&r(e,n)})}),a}];function d(e,t=[]){const n=[];var a=[],r=function(e,t){return c(e,!t)}([e],!1);return(0,i.forEach)([...u,...t],function(t){n.push(t({elements:r,containerElement:e,processVariables:a}))}),Promise.all(n).then(()=>a)}var h=n(70868);class f{constructor(e){this._generate=e,this.value=null,this.valid=!1}invalidate(){this.valid=!1}get(){return this.valid||(this.value=this._generate(),this.valid=!0),this.value}}function v(e,t=void 0){const n=e.get("extensionElements");if(!n)return[];const i=n.get("values");return i&&i.length?t?i.filter(e=>(0,h.is)(e,t)):i:[]}function g(e){return b(e,"zeebe:IoMapping")[0]||b(e,"camunda:InputOutput")[0]}function y(e,t){var n=g(e);return n&&n.get(t)||[]}function b(e,t){var n=[],a=e.get("extensionElements");if(void 0!==a){var r=a.get("values");void 0!==r&&(n=(0,i.filter)(r,function(e){return(0,h.is)(e,t)}))}return n}function E(e,t,n){var i=x(e);if(function(e){return!!function(e){return y(e,"outputParameters")}(e).length}(e))return e;var a=i.find(function(e){return(0,h.is)(e,"bpmn:SubProcess")&&function(e,t){return function(e){return y(e,"inputParameters")}(e).find(function(e){return e.target===t||e.name===t})}(e,n)});return a||t}function x(e){for(var t=[],n=e;n.$parent;)t.push(n.$parent),n=n.$parent;return t}class w{constructor(e,t){this.providers=[],this._eventBus=e,this._bpmnjs=t,this.rawVariables=new f(this._generateRawVariables.bind(this)),this.parsedVariables=new f(async()=>{const t={variables:await this.getRawVariables()};return e.fire("variableResolver.parseVariables",t),t.variables}),e.on(["commandStack.changed","diagram.clear","import.done","variables.changed"],()=>{this.invalidateCache()}),e.on("variableResolver.parseVariables",(e,t)=>{t.variables=this._parseVariables(t.variables)})}_baseExtractor(){return[]}async getRawVariables(){return await this.rawVariables.get()}async getVariables(){return await this.parsedVariables.get()}invalidateCache(){this.rawVariables.invalidate(),this.parsedVariables.invalidate()}async _generateRawVariables(){const e=this._bpmnjs,t={},n=e.getDefinitions().get("rootElements").map(async e=>{const n=await this._baseExtractor(e,[this._extractor.bind(this)]);t[e.id]=n.map(e=>(e.provider||(e.provider=[this._baseExtractor]),e))});return await Promise.all(n),t}_parseVariables(e){const t={};for(const n in e){const i=e[n],a=[];i.forEach(e=>{const t=a.find(t=>t.name===e.name&&t.scope===e.scope);t?(_("origin",t,e),_("provider",t,e),S(t,e)):a.push(e)}),C(a),t[n]=a}return t}async _extractor(e){const{elements:t,containerElement:n,processVariables:i}=e,a=this,r=t.flatMap(e=>a.providers.map(async t=>{const a=await t.getVariables(e);a&&a.forEach(a=>{i.push({...N(a),origin:[e],scope:a.scope||E(e,n,a.name),provider:[t]})})}));await Promise.all(r)}registerProvider(e){this.providers.push(e),this.invalidateCache()}async getProcessVariables(e){const t=(0,h.Cf)(e);return(await this.getVariables())[t.id]||[]}async getVariablesForElement(e){const t=(0,h.Cf)(e),n=function(e){const t=(0,h.Cf)(e);if((0,h.is)(t,"bpmn:Participant"))return t.processRef;if((0,h.is)(t,"bpmn:Process"))return t;let n=t;for(;n.$parent&&!(0,h.is)(n,"bpmn:Process");)n=n.$parent;return n}(t),i=await this.getProcessVariables(n);var a=i.filter(function(e){return e.scope.id===t.id}),r=x(t);const o=[...a,...i.filter(function(e){return r.find(function(t){return t.id===e.scope.id})})].reverse(),s=new Set;return o.filter(e=>!!e.provider.find(e=>e!==this._baseExtractor)||!s.has(e.name)&&(s.add(e.name),!0))}}function _(e,t,n){n[e]||(n[e]=[]),t[e]||(t[e]=[]);const i=n[e].filter(n=>!t[e].includes(n));t[e].push(...i)}function S(e,t,n=[]){n.includes(t)||n.includes(e)||(n.push(t),n.push(e),e.type=A(e.type,t.type,"|"),e.info=A(e.info,t.info,"\n"),e.isList=!!e.isList==!!t.isList?e.isList:"optional",t.entries&&(e.entries||(e.entries=[]),t.entries.forEach(t=>{const i=e.entries.find(e=>e.name===t.name);i?S(i,t,n):e.entries.push(t)})))}w.$inject=["eventBus","bpmnjs"];const A=(e,t,n)=>{if(e&&e!==t){const i=e.split(n);return i.includes(t)||i.push(t),i.join(n)}return t};function C(e){e&&e.forEach(e=>{e.detail=e.type,C(e.entries)})}function N(e){const t={...e};return t.entries&&(t.entries=t.entries.map(N)),t}function T(e){return(k(e,"zeebe:IoMapping")||[])[0]}function D(e){return(T(e)||{}).outputParameters}function k(e,t,n){var a=function(e,t){var n=[],a=e.get("extensionElements");if(void 0!==a){var r=a.get("values");void 0!==r&&(n=(0,i.filter)(r,function(e){return function(e,t){return e&&"function"==typeof e.$instanceOf&&e.$instanceOf(t)}(e,t)}))}return n}(e,t);return a}function P(e,t,n){n=n||0,(0,i.isArray)(e)||(e=[e]),(0,i.forEach)(e,function(e,a){var r=t(e,a,n);(0,i.isArray)(r)&&r.length&&P(r,t,n+1)})}function R(e,t,n){var i=!n||-1===e.indexOf(t);return i&&e.push(t),i}function B(e,t,n){var i=[],a=[];return P(e,function(e,n,r){R(i,e,t);var o=e.flowElements;if(o&&R(a,o,t))return o}),i}function M(e,t){var n,a,r=(0,i.findIndex)(e,function(e){return e.name===t.name&&e.scope===t.scope});r>=0?e[r].origin=(n=e[r].origin,a=t.origin,n.concat(a)):e.push(t)}function I(e,t,n){var a,r,o,s,c=(a=n,r=t,o=function(e){for(var t=[],n=e;n.$parent;)t.push(n.$parent),n=n.$parent;return t}(e),s=(0,i.find)(o,function(e){return(t=e)&&"function"==typeof t.$instanceOf&&t.$instanceOf("bpmn:SubProcess")&&function(e,t){return(0,i.find)(function(e){return function(e){var t=T(e);return t&&t.get("inputParameters")||[]}(e)}(e),function(e){return e.target===t})}(e,r);var t}),s||a);return{name:t,origin:[e],scope:c}}var F=[function(e){var t=e.elements,n=e.processVariables;return(0,i.isArray)(t)||(t=[t]),(0,i.forEach)(t,function(e){var t=function(e){return(T(e)||{}).inputParameters}(e);(0,i.forEach)(t,function(t){var i=I(e,t.target,e);M(n,i)})}),n},function(e){var t=e.elements,n=e.processVariables;return(0,i.isArray)(t)||(t=[t]),(0,i.forEach)(t,function(e){var t=e.loopCharacteristics,i=t&&function(e){const t=k(e,"zeebe:LoopCharacteristics")[0];return t&&t.inputElement}(t);if(i){var a=I(e,i,e);M(n,a)}}),n},function(e){var t=e.elements,n=e.containerElement,a=e.processVariables;return(0,i.isArray)(t)||(t=[t]),(0,i.forEach)(t,function(e){var t=D(e);(0,i.forEach)(t,function(t){var i=I(e,t.target,n);M(a,i)})}),a},function(e){var t=e.elements,n=e.containerElement,a=e.processVariables;return(0,i.isArray)(t)||(t=[t]),(0,i.forEach)(t,function(e){var t=e.loopCharacteristics,i=t&&function(e){const t=k(e,"zeebe:LoopCharacteristics")[0];return t&&t.outputCollection}(t);if(i){var r=I(e,i,n);M(a,r)}}),a},function(e){var t=e.elements,n=e.containerElement,a=e.processVariables;return(0,i.isArray)(t)||(t=[t]),(0,i.forEach)(t,function(e){var t=function(e){return(k(e,"zeebe:CalledDecision")||[])[0]}(e)||function(e){return(k(e,"zeebe:Script")||[])[0]}(e);if(t){var i=t.resultVariable;if(function(e){var t=D(e);return t&&t.length}(e)&&(n=e,a.some(e=>e.name===i)))return a;if(i){var r=I(e,i,n);M(a,r)}}}),a}];function j(e,t=[]){var n=[],a=function(e,t){return B(e,!t)}([e],!1);const r=[];return(0,i.forEach)([...F,...t],function(t){r.push(t({elements:a,containerElement:e,processVariables:n}))}),Promise.all(r).then(()=>n)}var O=n(60805),L=n(782);class $ extends O.oX{constructor(e={entries:{}}){super(e);const t=this.value.entries=this.value.entries||{};for(const[e,n]of Object.entries(t))n instanceof $||(t[e]=$.of(n))}getKeys(){return Object.keys(this.value.entries)}get(e){const t=this.value.entries[e];if(!t)return t;const n=t?.value.atomicValue;return n?.fn?n:t}set(e,t){return this.constructor.of({...this.value,entries:{...this.value.entries,[e]:t}})}static __unwrap(e){return this.isAtomic(e)?e instanceof this?e.value:{atomicValue:e}:e}static __merge(e,t){const{entries:n={},...i}=this.__unwrap(e),{entries:a={},...r}=this.__unwrap(t);return{...i,...r,entries:super.__merge(n,a)}}}function z(e){const t=[];return e.forEach(e=>{e.origin.forEach(n=>{const i=function(e,t){const n=e.scope!==t?G(e,t)||H(e,t):H(e,t)||G(e,t);if(!n)return;return{expression:n,unresolved:W(V(n))}}(e,n);if(!i)return;const{expression:a,unresolved:r}=i;t.push({variable:e,expression:a,unresolved:r})})}),function(e,t){const n=[];e.forEach(e=>{const{variable:t,unresolved:i}=e,a=n.findIndex(({unresolved:e})=>e.includes(t.name));if(a>-1)return void n.splice(a,0,e);const r=n.findLastIndex(({variable:e})=>i.includes(e.name));r>-1?n.splice(r+1,0,e):n.push(e)});const i={name:"OuterContext",entries:U(t.filter(t=>!e.find(({variable:e})=>{})))},a=[];return n.forEach(({variable:e,expression:t})=>{const n=V(t,function(e,t){const n={entries:{}},i=t.origin.flatMap(e=>[e,...x(e)]);for(const t in e.entries){const a=e.entries[t];i.find(e=>e.id===a.scope.id)&&(n.entries[t]=a)}return n}(i,e));let r=n.computedValue();r instanceof $||(r=$.of(r)),r.scope=e.scope,i.entries[e.name]=r,a.push({newVariable:K({[e.name]:r})[0],oldVariable:e})}),a.map(({newVariable:e,oldVariable:t})=>t?{...e,...t}:e)}(t,e)}function V(e,t={}){const n=(0,O.L$)(t,$);let i=n.start;const a=new L.Aj({start:n.start,reduce(...e){const t=n.reduce(...e);return i=t,t}}),r=O.K3.configure({contextTracker:a,strict:!0});try{r.parse(e)}catch(e){return i}return i}function G(e,t){const n=v(t,"zeebe:IoMapping")[0];if(!n)return;let i;if(i=t===e.scope?n.inputParameters:n.outputParameters,!i)return;const a=i.slice().reverse().find(t=>t.target===e.name);return a&&a.source?a.source.substring(1):void 0}function H(e,t){const n=v(t,"zeebe:Script")[0];if(n&&n.expression)return n.resultVariable===e.name?n.expression.substring(1):void 0}function W(e){const t=[];return t.push(...e.children.flatMap(W)),"VariableName"!==e.name||e.value||t.push(e.raw),t}function U(e){if(!e)return;const t={};return e.forEach(e=>{t[e.name]={...e},t[e.name].entries=U(e.entries)}),t}function K(e){if(!e)return;const t=[];for(const n in e){let i=e[n];i instanceof $&&(i=i.value),i?t.push({...q(i),entries:K(i.entries),name:n,scope:i.scope}):t.push({name:n})}return t}function q(e){return{...e,type:J(e),info:X(e)}}function J(e){return e?e.type?e.type:e.entries&&Object.keys(e.entries).length?"Context":e.atomicValue?(t=typeof e.atomicValue).charAt(0).toUpperCase()+t.slice(1):"":"";var t}function X(e){return e?e.info?e.info:e.atomicValue?""+e.atomicValue:"":""}var Y=n(72794);class Q extends Y.A{getVariables(e){const t=[],n=v(e,"zeebe:TaskHeaders")[0];if(!n||!n.values)return;const i=n.values,a=i.find(e=>"resultVariable"===e.key),r=i.find(e=>"resultExpression"===e.key);if(a&&a.value&&t.push({name:a.value}),r&&r.value){const e=K(V(r.value.substring(1)).computedValue());e&&e.length>0&&t.push(...e[0].entries)}return t}}const Z=Q,ee={__init__:["variableResolver","connectorVariableProvider"],variableResolver:["type",class extends w{constructor(e,t){super(e,t),this._baseExtractor=j,e.on("variableResolver.parseVariables",2e3,this._resolveVariables)}async getVariablesForElement(e,t){const n=await super.getVariablesForElement(e),i=(0,h.Cf)(e);if(!t)return n;const a=g(i);if(!a)return n;const r=function(e,t){const n=[];if((0,h.is)(e,"zeebe:Input")){const i=t.inputParameters,a=i.slice(i.indexOf(e)).map(e=>e.target);n.push(...a)}const i=t.outputParameters;if((0,h.is)(e,"zeebe:Output")){const t=i.slice(i.indexOf(e)).map(e=>e.target);n.push(...t)}else if(i){const e=i.map(e=>e.target);n.push(...e)}return n}(t,a);return n.filter(e=>e.origin.length>1||e.origin[0]!==i||!(!(0,h.is)(t,"zeebe:Output")||!e.provider.find(e=>e!==this._baseExtractor))||!r.includes(e.name))}_resolveVariables(e,t){const n=t.variables,i={};for(const e in n){const t=n[e],a=z(t);i[e]=[...t,...a]}t.variables=i}}],connectorVariableProvider:["type",Z]},te={__init__:["variableResolver"],variableResolver:["type",class extends w{constructor(e,t){super(e,t),this._baseExtractor=d}}]}},30939(e,t,n){n.d(t,{A:()=>v});var i=n(70868),a=n(42720);class r{constructor(e,t,n,i,a,r){this._canvas=e,this._elementRegistry=n,this._eventBus=i,this._lintingAnnotations=a,this._selection=r,this._active=t&&t.active||!1,this._reports=[],i.on("selection.changed",()=>this._update()),i.on("lintingAnnotations.click",({report:e})=>this.showError(e))}showError(e){const{id:t,propertiesPanel:n={}}=e,i=this._getSelectableElement(t);i&&(this._canvas.scrollToElement(i),i===this._canvas.getRootElement()?this._selection.select():this._selection.select(i));const{entryIds:a=[]}=n;setTimeout(()=>{this._eventBus.fire("propertiesPanel.showEntry",{id:a[Math.max(0,a.length-1)]})})}setErrors(e){this._reports=e,this._update()}activate(){this._active=!0,this._update()}deactivate(){this._active=!1,this._update()}isActive(){return this._active}_update(){this._lintingAnnotations.setErrors(this.isActive()?this._reports:[]);const e=this._getSelectedElement();this._eventBus.fire("propertiesPanel.setErrors",{errors:(0,a.Yl)(this._reports,e)})}_getSelectableElement(e){let t=this._elementRegistry.get(e);return t||(t=this._elementRegistry.filter(t=>(0,i.is)(t,"bpmn:Participant")&&(0,i.Cf)(t).get("processRef").get("id")===e)[0]),t}_getSelectedElement(){const e=this._selection.get();if(!e||!e.length)return this._canvas.getRootElement();const t=e[0];return t.labelTarget?t.labelTarget:t}}r.$inject=["canvas","config.linting","elementRegistry","eventBus","lintingAnnotations","selection"];var o=n(57094),s=n(93083),c=n.n(s),p=n(29610),l=n(60616),m=n(11750);const u={error:p.qy`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <path d="M16,2C8.3,2,2,8.3,2,16s6.3,14,14,14s14-6.3,14-14S23.7,2,16,2z M21.4,23L16,17.6L10.6,23L9,21.4l5.4-5.4L9,10.6L10.6,9
    l5.4,5.4L21.4,9l1.6,1.6L17.6,16l5.4,5.4L21.4,23z" fill="currentColor" />
</svg>
`,warn:p.qy`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
<path d="M16,2C8.3,2,2,8.3,2,16s6.3,14,14,14s14-6.3,14-14C30,8.3,23.7,2,16,2z M14.9,8h2.2v11h-2.2V8z M16,25
  c-0.8,0-1.5-0.7-1.5-1.5S15.2,22,16,22c0.8,0,1.5,0.7,1.5,1.5S16.8,25,16,25z" fill="currentColor" />
</svg>
`,info:p.qy`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <path d="M16,2A14,14,0,1,0,30,16,14,14,0,0,0,16,2Zm0,6a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,16,8Zm4,16.125H12v-2.25h2.875v-5.75H13v-2.25h4.125v8H20Z" fill="currentColor" />
</svg>
`};function d(e){const{onClick:t=()=>{},reports:n}=e,i=n.find(({category:e})=>"error"===e)?"error":n.find(({category:e})=>"warn"===e)?"warn":"info";return p.qy`
    <div
      class=${(0,m.A)("cl-icon",`cl-icon-${i}`)}
      onClick=${t}
      title="Click to show issue"
    >
      ${u[i]}
    </div>
  `}function h(e,t){return(0,l.render)(p.qy`<${d} ...${t} />`,e)}class f{constructor(e,t,n,i){this._canvas=e,this._elementRegistry=t,this._eventBus=n,this._overlays=i,this._reportsByElement={},this._overlayIds={}}setErrors(e){this._reportsByElement=(0,o.groupBy)(e.filter(e=>"rule-error"!==e.category),"id"),this._update()}_update(e){e||(e=this._reportsByElement),this._overlays.remove({type:"linting"}),Object.entries(e).forEach(([e,t])=>{const n=this._elementRegistry.get(e);if(!n||n===this._canvas.getRootElement())return;const a=c()('\n        <div class="cl-overlay-root"></div>\n      ');h(a,{reports:t,onClick:()=>{this._eventBus.fire("lintingAnnotations.click",{report:t[0]})}});const r=function(e){return e.parent?{bottom:14,left:-6}:(0,i.is)(e,"bpmn:SubProcess")?{top:50,left:150}:{top:20,left:150}}(n),o=this._overlays.add(n,"linting",{position:r,html:a,scale:{min:.7}});this._overlayIds[e]=o})}}f.$inject=["canvas","elementRegistry","eventBus","overlays"];const v={__init__:["linting","lintingAnnotations"],linting:["type",r],lintingAnnotations:["type",f]}},5418(e,t,n){function i(e,t,n,i){this._contextPad=e,this._popupMenu=t,this._canvas=n,this._translate=i,e.registerProvider(this)}function a(e,t){var n=e.getPad(t).html.getBoundingClientRect();return{x:n.left,y:n.bottom+5}}n.d(t,{A:()=>c}),i.$inject=["contextPad","popupMenu","canvas","translate"],i.prototype.getContextPadEntries=function(e){return this._createPopupAction([e])},i.prototype.getMultiElementContextPadEntries=function(e){return this._createPopupAction(e)},i.prototype._createPopupAction=function(e){const t=this._translate,n=this._contextPad,i=this._popupMenu;return{"set-color":{group:"edit",className:"bpmn-icon-color",title:t("Set color"),html:'<div class="entry"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor">\n  <path d="m12.5 5.5.3-.4 3.6-3.6c.5-.5 1.3-.5 1.7 0l1 1c.5.4.5 1.2 0 1.7l-3.6 3.6-.4.2v.2c0 1.4.6 2 1 2.7v.6l-1.7 1.6c-.2.2-.4.2-.6 0L7.3 6.6a.4.4 0 0 1 0-.6l.3-.3.5-.5.8-.8c.2-.2.4-.1.6 0 .9.5 1.5 1.1 3 1.1zm-9.9 6 4.2-4.2 6.3 6.3-4.2 4.2c-.3.3-.9.3-1.2 0l-.8-.8-.9-.8-2.3-2.9" />\n</svg></div>',action:{click:(t,r)=>{var o={...a(n,e),cursor:{x:t.x,y:t.y}};i.open(e,"color-picker",o)}}}}};const r=[{label:"Default",fill:void 0,stroke:void 0},{label:"Blue",fill:"#BBDEFB",stroke:"#0D4372"},{label:"Orange",fill:"#FFE0B2",stroke:"#6B3C00"},{label:"Green",fill:"#C8E6C9",stroke:"#205022"},{label:"Red",fill:"#FFCDD2",stroke:"#831311"},{label:"Purple",fill:"#E1BEE7",stroke:"#5B176D"}];function o(e,t,n,i,a){this._popupMenu=n,this._modeling=i,this._translate=a,this._colors=e&&e.colors||r,this._defaultFillColor=t&&t.defaultFillColor||"white",this._defaultStrokeColor=t&&t.defaultStrokeColor||"rgb(34, 36, 42)",this._popupMenu.registerProvider("color-picker",this)}function s(e,t,n){return function(){e.setColor(t,n)}}o.$inject=["config.colorPicker","config.bpmnRenderer","popupMenu","modeling","translate"],o.prototype.getEntries=function(e){var t=this;return this._colors.map(function(n){var i='\n    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" height="100%" width="100%">\n      <rect rx="2" x="1" y="1" width="22" height="22" fill="var(--fill-color)" stroke="var(--stroke-color)" style="stroke-width:2"></rect>\n    </svg>\n  '.replace("var(--fill-color)",n.fill||t._defaultFillColor).replace("var(--stroke-color)",n.stroke||t._defaultStrokeColor);return{title:t._translate(n.label),id:n.label.toLowerCase()+"-color",imageHtml:i,action:s(t._modeling,e,n)}})};const c={__init__:["colorContextPadProvider","colorPopupProvider"],colorContextPadProvider:["type",i],colorPopupProvider:["type",o]}},33428(e,t,n){n.d(t,{Sl:()=>ge,t7:()=>ne,y:()=>ve});const i=Object.prototype.toString,a=Object.prototype.hasOwnProperty;function r(e){return void 0===e}function o(e){return"[object Array]"===i.call(e)}function s(e){return"[object Object]"===i.call(e)}function c(e){return"[object Number]"===i.call(e)}function p(e){const t=i.call(e);return"[object Function]"===t||"[object AsyncFunction]"===t||"[object GeneratorFunction]"===t||"[object AsyncGeneratorFunction]"===t||"[object Proxy]"===t}function l(e,t){return!(null==e)&&a.call(e,t)}function m(e,t){const n=function(e){return p(e)?e:t=>t===e}(t);let i;return u(e,function(e,t){if(n(e,t))return i=e,!1}),i}function u(e,t){let n,i;if(r(e))return;const a=o(e)?h:d;for(let r in e)if(l(e,r)&&(n=e[r],i=t(n,a(r)),!1===i))return n}function d(e){return e}function h(e){return Number(e)}function f(e,...t){return Object.assign(e,...t)}const v={id:"events",name:"Events"},g={id:"tasks",name:"Tasks"},y={id:"data",name:"Data"},b={id:"participants",name:"Participants"},E={id:"subprocess",name:"Sub-processes"},x={id:"gateways",name:"Gateways"},w=[{label:"Start event",actionName:"none-start-event",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"Boundary event",actionName:"none-boundary-event",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:BoundaryEvent"}},{label:"End event",actionName:"none-end-event",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}].map(e=>({...e,group:v})),_=[{label:"Message start event",actionName:"message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer start event",actionName:"timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional start event",actionName:"conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal start event",actionName:"signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}].map(e=>({...e,group:v})),S=[{label:"Message start event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer start event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional start event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal start event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation start event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}].map(e=>({...e,group:v,rank:-1})),A=[{label:"Message intermediate catch event",actionName:"message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate throw event",actionName:"message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer intermediate catch event",actionName:"timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation intermediate throw event",actionName:"escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional intermediate catch event",actionName:"conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link intermediate catch event",actionName:"link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link intermediate throw event",actionName:"link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation intermediate throw event",actionName:"compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal intermediate catch event",actionName:"signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate throw event",actionName:"signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}].map(e=>({...e,group:v})),C=[{label:"Message boundary event",actionName:"message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer boundary event",actionName:"timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation boundary event",actionName:"escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional boundary event",actionName:"conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Error boundary event",actionName:"error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel boundary event",actionName:"cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Signal boundary event",actionName:"signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Compensation boundary event",actionName:"compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message boundary event (non-interrupting)",actionName:"non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer boundary event (non-interrupting)",actionName:"non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation boundary event (non-interrupting)",actionName:"non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional boundary event (non-interrupting)",actionName:"non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal boundary event (non-interrupting)",actionName:"non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}].map(e=>({...e,group:v})),N=[{label:"Message end event",actionName:"message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation end event",actionName:"escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error end event",actionName:"error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel end event",actionName:"cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation end event",actionName:"compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal end event",actionName:"signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate end event",actionName:"terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}].map(e=>({...e,group:v})),T=[{label:"Exclusive gateway",actionName:"exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel gateway",actionName:"parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive gateway",search:"or",actionName:"inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"},rank:-1},{label:"Complex gateway",actionName:"complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"},rank:-1},{label:"Event-based gateway",actionName:"event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}].map(e=>({...e,group:x})),D=[{label:"Call activity",actionName:"call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Transaction",actionName:"transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event sub-process",search:"subprocess",actionName:"event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Sub-process (collapsed)",search:"subprocess",actionName:"collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub-process (expanded)",search:"subprocess",actionName:"expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Ad-hoc sub-process (collapsed)",search:"adhoc subprocess",actionName:"collapsed-ad-hoc-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:AdHocSubProcess",isExpanded:!1}},{label:"Ad-hoc sub-process (expanded)",search:"adhoc subprocess",actionName:"expanded-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}}].map(e=>({...e,group:E})),k=[...T,...[{label:"Task",actionName:"task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"User task",actionName:"user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Service task",actionName:"service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Send task",actionName:"send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"},rank:-1},{label:"Receive task",actionName:"receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"},rank:-1},{label:"Manual task",actionName:"manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"},rank:-1},{label:"Business rule task",actionName:"rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Script task",actionName:"script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}}].map(e=>({...e,group:g})),...D,...w,..._,...S,...A,...N,...C,...[{label:"Data store reference",actionName:"data-store-reference",className:"bpmn-icon-data-store",target:{type:"bpmn:DataStoreReference"}},{label:"Data object reference",actionName:"data-object-reference",className:"bpmn-icon-data-object",target:{type:"bpmn:DataObjectReference"}}].map(e=>({...e,group:y})),...[{label:"Expanded pool/participant",search:"Non-empty pool/participant",actionName:"expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:"Empty pool/participant",search:"Collapsed pool/participant",actionName:"collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}].map(e=>({...e,group:b}))];function P(e,t,n,i,a,r,o){this._elementFactory=e,this._popupMenu=t,this._create=n,this._autoPlace=i,this._rules=a,this._create=n,this._mouse=r,this._translate=o,this.register()}function R(e,t,n,i,a){this._contextPad=e,this._popupMenu=t,this._translate=n,this._canvas=i,this._rules=a,this.register()}function B(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}function M(e,t){var n=I(e);return n&&"function"==typeof n.$instanceOf&&n.$instanceOf(t)}function I(e){return e&&e.businessObject||e}function F(e){this._eventBus=e}function j(e){return function(t,n,i,a,r){(p(t)||c(t))&&(r=a,a=i,i=n,n=t,t=null),this.on(t,e,n,i,a,r)}}function O(e){F.call(this,e),this.init()}function L(e){O.call(this,e)}P.$inject=["elementFactory","popupMenu","create","autoPlace","rules","mouse","translate"],P.prototype.register=function(){this._popupMenu.registerProvider("bpmn-append",this)},P.prototype.getPopupMenuEntries=function(e){const t=this._rules,n=this._translate,i={};return t.allowed("shape.append",{element:e})?(this._filterEntries(k).forEach(t=>{const{actionName:a,className:r,label:o,target:s,description:c,group:p,search:l,rank:m}=t;i[`append-${a}`]={label:o&&n(o),className:r,description:c,group:p&&{...p,name:n(p.name)},search:l,rank:m,action:this._createEntryAction(e,s)}}),i):[]},P.prototype._filterEntries=function(e){return e.filter(e=>{const t=e.target,{type:n,eventDefinitionType:i}=t;return!(["bpmn:StartEvent","bpmn:Participant"].includes(n)||"bpmn:BoundaryEvent"===n&&r(i))})},P.prototype._createEntryAction=function(e,t){const n=this._elementFactory,i=this._autoPlace,a=this._create,r=this._mouse,o=i=>{const o=n.create("shape",t);return i instanceof KeyboardEvent&&(i=r.getLastMoveEvent()),a.start(i,o,{source:e})};return{click:this._canAutoPlaceElement(t)?()=>{const a=n.create("shape",t);i.append(e,a)}:o,dragstart:o}},P.prototype._canAutoPlaceElement=e=>{const{type:t}=e;return!("bpmn:BoundaryEvent"===t||"bpmn:SubProcess"===t&&e.triggeredByEvent||"bpmn:IntermediateCatchEvent"===t&&"bpmn:LinkEventDefinition"===e.eventDefinitionType)},R.$inject=["contextPad","popupMenu","translate","canvas","rules"],R.prototype.register=function(){this._contextPad.registerProvider(this)},R.prototype.getContextPadEntries=function(e){const t=this._popupMenu,n=this._translate,i=this._rules,a=this._getAppendMenuPosition.bind(this);if(i.allowed("shape.append",{element:e}))return{append:{group:"model",html:'<div class="entry"><svg width="22" height="22" viewBox="0 0 5.82 5.82" xmlns="http://www.w3.org/2000/svg" fill="currentColor">\n  <path d="M1.3 3.4c.3 0 .5-.2.5-.5s-.2-.4-.5-.4c-.2 0-.4.1-.4.4 0 .3.2.5.4.5zM3 3.4c.2 0 .4-.2.4-.5s-.2-.4-.4-.4c-.3 0-.5.1-.5.4 0 .3.2.5.5.5zM4.6 3.4c.2 0 .4-.2.4-.5s-.2-.4-.4-.4c-.3 0-.5.1-.5.4 0 .3.2.5.5.5z"/>\n</svg></div>',title:n("Append element"),action:{click:function(e,i){const r=f(a(i),{cursor:{x:e.x,y:e.y}});t.open(i,"bpmn-append",r,{title:n("Append element"),width:300,search:!0})}}}}},R.prototype._getAppendMenuPosition=function(e){const t=this._canvas.getContainer().querySelector(".djs-context-pad").getBoundingClientRect();return{x:t.right+5,y:t.top}},F.$inject=["eventBus"],F.prototype.on=function(e,t,n,i,a,r){if((p(t)||c(t))&&(r=a,a=i,i=n,n=t,t=null),p(n)&&(r=a,a=i,i=n,n=1e3),s(a)&&(r=a,a=!1),!p(i))throw new Error("handlerFn must be a function");o(e)||(e=[e]);var l=this._eventBus;u(e,function(e){var o=["commandStack",e,t].filter(function(e){return e}).join(".");l.on(o,n,a?function(e,t){return function(n){return e.call(t||null,n.context,n.command,n)}}(i,r):i,r)})},F.prototype.canExecute=j("canExecute"),F.prototype.preExecute=j("preExecute"),F.prototype.preExecuted=j("preExecuted"),F.prototype.execute=j("execute"),F.prototype.executed=j("executed"),F.prototype.postExecute=j("postExecute"),F.prototype.postExecuted=j("postExecuted"),F.prototype.revert=j("revert"),F.prototype.reverted=j("reverted"),O.$inject=["eventBus"],B(O,F),O.prototype.addRule=function(e,t,n){var i=this;"string"==typeof e&&(e=[e]),e.forEach(function(e){i.canExecute(e,t,function(e,t,i){return n(e)},!0)})},O.prototype.init=function(){},B(L,O),L.$inject=["eventBus"],L.prototype.init=function(){this.addRule("shape.append",function(e){const t=e.element,n=I(t);return(!s(a=t)||!l(a,"labelTarget"))&&(i=t,!m(["bpmn:EndEvent","bpmn:Group","bpmn:TextAnnotation","bpmn:Lane","bpmn:Participant","bpmn:DataStoreReference","bpmn:DataObjectReference"],function(e){return M(i,e)})&&!t.waypoints&&(!M(t,"bpmn:IntermediateThrowEvent")||!function(e){return!!m(I(e).eventDefinitions||[],function(e){return M(e,"bpmn:LinkEventDefinition")})}(t))&&(!M(t,"bpmn:SubProcess")||!n.triggeredByEvent)&&void 0);var i,a})};var $,z={__init__:["appendMenuProvider","appendContextPadProvider","appendRules"],appendMenuProvider:["type",P],appendContextPadProvider:["type",R],appendRules:["type",L]};function V(e,t,n,i,a,r){this._elementFactory=e,this._popupMenu=t,this._create=n,this._autoPlace=i,this._mouse=a,this._translate=r,this.register()}function G(e,t,n,i,a){this._palette=e,this._translate=t,this._popupMenu=n,this._canvas=i,this._mouse=a,this.register()}V.$inject=["elementFactory","popupMenu","create","autoPlace","mouse","translate"],V.prototype.register=function(){this._popupMenu.registerProvider("bpmn-create",this)},V.prototype.getPopupMenuEntries=function(){const e={};return k.forEach(t=>{const{actionName:n,className:i,label:a,target:r,description:o,group:s,search:c,rank:p}=t,l=this._createEntryAction(r);e[`create-${n}`]={label:a&&this._translate(a),className:i,description:o,group:s&&{...s,name:this._translate(s.name)},search:c,rank:p,action:{click:l,dragstart:l}}}),e},V.prototype._createEntryAction=function(e){const t=this._create,n=this._mouse,i=this._popupMenu,a=this._elementFactory;let r;return o=>(i.close(),r="bpmn:Participant"===e.type?a.createParticipantShape(e):a.create("shape",e),o instanceof KeyboardEvent&&(o=n.getLastMoveEvent()),t.start(o,r))},"undefined"!=typeof document&&(($=document.createElement("div")).innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',$.getElementsByTagName("link").length,$=void 0),G.$inject=["palette","translate","popupMenu","canvas","mouse"],G.prototype.register=function(){this._palette.registerProvider(900,this)},G.prototype.getPaletteEntries=function(e){const t=this._translate,n=this._popupMenu,i=this._canvas,a=this._mouse;return{create:{group:"create",html:'<div class="entry"> <svg width="46" height="46" viewBox="-2 -2 9.82 9.82" xmlns="http://www.w3.org/2000/svg" fill="currentColor">\n  <path d="M1.3 3.4c.3 0 .5-.2.5-.5s-.2-.4-.5-.4c-.2 0-.4.1-.4.4 0 .3.2.5.4.5zM3 3.4c.2 0 .4-.2.4-.5s-.2-.4-.4-.4c-.3 0-.5.1-.5.4 0 .3.2.5.5.5zM4.6 3.4c.2 0 .4-.2.4-.5s-.2-.4-.4-.4c-.3 0-.5.1-.5.4 0 .3.2.5.5.5z"/>\n</svg></div>',title:t("Create element"),action:{click:function(e){const r=(e=>{if(e instanceof KeyboardEvent)return{x:(e=a.getLastMoveEvent()).x,y:e.y};const t=e&&e.target||(n=n||document).querySelector('.djs-palette [data-action="create"]');var n;const i=t.getBoundingClientRect();return t&&{x:i.left+i.width/2+35,y:i.top+i.height/2+10}})(e),o=i.getRootElement();n.open(o,"bpmn-create",r,{title:t("Create element"),width:300,search:!0})}}}}};var H={__init__:["createMenuProvider","createPaletteProvider"],createMenuProvider:["type",V],createPaletteProvider:["type",G]};function W(e){this._injector=e,this.registerActions()}W.$inject=["injector"],W.prototype.registerActions=function(){const e=this._injector.get("editorActions",!1),t=this._injector.get("selection",!1),n=this._injector.get("contextPad",!1),i=this._injector.get("palette",!1),a=this._injector.get("popupMenu",!1),r={};t&&n&&i&&a&&i&&f(r,{appendElement:function(e){const r=t&&t.get();1!=r.length||a.isEmpty(r[0],"bpmn-append")?i.triggerEntry("create","click",e):n.triggerEntry("append","click",e)}}),i&&f(r,{createElement:function(e){i.triggerEntry("create","click",e)}}),e&&e.register(r)};var U={__depends__:[z,H],__init__:["createAppendEditorActions"],createAppendEditorActions:["type",W]},K=["c","C"],q=["v","V"],J=["y","Y"],X=["z","Z"];function Y(e){return!e.altKey&&(e.ctrlKey||e.metaKey)}function Q(e,t){return-1!==(e=o(e)?e:[e]).indexOf(t.key)||-1!==e.indexOf(t.code)}function Z(e){return e.shiftKey}function ee(e,t){var n=this;e.on("editorActions.init",500,function(e){var i=e.editorActions;n.registerBindings(t,i)})}function te(e){this._injector=e,this._keyboard=this._injector.get("keyboard",!1),this._editorActions=this._injector.get("editorActions",!1),this._keyboard&&this._injector.invoke(ee,this)}ee.$inject=["eventBus","keyboard"],ee.prototype.registerBindings=function(e,t){function n(n,i){t.isRegistered(n)&&e.addListener(i)}n("undo",function(e){if(Y(n=e.keyEvent)&&!Z(n)&&Q(X,n))return t.trigger("undo"),!0;var n}),n("redo",function(e){if(Y(n=e.keyEvent)&&(Q(J,n)||Q(X,n)&&Z(n)))return t.trigger("redo"),!0;var n}),n("copy",function(e){if(Y(n=e.keyEvent)&&Q(K,n))return t.trigger("copy"),!0;var n}),n("paste",function(e){if(Y(n=e.keyEvent)&&Q(q,n))return t.trigger("paste"),!0;var n}),n("stepZoom",function(e){var n=e.keyEvent;if(Q(["+","Add","="],n)&&Y(n))return t.trigger("stepZoom",{value:1}),!0}),n("stepZoom",function(e){var n=e.keyEvent;if(Q(["-","Subtract"],n)&&Y(n))return t.trigger("stepZoom",{value:-1}),!0}),n("zoom",function(e){var n=e.keyEvent;if(Q("0",n)&&Y(n))return t.trigger("zoom",{value:1}),!0}),n("removeSelection",function(e){if(Q(["Backspace","Delete","Del"],e.keyEvent))return t.trigger("removeSelection"),!0})},B(te,ee),te.$inject=["injector"],te.prototype.registerBindings=function(){const e=this._keyboard,t=this._editorActions;function n(n,i){t&&t.isRegistered(n)&&e&&e.addListener(i)}ee.prototype.registerBindings.call(this,e,t),n("appendElement",function(n){const i=n.keyEvent;if(!e||!e.hasModifier(i))return e&&e.isKey(["a","A"],i)?(t&&t.trigger("appendElement",i),!0):void 0}),n("createElement",function(n){const i=n.keyEvent;if(!e||!e.hasModifier(i))return e&&e.isKey(["n","N"],i)?(t&&t.trigger("createElement",i),!0):void 0})};var ne={__depends__:[z,H,U,{__depends__:[z,H],__init__:["createAppendKeyboardBindings"],createAppendKeyboardBindings:["type",te]}]};function ie(e,t,n,i,a,r,o){this._popupMenu=e,this._translate=t,this._elementTemplates=n,this._autoPlace=i,this._create=a,this._mouse=r,this._rules=o,this.register()}function ae(e){const{appliesTo:t=[],elementType:n={}}=e,i=n.value||t[0];return"bpmn:BoundaryEvent"!==i&&("bpmn:IntermediateCatchEvent"!==i||"bpmn:LinkEventDefinition"!==n.eventDefinition)}ie.$inject=["popupMenu","translate","elementTemplates","autoPlace","create","move","rules"],ie.prototype.register=function(){this._popupMenu.registerProvider("bpmn-append",this)},ie.prototype.getPopupMenuEntries=function(e){return t=>{if(!this._rules.allowed("shape.append",{element:e}))return[];const n=this._filterTemplates(this._elementTemplates.getLatest());return f(t,this.getTemplateEntries(e,n)),t}},ie.prototype.getTemplateEntries=function(e,t){const n={};return t.map(t=>{const{icon:i={},category:a,keywords:r=[]}=t,o=`append.template-${t.id}`,s={id:"templates",name:this._translate("Templates")};n[o]={label:t.name,description:t.description,documentationRef:t.documentationRef,search:r,imageUrl:i.contents,group:a||s,action:this._getEntryAction(e,t)}}),n},ie.prototype._filterTemplates=function(e){return e.filter(e=>{const{appliesTo:t,elementType:n}=e,i=n&&n.value||t[0];return!["bpmn:StartEvent","bpmn:Participant"].includes(i)&&"bpmn:SequenceFlow"!==i})},ie.prototype._getEntryAction=function(e,t){const n=n=>{const i=this._elementTemplates.createElement(t);return n instanceof KeyboardEvent&&(n=this._mouse.getLastMoveEvent()),this._create.start(n,i,{source:e})};return{click:ae(t)?()=>{const n=this._elementTemplates.createElement(t);this._autoPlace.append(e,n)}:n,dragstart:n}};var re={__init__:["elementTemplatesAppendProvider"],elementTemplatesAppendProvider:["type",ie]};function oe(e,t,n,i,a){this._popupMenu=e,this._translate=t,this._elementTemplates=n,this._mouse=i,this._create=a,this.register()}oe.$inject=["popupMenu","translate","elementTemplates","mouse","create"],oe.prototype.register=function(){this._popupMenu.registerProvider("bpmn-create",this)},oe.prototype.getPopupMenuEntries=function(e){return t=>(f(t,this.getTemplateEntries(e)),t)},oe.prototype.getTemplateEntries=function(){const e=this._elementTemplates.getLatest(),t={};return e.map(e=>{const{icon:n={},category:i,keywords:a=[]}=e,r=`create.template-${e.id}`,o={id:"templates",name:this._translate("Templates")};t[r]={label:e.name,description:e.description,documentationRef:e.documentationRef,imageUrl:n.contents,group:i||o,search:a,action:{click:this._getEntryAction(e),dragstart:this._getEntryAction(e)}}}),t},oe.prototype._getEntryAction=function(e){const t=this._create,n=this._popupMenu,i=this._elementTemplates,a=this._mouse;return r=>{n.close();let o=i.createElement(e);return r instanceof KeyboardEvent&&(r=a.getLastMoveEvent()),t.start(r,o)}};var se={__init__:["elementTemplatesCreateProvider"],elementTemplatesCreateProvider:["type",oe]};function ce(e,t,n){this._popupMenu=e,this._translate=t,this._elementTemplates=n,this.register()}ce.$inject=["popupMenu","translate","elementTemplates"],ce.prototype.register=function(){this._popupMenu.registerProvider("bpmn-replace",this)},ce.prototype.getPopupMenuEntries=function(e){return t=>{let n=Object.entries(t);return n=[...n,...this.getTemplateEntries(e)],n.reduce((e,[t,n])=>(e[t]=n,e),{})}},ce.prototype.getTemplateEntries=function(e){return this._getMatchingTemplates(e).map(t=>{const{icon:n={},category:i,keywords:a=[]}=t,r=`replace.template-${t.id}`,o={id:"templates",name:this._translate("Templates")};return[r,{label:t.name,description:t.description,documentationRef:t.documentationRef,imageUrl:n.contents,search:a,group:i||o,action:()=>{this._elementTemplates.applyTemplate(e,t)}}]})},ce.prototype._getMatchingTemplates=function(e){return this._elementTemplates.getLatest(e).filter(t=>!function(e,t){const n=I(e);return!!n&&n.get("zeebe:modelerTemplate")===t.id}(e,t))};var pe={__init__:["elementTemplatesReplaceProvider"],elementTemplatesReplaceProvider:["type",ce]};var le=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Sub-process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Ad-hoc sub-process",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}}],me=le,ue=Object.freeze({__proto__:null,AD_HOC_SUBPROCESS_EXPANDED:[{label:"Sub-process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Ad-hoc sub-process (collapsed)",actionName:"replace-with-collapsed-ad-hoc-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:AdHocSubProcess",isExpanded:!1}}],BOUNDARY_EVENT:[{label:"Message boundary event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!0}},{label:"Timer boundary event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!0}},{label:"Escalation boundary event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!0}},{label:"Conditional boundary event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!0}},{label:"Error boundary event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",cancelActivity:!0}},{label:"Cancel boundary event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition",cancelActivity:!0}},{label:"Signal boundary event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!0}},{label:"Compensation boundary event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",cancelActivity:!0}},{label:"Message boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],DATA_OBJECT_REFERENCE:[{label:"Data store reference",actionName:"replace-with-data-store-reference",className:"bpmn-icon-data-store",target:{type:"bpmn:DataStoreReference"}}],DATA_STORE_REFERENCE:[{label:"Data object reference",actionName:"replace-with-data-object-reference",className:"bpmn-icon-data-object",target:{type:"bpmn:DataObjectReference"}}],END_EVENT:[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message end event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation end event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error end event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel end event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation end event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal end event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate end event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],EVENT_SUB_PROCESS:me,EVENT_SUB_PROCESS_START_EVENT:[{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!0}},{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!0}},{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!0}},{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!0}},{label:"Error start event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",isInterrupting:!0}},{label:"Escalation start event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!0}},{label:"Compensation start event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",isInterrupting:!0}},{label:"Message start event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer start event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional start event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal start event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation start event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],GATEWAY:[{label:"Exclusive gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event-based gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],INTERMEDIATE_EVENT:[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message intermediate catch event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate throw event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer intermediate catch event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation intermediate throw event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional intermediate catch event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link intermediate catch event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link intermediate throw event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation intermediate throw event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal intermediate catch event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate throw event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],PARTICIPANT:[{label:"Expanded pool/participant",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:function(e){var t="Empty pool/participant";return e.children&&e.children.length&&(t+=" (removes content)"),t},actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}],SEQUENCE_FLOW:[{label:"Sequence flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],START_EVENT:[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],START_EVENT_SUB_PROCESS:[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}],SUBPROCESS_EXPANDED:[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Ad-hoc sub-process",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}},{label:"Sub-process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}}],TASK:[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"User task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Service task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Send task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"Manual task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business rule task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Script task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub-process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub-process (expanded)",actionName:"replace-with-expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Ad-hoc sub-process (collapsed)",actionName:"replace-with-collapsed-ad-hoc-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:AdHocSubProcess",isExpanded:!1}},{label:"Ad-hoc sub-process (expanded)",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}}],TRANSACTION:le,TYPED_EVENT:{"bpmn:MessageEventDefinition":[{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate catch event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate throw event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message end event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}}],"bpmn:TimerEventDefinition":[{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Timer intermediate catch event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}}],"bpmn:ConditionalEventDefinition":[{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Conditional intermediate catch event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}}],"bpmn:SignalEventDefinition":[{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate catch event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate throw event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal end event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],"bpmn:ErrorEventDefinition":[{label:"Error start event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Error end event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}}],"bpmn:EscalationEventDefinition":[{label:"Escalation start event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Escalation intermediate throw event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Escalation end event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}}],"bpmn:CompensateEventDefinition":[{label:"Compensation start event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Compensation intermediate throw event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Compensation end event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}}]}});const de=Object.values(ue);function he(e,t,n){this._popupMenu=e,this._translate=t,this._elementTemplates=n,this.register()}function fe(e,t,n){const i=e[t];return!!i&&n.findIndex(([e])=>e===i.actionName)}he.$inject=["popupMenu","translate","elementTemplates"],he.prototype.register=function(){this._popupMenu.registerProvider("bpmn-replace",this)},he.prototype.getPopupMenuEntries=function(e){return t=>{let n=Object.entries(t);return this._elementTemplates&&this._elementTemplates.get(e)&&this.addPlainElementEntry(e,n,this._translate,this._elementTemplates),n.reduce((e,[t,n])=>(e[t]=n,e),{})}},he.prototype.addPlainElementEntry=function(e,t,n,i){const a=this.getPlainEntry(e,t,n,i);if(!a)return;const[r,o]=a;t.splice(r,0,[o.id,o])},he.prototype.getPlainEntry=function(e,t,n,i){const{options:a,option:r,optionIndex:o}=function(e){const t=(e,t)=>t.target&&!function(e){return function(t){var n=t.target,i=I(e),a=i.eventDefinitions&&i.eventDefinitions[0],r=i.$type===n.type,o=(a&&a.$type)===n.eventDefinitionType,s=!!n.triggeredByEvent==!!i.triggeredByEvent,c=void 0===n.isExpanded||n.isExpanded===function(e,t){return!M(e,"bpmn:CallActivity")&&(M(e,"bpmn:SubProcess")?(t=t||function(e){return e&&e.di}(e),!(!t||!M(t,"bpmndi:BPMNPlane"))||t&&!!t.isExpanded):!M(e,"bpmn:Participant")||!!I(e).processRef)}(e);return!(r&&o&&s&&c)}}(e)(t);return de.reduce((n,i)=>{if(n)return n;const a=i.findIndex(n=>t(e,n));return-1!==a?{options:i,option:i[a],optionIndex:a}:void 0},null)}(e)||{};if(!a)return null;const s={id:"replace-remove-element-template",action:()=>{i.removeTemplate(e)},label:n(r.label),className:r.className},c=fe(a,o-1,t);if(c)return[c+1,s];const p=fe(a,o+1,t);return p?[p,s]:[0,s]};var ve={__init__:["removeTemplateReplaceProvider"],removeTemplateReplaceProvider:["type",he]},ge={__depends__:[re,se,pe,ve]}},62038(e,t,n){function i(e){return e instanceof PointerEvent?"click":e instanceof DragEvent?"drag":e instanceof KeyboardEvent?"keyboard":void 0}n.d(t,{v:()=>i})},57834(e,t,n){n.d(t,{A:()=>r});var i=n(62038);class a{constructor(e,t,n){this._eventBus=e,this._bpmnJSTracking=t,this._selection=n,this._eventBus.on("contextPad.trigger",this.trackTrigger.bind(this))}trackTrigger(e){const{entry:t,event:n}=e,{target:a}=n;if(!a)return;const r=a.closest("[data-action]"),o=r&&r.getAttribute("data-action");if(!o)return;const s=(0,i.v)(n);this._bpmnJSTracking.track({name:"contextPad.trigger",data:{entryId:o,entryGroup:t.group||"default",entryTitle:t.title,selection:this._selection.get(),triggerType:s}})}}a.$inject=["eventBus","bpmnJSTracking","selection"];const r={__init__:["contextPadTracking"],contextPadTracking:["type",a]}},40802(e,t,n){n.d(t,{A:()=>a});class i{constructor(e,t,n){this._eventBus=e,this._bpmnJSTracking=t,this._selection=n,this._eventBus.on("elementTemplates.select",this.trackTemplateSelect.bind(this)),this._eventBus.on("elementTemplates.update",this.trackTemplateUpdate.bind(this)),this._eventBus.on("elementTemplates.unlink",this.trackTemplateUnlink.bind(this)),this._eventBus.on("elementTemplates.remove",this.trackTemplateRemove.bind(this))}trackTemplateSelect(e){const{element:t}=e;this._bpmnJSTracking.track({name:"elementTemplates.select",data:{element:t}})}trackTemplateUpdate(e){const{element:t,newTemplate:n}=e;this._bpmnJSTracking.track({name:"elementTemplates.update",data:{element:t,newTemplate:n}})}trackTemplateUnlink(e){const{element:t}=e;this._bpmnJSTracking.track({name:"elementTemplates.unlink",data:{element:t}})}trackTemplateRemove(e){const{element:t}=e;this._bpmnJSTracking.track({name:"elementTemplates.remove",data:{element:t}})}}i.$inject=["eventBus","bpmnJSTracking","selection"];const a={__init__:["elementTemplatesTracking"],elementTemplatesTracking:["type",i]}},42371(e,t,n){n.d(t,{A:()=>a});class i{constructor(e,t,n){this._eventBus=e,this._bpmnJSTracking=t,this._selection=n,this._eventBus.on("feelPopup.opened",this.trackOpen.bind(this)),this._eventBus.on("feelPopup.closed",this.trackClosed.bind(this))}trackOpen(){this._bpmnJSTracking.track({name:"feelPopup.opened",data:{selection:this._selection.get()}})}trackClosed(){this._bpmnJSTracking.track({name:"feelPopup.closed",data:{selection:this._selection.get()}})}}i.$inject=["eventBus","bpmnJSTracking","selection"];const a={__init__:["feelPopupTracking"],feelPopupTracking:["type",i]}},56927(e,t,n){n.d(t,{A:()=>a});class i{constructor(e,t,n,i){this._eventBus=e,this._bpmnJSTracking=t,this._elementRegistry=n,this._selection=i,this._eventBus.on("commandStack.elements.create.postExecuted",this.trackElementsCreate.bind(this)),this._eventBus.on("commandStack.shape.append.postExecuted",this.trackElementAppend.bind(this)),this._eventBus.on("commandStack.shape.replace.postExecuted",this.trackElementReplace.bind(this))}trackElementsCreate(e){const{context:t}=e;this._bpmnJSTracking.track({name:"modeling.createElements",data:{elements:t.elements}})}trackElementAppend(e){const{shape:t,source:n}=e.context;this._bpmnJSTracking.track({name:"modeling.appendElement",data:{element:t,sourceElement:n}})}trackElementReplace(e){const{oldShape:t,newShape:n}=e.context;this._bpmnJSTracking.track({name:"modeling.replaceElement",data:{newElement:n,oldElement:t}})}}i.$inject=["eventBus","bpmnJSTracking","elementRegistry","selection"];const a={__init__:["modelingTracking"],modelingTracking:["type",i]}},8493(e,t,n){n.d(t,{A:()=>r});var i=n(62038);class a{constructor(e,t,n){this._eventBus=e,this._bpmnJSTracking=t,this._selection=n,this._eventBus.on("palette.trigger",this.trackTrigger.bind(this))}trackTrigger(e){const{entry:t,event:n}=e,{target:a}=n;if(!a)return;const r=a.closest("[data-action]"),o=r&&r.getAttribute("data-action");if(!o)return;const s=(0,i.v)(n);this._bpmnJSTracking.track({name:"palette.trigger",data:{entryId:o,entryGroup:t.group||"default",entryTitle:t.title,selection:this._selection.get(),triggerType:s}})}}a.$inject=["eventBus","bpmnJSTracking","selection"];const r={__init__:["paletteTracking"],paletteTracking:["type",a]}},65321(e,t,n){n.d(t,{A:()=>r});var i=n(62038);class a{constructor(e,t,n){this._eventBus=e,this._bpmnJSTracking=t,this._selection=n,this._eventBus.on("popupMenu.open",this.trackOpen.bind(this)),this._eventBus.on("popupMenu.trigger",this.trackTrigger.bind(this))}trackOpen(){this._bpmnJSTracking.track({name:"popupMenu.open",data:{selection:this._selection.get()}})}trackTrigger(e){const{entry:t,event:n}=e,a=(0,i.v)(n);this._bpmnJSTracking.track({name:"popupMenu.trigger",data:{entryId:t.id,entryGroup:t.group||"default",entryLabel:t.label,triggerType:a}})}}a.$inject=["eventBus","bpmnJSTracking","selection"];const r={__init__:["popupMenuTracking"],popupMenuTracking:["type",a]}},66778(e,t,n){n.d(t,{A:()=>a});class i{constructor(e,t){this._eventBus=t,this._isEnabled=!1,e&&e.track&&this.on("tracking.event",e.track)}isEnabled(){return this._isEnabled}enable(){this._isEnabled=!0,this._eventBus.fire("tracking.enabled")}disable(){this._isEnabled=!1,this._eventBus.fire("tracking.disabled")}on(...e){return this._eventBus.on(...e)}track(e){this.isEnabled()&&this._eventBus.fire("tracking.event",function(e){e.data||(e.data={});for(const[t,n]of Object.entries(e.data))Array.isArray(n)?e.data[t]=n.map(r):e.data[t]=r(n);return e}(e))}}i.$inject=["config.bpmnJSTracking","eventBus"];const a={__init__:["bpmnJSTracking"],bpmnJSTracking:["type",i]};function r(e){return function(e){return e&&(e.$type||e.type)}(e)?{type:e.type||e.$type,collapsed:e.collapsed,attachers:e.attachers&&e.attachers.map(r),incoming:e.incoming&&e.incoming.map(r),outgoing:e.outgoing&&e.outgoing.map(r),parent:e.parent&&r(e.parent)}:e}var o=n(57834),s=n(40802),c=n(42371),p=n(56927),l=n(8493),m=n(65321);class u{constructor(e,t){this._bpmnJSTracking=t,this._eventBus=e,this._eventBus.on("refactorings.execute",this.trackRefactoring.bind(this))}trackRefactoring(e){const{refactoring:t}=e;this._bpmnJSTracking.track({name:"refactorings.execute",data:{refactoring:t}})}}u.$inject=["eventBus","bpmnJSTracking"];class d{constructor(e,t){this._eventBus=e,this._bpmnJSTracking=t,this._eventBus.on("selection.changed",this.trackEvent.bind(this))}trackEvent(e){this._bpmnJSTracking.track({name:"selection.select",data:{oldSelection:e.oldSelection,newSelection:e.newSelection}})}}d.$inject=["eventBus","bpmnJSTracking"];o.A,s.A,c.A,p.A,l.A,m.A},30261(e,t,n){n.d(t,{A:()=>r});var i=n(98142),a=n(70868);class r extends i.A{constructor(e,t,n){super(e),this.postExecuted("shape.delete",250,function(e){const{collaborationRoot:i,shape:r}=e,o=t.getRootElement();if((0,a.is)(r,"bpmn:Participant")&&i&&!i.businessObject.get("participants").length&&(0,a.is)(o,"bpmn:Process")){const e=r.businessObject.get("processRef");if(!e)return;n.updateProperties(o,{isExecutable:e.get("isExecutable")})}},!0)}}r.$inject=["eventBus","canvas","modeling"]},93693(e,t,n){n.d(t,{V:()=>o,t:()=>r});var i=n(70868),a=n(57094);function r(e,t=void 0){const n=(0,i.Cf)(e).get("extensionElements");if(!n)return[];const a=n.get("values");return a&&a.length?t?a.filter(e=>(0,i.is)(e,t)):a:[]}function o(e,t,n,i){(0,a.isArray)(n)||(n=[n]);const r=t.get("extensionElements"),o=r.get("values").filter(e=>!n.includes(e));i.execute("element.updateModdleProperties",{element:e,moddleElement:r,properties:{values:o}})}},99719(e,t,n){n.d(t,{A:()=>Wp});var i=n(7475);function a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var r,o={exports:{}},s=function(){if(r)return o.exports;r=1;var e=o.exports=function(t,n){if(n||(n=16),void 0===t&&(t=128),t<=0)return"0";for(var i=Math.log(Math.pow(2,t))/Math.log(n),a=2;i===1/0;a*=2)i=Math.log(Math.pow(2,t/a))/Math.log(n)*a;var r=i-Math.floor(i),o="";for(a=0;a<Math.floor(i);a++)o=Math.floor(Math.random()*n).toString(n)+o;if(r){var s=Math.pow(n,r);o=Math.floor(Math.random()*s).toString(n)+o}var c=parseInt(o,n);return c!==1/0&&c>=Math.pow(2,t)?e(t,n):o};return e.rack=function(t,n,i){var a=function(a){var o=0;do{if(o++>10){if(!i)throw new Error("too many ID collisions, use more bits");t+=i}var s=e(t,n)}while(Object.hasOwnProperty.call(r,s));return r[s]=a,s},r=a.hats={};return a.get=function(e){return a.hats[e]},a.set=function(e,t){return a.hats[e]=t,a},a.bits=t||128,a.base=n||16,a},o.exports}(),c=a(s);function p(e){if(!(this instanceof p))return new p(e);e=e||[128,36,1],this._seed=e.length?c.rack(e[0],e[1],e[2]):e}p.prototype.next=function(e){return this._seed(e||!0)},p.prototype.nextPrefixed=function(e,t){var n;do{n=e+this.next(!0)}while(this.assigned(n));return this.claim(n,t),n},p.prototype.claim=function(e,t){this._seed.set(e,t||!0)},p.prototype.assigned=function(e){return this._seed.get(e)||!1},p.prototype.unclaim=function(e){delete this._seed.hats[e]},p.prototype.clear=function(){var e,t=this._seed.hats;for(e in t)this.unclaim(e)};var l=n(57094),m=n(81340),u=n(93083),d=n.n(u),h=n(27828),f=n(96222);function v(){}function g(e,t){this.model=e,this.properties=t}v.prototype.get=function(e){return this.$model.properties.get(this,e)},v.prototype.set=function(e,t){this.$model.properties.set(this,e,t)},g.prototype.createType=function(e){var t=this.model,n=this.properties,i=Object.create(v.prototype);(0,l.forEach)(e.properties,function(e){e.isMany||void 0===e.default||(i[e.name]=e.default)}),n.defineModel(i,t),n.defineDescriptor(i,e);var a=e.ns.name;function r(e){n.define(this,"$type",{value:a,enumerable:!0}),n.define(this,"$attrs",{value:{}}),n.define(this,"$parent",{writable:!0}),(0,l.forEach)(e,(0,l.bind)(function(e,t){this.set(t,e)},this))}return r.prototype=i,r.hasType=i.$instanceOf=this.model.hasType,n.defineModel(r,t),n.defineDescriptor(r,e),r};var y={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0},b={String:function(e){return e},Boolean:function(e){return"true"===e},Integer:function(e){return parseInt(e,10)},Real:function(e){return parseFloat(e)}};function E(e,t){var n=b[e];return n?n(t):t}function x(e){return!!y[e]}function w(e){return!!b[e]}function _(e,t){var n,i,a=e.split(/:/);if(1===a.length)n=e,i=t;else{if(2!==a.length)throw new Error("expected <prefix:localName> or <localName>, got "+e);n=a[1],i=a[0]}return{name:e=(i?i+":":"")+n,prefix:i,localName:n}}function S(e){this.ns=e,this.name=e.name,this.allTypes=[],this.allTypesByName={},this.properties=[],this.propertiesByName={}}function A(e,t){this.packageMap={},this.typeMap={},this.packages=[],this.properties=t,(0,l.forEach)(e,(0,l.bind)(this.registerPackage,this))}function C(e,t,n){var i=t[n];if(i in e)throw new Error("package with "+n+" <"+i+"> already defined")}function N(e){this.model=e}function T(e,t,n){Object.defineProperty(e,t.name,{enumerable:!t.isReference,writable:!0,value:n,configurable:!0})}function D(e){return e.replace(/^:/,"")}function k(e,t={}){this.properties=new N(this),this.factory=new g(this,this.properties),this.registry=new A(e,this.properties),this.typeCache={},this.config=t}S.prototype.build=function(){return(0,l.pick)(this,["ns","name","allTypes","allTypesByName","properties","propertiesByName","bodyProperty","idProperty"])},S.prototype.addProperty=function(e,t,n){"boolean"==typeof t&&(n=t,t=void 0),this.addNamedProperty(e,!1!==n);var i=this.properties;void 0!==t?i.splice(t,0,e):i.push(e)},S.prototype.replaceProperty=function(e,t,n){var i=e.ns,a=this.properties,r=this.propertiesByName,o=e.name!==t.name;if(e.isId){if(!t.isId)throw new Error("property <"+t.ns.name+"> must be id property to refine <"+e.ns.name+">");this.setIdProperty(t,!1)}if(e.isBody){if(!t.isBody)throw new Error("property <"+t.ns.name+"> must be body property to refine <"+e.ns.name+">");this.setBodyProperty(t,!1)}var s=a.indexOf(e);if(-1===s)throw new Error("property <"+i.name+"> not found in property list");a.splice(s,1),this.addProperty(t,n?void 0:s,o),r[i.name]=r[i.localName]=t},S.prototype.redefineProperty=function(e,t,n){var i=e.ns.prefix,a=t.split("#"),r=_(a[0],i),o=_(a[1],r.prefix).name,s=this.propertiesByName[o];if(!s)throw new Error("refined property <"+o+"> not found");this.replaceProperty(s,e,n),delete e.redefines},S.prototype.addNamedProperty=function(e,t){var n=e.ns,i=this.propertiesByName;t&&(this.assertNotDefined(e,n.name),this.assertNotDefined(e,n.localName)),i[n.name]=i[n.localName]=e},S.prototype.removeNamedProperty=function(e){var t=e.ns,n=this.propertiesByName;delete n[t.name],delete n[t.localName]},S.prototype.setBodyProperty=function(e,t){if(t&&this.bodyProperty)throw new Error("body property defined multiple times (<"+this.bodyProperty.ns.name+">, <"+e.ns.name+">)");this.bodyProperty=e},S.prototype.setIdProperty=function(e,t){if(t&&this.idProperty)throw new Error("id property defined multiple times (<"+this.idProperty.ns.name+">, <"+e.ns.name+">)");this.idProperty=e},S.prototype.assertNotTrait=function(e){if((e.extends||[]).length)throw new Error(`cannot create <${e.name}> extending <${e.extends}>`)},S.prototype.assertNotDefined=function(e,t){var n=e.name,i=this.propertiesByName[n];if(i)throw new Error("property <"+n+"> already defined; override of <"+i.definedBy.ns.name+"#"+i.ns.name+"> by <"+e.definedBy.ns.name+"#"+e.ns.name+"> not allowed without redefines")},S.prototype.hasProperty=function(e){return this.propertiesByName[e]},S.prototype.addTrait=function(e,t){t&&this.assertNotTrait(e);var n=this.allTypesByName,i=this.allTypes,a=e.name;a in n||((0,l.forEach)(e.properties,(0,l.bind)(function(n){n=(0,l.assign)({},n,{name:n.ns.localName,inherited:t}),Object.defineProperty(n,"definedBy",{value:e});var i=n.replaces,a=n.redefines;i||a?this.redefineProperty(n,i||a,i):(n.isBody&&this.setBodyProperty(n),n.isId&&this.setIdProperty(n),this.addProperty(n))},this)),i.push(e),n[a]=e)},A.prototype.getPackage=function(e){return this.packageMap[e]},A.prototype.getPackages=function(){return this.packages},A.prototype.registerPackage=function(e){e=(0,l.assign)({},e);var t=this.packageMap;C(t,e,"prefix"),C(t,e,"uri"),(0,l.forEach)(e.types,(0,l.bind)(function(t){this.registerType(t,e)},this)),t[e.uri]=t[e.prefix]=e,this.packages.push(e)},A.prototype.registerType=function(e,t){var n=_((e=(0,l.assign)({},e,{superClass:(e.superClass||[]).slice(),extends:(e.extends||[]).slice(),properties:(e.properties||[]).slice(),meta:(0,l.assign)(e.meta||{})})).name,t.prefix),i=n.name,a={};(0,l.forEach)(e.properties,(0,l.bind)(function(e){var t=_(e.name,n.prefix),i=t.name;x(e.type)||(e.type=_(e.type,t.prefix).name),(0,l.assign)(e,{ns:t,name:i}),a[i]=e},this)),(0,l.assign)(e,{ns:n,name:i,propertiesByName:a}),(0,l.forEach)(e.extends,(0,l.bind)(function(e){var t=_(e,n.prefix),a=this.typeMap[t.name];a.traits=a.traits||[],a.traits.push(i)},this)),this.definePackage(e,t),this.typeMap[i]=e},A.prototype.mapTypes=function(e,t,n){var i=x(e.name)?{name:e.name}:this.typeMap[e.name],a=this;function r(n,i){var r=_(n,x(n)?"":e.prefix);a.mapTypes(r,t,i)}function o(e){return r(e,!0)}if(!i)throw new Error("unknown type <"+e.name+">");(0,l.forEach)(i.superClass,n?o:function(e){return r(e,!1)}),t(i,!n),(0,l.forEach)(i.traits,o)},A.prototype.getEffectiveDescriptor=function(e){var t=_(e),n=new S(t);this.mapTypes(t,function(e,t){n.addTrait(e,t)});var i=n.build();return this.definePackage(i,i.allTypes[i.allTypes.length-1].$pkg),i},A.prototype.definePackage=function(e,t){this.properties.define(e,"$pkg",{value:t})},N.prototype.set=function(e,t,n){if(!(0,l.isString)(t)||!t.length)throw new TypeError("property name must be a non-empty string");var i=this.getProperty(e,t),a=i&&i.name;void 0===n?i?delete e[a]:delete e.$attrs[D(t)]:i?a in e?e[a]=n:T(e,i,n):e.$attrs[D(t)]=n},N.prototype.get=function(e,t){var n=this.getProperty(e,t);if(!n)return e.$attrs[D(t)];var i=n.name;return!e[i]&&n.isMany&&T(e,n,[]),e[i]},N.prototype.define=function(e,t,n){if(!n.writable){var i=n.value;delete(n=(0,l.assign)({},n,{get:function(){return i}})).value}Object.defineProperty(e,t,n)},N.prototype.defineDescriptor=function(e,t){this.define(e,"$descriptor",{value:t})},N.prototype.defineModel=function(e,t){this.define(e,"$model",{value:t})},N.prototype.getProperty=function(e,t){var n=this.model,i=n.getPropertyDescriptor(e,t);if(i)return i;if(t.includes(":"))return null;const a=n.config.strict;if(void 0!==a){const n=new TypeError(`unknown property <${t}> on <${e.$type}>`);if(a)throw n;"undefined"!=typeof console&&console.warn(n)}return null},k.prototype.create=function(e,t){var n=this.getType(e);if(!n)throw new Error("unknown type <"+e+">");return new n(t)},k.prototype.getType=function(e){var t=this.typeCache,n=(0,l.isString)(e)?e:e.ns.name,i=t[n];return i||(e=this.registry.getEffectiveDescriptor(n),i=t[n]=this.factory.createType(e)),i},k.prototype.createAny=function(e,t,n){var i=_(e),a={$type:e,$instanceOf:function(e){return e===this.$type},get:function(e){return this[e]},set:function(e,t){(0,l.set)(this,[e],t)}},r={name:e,isGeneric:!0,ns:{prefix:i.prefix,localName:i.localName,uri:t}};return this.properties.defineDescriptor(a,r),this.properties.defineModel(a,this),this.properties.define(a,"get",{enumerable:!1,writable:!0}),this.properties.define(a,"set",{enumerable:!1,writable:!0}),this.properties.define(a,"$parent",{enumerable:!1,writable:!0}),this.properties.define(a,"$instanceOf",{enumerable:!1,writable:!0}),(0,l.forEach)(n,function(e,t){(0,l.isObject)(e)&&void 0!==e.value?a[e.name]=e.value:a[t]=e}),a},k.prototype.getPackage=function(e){return this.registry.getPackage(e)},k.prototype.getPackages=function(){return this.registry.getPackages()},k.prototype.getElementDescriptor=function(e){return e.$descriptor},k.prototype.hasType=function(e,t){return void 0===t&&(t=e,e=this),t in e.$model.getElementDescriptor(e).allTypesByName},k.prototype.getPropertyDescriptor=function(e,t){return this.getElementDescriptor(e).propertiesByName[t]},k.prototype.getTypeDescriptor=function(e){return this.registry.typeMap[e]};var P=n(11302);function R(e){return e.xml&&"lowerCase"===e.xml.tagAlias}var B={xsi:"http://www.w3.org/2001/XMLSchema-instance",xml:"http://www.w3.org/XML/1998/namespace"},M="property";function I(e){return e.xml&&e.xml.serialize}function F(e,t){return R(t)?e.prefix+":"+((n=e.localName).charAt(0).toUpperCase()+n.slice(1)):e.name;var n}function j(e){return new Error(e)}function O(e){return e.$descriptor}function L(e){(0,l.assign)(this,e),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(e){this.references.push(e)},this.addElement=function(e){if(!e)throw j("expected element");var t,n=this.elementsById,i=O(e).idProperty;if(i&&(t=e.get(i.name))){if(!/^([a-z][\w-.]*:)?[a-z_][\w-.]*$/i.test(t))throw new Error("illegal ID <"+t+">");if(n[t])throw j("duplicate ID <"+t+">");n[t]=e}},this.addWarning=function(e){this.warnings.push(e)}}function $(){}function z(){}function V(){}function G(e,t){this.property=e,this.context=t}function H(e,t){this.element=t,this.propertyDesc=e}function W(){}function U(e,t,n){this.model=e,this.type=e.getType(t),this.context=n}function K(e,t,n){U.call(this,e,t,n)}function q(e,t,n){this.model=e,this.context=n}function J(e){e instanceof k&&(e={model:e}),(0,l.assign)(this,{lax:!1},e)}$.prototype.handleEnd=function(){},$.prototype.handleText=function(){},$.prototype.handleNode=function(){},z.prototype=Object.create($.prototype),z.prototype.handleNode=function(){return this},V.prototype=Object.create($.prototype),V.prototype.handleText=function(e){this.body=(this.body||"")+e},G.prototype=Object.create(V.prototype),G.prototype.handleNode=function(e){if(this.element)throw j("expected no sub nodes");return this.element=this.createReference(e),this},G.prototype.handleEnd=function(){this.element.id=this.body},G.prototype.createReference=function(e){return{property:this.property.ns.name,id:""}},H.prototype=Object.create(V.prototype),H.prototype.handleEnd=function(){var e=this.body||"",t=this.element,n=this.propertyDesc;e=E(n.type,e),n.isMany?t.get(n.name).push(e):t.set(n.name,e)},W.prototype=Object.create(V.prototype),W.prototype.handleNode=function(e){var t=this,n=this.element;return n?t=this.handleChild(e):(n=this.element=this.createElement(e),this.context.addElement(n)),t},U.prototype=Object.create(W.prototype),U.prototype.addReference=function(e){this.context.addReference(e)},U.prototype.handleText=function(e){if(!O(this.element).bodyProperty)throw j("unexpected body text <"+e+">");V.prototype.handleText.call(this,e)},U.prototype.handleEnd=function(){var e=this.body,t=this.element,n=O(t).bodyProperty;n&&void 0!==e&&(e=E(n.type,e),t.set(n.name,e))},U.prototype.createElement=function(e){var t,n=e.attributes,i=this.type,a=O(i),r=this.context,o=new i({}),s=this.model;return(0,l.forEach)(n,function(e,n){var i,c=a.propertiesByName[n];c&&c.isReference?c.isMany?(i=e.split(" "),(0,l.forEach)(i,function(e){r.addReference({element:o,property:c.ns.name,id:e})})):r.addReference({element:o,property:c.ns.name,id:e}):(c?e=E(c.type,e):"xmlns"===n?n=":"+n:(t=_(n,a.ns.prefix),s.getPackage(t.prefix)&&r.addWarning({message:"unknown attribute <"+n+">",element:o,property:n,value:e})),o.set(n,e))}),o},U.prototype.getPropertyForNode=function(e){var t=_(e.name),n=this.type,i=this.model,a=O(n),r=t.name,o=a.propertiesByName[r];if(o&&!o.isAttr){const t=function(e){const t=I(e);return t!==M&&(t||null)}(o);if(t){const n=e.attributes[t];if(n){const t=function(e,t,n){const i=_(e,t.xmlns),a=_(`${t[i.prefix]||i.prefix}:${i.localName}`);return function(e,t){var n=e.name,i=e.localName,a=t&&t.xml&&t.xml.typePrefix;return a&&0===i.indexOf(a)?e.prefix+":"+i.slice(a.length):n}(a,n.getPackage(a.prefix))}(n,e.ns,i),a=i.getType(t);return(0,l.assign)({},o,{effectiveType:O(a).name})}}return o}var s=i.getPackage(t.prefix);if(s){const e=F(t,s),n=i.getType(e);if(o=(0,l.find)(a.properties,function(e){return!e.isVirtual&&!e.isReference&&!e.isAttribute&&n.hasType(e.type)}))return(0,l.assign)({},o,{effectiveType:O(n).name})}else if(o=(0,l.find)(a.properties,function(e){return!e.isReference&&!e.isAttribute&&"Element"===e.type}))return o;throw j("unrecognized element <"+t.name+">")},U.prototype.toString=function(){return"ElementDescriptor["+O(this.type).name+"]"},U.prototype.valueHandler=function(e,t){return new H(e,t)},U.prototype.referenceHandler=function(e){return new G(e,this.context)},U.prototype.handler=function(e){return"Element"===e?new q(this.model,e,this.context):new U(this.model,e,this.context)},U.prototype.handleChild=function(e){var t,n,i,a;if(t=this.getPropertyForNode(e),i=this.element,w(n=t.effectiveType||t.type))return this.valueHandler(t,i);var r=(a=t.isReference?this.referenceHandler(t).handleNode(e):this.handler(n).handleNode(e)).element;return void 0!==r&&(t.isMany?i.get(t.name).push(r):i.set(t.name,r),t.isReference?((0,l.assign)(r,{element:i}),this.context.addReference(r)):r.$parent=i),a},K.prototype=Object.create(U.prototype),K.prototype.createElement=function(e){var t=e.name,n=_(t),i=this.model,a=this.type,r=i.getPackage(n.prefix),o=r&&F(n,r)||t;if(!a.hasType(o))throw j("unexpected element <"+e.originalName+">");return U.prototype.createElement.call(this,e)},q.prototype=Object.create(W.prototype),q.prototype.createElement=function(e){var t=e.name,n=_(t).prefix,i=e.ns[n+"$uri"],a=e.attributes;return this.model.createAny(t,i,a)},q.prototype.handleChild=function(e){var t=new q(this.model,"Element",this.context).handleNode(e),n=this.element,i=t.element;return void 0!==i&&((n.$children=n.$children||[]).push(i),i.$parent=n),t},q.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body)},J.prototype.fromXML=function(e,t,n){var i=t.rootHandler;t instanceof U?(i=t,t={}):"string"==typeof t?(i=this.handler(t),t={}):"string"==typeof i&&(i=this.handler(i));var a=this.model,r=this.lax,o=new L((0,l.assign)({},t,{rootHandler:i})),s=new P.i({proxy:!0}),c=function(){var e=[];return Object.defineProperty(e,"peek",{value:function(){return this[this.length-1]}}),e}();function p(e,t,n){var i=t(),a=i.line,r=i.column,s=i.data;"<"===s.charAt(0)&&-1!==s.indexOf(" ")&&(s=s.slice(0,s.indexOf(" "))+">");var c="unparsable content "+(s?s+" ":"")+"detected\n\tline: "+a+"\n\tcolumn: "+r+"\n\tnested error: "+e.message;if(n)return o.addWarning({message:c,error:e}),!0;throw j(c)}function m(e,t){return p(e,t,!0)}i.context=o,c.push(i);var u=/^<\?xml /i,d=/ encoding="([^"]+)"/i,h=/^utf-8$/i;function f(e,t){try{c.peek().handleText(e)}catch(e){m(e,t)}}var v=a.getPackages().reduce(function(e,t){return e[t.uri]=t.prefix,e},Object.entries(B).reduce(function(e,[t,n]){return e[n]=t,e},a.config&&a.config.nsMap||{}));return s.ns(v).on("openTag",function(e,t,n,i){var a=e.attrs||{},o=Object.keys(a).reduce(function(e,n){var i=t(a[n]);return e[n]=i,e},{});!function(e,t){var n=c.peek();try{c.push(n.handleNode(e))}catch(e){p(e,t,r)&&c.push(new z)}}({name:e.name,originalName:e.originalName,attributes:o,ns:e.ns},i)}).on("question",function(e){if(u.test(e)){var t=d.exec(e),n=t&&t[1];n&&!h.test(n)&&o.addWarning({message:"unsupported document encoding <"+n+">, falling back to UTF-8"})}}).on("closeTag",function(){c.pop().handleEnd()}).on("cdata",f).on("text",function(e,t,n){!function(e,t){e.trim()&&f(e,t)}(t(e),n)}).on("error",p).on("warn",m),new Promise(function(t,n){var a;try{s.parse(e),function(){var e,t,n=o.elementsById,i=o.references;for(e=0;t=i[e];e++){var a=t.element,r=n[t.id],s=O(a).propertiesByName[t.property];if(r||o.addWarning({message:"unresolved reference <"+t.id+">",element:t.element,property:t.property,value:t.id}),s.isMany){var c=a.get(s.name),p=c.indexOf(t);-1===p&&(p=c.length),r?c[p]=r:c.splice(p,1)}else a.set(s.name,r)}}()}catch(e){a=e}var r=i.element;a||r||(a=j("failed to parse document as <"+i.type.$descriptor.name+">"));var c=o.warnings,p=o.references,l=o.elementsById;return a?(a.warnings=c,n(a)):t({rootElement:r,elementsById:l,references:p,warnings:c})})},J.prototype.handler=function(e){return new K(this.model,e)};var X=/<|>|'|"|&|\n\r|\n/g,Y=/<|>|&/g;function Q(e){this.prefixMap={},this.uriMap={},this.used={},this.wellknown=[],this.custom=[],this.parent=e,this.defaultPrefixMap=e&&e.defaultPrefixMap||{}}function Z(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function ee(e){return(0,l.isString)(e)?e:(e.prefix?e.prefix+":":"")+e.localName}Q.prototype.mapDefaultPrefixes=function(e){this.defaultPrefixMap=e},Q.prototype.defaultUriByPrefix=function(e){return this.defaultPrefixMap[e]},Q.prototype.byUri=function(e){return this.uriMap[e]||this.parent&&this.parent.byUri(e)},Q.prototype.add=function(e,t){this.uriMap[e.uri]=e,t?this.wellknown.push(e):this.custom.push(e),this.mapPrefix(e.prefix,e.uri)},Q.prototype.uriByPrefix=function(e){return this.prefixMap[e||"xmlns"]||this.parent&&this.parent.uriByPrefix(e)},Q.prototype.mapPrefix=function(e,t){this.prefixMap[e||"xmlns"]=t},Q.prototype.getNSKey=function(e){return void 0!==e.prefix?e.uri+"|"+e.prefix:e.uri},Q.prototype.logUsed=function(e){var t=e.uri,n=this.getNSKey(e);this.used[n]=this.byUri(t),this.parent&&this.parent.logUsed(e)},Q.prototype.getUsed=function(e){return[].concat(this.wellknown,this.custom).filter(e=>{var t=this.getNSKey(e);return this.used[t]})};var te={"\n":"#10","\n\r":"#10",'"':"#34","'":"#39","<":"#60",">":"#62","&":"#38"},ne={"<":"lt",">":"gt","&":"amp"};function ie(e,t,n){return(e=(0,l.isString)(e)?e:""+e).replace(t,function(e){return"&"+n[e]+";"})}function ae(e){this.tagName=e}function re(){}function oe(e){this.tagName=e}function se(e,t){this.body=[],this.attrs=[],this.parent=e,this.propertyDescriptor=t}function ce(e,t,n){se.call(this,e,t),this.serialization=n}function pe(){this.value="",this.write=function(e){this.value+=e}}function le(e,t){var n=[""];this.append=function(t){return e.write(t),this},this.appendNewLine=function(){return t&&e.write("\n"),this},this.appendIndent=function(){return t&&e.write(n.join("  ")),this},this.indent=function(){return n.push(""),this},this.unindent=function(){return n.pop(),this}}function me(e){return e=(0,l.assign)({format:!1,preamble:!0},e||{}),{toXML:function(t,n){var i=n||new pe,a=new le(i,e.format);e.preamble&&a.append('<?xml version="1.0" encoding="UTF-8"?>\n');var r=new se,o=t.$model;if(r.getNamespaces().mapDefaultPrefixes(function(e){const t=e.config&&e.config.nsMap||{},n={};for(const e in B)n[e]=B[e];for(const e in t)n[t[e]]=e;for(const t of e.getPackages())n[t.prefix]=t.uri;return n}(o)),r.build(t).serializeTo(a),!n)return i.value}}}function ue(e,t){k.call(this,e,t)}ae.prototype.build=function(e){return this.element=e,this},ae.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"+this.element.id+"</"+this.tagName+">").appendNewLine()},re.prototype.serializeValue=re.prototype.serializeTo=function(e){e.append(this.escape?ie(this.value,Y,ne):this.value)},re.prototype.build=function(e,t){return this.value=t,"String"===e.type&&-1!==t.search(Y)&&(this.escape=!0),this},Z(oe,re),oe.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"),this.serializeValue(e),e.append("</"+this.tagName+">").appendNewLine()},se.prototype.build=function(e){this.element=e;var t,n,i,a=e.$descriptor,r=this.propertyDescriptor,o=a.isGeneric;return t=o?this.parseGenericNsAttributes(e):this.parseNsAttributes(e),this.ns=r?this.nsPropertyTagName(r):this.nsTagName(a),this.tagName=this.addTagName(this.ns),o?this.parseGenericContainments(e):(n=function(e){var t=e.$descriptor;return(0,l.filter)(t.properties,function(t){var n=t.name;if(t.isVirtual)return!1;if(!(0,l.has)(e,n))return!1;var i=e[n];return i!==t.default&&null!==i&&(!t.isMany||i.length)})}(e),this.parseAttributes((i=n,(0,l.filter)(i,function(e){return e.isAttr}))),this.parseContainments(function(e){return(0,l.filter)(e,function(e){return!e.isAttr})}(n))),this.parseGenericAttributes(e,t),this},se.prototype.nsTagName=function(e){return function(e,t){return t.isGeneric?(0,l.assign)({localName:t.ns.localName},e):(0,l.assign)({localName:(n=t.ns.localName,i=t.$pkg,R(i)?(a=n).charAt(0).toLowerCase()+a.slice(1):n)},e);var n,i,a}(this.logNamespaceUsed(e.ns),e)},se.prototype.nsPropertyTagName=function(e){return function(e,t){return(0,l.assign)({localName:t.ns.localName},e)}(this.logNamespaceUsed(e.ns),e)},se.prototype.isLocalNs=function(e){return e.uri===this.ns.uri},se.prototype.nsAttributeName=function(e){var t;if(t=(0,l.isString)(e)?_(e):e.ns,e.inherited)return{localName:t.localName};var n=this.logNamespaceUsed(t);return this.getNamespaces().logUsed(n),this.isLocalNs(n)?{localName:t.localName}:(0,l.assign)({localName:t.localName},n)},se.prototype.parseGenericNsAttributes=function(e){return Object.entries(e).filter(([t,n])=>!t.startsWith("$")&&this.parseNsAttribute(e,t,n)).map(([e,t])=>({name:e,value:t}))},se.prototype.parseGenericContainments=function(e){var t=e.$body;t&&this.body.push((new re).build({type:"String"},t));var n=e.$children;n&&(0,l.forEach)(n,e=>{this.body.push(new se(this).build(e))})},se.prototype.parseNsAttribute=function(e,t,n){var i,a=e.$model,r=_(t);if("xmlns"===r.prefix&&(i={prefix:r.localName,uri:n}),r.prefix||"xmlns"!==r.localName||(i={uri:n}),!i)return{name:t,value:n};if(a&&a.getPackage(n))this.logNamespace(i,!0,!0);else{var o=this.logNamespaceUsed(i,!0);this.getNamespaces().logUsed(o)}},se.prototype.parseNsAttributes=function(e){var t=this,n=e.$attrs,i=[];return(0,l.forEach)(n,function(n,a){var r=t.parseNsAttribute(e,a,n);r&&i.push(r)}),i},se.prototype.parseGenericAttributes=function(e,t){var n=this;(0,l.forEach)(t,function(t){try{n.addAttribute(n.nsAttributeName(t.name),t.value)}catch(n){"undefined"!=typeof console&&console.warn(`missing namespace information for <${t.name}=${t.value}> on`,e,n)}})},se.prototype.parseContainments=function(e){var t=this,n=this.body,i=this.element;(0,l.forEach)(e,function(e){var a=i.get(e.name),r=e.isReference;if(e.isMany||(a=[a]),e.isBody)n.push((new re).build(e,a[0]));else if(w(e.type))(0,l.forEach)(a,function(i){n.push(new oe(t.addTagName(t.nsPropertyTagName(e))).build(e,i))});else if(r)(0,l.forEach)(a,function(i){n.push(new ae(t.addTagName(t.nsPropertyTagName(e))).build(i))});else{var o=I(e);(0,l.forEach)(a,function(i){var a;a=o?o===M?new se(t,e):new ce(t,e,o):new se(t),n.push(a.build(i))})}})},se.prototype.getNamespaces=function(e){var t,n=this.namespaces,i=this.parent;return n||(t=i&&i.getNamespaces(),e||!t?this.namespaces=n=new Q(t):n=t),n},se.prototype.logNamespace=function(e,t,n){var i=this.getNamespaces(n),a=e.uri,r=e.prefix;return i.byUri(a)&&!n||i.add(e,t),i.mapPrefix(r,a),e},se.prototype.logNamespaceUsed=function(e,t){var n,i,a,r=this.getNamespaces(t),o=e.prefix,s=e.uri;if(!o&&!s)return{localName:e.localName};if(a=r.defaultUriByPrefix(o),!(s=s||a||r.uriByPrefix(o)))throw new Error("no namespace uri given for prefix <"+o+">");if((e=r.byUri(s))||o||(e=this.logNamespace({uri:s},a===s,!0)),!e){for(n=o,i=1;r.uriByPrefix(n);)n=o+"_"+i++;e=this.logNamespace({prefix:n,uri:s},a===s)}return o&&r.mapPrefix(o,s),e},se.prototype.parseAttributes=function(e){var t=this,n=this.element;(0,l.forEach)(e,function(e){var i=n.get(e.name);if(e.isReference)if(e.isMany){var a=[];(0,l.forEach)(i,function(e){a.push(e.id)}),i=a.join(" ")}else i=i.id;t.addAttribute(t.nsAttributeName(e),i)})},se.prototype.addTagName=function(e){var t=this.logNamespaceUsed(e);return this.getNamespaces().logUsed(t),ee(e)},se.prototype.addAttribute=function(e,t){var n=this.attrs;(0,l.isString)(t)&&(t=ie(t,X,te));var i=(0,l.findIndex)(n,function(t){return t.name.localName===e.localName&&t.name.uri===e.uri&&t.name.prefix===e.prefix}),a={name:e,value:t};-1!==i?n.splice(i,1,a):n.push(a)},se.prototype.serializeAttributes=function(e){var t=this.attrs,n=this.namespaces;n&&(t=function(e){return e.getUsed().filter(function(e){return"xml"!==e.prefix}).map(function(e){return{name:"xmlns"+(e.prefix?":"+e.prefix:""),value:e.uri}})}(n).concat(t)),(0,l.forEach)(t,function(t){e.append(" ").append(ee(t.name)).append('="').append(t.value).append('"')})},se.prototype.serializeTo=function(e){var t=this.body[0],n=t&&t.constructor!==re;e.appendIndent().append("<"+this.tagName),this.serializeAttributes(e),e.append(t?">":" />"),t&&(n&&e.appendNewLine().indent(),(0,l.forEach)(this.body,function(t){t.serializeTo(e)}),n&&e.unindent().appendIndent(),e.append("</"+this.tagName+">")),e.appendNewLine()},Z(ce,se),ce.prototype.parseNsAttributes=function(e){var t=se.prototype.parseNsAttributes.call(this,e).filter(e=>e.name!==this.serialization),n=e.$descriptor;if(n.name===this.propertyDescriptor.type)return t;var i=this.typeNs=this.nsTagName(n);this.getNamespaces().logUsed(this.typeNs);var a=e.$model.getPackage(i.uri),r=a.xml&&a.xml.typePrefix||"";return this.addAttribute(this.nsAttributeName(this.serialization),(i.prefix?i.prefix+":":"")+r+n.ns.localName),t},ce.prototype.isLocalNs=function(e){return e.uri===(this.typeNs||this.ns).uri},ue.prototype=Object.create(k.prototype),ue.prototype.fromXML=function(e,t,n){(0,l.isString)(t)||(n=t,t="bpmn:Definitions");var i=new J((0,l.assign)({model:this,lax:!0},n)),a=i.handler(t);return i.fromXML(e,a)},ue.prototype.toXML=function(e,t){var n=new me(t);return new Promise(function(t,i){try{return t({xml:n.toXML(e)})}catch(e){return i(e)}})};const de={bpmn:{name:"BPMN20",uri:"http://www.omg.org/spec/BPMN/20100524/MODEL",prefix:"bpmn",associations:[],types:[{name:"Interface",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"operations",type:"Operation",isMany:!0},{name:"implementationRef",isAttr:!0,type:"String"}]},{name:"Operation",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"inMessageRef",type:"Message",isReference:!0},{name:"outMessageRef",type:"Message",isReference:!0},{name:"errorRef",type:"Error",isMany:!0,isReference:!0},{name:"implementationRef",isAttr:!0,type:"String"}]},{name:"EndPoint",superClass:["RootElement"]},{name:"Auditing",superClass:["BaseElement"]},{name:"GlobalTask",superClass:["CallableElement"],properties:[{name:"resources",type:"ResourceRole",isMany:!0}]},{name:"Monitoring",superClass:["BaseElement"]},{name:"Performer",superClass:["ResourceRole"]},{name:"Process",superClass:["FlowElementsContainer","CallableElement"],properties:[{name:"processType",type:"ProcessType",isAttr:!0},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"properties",type:"Property",isMany:!0},{name:"laneSets",isMany:!0,replaces:"FlowElementsContainer#laneSets",type:"LaneSet"},{name:"flowElements",isMany:!0,replaces:"FlowElementsContainer#flowElements",type:"FlowElement"},{name:"artifacts",type:"Artifact",isMany:!0},{name:"resources",type:"ResourceRole",isMany:!0},{name:"correlationSubscriptions",type:"CorrelationSubscription",isMany:!0},{name:"supports",type:"Process",isMany:!0,isReference:!0},{name:"definitionalCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"isExecutable",isAttr:!0,type:"Boolean"}]},{name:"LaneSet",superClass:["BaseElement"],properties:[{name:"lanes",type:"Lane",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Lane",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"partitionElementRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"partitionElement",type:"BaseElement"},{name:"flowNodeRef",type:"FlowNode",isMany:!0,isReference:!0},{name:"childLaneSet",type:"LaneSet",xml:{serialize:"xsi:type"}}]},{name:"GlobalManualTask",superClass:["GlobalTask"]},{name:"ManualTask",superClass:["Task"]},{name:"UserTask",superClass:["Task"],properties:[{name:"renderings",type:"Rendering",isMany:!0},{name:"implementation",isAttr:!0,type:"String"}]},{name:"Rendering",superClass:["BaseElement"]},{name:"HumanPerformer",superClass:["Performer"]},{name:"PotentialOwner",superClass:["HumanPerformer"]},{name:"GlobalUserTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"renderings",type:"Rendering",isMany:!0}]},{name:"Gateway",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"gatewayDirection",type:"GatewayDirection",default:"Unspecified",isAttr:!0}]},{name:"EventBasedGateway",superClass:["Gateway"],properties:[{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"eventGatewayType",type:"EventBasedGatewayType",isAttr:!0,default:"Exclusive"}]},{name:"ComplexGateway",superClass:["Gateway"],properties:[{name:"activationCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ExclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"InclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ParallelGateway",superClass:["Gateway"]},{name:"RootElement",isAbstract:!0,superClass:["BaseElement"]},{name:"Relationship",superClass:["BaseElement"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"direction",type:"RelationshipDirection",isAttr:!0},{name:"source",isMany:!0,isReference:!0,type:"Element"},{name:"target",isMany:!0,isReference:!0,type:"Element"}]},{name:"BaseElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,type:"String",isId:!0},{name:"documentation",type:"Documentation",isMany:!0},{name:"extensionDefinitions",type:"ExtensionDefinition",isMany:!0,isReference:!0},{name:"extensionElements",type:"ExtensionElements"}]},{name:"Extension",properties:[{name:"mustUnderstand",default:!1,isAttr:!0,type:"Boolean"},{name:"definition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"extensionAttributeDefinitions",type:"ExtensionAttributeDefinition",isMany:!0}]},{name:"ExtensionAttributeDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",isAttr:!0,type:"String"},{name:"isReference",default:!1,isAttr:!0,type:"Boolean"},{name:"extensionDefinition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionElements",properties:[{name:"valueRef",isAttr:!0,isReference:!0,type:"Element"},{name:"values",type:"Element",isMany:!0},{name:"extensionAttributeDefinition",type:"ExtensionAttributeDefinition",isAttr:!0,isReference:!0}]},{name:"Documentation",superClass:["BaseElement"],properties:[{name:"text",type:"String",isBody:!0},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Event",isAbstract:!0,superClass:["FlowNode","InteractionNode"],properties:[{name:"properties",type:"Property",isMany:!0}]},{name:"IntermediateCatchEvent",superClass:["CatchEvent"]},{name:"IntermediateThrowEvent",superClass:["ThrowEvent"]},{name:"EndEvent",superClass:["ThrowEvent"]},{name:"StartEvent",superClass:["CatchEvent"],properties:[{name:"isInterrupting",default:!0,isAttr:!0,type:"Boolean"}]},{name:"ThrowEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"inputSet",type:"InputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"CatchEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"parallelMultiple",isAttr:!0,type:"Boolean",default:!1},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"outputSet",type:"OutputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"BoundaryEvent",superClass:["CatchEvent"],properties:[{name:"cancelActivity",default:!0,isAttr:!0,type:"Boolean"},{name:"attachedToRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"EventDefinition",isAbstract:!0,superClass:["RootElement"]},{name:"CancelEventDefinition",superClass:["EventDefinition"]},{name:"ErrorEventDefinition",superClass:["EventDefinition"],properties:[{name:"errorRef",type:"Error",isAttr:!0,isReference:!0}]},{name:"TerminateEventDefinition",superClass:["EventDefinition"]},{name:"EscalationEventDefinition",superClass:["EventDefinition"],properties:[{name:"escalationRef",type:"Escalation",isAttr:!0,isReference:!0}]},{name:"Escalation",properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"escalationCode",isAttr:!0,type:"String"}],superClass:["RootElement"]},{name:"CompensateEventDefinition",superClass:["EventDefinition"],properties:[{name:"waitForCompletion",isAttr:!0,type:"Boolean",default:!0},{name:"activityRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"TimerEventDefinition",superClass:["EventDefinition"],properties:[{name:"timeDate",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeCycle",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeDuration",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"LinkEventDefinition",superClass:["EventDefinition"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"target",type:"LinkEventDefinition",isReference:!0},{name:"source",type:"LinkEventDefinition",isMany:!0,isReference:!0}]},{name:"MessageEventDefinition",superClass:["EventDefinition"],properties:[{name:"messageRef",type:"Message",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isReference:!0}]},{name:"ConditionalEventDefinition",superClass:["EventDefinition"],properties:[{name:"condition",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"SignalEventDefinition",superClass:["EventDefinition"],properties:[{name:"signalRef",type:"Signal",isAttr:!0,isReference:!0}]},{name:"Signal",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ImplicitThrowEvent",superClass:["ThrowEvent"]},{name:"DataState",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"ItemAwareElement",superClass:["BaseElement"],properties:[{name:"itemSubjectRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"dataState",type:"DataState"}]},{name:"DataAssociation",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"ItemAwareElement",isMany:!0,isReference:!0},{name:"targetRef",type:"ItemAwareElement",isReference:!0},{name:"transformation",type:"FormalExpression",xml:{serialize:"property"}},{name:"assignment",type:"Assignment",isMany:!0}]},{name:"DataInput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"inputSetRef",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"inputSetWithOptional",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"inputSetWithWhileExecuting",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"DataOutput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"outputSetRef",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"outputSetWithOptional",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"outputSetWithWhileExecuting",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"InputSet",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"dataInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"optionalInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"whileExecutingInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"outputSetRefs",type:"OutputSet",isMany:!0,isReference:!0}]},{name:"OutputSet",superClass:["BaseElement"],properties:[{name:"dataOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"inputSetRefs",type:"InputSet",isMany:!0,isReference:!0},{name:"optionalOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"whileExecutingOutputRefs",type:"DataOutput",isMany:!0,isReference:!0}]},{name:"Property",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"DataInputAssociation",superClass:["DataAssociation"]},{name:"DataOutputAssociation",superClass:["DataAssociation"]},{name:"InputOutputSpecification",superClass:["BaseElement"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"inputSets",type:"InputSet",isMany:!0},{name:"outputSets",type:"OutputSet",isMany:!0}]},{name:"DataObject",superClass:["FlowElement","ItemAwareElement"],properties:[{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"}]},{name:"InputOutputBinding",properties:[{name:"inputDataRef",type:"InputSet",isAttr:!0,isReference:!0},{name:"outputDataRef",type:"OutputSet",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"Assignment",superClass:["BaseElement"],properties:[{name:"from",type:"Expression",xml:{serialize:"xsi:type"}},{name:"to",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"DataStore",superClass:["RootElement","ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"capacity",isAttr:!0,type:"Integer"},{name:"isUnlimited",default:!0,isAttr:!0,type:"Boolean"}]},{name:"DataStoreReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataStoreRef",type:"DataStore",isAttr:!0,isReference:!0}]},{name:"DataObjectReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataObjectRef",type:"DataObject",isAttr:!0,isReference:!0}]},{name:"ConversationLink",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ConversationAssociation",superClass:["BaseElement"],properties:[{name:"innerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0},{name:"outerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0}]},{name:"CallConversation",superClass:["ConversationNode"],properties:[{name:"calledCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"Conversation",superClass:["ConversationNode"]},{name:"SubConversation",superClass:["ConversationNode"],properties:[{name:"conversationNodes",type:"ConversationNode",isMany:!0}]},{name:"ConversationNode",isAbstract:!0,superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"messageFlowRefs",type:"MessageFlow",isMany:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0}]},{name:"GlobalConversation",superClass:["Collaboration"]},{name:"PartnerEntity",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"PartnerRole",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"CorrelationProperty",superClass:["RootElement"],properties:[{name:"correlationPropertyRetrievalExpression",type:"CorrelationPropertyRetrievalExpression",isMany:!0},{name:"name",isAttr:!0,type:"String"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Error",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"errorCode",isAttr:!0,type:"String"}]},{name:"CorrelationKey",superClass:["BaseElement"],properties:[{name:"correlationPropertyRef",type:"CorrelationProperty",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Expression",superClass:["BaseElement"],isAbstract:!1,properties:[{name:"body",isBody:!0,type:"String"}]},{name:"FormalExpression",superClass:["Expression"],properties:[{name:"language",isAttr:!0,type:"String"},{name:"evaluatesToTypeRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Message",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"itemRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"ItemDefinition",superClass:["RootElement"],properties:[{name:"itemKind",type:"ItemKind",isAttr:!0},{name:"structureRef",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"import",type:"Import",isAttr:!0,isReference:!0}]},{name:"FlowElement",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"categoryValueRef",type:"CategoryValue",isMany:!0,isReference:!0}]},{name:"SequenceFlow",superClass:["FlowElement"],properties:[{name:"isImmediate",isAttr:!0,type:"Boolean"},{name:"conditionExpression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"sourceRef",type:"FlowNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"FlowNode",isAttr:!0,isReference:!0}]},{name:"FlowElementsContainer",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"laneSets",type:"LaneSet",isMany:!0},{name:"flowElements",type:"FlowElement",isMany:!0}]},{name:"CallableElement",isAbstract:!0,superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"supportedInterfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"ioBinding",type:"InputOutputBinding",isMany:!0,xml:{serialize:"property"}}]},{name:"FlowNode",isAbstract:!0,superClass:["FlowElement"],properties:[{name:"incoming",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"outgoing",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"lanes",type:"Lane",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"CorrelationPropertyRetrievalExpression",superClass:["BaseElement"],properties:[{name:"messagePath",type:"FormalExpression"},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"CorrelationPropertyBinding",superClass:["BaseElement"],properties:[{name:"dataPath",type:"FormalExpression"},{name:"correlationPropertyRef",type:"CorrelationProperty",isAttr:!0,isReference:!0}]},{name:"Resource",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"resourceParameters",type:"ResourceParameter",isMany:!0}]},{name:"ResourceParameter",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isRequired",isAttr:!0,type:"Boolean"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"CorrelationSubscription",superClass:["BaseElement"],properties:[{name:"correlationKeyRef",type:"CorrelationKey",isAttr:!0,isReference:!0},{name:"correlationPropertyBinding",type:"CorrelationPropertyBinding",isMany:!0}]},{name:"MessageFlow",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"MessageFlowAssociation",superClass:["BaseElement"],properties:[{name:"innerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0},{name:"outerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0}]},{name:"InteractionNode",isAbstract:!0,properties:[{name:"incomingConversationLinks",type:"ConversationLink",isMany:!0,isVirtual:!0,isReference:!0},{name:"outgoingConversationLinks",type:"ConversationLink",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"Participant",superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"interfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"participantMultiplicity",type:"ParticipantMultiplicity"},{name:"endPointRefs",type:"EndPoint",isMany:!0,isReference:!0},{name:"processRef",type:"Process",isAttr:!0,isReference:!0}]},{name:"ParticipantAssociation",superClass:["BaseElement"],properties:[{name:"innerParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"outerParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"ParticipantMultiplicity",properties:[{name:"minimum",default:0,isAttr:!0,type:"Integer"},{name:"maximum",default:1,isAttr:!0,type:"Integer"}],superClass:["BaseElement"]},{name:"Collaboration",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"participants",type:"Participant",isMany:!0},{name:"messageFlows",type:"MessageFlow",isMany:!0},{name:"artifacts",type:"Artifact",isMany:!0},{name:"conversations",type:"ConversationNode",isMany:!0},{name:"conversationAssociations",type:"ConversationAssociation"},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0},{name:"messageFlowAssociations",type:"MessageFlowAssociation",isMany:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"choreographyRef",type:"Choreography",isMany:!0,isReference:!0},{name:"conversationLinks",type:"ConversationLink",isMany:!0}]},{name:"ChoreographyActivity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"loopType",type:"ChoreographyLoopType",default:"None",isAttr:!0}]},{name:"CallChoreography",superClass:["ChoreographyActivity"],properties:[{name:"calledChoreographyRef",type:"Choreography",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"SubChoreography",superClass:["ChoreographyActivity","FlowElementsContainer"],properties:[{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"ChoreographyTask",superClass:["ChoreographyActivity"],properties:[{name:"messageFlowRef",type:"MessageFlow",isMany:!0,isReference:!0}]},{name:"Choreography",superClass:["Collaboration","FlowElementsContainer"]},{name:"GlobalChoreographyTask",superClass:["Choreography"],properties:[{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"TextAnnotation",superClass:["Artifact"],properties:[{name:"text",type:"String"},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Group",superClass:["Artifact"],properties:[{name:"categoryValueRef",type:"CategoryValue",isAttr:!0,isReference:!0}]},{name:"Association",superClass:["Artifact"],properties:[{name:"associationDirection",type:"AssociationDirection",isAttr:!0},{name:"sourceRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"targetRef",type:"BaseElement",isAttr:!0,isReference:!0}]},{name:"Category",superClass:["RootElement"],properties:[{name:"categoryValue",type:"CategoryValue",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Artifact",isAbstract:!0,superClass:["BaseElement"]},{name:"CategoryValue",superClass:["BaseElement"],properties:[{name:"categorizedFlowElements",type:"FlowElement",isMany:!0,isVirtual:!0,isReference:!0},{name:"value",isAttr:!0,type:"String"}]},{name:"Activity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"isForCompensation",default:!1,isAttr:!0,type:"Boolean"},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"boundaryEventRefs",type:"BoundaryEvent",isMany:!0,isReference:!0},{name:"properties",type:"Property",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"startQuantity",default:1,isAttr:!0,type:"Integer"},{name:"resources",type:"ResourceRole",isMany:!0},{name:"completionQuantity",default:1,isAttr:!0,type:"Integer"},{name:"loopCharacteristics",type:"LoopCharacteristics"}]},{name:"ServiceTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"SubProcess",superClass:["Activity","FlowElementsContainer","InteractionNode"],properties:[{name:"triggeredByEvent",default:!1,isAttr:!0,type:"Boolean"},{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"LoopCharacteristics",isAbstract:!0,superClass:["BaseElement"]},{name:"MultiInstanceLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"isSequential",default:!1,isAttr:!0,type:"Boolean"},{name:"behavior",type:"MultiInstanceBehavior",default:"All",isAttr:!0},{name:"loopCardinality",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopDataInputRef",type:"ItemAwareElement",isReference:!0},{name:"loopDataOutputRef",type:"ItemAwareElement",isReference:!0},{name:"inputDataItem",type:"DataInput",xml:{serialize:"property"}},{name:"outputDataItem",type:"DataOutput",xml:{serialize:"property"}},{name:"complexBehaviorDefinition",type:"ComplexBehaviorDefinition",isMany:!0},{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"oneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0},{name:"noneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0}]},{name:"StandardLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"testBefore",default:!1,isAttr:!0,type:"Boolean"},{name:"loopCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopMaximum",type:"Integer",isAttr:!0}]},{name:"CallActivity",superClass:["Activity","InteractionNode"],properties:[{name:"calledElement",type:"String",isAttr:!0}]},{name:"Task",superClass:["Activity","InteractionNode"]},{name:"SendTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ReceiveTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ScriptTask",superClass:["Task"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"script",type:"String"}]},{name:"BusinessRuleTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"AdHocSubProcess",superClass:["SubProcess"],properties:[{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"ordering",type:"AdHocOrdering",isAttr:!0},{name:"cancelRemainingInstances",default:!0,isAttr:!0,type:"Boolean"}]},{name:"Transaction",superClass:["SubProcess"],properties:[{name:"protocol",isAttr:!0,type:"String"},{name:"method",isAttr:!0,type:"String"}]},{name:"GlobalScriptTask",superClass:["GlobalTask"],properties:[{name:"scriptLanguage",isAttr:!0,type:"String"},{name:"script",isAttr:!0,type:"String"}]},{name:"GlobalBusinessRuleTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"ComplexBehaviorDefinition",superClass:["BaseElement"],properties:[{name:"condition",type:"FormalExpression"},{name:"event",type:"ImplicitThrowEvent"}]},{name:"ResourceRole",superClass:["BaseElement"],properties:[{name:"resourceRef",type:"Resource",isReference:!0},{name:"resourceParameterBindings",type:"ResourceParameterBinding",isMany:!0},{name:"resourceAssignmentExpression",type:"ResourceAssignmentExpression"},{name:"name",isAttr:!0,type:"String"}]},{name:"ResourceParameterBinding",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"parameterRef",type:"ResourceParameter",isAttr:!0,isReference:!0}],superClass:["BaseElement"]},{name:"ResourceAssignmentExpression",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}}],superClass:["BaseElement"]},{name:"Import",properties:[{name:"importType",isAttr:!0,type:"String"},{name:"location",isAttr:!0,type:"String"},{name:"namespace",isAttr:!0,type:"String"}]},{name:"Definitions",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"targetNamespace",isAttr:!0,type:"String"},{name:"expressionLanguage",default:"http://www.w3.org/1999/XPath",isAttr:!0,type:"String"},{name:"typeLanguage",default:"http://www.w3.org/2001/XMLSchema",isAttr:!0,type:"String"},{name:"imports",type:"Import",isMany:!0},{name:"extensions",type:"Extension",isMany:!0},{name:"rootElements",type:"RootElement",isMany:!0},{name:"diagrams",isMany:!0,type:"bpmndi:BPMNDiagram"},{name:"exporter",isAttr:!0,type:"String"},{name:"relationships",type:"Relationship",isMany:!0},{name:"exporterVersion",isAttr:!0,type:"String"}]}],enumerations:[{name:"ProcessType",literalValues:[{name:"None"},{name:"Public"},{name:"Private"}]},{name:"GatewayDirection",literalValues:[{name:"Unspecified"},{name:"Converging"},{name:"Diverging"},{name:"Mixed"}]},{name:"EventBasedGatewayType",literalValues:[{name:"Parallel"},{name:"Exclusive"}]},{name:"RelationshipDirection",literalValues:[{name:"None"},{name:"Forward"},{name:"Backward"},{name:"Both"}]},{name:"ItemKind",literalValues:[{name:"Physical"},{name:"Information"}]},{name:"ChoreographyLoopType",literalValues:[{name:"None"},{name:"Standard"},{name:"MultiInstanceSequential"},{name:"MultiInstanceParallel"}]},{name:"AssociationDirection",literalValues:[{name:"None"},{name:"One"},{name:"Both"}]},{name:"MultiInstanceBehavior",literalValues:[{name:"None"},{name:"One"},{name:"All"},{name:"Complex"}]},{name:"AdHocOrdering",literalValues:[{name:"Parallel"},{name:"Sequential"}]}],xml:{tagAlias:"lowerCase",typePrefix:"t"}},bpmndi:{name:"BPMNDI",uri:"http://www.omg.org/spec/BPMN/20100524/DI",prefix:"bpmndi",types:[{name:"BPMNDiagram",properties:[{name:"plane",type:"BPMNPlane",redefines:"di:Diagram#rootElement"},{name:"labelStyle",type:"BPMNLabelStyle",isMany:!0}],superClass:["di:Diagram"]},{name:"BPMNPlane",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"}],superClass:["di:Plane"]},{name:"BPMNShape",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"isHorizontal",isAttr:!0,type:"Boolean"},{name:"isExpanded",isAttr:!0,type:"Boolean"},{name:"isMarkerVisible",isAttr:!0,type:"Boolean"},{name:"label",type:"BPMNLabel"},{name:"isMessageVisible",isAttr:!0,type:"Boolean"},{name:"participantBandKind",type:"ParticipantBandKind",isAttr:!0},{name:"choreographyActivityShape",type:"BPMNShape",isAttr:!0,isReference:!0}],superClass:["di:LabeledShape"]},{name:"BPMNEdge",properties:[{name:"label",type:"BPMNLabel"},{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"sourceElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#source"},{name:"targetElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#target"},{name:"messageVisibleKind",type:"MessageVisibleKind",isAttr:!0,default:"initiating"}],superClass:["di:LabeledEdge"]},{name:"BPMNLabel",properties:[{name:"labelStyle",type:"BPMNLabelStyle",isAttr:!0,isReference:!0,redefines:"di:DiagramElement#style"}],superClass:["di:Label"]},{name:"BPMNLabelStyle",properties:[{name:"font",type:"dc:Font"}],superClass:["di:Style"]}],enumerations:[{name:"ParticipantBandKind",literalValues:[{name:"top_initiating"},{name:"middle_initiating"},{name:"bottom_initiating"},{name:"top_non_initiating"},{name:"middle_non_initiating"},{name:"bottom_non_initiating"}]},{name:"MessageVisibleKind",literalValues:[{name:"initiating"},{name:"non_initiating"}]}],associations:[]},dc:{name:"DC",uri:"http://www.omg.org/spec/DD/20100524/DC",prefix:"dc",types:[{name:"Boolean"},{name:"Integer"},{name:"Real"},{name:"String"},{name:"Font",properties:[{name:"name",type:"String",isAttr:!0},{name:"size",type:"Real",isAttr:!0},{name:"isBold",type:"Boolean",isAttr:!0},{name:"isItalic",type:"Boolean",isAttr:!0},{name:"isUnderline",type:"Boolean",isAttr:!0},{name:"isStrikeThrough",type:"Boolean",isAttr:!0}]},{name:"Point",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0}]},{name:"Bounds",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0},{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]}],associations:[]},di:{name:"DI",uri:"http://www.omg.org/spec/DD/20100524/DI",prefix:"di",types:[{name:"DiagramElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"extension",type:"Extension"},{name:"owningDiagram",type:"Diagram",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"owningElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"modelElement",isReadOnly:!0,isVirtual:!0,isReference:!0,type:"Element"},{name:"style",type:"Style",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"ownedElement",type:"DiagramElement",isReadOnly:!0,isMany:!0,isVirtual:!0}]},{name:"Node",isAbstract:!0,superClass:["DiagramElement"]},{name:"Edge",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"source",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"target",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"waypoint",isUnique:!1,isMany:!0,type:"dc:Point",xml:{serialize:"xsi:type"}}]},{name:"Diagram",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"rootElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0},{name:"name",isAttr:!0,type:"String"},{name:"documentation",isAttr:!0,type:"String"},{name:"resolution",isAttr:!0,type:"Real"},{name:"ownedStyle",type:"Style",isReadOnly:!0,isMany:!0,isVirtual:!0}]},{name:"Shape",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Plane",isAbstract:!0,superClass:["Node"],properties:[{name:"planeElement",type:"DiagramElement",subsettedProperty:"DiagramElement-ownedElement",isMany:!0}]},{name:"LabeledEdge",isAbstract:!0,superClass:["Edge"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isMany:!0,isVirtual:!0}]},{name:"LabeledShape",isAbstract:!0,superClass:["Shape"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isMany:!0,isVirtual:!0}]},{name:"Label",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Style",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"}]},{name:"Extension",properties:[{name:"values",isMany:!0,type:"Element"}]}],associations:[],xml:{tagAlias:"lowerCase"}},bioc:{name:"bpmn.io colors for BPMN",uri:"http://bpmn.io/schema/bpmn/biocolor/1.0",prefix:"bioc",types:[{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]}],enumerations:[],associations:[]},color:{name:"BPMN in Color",uri:"http://www.omg.org/spec/BPMN/non-normative/color/1.0",prefix:"color",types:[{name:"ColoredLabel",extends:["bpmndi:BPMNLabel"],properties:[{name:"color",isAttr:!0,type:"String"}]},{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"background-color",isAttr:!0,type:"String"},{name:"border-color",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"border-color",isAttr:!0,type:"String"}]}],enumerations:[],associations:[]}};function he(e,t){return new ue((0,l.assign)({},de,e),t)}function fe(e){return e?"<"+e.$type+(e.id?' id="'+e.id:"")+'" />':"<null>"}function ve(e){(0,l.has)(e,"di")||Object.defineProperty(e,"di",{enumerable:!1,get:function(){throw new Error("Tried to access di from the businessObject. The di is available through the diagram element only. For more information, see https://github.com/bpmn-io/bpmn-js/issues/1472")}})}function ge(e,t){return e.$instanceOf(t)}function ye(e){var t={},n=[],i={};function a(e,t){return function(n){e(n,t)}}function r(e){t[e.id]=e}function o(t,n){try{var a=i[t.id]&&function(t,n){if(t.gfx)throw new Error(`already rendered ${fe(t)}`);return e.element(t,i[t.id],n)}(t,n);return r(t),a}catch(e){s(e.message,{element:t,error:e}),console.error(`failed to import ${fe(t)}`,e)}}function s(t,n){e.error(t,n)}var c=this.registerDi=function(e){var t=e.bpmnElement;t?i[t.id]?s(`multiple DI elements defined for ${fe(t)}`,{element:t}):(i[t.id]=e,ve(t)):s(`no bpmnElement referenced in ${fe(e)}`,{element:e})};function p(e){c(e)}this.handleDefinitions=function(r,o){var h=r.diagrams;if(o&&-1===h.indexOf(o))throw new Error("diagram not part of <bpmn:Definitions />");if(!o&&h&&h.length&&(o=h[0]),!o)throw new Error("no diagram to display");i={},function(e){var t;t=e.plane,c(t),(0,l.forEach)(t.planeElement,p)}(o);var f=o.plane;if(!f)throw new Error(`no plane for ${fe(o)}`);var v=f.bpmnElement;if(!v){if(v=function(e){return(0,l.find)(e.rootElements,function(e){return ge(e,"bpmn:Process")||ge(e,"bpmn:Collaboration")})}(r),!v)throw new Error("no process or collaboration to display");s(`correcting missing bpmnElement on ${fe(f)} to ${fe(v)}`),f.bpmnElement=v,c(f)}var g,b,E=function(t,n){return e.root(t,i[t.id],n)}(v,f);if(ge(v,"bpmn:Process")||ge(v,"bpmn:SubProcess"))u(v,E);else{if(!ge(v,"bpmn:Collaboration"))throw new Error(`unsupported bpmnElement for ${fe(f)}: ${fe(v)}`);g=v,b=E,(0,l.forEach)(g.participants,a(A,b)),n.push(function(){!function(e,t){(0,l.forEach)(e,a(d,t))}(g.messageFlows,b)}),y(g.artifacts,b),function(e,n){(0,l.filter)(e,function(e){return!t[e.id]&&ge(e,"bpmn:Process")&&e.laneSets}).forEach(a(u,n))}(r.rootElements,E)}m(n)};var m=this.handleDeferred=function(){for(;n.length;)n.shift()()};function u(e,t){S(e,t),b(e.ioSpecification,t),y(e.artifacts,t),r(e)}function d(e,t){o(e,t)}function h(e,t){o(e,t)}function f(e,t){o(e,t)}function v(e,t){o(e,t)}function g(e,t){o(e,t)}function y(e,t){(0,l.forEach)(e,function(e){ge(e,"bpmn:Association")?n.push(function(){g(e,t)}):g(e,t)})}function b(e,t){e&&((0,l.forEach)(e.dataInputs,a(f,t)),(0,l.forEach)(e.dataOutputs,a(v,t)))}var E=this.handleSubProcess=function(e,t){S(e,t),y(e.artifacts,t)};function x(e,t){var i=o(e,t);ge(e,"bpmn:SubProcess")&&E(e,i||t),ge(e,"bpmn:Activity")&&b(e.ioSpecification,t),n.push(function(){(0,l.forEach)(e.dataInputAssociations,a(h,t)),(0,l.forEach)(e.dataOutputAssociations,a(h,t))})}function w(e,t){n.push(function(){var n=o(e,t);e.childLaneSet&&_(e.childLaneSet,n||t),function(e){(0,l.forEach)(e.flowNodeRef,function(t){var n=t.get("lanes");n&&n.push(e)})}(e)})}function _(e,t){(0,l.forEach)(e.lanes,a(w,t))}function S(e,t){!function(e,t){(0,l.forEach)(e,function(e){ge(e,"bpmn:SequenceFlow")?n.push(function(){!function(e,t){o(e,t)}(e,t)}):ge(e,"bpmn:BoundaryEvent")?n.unshift(function(){x(e,t)}):ge(e,"bpmn:FlowNode")?x(e,t):ge(e,"bpmn:DataObject")||(ge(e,"bpmn:DataStoreReference")||ge(e,"bpmn:DataObjectReference")?function(e,t){o(e,t)}(e,t):s(`unrecognized flowElement ${fe(e)} in context ${fe(t&&t.businessObject)}`,{element:e,context:t}))})}(e.flowElements,t),e.laneSets&&function(e,t){(0,l.forEach)(e,a(_,t))}(e.laneSets,t)}function A(e,t){var n=o(e,t),i=e.processRef;i&&u(i,n||t)}}var be=n(70868);function Ee(e,t,n){var i,a,r,o=[];function s(e,t){var n=new ye({root:function(e,t){return i.add(e,t)},element:function(e,t,n){return i.add(e,t,n)},error:function(e,t){o.push({message:e,context:t})}});t=t||e.diagrams&&e.diagrams[0];var a=function(e,t){if(t&&t.plane){var n,i=t.plane.bpmnElement,a=i;(0,be.is)(i,"bpmn:Process")||(0,be.is)(i,"bpmn:Collaboration")||(a=function(e){for(var t=e;t;){if((0,be.is)(t,"bpmn:Process"))return t;t=t.$parent}}(i)),n=(0,be.is)(a,"bpmn:Collaboration")?a:(0,l.find)(e.rootElements,function(e){if((0,be.is)(e,"bpmn:Collaboration"))return(0,l.find)(e.participants,function(e){return e.processRef===a})});var r=[a];n&&(r=(0,l.map)(n.participants,function(e){return e.processRef})).push(n);var o=xe(r),s=[t],c=[i];return(0,l.forEach)(e.diagrams,function(e){if(e.plane){var t=e.plane.bpmnElement;-1!==o.indexOf(t)&&-1===c.indexOf(t)&&(s.push(e),c.push(t))}}),s}}(e,t);if(!a)throw new Error("no diagram to display");(0,l.forEach)(a,function(t){n.handleDefinitions(e,t)});var s=t.plane.bpmnElement.id;r.setRootElement(r.findRoot(s+"_plane")||r.findRoot(s))}return new Promise(function(c,p){try{return i=e.get("bpmnImporter"),a=e.get("eventBus"),r=e.get("canvas"),a.fire("import.render.start",{definitions:t}),s(t,n),a.fire("import.render.complete",{error:void 0,warnings:o}),c({warnings:o})}catch(e){return e.warnings=o,p(e)}})}function xe(e){var t=[];return(0,l.forEach)(e,function(e){e&&(t.push(e),t=t.concat(xe(e.flowElements)))}),t}var we,_e='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.02 5.57" width="53" height="21"><path fill="currentColor" d="M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z"/><path fill="currentColor" d="M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z"/></svg>',Se={verticalAlign:"middle"},Ae={color:"#404040"},Ce={zIndex:"1001",position:"fixed",top:"0",left:"0",right:"0",bottom:"0"},Ne={width:"100%",height:"100%",background:"rgba(40,40,40,0.2)"},Te={position:"absolute",left:"50%",top:"40%",transform:"translate(-50%)",width:"260px",padding:"10px",background:"white",boxShadow:"0 1px 4px rgba(0,0,0,0.3)",fontFamily:"Helvetica, Arial, sans-serif",fontSize:"14px",display:"flex",lineHeight:"1.3"},De='<div class="bjs-powered-by-lightbox"><div class="backdrop"></div><div class="notice"><a href="https://bpmn.io" target="_blank" rel="noopener" class="link">'+_e+'</a><span>Web-based tooling for BPMN, DMN and forms powered by <a href="https://bpmn.io" target="_blank" rel="noopener">bpmn.io</a>.</span></div></div>';function ke(e){e=(0,l.assign)({},Re,e),this._moddle=this._createModdle(e),this._container=this._createContainer(e),this._init(this._container,this._moddle,e),function(e){const t='<a href="http://bpmn.io" target="_blank" class="bjs-powered-by" title="Powered by bpmn.io" >'+_e+"</a>",n=d()(t);(0,m.HZ)((0,m.P)("svg",n),Se),(0,m.HZ)(n,Ae,{position:"absolute",bottom:"15px",right:"15px",zIndex:"100"}),e.appendChild(n),m.f0.bind(n,"click",function(e){we||(we=d()(De),(0,m.HZ)(we,Ce),(0,m.HZ)((0,m.P)("svg",we),Se),(0,m.HZ)((0,m.P)(".backdrop",we),Ne),(0,m.HZ)((0,m.P)(".notice",we),Te),(0,m.HZ)((0,m.P)(".link",we),Ae,{margin:"15px 20px 15px 10px",alignSelf:"center"}),m.Mm.bind(we,".backdrop","click",function(e){document.body.removeChild(we)})),document.body.appendChild(we),e.preventDefault()})}(this._container)}function Pe(e,t){return e.warnings=t,e}(0,i.A)(ke,f.A),ke.prototype.importXML=async function(e,t){const n=this;let i=[];try{let r;e=this._emit("import.parse.start",{xml:e})||e;try{r=await this._moddle.fromXML(e,"bpmn:Definitions")}catch(e){throw this._emit("import.parse.complete",{error:e}),e}let o=r.rootElement;const s=r.references,c=r.warnings,p=r.elementsById;i=i.concat(c),o=this._emit("import.parse.complete",(a={error:null,definitions:o,elementsById:p,references:s,warnings:i},n.get("eventBus").createEvent(a)))||o;const l=await this.importDefinitions(o,t);return i=i.concat(l.warnings),this._emit("import.done",{error:null,warnings:i}),{warnings:i}}catch(e){let t=e;throw i=i.concat(t.warnings||[]),Pe(t,i),t=function(e){const t=/unparsable content <([^>]+)> detected([\s\S]*)$/.exec(e.message);return t&&(e.message="unparsable content <"+t[1]+"> detected; this may indicate an invalid BPMN 2.0 diagram file"+t[2]),e}(t),this._emit("import.done",{error:t,warnings:t.warnings}),t}var a},ke.prototype.importDefinitions=async function(e,t){return this._setDefinitions(e),{warnings:(await this.open(t)).warnings}},ke.prototype.open=async function(e){const t=this._definitions;let n=e;if(!t){const e=new Error("no XML imported");throw Pe(e,[]),e}if("string"==typeof e&&(n=function(e,t){return t&&(0,l.find)(e.diagrams,function(e){return e.id===t})||null}(t,e),!n)){const t=new Error("BPMNDiagram <"+e+"> not found");throw Pe(t,[]),t}try{this.clear()}catch(e){throw Pe(e,[]),e}const{warnings:i}=await Ee(this,t,n);return{warnings:i}},ke.prototype.saveXML=async function(e){e=e||{};let t,n,i=this._definitions;try{if(!i)throw new Error("no definitions loaded");i=this._emit("saveXML.start",{definitions:i})||i,n=(await this._moddle.toXML(i,e)).xml,n=this._emit("saveXML.serialized",{xml:n})||n}catch(e){t=e}const a=t?{error:t}:{xml:n};if(this._emit("saveXML.done",a),t)throw t;return a},ke.prototype.saveSVG=async function(){let e,t;this._emit("saveSVG.start");try{const t=this.get("canvas"),n=t.getActiveLayer(),i=(0,m.P)(":scope > defs",t._svg),a=(0,h.LI)(n),r=i?"<defs>"+(0,h.LI)(i)+"</defs>":"",o=n.getBBox();e='<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- created with bpmn-js / http://bpmn.io --\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+o.width+'" height="'+o.height+'" viewBox="'+o.x+" "+o.y+" "+o.width+" "+o.height+'" version="1.1">'+r+a+"</svg>"}catch(e){t=e}if(this._emit("saveSVG.done",{error:t,svg:e}),t)throw t;return{svg:e}},ke.prototype._setDefinitions=function(e){this._definitions=e},ke.prototype.getModules=function(){return this._modules},ke.prototype.clear=function(){this.getDefinitions()&&f.A.prototype.clear.call(this)},ke.prototype.destroy=function(){f.A.prototype.destroy.call(this),(0,m.TF)(this._container)},ke.prototype.on=function(e,t,n,i){return this.get("eventBus").on(e,t,n,i)},ke.prototype.off=function(e,t){this.get("eventBus").off(e,t)},ke.prototype.attachTo=function(e){if(!e)throw new Error("parentNode required");this.detach(),e.get&&e.constructor.prototype.jquery&&(e=e.get(0)),"string"==typeof e&&(e=(0,m.P)(e)),e.appendChild(this._container),this._emit("attach",{}),this.get("canvas").resized()},ke.prototype.getDefinitions=function(){return this._definitions},ke.prototype.detach=function(){const e=this._container,t=e.parentNode;t&&(this._emit("detach",{}),t.removeChild(e))},ke.prototype._init=function(e,t,n){const i=n.modules||this.getModules(n),a=n.additionalModules||[],r=[].concat([{bpmnjs:["value",this],moddle:["value",t]}],i,a),o=(0,l.assign)((0,l.omit)(n,["additionalModules"]),{canvas:(0,l.assign)({},n.canvas,{container:e}),modules:r});f.A.call(this,o),n&&n.container&&this.attachTo(n.container)},ke.prototype._emit=function(e,t){return this.get("eventBus").fire(e,t)},ke.prototype._createContainer=function(e){const t=d()('<div class="bjs-container"></div>');return(0,m.HZ)(t,{width:Be(e.width),height:Be(e.height),position:e.position}),t},ke.prototype._createModdle=function(e){return new he((0,l.assign)({},this._moddleExtensions,e.moddleExtensions))},ke.prototype._modules=[];const Re={width:"100%",height:"100%",position:"relative"};function Be(e){return e+((0,l.isNumber)(e)?"px":"")}function Me(e){ke.call(this,e),this.on("import.parse.complete",function(e){e.error||this._collectIds(e.definitions,e.elementsById)},this),this.on("diagram.destroy",function(){this.get("moddle").ids.clear()},this)}(0,i.A)(Me,ke),Me.prototype._createModdle=function(e){var t=ke.prototype._createModdle.call(this,e);return t.ids=new p([32,36,1]),t},Me.prototype._collectIds=function(e,t){var n,i=e.$model.ids;for(n in i.clear(),t)i.claim(n,t[n])};var Ie=n(1591),Fe=n(97810),je=n(48719),Oe=n(64242),Le=n(24107),$e="hsl(225, 10%, 15%)";function ze(e,t){return(0,l.some)(e.eventDefinitions,function(e){return e.$type===t})}function Ve(e,t,n){var i=(0,be.S2)(e);return n||i.get("color:background-color")||i.get("bioc:fill")||t||"white"}function Ge(e,t,n){var i=(0,be.S2)(e);return n||i.get("color:border-color")||i.get("bioc:stroke")||t||$e}function He(e,t,n,i){var a=(0,be.S2)(e).get("label");return i||a&&a.get("color:color")||t||Ge(e,n)}function We(e){var t=e.x+e.width/2,n=e.y+e.height/2,i=e.width/2,a=[["M",t,n],["m",0,-i],["a",i,i,0,1,1,0,2*i],["a",i,i,0,1,1,0,-2*i],["z"]];return(0,Le.tx)(a)}function Ue(e,t){var n=e.x,i=e.y,a=e.width,r=e.height,o=[["M",n+t,i],["l",a-2*t,0],["a",t,t,0,0,1,t,t],["l",0,r-2*t],["a",t,t,0,0,1,-t,t],["l",2*t-a,0],["a",t,t,0,0,1,-t,-t],["l",0,2*t-r],["a",t,t,0,0,1,t,-t],["z"]];return(0,Le.tx)(o)}function Ke(e,t={}){return{width:qe(e,t),height:Je(e,t)}}function qe(e,t={}){return(0,l.has)(t,"width")?t.width:e.width}function Je(e,t={}){return(0,l.has)(t,"height")?t.height:e.height}var Xe=n(46757),Ye=new p,Qe=.95;function Ze(e,t,n,i,a,r,o){Ie.A.call(this,t,o);var s=e&&e.defaultFillColor,c=e&&e.defaultStrokeColor,p=e&&e.defaultLabelColor;function u(e){return n.computeStyle(e,{strokeLinecap:"round",strokeLinejoin:"round",stroke:$e,strokeWidth:2,fill:"white"})}function d(e){return n.computeStyle(e,["no-fill"],{strokeLinecap:"round",strokeLinejoin:"round",stroke:$e,strokeWidth:2})}function f(e,t){var{ref:n={x:0,y:0},scale:i=1,element:r,parentGfx:o=a._svg}=t,s=(0,h.vt)("marker",{id:e,viewBox:"0 0 20 20",refX:n.x,refY:n.y,markerWidth:20*i,markerHeight:20*i,orient:"auto"});(0,h.BC)(s,r);var c=(0,m.P)(":scope > defs",o);c||(c=(0,h.vt)("defs"),(0,h.BC)(o,c)),(0,h.BC)(c,s)}function v(e,t,n,i){var a=Ye.nextPrefixed("marker-");return function(e,t,n,i,a){"sequenceflow-end"===n&&f(t,{element:(0,h.vt)("path",{d:"M 1 5 L 11 10 L 1 15 Z",...u({fill:a,stroke:a,strokeWidth:1})}),ref:{x:11,y:10},scale:.5,parentGfx:e}),"messageflow-start"===n&&f(t,{element:(0,h.vt)("circle",{cx:6,cy:6,r:3.5,...u({fill:i,stroke:a,strokeWidth:1,strokeDasharray:[1e4,1]})}),ref:{x:6,y:6},parentGfx:e}),"messageflow-end"===n&&f(t,{element:(0,h.vt)("path",{d:"m 1 5 l 0 -3 l 7 3 l -7 3 z",...u({fill:i,stroke:a,strokeWidth:1,strokeDasharray:[1e4,1]})}),ref:{x:8.5,y:5},parentGfx:e}),"association-start"===n&&f(t,{element:(0,h.vt)("path",{d:"M 11 5 L 1 10 L 11 15",...d({fill:"none",stroke:a,strokeWidth:1.5,strokeDasharray:[1e4,1]})}),ref:{x:1,y:10},scale:.5,parentGfx:e}),"association-end"===n&&f(t,{element:(0,h.vt)("path",{d:"M 1 5 L 11 10 L 1 15",...d({fill:"none",stroke:a,strokeWidth:1.5,strokeDasharray:[1e4,1]})}),ref:{x:11,y:10},scale:.5,parentGfx:e}),"conditional-flow-marker"===n&&f(t,{element:(0,h.vt)("path",{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z",...u({fill:i,stroke:a})}),ref:{x:-1,y:10},scale:.5,parentGfx:e}),"conditional-default-flow-marker"===n&&f(t,{element:(0,h.vt)("path",{d:"M 6 4 L 10 16",...u({stroke:a,fill:"none"})}),ref:{x:0,y:10},scale:.5,parentGfx:e})}(e,a,t,n,i),"url(#"+a+")"}function g(e,t,n,i,a={}){(0,l.isObject)(i)&&(a=i,i=0),i=i||0,a=u(a);var r=t/2,o=n/2,s=(0,h.vt)("circle",{cx:r,cy:o,r:Math.round((t+n)/4-i),...a});return(0,h.BC)(e,s),s}function y(e,t,n,i,a,r){(0,l.isObject)(a)&&(r=a,a=0),a=a||0,r=u(r);var o=(0,h.vt)("rect",{x:a,y:a,width:t-2*a,height:n-2*a,rx:i,ry:i,...r});return(0,h.BC)(e,o),o}function b(e,t,n,i){n=d(n);var a=(0,Le.RJ)(t,n,i);return(0,h.BC)(e,a),a}function E(e,t,n){return b(e,t,n,5)}function x(e,t,n){n=d(n);var i=(0,h.vt)("path",{...n,d:t});return(0,h.BC)(e,i),i}function w(e,t,n,i){return x(t,n,(0,l.assign)({"data-marker":e},i))}function _(e){return $[e]}function S(e){return function(t,n,i){return _(e)(t,n,i)}}function A(e,t,n={},a){var r,o=(0,be.Cf)(e),p="bpmn:IntermediateThrowEvent"===(r=o).$type||"bpmn:EndEvent"===r.$type,l=a||e;return o.get("eventDefinitions")&&o.get("eventDefinitions").length>1?o.get("parallelMultiple")?function(e,t,n={}){return x(e,i.getScaledPath("EVENT_PARALLEL_MULTIPLE",{xScaleFactor:1.2,yScaleFactor:1.2,containerWidth:n.width||t.width,containerHeight:n.height||t.height,position:{mx:.458,my:.194}}),{fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:1})}(t,l,n):function(e,t,n={},a){return x(e,i.getScaledPath("EVENT_MULTIPLE",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:n.width||t.width,containerHeight:n.height||t.height,position:{mx:.211,my:.36}}),{fill:a?Ge(t,c,n.stroke):Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:1})}(t,l,n,p):ze(o,"bpmn:MessageEventDefinition")?function(e,t,n={},a){return x(e,i.getScaledPath("EVENT_MESSAGE",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:n.width||t.width,containerHeight:n.height||t.height,position:{mx:.235,my:.315}}),{fill:a?Ge(t,c,n.stroke):Ve(t,s,n.fill),stroke:a?Ve(t,s,n.fill):Ge(t,c,n.stroke),strokeWidth:1})}(t,l,n,p):ze(o,"bpmn:TimerEventDefinition")?function(e,t,n={}){var a=n.width||t.width,r=n.height||t.height,o=n.width?1:2,p=g(e,a,r,.2*r,{fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:o});x(e,i.getScaledPath("EVENT_TIMER_WH",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:a,containerHeight:r,position:{mx:.5,my:.5}}),{stroke:Ge(t,c,n.stroke),strokeWidth:o});for(var l=0;l<12;l++){var m=a/2,u=r/2;x(e,i.getScaledPath("EVENT_TIMER_LINE",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:a,containerHeight:r,position:{mx:.5,my:.5}}),{strokeWidth:1,stroke:Ge(t,c,n.stroke),transform:"rotate("+30*l+","+u+","+m+")"})}return p}(t,l,n):ze(o,"bpmn:ConditionalEventDefinition")?function(e,t,n={}){return x(e,i.getScaledPath("EVENT_CONDITIONAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:n.width||t.width,containerHeight:n.height||t.height,position:{mx:.5,my:.222}}),{fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:1})}(t,l,n):ze(o,"bpmn:SignalEventDefinition")?function(e,t,n={},a){return x(e,i.getScaledPath("EVENT_SIGNAL",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:n.width||t.width,containerHeight:n.height||t.height,position:{mx:.5,my:.2}}),{strokeWidth:1,fill:a?Ge(t,c,n.stroke):Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke)})}(t,l,n,p):ze(o,"bpmn:EscalationEventDefinition")?function(e,t,n={},a){return x(e,i.getScaledPath("EVENT_ESCALATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:n.width||t.width,containerHeight:n.height||t.height,position:{mx:.5,my:.2}}),{fill:a?Ge(t,c,n.stroke):Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:1})}(t,l,n,p):ze(o,"bpmn:LinkEventDefinition")?function(e,t,n={},a){return x(e,i.getScaledPath("EVENT_LINK",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.57,my:.263}}),{fill:a?Ge(t,c,n.stroke):Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:1})}(t,l,n,p):ze(o,"bpmn:ErrorEventDefinition")?function(e,t,n={},a){return x(e,i.getScaledPath("EVENT_ERROR",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:n.width||t.width,containerHeight:n.height||t.height,position:{mx:.2,my:.722}}),{fill:a?Ge(t,c,n.stroke):Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:1})}(t,l,n,p):ze(o,"bpmn:CancelEventDefinition")?function(e,t,n={},a){var r=x(e,i.getScaledPath("EVENT_CANCEL_45",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.638,my:-.055}}),{fill:a?Ge(t,c,n.stroke):"none",stroke:Ge(t,c,n.stroke),strokeWidth:1});return(0,Xe.e$)(r,45),r}(t,l,n,p):ze(o,"bpmn:CompensateEventDefinition")?function(e,t,n={},a){return x(e,i.getScaledPath("EVENT_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:n.width||t.width,containerHeight:n.height||t.height,position:{mx:.22,my:.5}}),{fill:a?Ge(t,c,n.stroke):Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:1})}(t,l,n,p):ze(o,"bpmn:TerminateEventDefinition")?function(e,t,n={}){return g(e,t.width,t.height,8,{fill:Ge(t,c,n.stroke),stroke:Ge(t,c,n.stroke),strokeWidth:4})}(t,l,n):null}var C={ParticipantMultiplicityMarker:function(e,t,n={}){var a=qe(t,n),r=Je(t,n);w("participant-multiplicity",e,i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:a,containerHeight:r,position:{mx:(a/2-6)/a,my:(r-15)/r}}),{strokeWidth:2,fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke)})},SubProcessMarker:function(e,t,n={}){var a=y(e,14,14,0,{strokeWidth:1,fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke)});(0,Xe.Tl)(a,t.width/2-7.5,t.height-20),w("sub-process",e,i.getScaledPath("MARKER_SUB_PROCESS",{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2-7.5)/t.width,my:(t.height-20)/t.height}}),{fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke)})},ParallelMarker:function(e,t,n){var a=qe(t,n),r=Je(t,n);w("parallel",e,i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:a,containerHeight:r,position:{mx:(a/2+n.parallel)/a,my:(r-20)/r}}),{fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke)})},SequentialMarker:function(e,t,n){w("sequential",e,i.getScaledPath("MARKER_SEQUENTIAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+n.seq)/t.width,my:(t.height-19)/t.height}}),{fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke)})},CompensationMarker:function(e,t,n){w("compensation",e,i.getScaledPath("MARKER_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+n.compensation)/t.width,my:(t.height-13)/t.height}}),{strokeWidth:1,fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke)})},LoopMarker:function(e,t,n){var a=qe(t,n),r=Je(t,n);w("loop",e,i.getScaledPath("MARKER_LOOP",{xScaleFactor:1,yScaleFactor:1,containerWidth:a,containerHeight:r,position:{mx:(a/2+n.loop)/a,my:(r-7)/r}}),{strokeWidth:1.5,fill:"none",stroke:Ge(t,c,n.stroke),strokeMiterlimit:.5})},AdhocMarker:function(e,t,n){var a=qe(t,n),r=Je(t,n);w("adhoc",e,i.getScaledPath("MARKER_ADHOC",{xScaleFactor:1,yScaleFactor:1,containerWidth:a,containerHeight:r,position:{mx:(a/2+n.adhoc)/a,my:(r-15)/r}}),{strokeWidth:1,fill:Ge(t,c,n.stroke),stroke:Ge(t,c,n.stroke)})}};function N(e,t,n,i){C[e](t,n,i)}function T(e,t,n=[],i={}){i={fill:i.fill,stroke:i.stroke,width:qe(t,i),height:Je(t,i)};var a=(0,be.Cf)(t),r=n.includes("SubProcessMarker");i=r?{...i,seq:-21,parallel:-22,compensation:-25,loop:-18,adhoc:10}:{...i,seq:-5,parallel:-6,compensation:-7,loop:0,adhoc:-8},a.get("isForCompensation")&&n.push("CompensationMarker"),(0,be.is)(a,"bpmn:AdHocSubProcess")&&(n.push("AdhocMarker"),r||(0,l.assign)(i,{compensation:i.compensation-18}));var o=a.get("loopCharacteristics"),s=o&&o.get("isSequential");o&&((0,l.assign)(i,{compensation:i.compensation-18}),n.includes("AdhocMarker")&&(0,l.assign)(i,{seq:-23,loop:-18,parallel:-24}),void 0===s&&n.push("LoopMarker"),!1===s&&n.push("ParallelMarker"),!0===s&&n.push("SequentialMarker")),n.includes("CompensationMarker")&&1===n.length&&(0,l.assign)(i,{compensation:-8}),(0,l.forEach)(n,function(n){N(n,e,t,i)})}function D(e,t,n={}){n=(0,l.assign)({size:{width:100}},n);var i=r.createText(t||"",n);return(0,h.Ly)(i).add("djs-label"),(0,h.BC)(e,i),i}function k(e,t,n,i={}){var a=(0,be.Cf)(t),r=Ke({x:t.x,y:t.y,width:t.width,height:t.height},i);return D(e,a.name,{align:n,box:r,padding:7,style:{fill:He(t,p,c,i.stroke)}})}function P(e,t,n,i={}){var a=(0,Fe.$b)(n),r=D(e,t,{box:{height:30,width:a?Je(n,i):qe(n,i)},align:"center-middle",style:{fill:He(n,p,c,i.stroke)}});if(a){var o=-1*Je(n,i);(0,Xe.pd)(r,0,-o,270)}}function R(e,t,n={}){var{width:i,height:a}=Ke(t,n);return y(e,i,a,10,{...n,fill:Ve(t,s,n.fill),fillOpacity:Qe,stroke:Ge(t,c,n.stroke)})}function B(e,t,n={}){var i=(0,be.Cf)(t),a=Ve(t,s,n.fill),r=Ge(t,c,n.stroke);return"One"!==i.get("associationDirection")&&"Both"!==i.get("associationDirection")||(n.markerEnd=v(e,"association-end",a,r)),"Both"===i.get("associationDirection")&&(n.markerStart=v(e,"association-start",a,r)),n=et(n,["markerStart","markerEnd"]),E(e,t.waypoints,{...n,stroke:r,strokeDasharray:"0, 5"})}function M(e,t,n={}){var a=Ve(t,s,n.fill),r=Ge(t,c,n.stroke),o=x(e,i.getScaledPath("DATA_OBJECT_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.474,my:.296}}),{fill:a,fillOpacity:Qe,stroke:r});return function(e){var t=e.dataObjectRef;return e.isCollection||t&&t.isCollection}((0,be.Cf)(t))&&x(e,i.getScaledPath("DATA_OBJECT_COLLECTION_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.33,my:(t.height-18)/t.height}}),{strokeWidth:2,fill:a,stroke:r}),o}function I(e,t,n={}){return g(e,t.width,t.height,{fillOpacity:Qe,...n,fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke)})}function F(e,t,n={}){return function(e,t,n,i){var a=t/2,r=n/2,o=[{x:a,y:0},{x:t,y:r},{x:a,y:n},{x:0,y:r}].map(function(e){return e.x+","+e.y}).join(" ");i=u(i);var s=(0,h.vt)("polygon",{...i,points:o});return(0,h.BC)(e,s),s}(e,t.width,t.height,{fill:Ve(t,s,n.fill),fillOpacity:Qe,stroke:Ge(t,c,n.stroke)})}function j(e,t,n={}){var i=y(e,qe(t,n),Je(t,n),0,{fill:Ve(t,s,n.fill),fillOpacity:n.fillOpacity||Qe,stroke:Ge(t,c,n.stroke),strokeWidth:1.5}),a=(0,be.Cf)(t);return(0,be.is)(a,"bpmn:Lane")&&P(e,a.get("name"),t,n),i}function O(e,t,n={}){var i=R(e,t,n),a=(0,Fe.Av)(t);if((0,Fe.Q1)(t)&&((0,h.CF)(i,{strokeDasharray:"0, 5.5",strokeWidth:2.5}),!a)){var r=((0,be.Cf)(t).flowElements||[]).filter(e=>(0,be.is)(e,"bpmn:StartEvent"));1===r.length&&function(e,t,n,i){var a={fill:Ve(i,s,n.fill),stroke:Ge(i,c,n.stroke),width:22,height:22},r=(0,be.Cf)(e).isInterrupting;g(t,20,20,{fill:a.fill,stroke:a.stroke,strokeWidth:r?1:1.2,strokeDasharray:r?0:3,transform:"translate(1,1)"}),A(e,t,a,i)}(r[0],e,n,t)}return k(e,t,a?"center-top":"center-middle",n),T(e,t,a?void 0:["SubProcessMarker"],n),i}function L(e,t,n={}){var i=R(e,t,n);return k(e,t,"center-middle",n),T(e,t,void 0,n),i}var $=this.handlers={"bpmn:AdHocSubProcess":function(e,t,n={}){return O(e,t,n=(0,Fe.Av)(t)?et(n,["fill","stroke","width","height"]):et(n,["fill","stroke"]))},"bpmn:Association":function(e,t,n={}){return B(e,t,n=et(n,["fill","stroke"]))},"bpmn:BoundaryEvent":function(e,t,n={}){var{renderIcon:i=!0}=n;n=et(n,["fill","stroke"]);var a=(0,be.Cf)(t).get("cancelActivity");n={strokeWidth:1.5,fill:Ve(t,s,n.fill),fillOpacity:1,stroke:Ge(t,c,n.stroke)},a||(n.strokeDasharray="6");var r=I(e,t,n);return g(e,t.width,t.height,3,{...n,fill:"none"}),i&&A(t,e,n),r},"bpmn:BusinessRuleTask":function(e,t,n={}){var a=L(e,t,n=et(n,["fill","stroke"])),r=x(e,i.getScaledPath("TASK_TYPE_BUSINESS_RULE_MAIN",{abspos:{x:8,y:8}}));(0,h.CF)(r,{fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:1});var o=x(e,i.getScaledPath("TASK_TYPE_BUSINESS_RULE_HEADER",{abspos:{x:8,y:8}}));return(0,h.CF)(o,{fill:Ge(t,c,n.stroke),stroke:Ge(t,c,n.stroke),strokeWidth:1}),a},"bpmn:CallActivity":function(e,t,n={}){return n=et(n,["fill","stroke"]),O(e,t,{strokeWidth:5,...n})},"bpmn:ComplexGateway":function(e,t,n={}){var a=F(e,t,n=et(n,["fill","stroke"]));return x(e,i.getScaledPath("GATEWAY_COMPLEX",{xScaleFactor:.5,yScaleFactor:.5,containerWidth:t.width,containerHeight:t.height,position:{mx:.46,my:.26}}),{fill:Ge(t,c,n.stroke),stroke:Ge(t,c,n.stroke),strokeWidth:1}),a},"bpmn:DataInput":function(e,t,n={}){n=et(n,["fill","stroke"]);var a=i.getRawPath("DATA_ARROW"),r=M(e,t,n);return x(e,a,{fill:"none",stroke:Ge(t,c,n.stroke),strokeWidth:1}),r},"bpmn:DataInputAssociation":function(e,t,n={}){return n=et(n,["fill","stroke"]),B(e,t,{...n,markerEnd:v(e,"association-end",Ve(t,s,n.fill),Ge(t,c,n.stroke))})},"bpmn:DataObject":function(e,t,n={}){return M(e,t,n=et(n,["fill","stroke"]))},"bpmn:DataObjectReference":S("bpmn:DataObject"),"bpmn:DataOutput":function(e,t,n={}){n=et(n,["fill","stroke"]);var a=i.getRawPath("DATA_ARROW"),r=M(e,t,n);return x(e,a,{strokeWidth:1,fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke)}),r},"bpmn:DataOutputAssociation":function(e,t,n={}){return n=et(n,["fill","stroke"]),B(e,t,{...n,markerEnd:v(e,"association-end",Ve(t,s,n.fill),Ge(t,c,n.stroke))})},"bpmn:DataStoreReference":function(e,t,n={}){return n=et(n,["fill","stroke"]),x(e,i.getScaledPath("DATA_STORE",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:0,my:.133}}),{fill:Ve(t,s,n.fill),fillOpacity:Qe,stroke:Ge(t,c,n.stroke),strokeWidth:2})},"bpmn:EndEvent":function(e,t,n={}){var{renderIcon:i=!0}=n;n=et(n,["fill","stroke"]);var a=I(e,t,{...n,strokeWidth:4});return i&&A(t,e,n),a},"bpmn:EventBasedGateway":function(e,t,n={}){n=et(n,["fill","stroke"]);var a=(0,be.Cf)(t),r=F(e,t,n);g(e,t.width,t.height,.2*t.height,{fill:Ve(t,"none",n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:1});var o=a.get("eventGatewayType"),s=!!a.get("instantiate");if("Parallel"===o){var p=i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:t.width,containerHeight:t.height,position:{mx:.474,my:.296}});x(e,p,{fill:"none",stroke:Ge(t,c,n.stroke),strokeWidth:1})}else"Exclusive"===o&&(s||g(e,t.width,t.height,.26*t.height,{fill:"none",stroke:Ge(t,c,n.stroke),strokeWidth:1}),function(){var a=i.getScaledPath("GATEWAY_EVENT_BASED",{xScaleFactor:.18,yScaleFactor:.18,containerWidth:t.width,containerHeight:t.height,position:{mx:.36,my:.44}});x(e,a,{fill:"none",stroke:Ge(t,c,n.stroke),strokeWidth:2})}());return r},"bpmn:ExclusiveGateway":function(e,t,n={}){var a=F(e,t,n=et(n,["fill","stroke"])),r=i.getScaledPath("GATEWAY_EXCLUSIVE",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:t.width,containerHeight:t.height,position:{mx:.32,my:.3}});return(0,be.S2)(t).get("isMarkerVisible")&&x(e,r,{fill:Ge(t,c,n.stroke),stroke:Ge(t,c,n.stroke),strokeWidth:1}),a},"bpmn:Gateway":function(e,t,n={}){return F(e,t,n=et(n,["fill","stroke"]))},"bpmn:Group":function(e,t,n={}){return n=et(n,["fill","stroke","width","height"]),y(e,t.width,t.height,10,{stroke:Ge(t,c,n.stroke),strokeWidth:1.5,strokeDasharray:"10, 6, 0, 6",fill:"none",pointerEvents:"none",width:qe(t,n),height:Je(t,n)})},"bpmn:InclusiveGateway":function(e,t,n={}){var i=F(e,t,n=et(n,["fill","stroke"]));return g(e,t.width,t.height,.24*t.height,{fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:2.5}),i},"bpmn:IntermediateEvent":function(e,t,n={}){var{renderIcon:i=!0}=n;n=et(n,["fill","stroke"]);var a=I(e,t,{...n,strokeWidth:1.5});return g(e,t.width,t.height,3,{fill:"none",stroke:Ge(t,c,n.stroke),strokeWidth:1.5}),i&&A(t,e,n),a},"bpmn:IntermediateCatchEvent":S("bpmn:IntermediateEvent"),"bpmn:IntermediateThrowEvent":S("bpmn:IntermediateEvent"),"bpmn:Lane":function(e,t,n={}){return n=et(n,["fill","stroke","width","height"]),j(e,t,{...n,fillOpacity:.25})},"bpmn:ManualTask":function(e,t,n={}){var a=L(e,t,n=et(n,["fill","stroke"]));return x(e,i.getScaledPath("TASK_TYPE_MANUAL",{abspos:{x:17,y:15}}),{fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:.5}),a},"bpmn:MessageFlow":function(e,t,n={}){n=et(n,["fill","stroke"]);var a=(0,be.Cf)(t),r=(0,be.S2)(t),o=Ve(t,s,n.fill),p=Ge(t,c,n.stroke),l=E(e,t.waypoints,{markerEnd:v(e,"messageflow-end",o,p),markerStart:v(e,"messageflow-start",o,p),stroke:p,strokeDasharray:"10, 11",strokeWidth:1.5});if(a.get("messageRef")){var m=l.getPointAtLength(l.getTotalLength()/2),u=i.getScaledPath("MESSAGE_FLOW_MARKER",{abspos:{x:m.x,y:m.y}}),d={strokeWidth:1};"initiating"===r.get("messageVisibleKind")?(d.fill=o,d.stroke=p):(d.fill=p,d.stroke=o);var h=x(e,u,d),f=D(e,a.get("messageRef").get("name"),{align:"center-top",fitBox:!0,style:{fill:p}}),g=h.getBBox(),y=f.getBBox(),b=m.x-y.width/2,w=m.y+g.height/2+10;(0,Xe.pd)(f,b,w,0)}return l},"bpmn:ParallelGateway":function(e,t,n={}){var a=F(e,t,n=et(n,["fill","stroke"]));return x(e,i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.6,yScaleFactor:.6,containerWidth:t.width,containerHeight:t.height,position:{mx:.46,my:.2}}),{fill:Ge(t,c,n.stroke),stroke:Ge(t,c,n.stroke),strokeWidth:1}),a},"bpmn:Participant":function(e,t,n={}){var i=j(e,t,n=et(n,["fill","stroke","width","height"])),a=(0,Fe.Av)(t),r=(0,Fe.$b)(t),o=(0,be.Cf)(t),s=o.get("name");if(a)b(e,r?[{x:30,y:0},{x:30,y:Je(t,n)}]:[{x:0,y:30},{x:qe(t,n),y:30}],{stroke:Ge(t,c,n.stroke),strokeWidth:1.5}),P(e,s,t,n);else{var l=Ke(t,n);r||(l.height=qe(t,n),l.width=Je(t,n));var m=D(e,s,{box:l,align:"center-middle",style:{fill:He(t,p,c,n.stroke)}});if(!r){var u=-1*Je(t,n);(0,Xe.pd)(m,0,-u,270)}}return o.get("participantMultiplicity")&&N("ParticipantMultiplicityMarker",e,t,n),i},"bpmn:ReceiveTask":function(e,t,n={}){n=et(n,["fill","stroke"]);var a,r=(0,be.Cf)(t),o=L(e,t,n);return r.get("instantiate")?(g(e,28,28,4.4,{fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:1}),a=i.getScaledPath("TASK_TYPE_INSTANTIATING_SEND",{abspos:{x:7.77,y:9.52}})):a=i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:21,containerHeight:14,position:{mx:.3,my:.4}}),x(e,a,{fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:1}),o},"bpmn:ScriptTask":function(e,t,n={}){var a=L(e,t,n=et(n,["fill","stroke"]));return x(e,i.getScaledPath("TASK_TYPE_SCRIPT",{abspos:{x:15,y:20}}),{fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:1}),a},"bpmn:SendTask":function(e,t,n={}){var a=L(e,t,n=et(n,["fill","stroke"]));return x(e,i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:1,yScaleFactor:1,containerWidth:21,containerHeight:14,position:{mx:.285,my:.357}}),{fill:Ge(t,c,n.stroke),stroke:Ve(t,s,n.fill),strokeWidth:1}),a},"bpmn:SequenceFlow":function(e,t,n={}){n=et(n,["fill","stroke"]);var i=Ve(t,s,n.fill),a=Ge(t,c,n.stroke),r=E(e,t.waypoints,{markerEnd:v(e,"sequenceflow-end",i,a),stroke:a}),o=(0,be.Cf)(t),{source:p}=t;if(p){var l=(0,be.Cf)(p);o.get("conditionExpression")&&(0,be.is)(l,"bpmn:Activity")&&(0,h.CF)(r,{markerStart:v(e,"conditional-flow-marker",i,a)}),l.get("default")&&((0,be.is)(l,"bpmn:Gateway")||(0,be.is)(l,"bpmn:Activity"))&&l.get("default")===o&&(0,h.CF)(r,{markerStart:v(e,"conditional-default-flow-marker",i,a)})}return r},"bpmn:ServiceTask":function(e,t,n={}){var a=L(e,t,n=et(n,["fill","stroke"]));return g(e,10,10,{fill:Ve(t,s,n.fill),stroke:"none",transform:"translate(6, 6)"}),x(e,i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:12,y:18}}),{fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:1}),g(e,10,10,{fill:Ve(t,s,n.fill),stroke:"none",transform:"translate(11, 10)"}),x(e,i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:17,y:22}}),{fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:1}),a},"bpmn:StartEvent":function(e,t,n={}){var{renderIcon:i=!0}=n;n=et(n,["fill","stroke"]),(0,be.Cf)(t).get("isInterrupting")||(n={...n,strokeDasharray:"6"});var a=I(e,t,n);return i&&A(t,e,n),a},"bpmn:SubProcess":function(e,t,n={}){return O(e,t,n=(0,Fe.Av)(t)?et(n,["fill","stroke","width","height"]):et(n,["fill","stroke"]))},"bpmn:Task":function(e,t,n={}){return L(e,t,n=et(n,["fill","stroke"]))},"bpmn:TextAnnotation":function(e,t,n={}){n=et(n,["fill","stroke","width","height"]);var{width:a,height:r}=Ke(t,n),o=y(e,a,r,0,0,{fill:"none",stroke:"none"});return x(e,i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:a,containerHeight:r,position:{mx:0,my:0}}),{stroke:Ge(t,c,n.stroke)}),D(e,(0,be.Cf)(t).get("text")||"",{align:"left-top",box:Ke(t,n),padding:7,style:{fill:He(t,p,c,n.stroke)}}),o},"bpmn:Transaction":function(e,t,i={}){i=(0,Fe.Av)(t)?et(i,["fill","stroke","width","height"]):et(i,["fill","stroke"]);var a=O(e,t,{strokeWidth:1.5,...i}),r=n.style(["no-fill","no-events"],{stroke:Ge(t,c,i.stroke),strokeWidth:1.5});return(0,Fe.Av)(t)||(i={}),y(e,qe(t,i),Je(t,i),7,3,r),a},"bpmn:UserTask":function(e,t,n={}){var a=L(e,t,n=et(n,["fill","stroke"]));return x(e,i.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:15,y:12}}),{fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:.5}),x(e,i.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:15,y:12}}),{fill:Ve(t,s,n.fill),stroke:Ge(t,c,n.stroke),strokeWidth:.5}),x(e,i.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:15,y:12}}),{fill:Ge(t,c,n.stroke),stroke:Ge(t,c,n.stroke),strokeWidth:.5}),a},label:function(e,t,n={}){return function(e,t,n={}){var i={width:90,height:30,x:t.width/2+t.x,y:t.height/2+t.y};return D(e,(0,je.p9)(t),{box:i,fitBox:!0,style:(0,l.assign)({},r.getExternalStyle(),{fill:He(t,p,c,n.stroke)})})}(e,t,n)}};this._drawPath=x,this._renderer=_}function et(e,t=[]){return t.reduce((t,n)=>(e[n]&&(t[n]=e[n]),t),{})}(0,i.A)(Ze,Ie.A),Ze.$inject=["config.bpmnRenderer","eventBus","styles","pathMap","canvas","textRenderer"],Ze.prototype.canRender=function(e){return(0,be.is)(e,"bpmn:BaseElement")},Ze.prototype.drawShape=function(e,t,n={}){var{type:i}=t;return this._renderer(i)(e,t,n)},Ze.prototype.drawConnection=function(e,t,n={}){var{type:i}=t;return this._renderer(i)(e,t,n)},Ze.prototype.getShapePath=function(e){return(0,Oe.J2)(e)?Ue(e,4):(0,be.is)(e,"bpmn:Event")?We(e):(0,be.is)(e,"bpmn:Activity")?Ue(e,10):(0,be.is)(e,"bpmn:Gateway")?function(e){var t=e.width/2,n=e.height/2,i=[["M",e.x+t,e.y],["l",t,n],["l",-t,n],["l",-t,-n],["z"]];return(0,Le.tx)(i)}(e):function(e){var t=e.x,n=e.y,i=e.width,a=[["M",t,n],["l",i,0],["l",0,e.height],["l",-i,0],["z"]];return(0,Le.tx)(a)}(e)};var tt=n(4156);function nt(e){var t=(0,l.assign)({fontFamily:"Arial, sans-serif",fontSize:12,fontWeight:"normal",lineHeight:1.2},e&&e.defaultStyle||{}),n=parseInt(t.fontSize,10)-1,i=(0,l.assign)({},t,{fontSize:n},e&&e.externalStyle||{}),a=new tt.A({style:t});this.getExternalLabelBounds=function(e,t){var n=a.getDimensions(t,{box:{width:90,height:30},style:i});return{x:Math.round(e.x+e.width/2-n.width/2),y:Math.round(e.y),width:Math.ceil(n.width),height:Math.ceil(n.height)}},this.getTextAnnotationBounds=function(e,n){var i=a.getDimensions(n,{box:e,style:t,align:"left-top",padding:5});return{x:e.x,y:e.y,width:e.width,height:Math.max(30,Math.round(i.height))}},this.createText=function(e,t){return a.createText(e,t||{})},this.getDefaultStyle=function(){return t},this.getExternalStyle=function(){return i}}nt.$inject=["config.textRenderer"];var it=/\{([^{}]+)\}/g,at=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;const rt={__init__:["bpmnRenderer"],bpmnRenderer:["type",Ze],textRenderer:["type",nt],pathMap:["type",function(){this.pathMap={EVENT_MESSAGE:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:36,width:36,heightElements:[6,14],widthElements:[10.5,21]},EVENT_SIGNAL:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z",height:36,width:36,heightElements:[18],widthElements:[10,20]},EVENT_ESCALATION:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x0},-{e.y1} l -{e.x0},{e.y1} Z",height:36,width:36,heightElements:[20,7],widthElements:[8]},EVENT_CONDITIONAL:{d:"M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z M {e.x2},{e.y3} l {e.x0},0 M {e.x2},{e.y4} l {e.x0},0 M {e.x2},{e.y5} l {e.x0},0 M {e.x2},{e.y6} l {e.x0},0 M {e.x2},{e.y7} l {e.x0},0 M {e.x2},{e.y8} l {e.x0},0 ",height:36,width:36,heightElements:[8.5,14.5,18,11.5,14.5,17.5,20.5,23.5,26.5],widthElements:[10.5,14.5,12.5]},EVENT_LINK:{d:"m {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z",height:36,width:36,heightElements:[4.4375,6.75,7.8125],widthElements:[9.84375,13.5]},EVENT_ERROR:{d:"m {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z",height:36,width:36,heightElements:[.023,8.737,8.151,16.564,10.591,8.714],widthElements:[.085,6.672,6.97,4.273,5.337,6.636]},EVENT_CANCEL_45:{d:"m {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:36,width:36,heightElements:[4.75,8.5],widthElements:[4.75,8.5]},EVENT_COMPENSATION:{d:"m {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x1},-{e.y2} {e.x2},-{e.y3} 0,{e.y1} -{e.x2},-{e.y3} z",height:36,width:36,heightElements:[6.5,13,.4,6.1],widthElements:[9,9.3,8.7]},EVENT_TIMER_WH:{d:"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ",height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:"M {mx},{my} m {e.x0},{e.y0} l -{e.x1},{e.y1} ",height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_MULTIPLE:{d:"m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z",height:36,width:36,heightElements:[6.28099,12.56199],widthElements:[3.1405,9.42149,12.56198]},EVENT_PARALLEL_MULTIPLE:{d:"m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} -{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z",height:36,width:36,heightElements:[2.56228,7.68683],widthElements:[2.56228,7.68683]},GATEWAY_EXCLUSIVE:{d:"m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} {e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} {e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z",height:17.5,width:17.5,heightElements:[8.5,6.5312,-6.5312,-8.5],widthElements:[6.5,-6.5,3,-3,5,-5]},GATEWAY_PARALLEL:{d:"m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:30,width:30,heightElements:[5,12.5],widthElements:[5,12.5]},GATEWAY_EVENT_BASED:{d:"m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z",height:11,width:11,heightElements:[-6,6,12,-12],widthElements:[9,-3,-12]},GATEWAY_COMPLEX:{d:"m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} {e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} {e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} -{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z",height:17.125,width:17.125,heightElements:[4.875,3.4375,2.125,3],widthElements:[3.4375,2.125,4.875,3]},DATA_OBJECT_PATH:{d:"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0",height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},DATA_OBJECT_COLLECTION_PATH:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},DATA_ARROW:{d:"m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z",height:61,width:51,heightElements:[],widthElements:[]},DATA_STORE:{d:"m  {mx},{my} l  0,{e.y2} c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 l  0,-{e.y2} c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1} {e.x2},0m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0",height:61,width:61,heightElements:[7,10,45],widthElements:[2,58,60]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",height:30,width:10,heightElements:[30],widthElements:[10]},MARKER_SUB_PROCESS:{d:"m{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_PARALLEL:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},MARKER_SEQUENTIAL:{d:"m{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_COMPENSATION:{d:"m {mx},{my} 7,-5 0,10 z m 7.1,-0.3 6.9,-4.7 0,10 -6.9,-4.7 z",height:10,width:21,heightElements:[],widthElements:[]},MARKER_LOOP:{d:"m {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 -6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902",height:13.9,width:13.7,heightElements:[],widthElements:[]},MARKER_ADHOC:{d:"m {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 -3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 -2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z",height:4,width:15,heightElements:[],widthElements:[]},TASK_TYPE_SEND:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:14,width:21,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_SCRIPT:{d:"m {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z m -7,-12 l 5,0 m -4.5,3 l 4.5,0 m -3,3 l 5,0m -4,3 l 5,0",height:15,width:12.6,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_USER_1:{d:"m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 -4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 zm -8,6 l 0,5.5 m 11,0 l 0,-5"},TASK_TYPE_USER_2:{d:"m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 -2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 "},TASK_TYPE_USER_3:{d:"m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 -4.20799998,3.36699999 -4.20699998,4.34799999 z"},TASK_TYPE_MANUAL:{d:"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 -0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 -1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 -10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 -0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 -1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 -0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 -5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z"},TASK_TYPE_INSTANTIATING_SEND:{d:"m {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6"},TASK_TYPE_SERVICE:{d:"m {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 -1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 -0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 -1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 -0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z m 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_SERVICE_FILL:{d:"m {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_BUSINESS_RULE_HEADER:{d:"m {mx},{my} 0,4 20,0 0,-4 z"},TASK_TYPE_BUSINESS_RULE_MAIN:{d:"m {mx},{my} 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"},MESSAGE_FLOW_MARKER:{d:"m {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6"}},this.getRawPath=function(e){return this.pathMap[e].d},this.getScaledPath=function(e,t){var n,i,a=this.pathMap[e];t.abspos?(n=t.abspos.x,i=t.abspos.y):(n=t.containerWidth*t.position.mx,i=t.containerHeight*t.position.my);var r,o,s={};if(t.position){for(var c=t.containerHeight/a.height*t.yScaleFactor,p=t.containerWidth/a.width*t.xScaleFactor,l=0;l<a.heightElements.length;l++)s["y"+l]=a.heightElements[l]*c;for(var m=0;m<a.widthElements.length;m++)s["x"+m]=a.widthElements[m]*p}return r=a.d,o={mx:n,my:i,e:s},String(r).replace(it,function(e,t){return function(e,t,n){var i=n;return t.replace(at,function(e,t,n,a,r){t=t||a,i&&(t in i&&(i=i[t]),"function"==typeof i&&r&&(i=i()))}),i=(null==i||i==n?e:i)+""}(e,t,o)})}}]};var ot=n(31323),st=n(67319);function ct(e,t,n){return(0,l.assign)({id:e.id,type:e.$type,businessObject:e,di:t},n)}function pt(e,t,n){var i=e.waypoint;return!i||i.length<2?[(0,st.pp)(t),(0,st.pp)(n)]:i.map(function(e){return{x:e.x,y:e.y}})}function lt(e,t,n){return new Error(`element ${fe(t)} referenced by ${fe(e)}#${n} not yet drawn`)}function mt(e,t,n,i,a){this._eventBus=e,this._canvas=t,this._elementFactory=n,this._elementRegistry=i,this._textRenderer=a}mt.$inject=["eventBus","canvas","elementFactory","elementRegistry","textRenderer"],mt.prototype.add=function(e,t,n){var i,a,r,o,s,c,p;if((0,be.is)(t,"bpmndi:BPMNPlane")){var l=(0,be.is)(e,"bpmn:SubProcess")?{id:e.id+"_plane"}:{};i=this._elementFactory.createRoot(ct(e,t,l)),this._canvas.addRootElement(i)}else if((0,be.is)(t,"bpmndi:BPMNShape")){var m=!(0,Fe.Av)(e,t),u=function(e){return(0,be.is)(e,"bpmn:Group")}(e);a=n&&(n.hidden||n.collapsed);var d=t.bounds;i=this._elementFactory.createShape(ct(e,t,{collapsed:m,hidden:a,x:Math.round(d.x),y:Math.round(d.y),width:Math.round(d.width),height:Math.round(d.height),isFrame:u})),(0,be.is)(e,"bpmn:BoundaryEvent")&&this._attachBoundary(e,i),(0,be.is)(e,"bpmn:Lane")&&(r=0),(0,be.is)(e,"bpmn:DataStoreReference")&&(o=n,c=(s=(0,st.pp)(d)).x,p=s.y,c>=o.x&&c<=o.x+o.width&&p>=o.y&&p<=o.y+o.height||(n=this._canvas.findRoot(n))),this._canvas.addShape(i,n,r)}else{if(!(0,be.is)(t,"bpmndi:BPMNEdge"))throw new Error(`unknown di ${fe(t)} for element ${fe(e)}`);var h=this._getSource(e),f=this._getTarget(e);a=n&&(n.hidden||n.collapsed),i=this._elementFactory.createConnection(ct(e,t,{hidden:a,source:h,target:f,waypoints:pt(t,h,f)})),(0,be.is)(e,"bpmn:DataAssociation")&&(n=this._canvas.findRoot(n)),this._canvas.addConnection(i,n,r)}return(0,je.UC)(e)&&(0,je.p9)(i)&&this.addLabel(e,t,i),this._eventBus.fire("bpmnElement.added",{element:i}),i},mt.prototype._attachBoundary=function(e,t){var n=e.attachedToRef;if(!n)throw new Error(`missing ${fe(e)}#attachedToRef`);var i=this._elementRegistry.get(n.id),a=i&&i.attachers;if(!i)throw lt(e,n,"attachedToRef");t.host=i,a||(i.attachers=a=[]),-1===a.indexOf(t)&&a.push(t)},mt.prototype.addLabel=function(e,t,n){var i,a,r;return i=(0,je.Dg)(t,n),(a=(0,je.p9)(n))&&(i=this._textRenderer.getExternalLabelBounds(i,a)),r=this._elementFactory.createLabel(ct(e,t,{id:e.id+"_label",labelTarget:n,type:"label",hidden:n.hidden||!(0,je.p9)(n),x:Math.round(i.x),y:Math.round(i.y),width:Math.round(i.width),height:Math.round(i.height)})),this._canvas.addShape(r,n.parent)},mt.prototype._getConnectedElement=function(e,t){var n,i,a=e.$type;if(i=e[t+"Ref"],"source"===t&&"bpmn:DataInputAssociation"===a&&(i=i&&i[0]),("source"===t&&"bpmn:DataOutputAssociation"===a||"target"===t&&"bpmn:DataInputAssociation"===a)&&(i=e.$parent),n=i&&this._getElement(i))return n;throw i?lt(e,i,t+"Ref"):new Error(`${fe(e)}#${t} Ref not specified`)},mt.prototype._getSource=function(e){return this._getConnectedElement(e,"source")},mt.prototype._getTarget=function(e){return this._getConnectedElement(e,"target")},mt.prototype._getElement=function(e){return this._elementRegistry.get(e.id)};const ut={__depends__:[rt,{__depends__:[ot.A],bpmnImporter:["type",mt]}]};var dt=n(4912),ht=n(17987),ft=n(98142);function vt(e,t){t.invoke(ft.A,this),this.executed(function(t){var n=t.context;n.rootElement?e.setRootElement(n.rootElement):n.rootElement=e.getRootElement()}),this.revert(function(t){var n=t.context;n.rootElement&&e.setRootElement(n.rootElement)})}(0,i.A)(vt,ft.A),vt.$inject=["canvas","injector"];const gt={__init__:["rootElementsBehavior"],rootElementsBehavior:["type",vt]};var yt=n(75340),bt=n(71964);function Et(e,t,n){var i=d()('<ul class="bjs-breadcrumbs"></ul>'),a=n.getContainer(),r=(0,m.Ly)(a);a.appendChild(i);var o=[];function s(e){e&&(o=function(e){for(var t=[],n=(0,be.Cf)(e);n;n=n.$parent)((0,be.is)(n,"bpmn:SubProcess")||(0,be.is)(n,"bpmn:Process"))&&t.push(n);return t.reverse()}(e));var a=o.flatMap(function(e){var i=n.findRoot((0,bt.hJ)(e))||n.findRoot(e.id);if(!i&&(0,be.is)(e,"bpmn:Process")){var a=t.find(function(t){var n=(0,be.Cf)(t);return n&&n.get("processRef")===e});i=a&&n.findRoot(a.id)}if(!i)return[];var r=(0,yt.Z)(e.name||e.id),o=d()('<li><span class="bjs-crumb"><a title="'+r+'">'+r+"</a></span></li>");return o.addEventListener("click",function(){n.setRootElement(i)}),o});i.innerHTML="";var s=a.length>1;r.toggle("bjs-breadcrumbs-shown",s),a.forEach(function(e){i.appendChild(e)})}e.on("element.changed",function(e){var t=e.element,n=(0,be.Cf)(t);(0,l.find)(o,function(e){return e===n})&&s()}),e.on("root.set",function(e){s(e.element)})}function xt(e,t){var n=null,i=new wt;e.on("root.set",function(e){var a=e.element,r=t.viewbox(),o=i.get(a);if(i.set(n,{x:r.x,y:r.y,zoom:r.scale}),n=a,(0,be.is)(a,"bpmn:SubProcess")||o){o=o||{x:0,y:0,zoom:1};var s=(r.x-o.x)*r.scale,c=(r.y-o.y)*r.scale;0===s&&0===c||t.scroll({dx:s,dy:c}),o.zoom!==r.scale&&t.zoom(o.zoom,{x:0,y:0})}}),e.on("diagram.clear",function(){i.clear(),n=null})}function wt(){this._entries=[],this.set=function(e,t){var n=!1;for(var i in this._entries)if(this._entries[i][0]===e){this._entries[i][1]=t,n=!0;break}n||this._entries.push([e,t])},this.get=function(e){for(var t in this._entries)if(this._entries[t][0]===e)return this._entries[t][1];return null},this.clear=function(){this._entries.length=0},this.remove=function(e){var t=-1;for(var n in this._entries)if(this._entries[n][0]===e){t=n;break}-1!==t&&this._entries.splice(t,1)}}Et.$inject=["eventBus","elementRegistry","canvas"],xt.$inject=["eventBus","canvas"];function _t(e,t){this._eventBus=e,this._moddle=t;var n=this;e.on("import.render.start",1500,function(e,t){n._handleImport(t.definitions)})}function St(e){return(0,be.is)(e,"bpmndi:BPMNDiagram")?e:St(e.$parent)}_t.prototype._handleImport=function(e){if(e.diagrams){var t=this;this._definitions=e,this._processToDiagramMap={},e.diagrams.forEach(function(e){e.plane&&e.plane.bpmnElement&&(t._processToDiagramMap[e.plane.bpmnElement.id]=e)}),e.diagrams.filter(e=>e.plane).flatMap(e=>t._createNewDiagrams(e.plane)).forEach(function(e){t._movePlaneElementsToOrigin(e.plane)})}},_t.prototype._createNewDiagrams=function(e){var t=this,n=[],i=[];e.get("planeElement").forEach(function(t){var a=t.bpmnElement;if(a){var r=a.$parent;(0,be.is)(a,"bpmn:SubProcess")&&!t.isExpanded&&n.push(a),function(e,t){var n=e.$parent;return!(!(0,be.is)(n,"bpmn:SubProcess")||n===t.bpmnElement)&&!(0,be.f7)(e,["bpmn:DataInputAssociation","bpmn:DataOutputAssociation"])}(a,e)&&i.push({diElement:t,parent:r})}});var a=[];return n.forEach(function(e){if(!t._processToDiagramMap[e.id]){var n=t._createDiagram(e);t._processToDiagramMap[e.id]=n,a.push(n)}}),i.forEach(function(e){for(var i=e.diElement,a=e.parent;a&&-1===n.indexOf(a);)a=a.$parent;if(a){var r=t._processToDiagramMap[a.id];t._moveToDiPlane(i,r.plane)}}),a},_t.prototype._movePlaneElementsToOrigin=function(e){var t=e.get("planeElement"),n=function(e){var t={top:1/0,right:-1/0,bottom:-1/0,left:1/0};return e.planeElement.forEach(function(e){if(e.bounds){var n=(0,st.Fy)(e.bounds);t.top=Math.min(n.top,t.top),t.left=Math.min(n.left,t.left)}}),(0,st.cD)(t)}(e),i=n.x-180,a=n.y-160;t.forEach(function(e){e.waypoint?e.waypoint.forEach(function(e){e.x=e.x-i,e.y=e.y-a}):e.bounds&&(e.bounds.x=e.bounds.x-i,e.bounds.y=e.bounds.y-a)})},_t.prototype._moveToDiPlane=function(e,t){var n=St(e).plane.get("planeElement");n.splice(n.indexOf(e),1),t.get("planeElement").push(e)},_t.prototype._createDiagram=function(e){var t=this._moddle.create("bpmndi:BPMNPlane",{bpmnElement:e}),n=this._moddle.create("bpmndi:BPMNDiagram",{plane:t});return t.$parent=n,t.bpmnElement=e,n.$parent=this._definitions,this._definitions.diagrams.push(n),n},_t.$inject=["eventBus","moddle"];var At=250;function Ct(e,t,n,i,a){ft.A.call(this,t),this._canvas=e,this._eventBus=t,this._elementRegistry=n,this._overlays=i,this._translate=a;var r=this;this.executed("shape.toggleCollapse",At,function(e){var t=e.shape;r._canDrillDown(t)?r._addOverlay(t):r._removeOverlay(t)},!0),this.reverted("shape.toggleCollapse",At,function(e){var t=e.shape;r._canDrillDown(t)?r._addOverlay(t):r._removeOverlay(t)},!0),this.executed(["shape.create","shape.move","shape.delete"],At,function(e){var t=e.oldParent,n=e.newParent||e.parent,i=e.shape;r._canDrillDown(i)&&r._addOverlay(i),r._updateDrilldownOverlay(t),r._updateDrilldownOverlay(n),r._updateDrilldownOverlay(i)},!0),this.reverted(["shape.create","shape.move","shape.delete"],At,function(e){var t=e.oldParent,n=e.newParent||e.parent,i=e.shape;r._canDrillDown(i)&&r._addOverlay(i),r._updateDrilldownOverlay(t),r._updateDrilldownOverlay(n),r._updateDrilldownOverlay(i)},!0),t.on("import.render.complete",function(){n.filter(function(e){return r._canDrillDown(e)}).map(function(e){r._addOverlay(e)})})}(0,i.A)(Ct,ft.A),Ct.prototype._updateDrilldownOverlay=function(e){var t=this._canvas;if(e){var n=t.findRoot(e);n&&this._updateOverlayVisibility(n)}},Ct.prototype._canDrillDown=function(e){var t=this._canvas;return(0,be.is)(e,"bpmn:SubProcess")&&t.findRoot((0,bt.hJ)(e))},Ct.prototype._updateOverlayVisibility=function(e){var t=this._overlays,n=(0,be.Cf)(e),i=t.get({element:n.id,type:"drilldown"})[0];if(i){var a=n&&n.get("flowElements")&&n.get("flowElements").length;(0,m.Ly)(i.html).toggle("bjs-drilldown-empty",!a)}},Ct.prototype._addOverlay=function(e){var t=this._canvas,n=this._overlays,i=(0,be.Cf)(e);n.get({element:e,type:"drilldown"}).length&&this._removeOverlay(e);var a=d()('<button type="button" class="bjs-drilldown"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.81801948,3.50735931 L10.4996894,9.1896894 L10.5,4 L12,4 L12,12 L4,12 L4,10.5 L9.6896894,10.4996894 L3.75735931,4.56801948 C3.46446609,4.27512627 3.46446609,3.80025253 3.75735931,3.50735931 C4.05025253,3.21446609 4.52512627,3.21446609 4.81801948,3.50735931 Z"/></svg></button>'),r=i.get("name")||i.get("id"),o=this._translate("Open {element}",{element:r});a.setAttribute("title",o),a.addEventListener("click",function(){t.setRootElement(t.findRoot((0,bt.hJ)(e)))}),n.add(e,"drilldown",{position:{bottom:-7,right:-8},html:a}),this._updateOverlayVisibility(e)},Ct.prototype._removeOverlay=function(e){this._overlays.remove({element:e,type:"drilldown"})},Ct.$inject=["canvas","eventBus","elementRegistry","overlays","translate"];const Nt={__depends__:[dt.A,ht.A,gt],__init__:["drilldownBreadcrumbs","drilldownOverlayBehavior","drilldownCentering","subprocessCompatibility"],drilldownBreadcrumbs:["type",Et],drilldownCentering:["type",xt],drilldownOverlayBehavior:["type",Ct],subprocessCompatibility:["type",_t]};var Tt=n(86104);function Dt(e){ke.call(this,e)}(0,i.A)(Dt,ke),Dt.prototype._modules=[ut,Nt,dt.A,Tt.A,ot.A],Dt.prototype._moddleExtensions={};var kt=n(56373),Pt=n(84361),Rt=n(3834);function Bt(e){Dt.call(this,e)}(0,i.A)(Bt,Dt),Bt.prototype._navigationModules=[kt.A,Pt.A,Rt.A],Bt.prototype._modules=[].concat(Dt.prototype._modules,Bt.prototype._navigationModules);var Mt=n(30566),It=n(80598),Ft=n(96412);const jt={align:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2000 2000">\n              <line x1="200" y1="150" x2="200" y2="1850" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>\n              <rect x="500" y="150" width="1300" height="700" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n              <rect x="500" y="1150" width="700" height="700" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n          </svg>',bottom:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">\n            <line x1="150" y1="1650" x2="1650" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>\n            <rect x="150" y="350" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n            <rect x="1050" y="850" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n          </svg>',center:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">\n            <line x1="900" y1="150" x2="900" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>\n            <rect x="250" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n            <rect x="500" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n          </svg>',left:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">\n            <line x1="100" y1="150" x2="100" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>\n            <rect x="100" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n            <rect x="100" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n          </svg>',right:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">\n            <line x1="1650" y1="150" x2="1650" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>\n            <rect x="350" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n            <rect x="850" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n          </svg>',top:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">\n            <line x1="150" y1="150" x2="1650" y2="150" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>\n            <rect x="150" y="150" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n            <rect x="1050" y="150" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n          </svg>',middle:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">\n            <line x1="150" y1="900" x2="1650" y2="900" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>\n            <rect x="150" y="250" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n            <rect x="1050" y="500" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n          </svg>'};function Ot(e,t,n,i){e.registerProvider(900,this),this._contextPad=e,this._popupMenu=t,this._translate=n,this._canvas=i}Ot.$inject=["contextPad","popupMenu","translate","canvas"],Ot.prototype.getMultiElementContextPadEntries=function(e){var t={};return this._isAllowed(e)&&(0,l.assign)(t,this._getEntries(e)),t},Ot.prototype._isAllowed=function(e){return!this._popupMenu.isEmpty(e,"align-elements")},Ot.prototype._getEntries=function(){var e=this;return{"align-elements":{group:"align-elements",title:e._translate("Align elements"),html:`<div class="entry">${jt.align}</div>`,action:{click:function(t,n){var i=e._getMenuPosition(n);(0,l.assign)(i,{cursor:{x:t.x,y:t.y}}),e._popupMenu.open(n,"align-elements",i)}}}}},Ot.prototype._getMenuPosition=function(e){var t=this._contextPad.getPad(e).html.getBoundingClientRect();return{x:t.left,y:t.bottom+5}};var Lt=["left","center","right","top","middle","bottom"];function $t(e,t,n,i){this._alignElements=t,this._translate=n,this._popupMenu=e,this._rules=i,e.registerProvider("align-elements",this)}$t.$inject=["popupMenu","alignElements","translate","rules"],$t.prototype.getPopupMenuEntries=function(e){var t={};return this._isAllowed(e)&&(0,l.assign)(t,this._getEntries(e)),t},$t.prototype._isAllowed=function(e){return this._rules.allowed("elements.align",{elements:e})},$t.prototype._getEntries=function(e){var t=this._alignElements,n=this._translate,i=this._popupMenu,a={};return(0,l.forEach)(Lt,function(r){a["align-elements-"+r]={group:"align",title:n("Align elements "+r),className:"bjs-align-elements-menu-entry",imageHtml:jt[r],action:function(){t.trigger(e,r),i.close()}}}),a};var zt=n(24049),Vt=n(91970);function Gt(e){zt.A.call(this,e)}Gt.$inject=["eventBus"],(0,i.A)(Gt,zt.A),Gt.prototype.init=function(){this.addRule("elements.align",function(e){var t=e.elements,n=(0,l.filter)(t,function(e){return!(e.waypoints||e.host||e.labelTarget)});return!((n=(0,Vt.wT)(n)).length<2)&&n})};const Ht={__depends__:[Mt.A,It.A,Ft.A],__init__:["alignElementsContextPadProvider","alignElementsMenuProvider","bpmnAlignElements"],alignElementsContextPadProvider:["type",Ot],alignElementsMenuProvider:["type",$t],bpmnAlignElements:["type",Gt]};var Wt=n(89768);function Ut(e,t){for((0,l.isString)(t)&&(t=[t]);e=e.parent;)if((0,be.f7)(e,t))return e;return null}function Kt(e,t){var n=Ut(e,"bpmn:Process");if(n)return!0;var i,a=["bpmn:Participant","bpmn:Lane"];if(n=Ut(e,a))return(0,Fe.$b)(n);if((0,be.f7)(e,a))return(0,Fe.$b)(e);for(i=(0,be.Cf)(e);i&&!(0,be.is)(i,"bpmn:Process");i=i.$parent);if(!t)return!0;var r=t.find(function(e){var t=(0,be.Cf)(e);return t&&t.get("processRef")===i});return!r||(0,Fe.$b)(r)}var qt=n(27714);function Jt(e,t,n){var i=Kt(e,n);return(0,be.is)(t,"bpmn:TextAnnotation")?function(e,t,n){var i=(0,st.Fy)(e),a=n?{x:i.right+t.width/2,y:i.top-50-t.height/2}:{x:i.right+50+t.width/2,y:i.bottom+t.height/2};(0,Oe.fX)(e)&&(a=(0,st.pp)(e),n?(a.x+=100,a.y-=50):(a.x+=100,a.y+=50));var r={margin:n?-30:30,minDistance:20},o=n?{y:r}:{x:r};return(0,qt.D6)(e,t,a,(0,qt.u6)(o))}(e,t,i):(0,be.f7)(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])?function(e,t,n){var i=(0,st.Fy)(e),a=n?{x:i.right-10+t.width/2,y:i.bottom+40+t.width/2}:{x:i.left-40-t.width/2,y:i.bottom-10+t.height/2},r={margin:30,minDistance:30},o=n?{x:r}:{y:r};return(0,qt.D6)(e,t,a,(0,qt.u6)(o))}(e,t,i):(0,be.is)(t,"bpmn:FlowNode")?function(e,t,n){var i=(0,st.Fy)(e),a=(0,st.pp)(e),r=n?{directionHint:"e",minDistance:80,baseOrientation:"left",boundaryOrientation:"top",start:"top",end:"bottom"}:{directionHint:"s",minDistance:90,baseOrientation:"top",boundaryOrientation:"left",start:"left",end:"right"},o=(0,qt.dq)(e,{filter:function(e){return(0,be.is)(e,"bpmn:SequenceFlow")},direction:r.directionHint}),s=30,c=r.minDistance,p=r.baseOrientation;(0,be.is)(e,"bpmn:BoundaryEvent")&&-1!==(p=(0,st.vc)(e,e.host,-25)).indexOf(r.boundaryOrientation)&&(s*=-1);var l=n?{x:i.right+o+t.width/2,y:a.y+Xt(p,c,r)}:{x:a.x+Xt(p,c,r),y:i.bottom+o+t.height/2},m={margin:s,minDistance:c},u=n?{y:m}:{x:m};return(0,qt.D6)(e,t,l,(0,qt.u6)(u))}(e,t,i):void 0}function Xt(e,t,n){return e.includes(n.start)?-1*t:e.includes(n.end)?t:0}function Yt(e,t){e.on("autoPlace",function(e){var n=e.shape;return Jt(e.source,n,t)})}Yt.$inject=["eventBus","elementRegistry"];const Qt={__depends__:[Wt.A],__init__:["bpmnAutoPlace"],bpmnAutoPlace:["type",Yt]};function Zt(e,t,n,i){ft.A.call(this,e),this._elementRegistry=t,this._modeling=n,this._rules=i;var a=this;this.postExecuted(["shape.create"],function(e){var t=e.context,n=t.hints||{},i=t.shape,r=t.parent||t.newParent;!1!==n.autoResize&&a._expand([i],r)}),this.postExecuted(["elements.move"],function(e){var t=e.context,n=(0,l.flatten)((0,l.values)(t.closure.topLevel)),i=t.hints,r=!i||i.autoResize;if(!1!==r){var o=(0,l.groupBy)(n,function(e){return e.parent.id});(0,l.forEach)(o,function(e,t){(0,l.isArray)(r)&&(e=e.filter(function(e){return(0,l.find)(r,(0,l.matchPattern)({id:e.id}))})),a._expand(e,t)})}}),this.postExecuted(["shape.toggleCollapse"],function(e){var t=e.context,n=t.hints,i=t.shape;n&&!1===n.autoResize||i.collapsed||a._expand(i.children||[],i)}),this.postExecuted(["shape.resize"],function(e){var t=e.context,n=t.hints,i=t.shape,r=i.parent;n&&!1===n.autoResize||r&&a._expand([i],r)})}function en(e){e.invoke(Zt,this)}function tn(e){zt.A.call(this,e);var t=this;this.addRule("element.autoResize",function(e){return t.canResize(e.elements,e.target)})}function nn(e,t){tn.call(this,e),this._modeling=t}Zt.$inject=["eventBus","elementRegistry","modeling","rules"],(0,i.A)(Zt,ft.A),Zt.prototype._getOptimalBounds=function(e,t){var n=this.getOffset(t),i=this.getPadding(t),a=(0,st.Fy)((0,Vt.U7)(e)),r=(0,st.Fy)(t),o={};return a.top-r.top<i.top&&(o.top=a.top-n.top),a.left-r.left<i.left&&(o.left=a.left-n.left),r.right-a.right<i.right&&(o.right=a.right+n.right),r.bottom-a.bottom<i.bottom&&(o.bottom=a.bottom+n.bottom),(0,st.cD)((0,l.assign)({},r,o))},Zt.prototype._expand=function(e,t){if("string"==typeof t&&(t=this._elementRegistry.get(t)),this._rules.allowed("element.autoResize",{elements:e,target:t})){var n=this._getOptimalBounds(e,t);if(function(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}(n,t)){var i=function(e,t){var n="";return e=(0,st.Fy)(e),t=(0,st.Fy)(t),e.top>t.top&&(n=n.concat("n")),e.right<t.right&&(n=n.concat("w")),e.bottom<t.bottom&&(n=n.concat("s")),e.left>t.left&&(n=n.concat("e")),n}((0,l.pick)(t,["x","y","width","height"]),n);this.resize(t,n,{autoResize:i});var a=t.parent;a&&this._expand([t],a)}}},Zt.prototype.getOffset=function(e){return{top:60,bottom:60,left:100,right:100}},Zt.prototype.getPadding=function(e){return{top:2,bottom:2,left:15,right:15}},Zt.prototype.resize=function(e,t,n){this._modeling.resizeShape(e,t,null,n)},en.$inject=["injector"],(0,i.A)(en,Zt),en.prototype.resize=function(e,t,n){(0,be.is)(e,"bpmn:Participant")?this._modeling.resizeLane(e,t,null,n):this._modeling.resizeShape(e,t,null,n)},tn.$inject=["eventBus"],(0,i.A)(tn,zt.A),tn.prototype.canResize=function(e,t){return!1},(0,i.A)(nn,tn),nn.$inject=["eventBus","modeling"],nn.prototype.canResize=function(e,t){if((0,be.is)(t.di,"bpmndi:BPMNPlane"))return!1;if(!(0,be.is)(t,"bpmn:Participant")&&!(0,be.is)(t,"bpmn:Lane")&&!(0,be.is)(t,"bpmn:SubProcess"))return!1;var n=!0;return(0,l.forEach)(e,function(e){((0,be.is)(e,"bpmn:Lane")||(0,Oe.J2)(e))&&(n=!1)}),n};const an={__init__:["bpmnAutoResize","bpmnAutoResizeProvider"],bpmnAutoResize:["type",en],bpmnAutoResizeProvider:["type",nn]};var rn=n(15167),on=n(86816),sn=n(25359),cn=n(48461),pn=n(30601),ln=n(37706);const mn="complex-preview";class un{constructor(e,t,n){this._canvas=e,this._graphicsFactory=t,this._previewSupport=n,this._markers=[]}create(e){this.cleanUp();const{created:t=[],moved:n=[],removed:i=[],resized:a=[]}=e,r=this._canvas.getLayer(mn);t.filter(e=>!function(e){return e.hidden}(e)).forEach(e=>{let t;(0,Oe.fX)(e)?(t=this._graphicsFactory._createContainer("connection",(0,h.vt)("g")),this._graphicsFactory.drawConnection((0,ln.P)(t),e)):(t=this._graphicsFactory._createContainer("shape",(0,h.vt)("g")),this._graphicsFactory.drawShape((0,ln.P)(t),e),(0,Xe.Tl)(t,e.x,e.y)),this._previewSupport.addDragger(e,r,t)}),n.forEach(({element:e,delta:t})=>{this._previewSupport.addDragger(e,r,void 0,"djs-dragging"),this._canvas.addMarker(e,"djs-element-hidden"),this._markers.push([e,"djs-element-hidden"]);const n=this._previewSupport.addDragger(e,r);(0,Oe.fX)(e)?(0,Xe.Tl)(n,t.x,t.y):(0,Xe.Tl)(n,e.x+t.x,e.y+t.y)}),i.forEach(e=>{this._previewSupport.addDragger(e,r,void 0,"djs-dragging"),this._canvas.addMarker(e,"djs-element-hidden"),this._markers.push([e,"djs-element-hidden"])}),a.forEach(({shape:e,bounds:t})=>{this._canvas.addMarker(e,"djs-hidden"),this._markers.push([e,"djs-hidden"]),this._previewSupport.addDragger(e,r,void 0,"djs-dragging");const n=this._graphicsFactory._createContainer("shape",(0,h.vt)("g"));this._graphicsFactory.drawShape((0,ln.P)(n),e,{width:t.width,height:t.height}),(0,Xe.Tl)(n,t.x,t.y),this._previewSupport.addDragger(e,r,n)})}cleanUp(){(0,h.IU)(this._canvas.getLayer(mn)),this._markers.forEach(([e,t])=>this._canvas.removeMarker(e,t)),this._markers=[]}show(){this._canvas.showLayer(mn)}hide(){this._canvas.hideLayer(mn)}}un.$inject=["canvas","graphicsFactory","previewSupport"];const dn={__depends__:[pn.A],__init__:["complexPreview"],complexPreview:["type",un]};var hn=n(79356),fn=["top","bottom","left","right"];function vn(e,t){function n(e){if((0,je.ur)(e)&&!(0,Oe.fX)(e)){var n=function(e){var t=(0,st.pp)(e.label),n=gn((0,st.pp)(e),t);if(i=n,-1!==fn.indexOf(i)){var i,a=function(e){var t=(0,st.pp)(e);return[].concat(e.incoming.map(function(e){return e.waypoints[e.waypoints.length-2]}),e.outgoing.map(function(e){return e.waypoints[1]})).map(function(e){return gn(t,e)})}(e);if(e.host){var r=function(e){var t,n=e.host,i=(0,st.pp)(e),a=(0,st.vc)(i,n);return t=a.indexOf("-")>=0?a.split("-"):[a],fn.filter(function(e){return-1===t.indexOf(e)})}(e);a=a.concat(r)}var o=fn.filter(function(e){return-1===a.indexOf(e)});if(-1===o.indexOf(n))return o[0]}}(e);n&&function(e,n){var i=(0,st.pp)(e),a=e.label,r=(0,st.pp)(a);if(a.parent){var o,s=(0,st.Fy)(e);switch(n){case"top":o={x:i.x,y:s.top-10-a.height/2};break;case"left":o={x:s.left-10-a.width/2,y:i.y};break;case"bottom":o={x:i.x,y:s.bottom+10+a.height/2};break;case"right":o={x:s.right+10+a.width/2,y:i.y}}var c=(0,hn.p)(o,r);t.moveShape(a,c)}}(e,n)}}ft.A.call(this,e),this.postExecuted(["connection.create","connection.layout","connection.updateWaypoints"],function(e){var t=e.context,i=t.connection,a=i.source,r=i.target;!1!==(t.hints||{}).createElementsBehavior&&(n(a),n(r))}),this.postExecuted(["label.create"],function(e){var t=e.context,i=t.shape;!1!==(t.hints||{}).createElementsBehavior&&n(i.labelTarget)}),this.postExecuted(["elements.create"],function(e){var t=e.context,i=t.elements;!1!==(t.hints||{}).createElementsBehavior&&i.forEach(function(e){n(e)})})}function gn(e,t){return(0,st.vc)(t,e,5)}function yn(e){ft.A.call(this,e),this.preExecute("shape.append",function(e){var t=e.source,n=e.shape;e.position||((0,be.is)(n,"bpmn:TextAnnotation")?e.position={x:t.x+t.width/2+75,y:t.y-50-n.height/2}:e.position={x:t.x+t.width+80+n.width/2,y:t.y+t.height/2})},!0)}function bn(e,t){e.invoke(ft.A,this),this.postExecute("shape.move",function(e){var n=e.newParent,i=e.shape,a=(0,l.filter)(i.incoming.concat(i.outgoing),function(e){return(0,be.is)(e,"bpmn:Association")});(0,l.forEach)(a,function(e){t.moveConnection(e,{x:0,y:0},n)})},!0)}function En(e,t){t.invoke(ft.A,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",500,function(e){var t=e.elements;1===(t=t.filter(function(e){return xn(e,e.host)})).length&&t.map(function(e){return t.indexOf(e)}).forEach(function(i){var a=t[i];e.elements[i]=n._replaceShape(t[i],a)})},!0),this.preExecute("elements.move",500,function(e){var t=e.shapes,i=e.newHost;if(1===t.length){var a=t[0];xn(a,i)&&(e.shapes=[n._replaceShape(a,i)])}},!0)}function xn(e,t){return!(0,Oe.J2)(e)&&(0,be.f7)(e,["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&!!t}function wn(e,t){function n(e){return(0,l.filter)(e.attachers,function(e){return(0,be.is)(e,"bpmn:BoundaryEvent")})}ft.A.call(this,e),this.postExecute("connection.create",function(e){var i=e.context.source,a=e.context.target,r=n(a);(0,be.is)(i,"bpmn:EventBasedGateway")&&(0,be.is)(a,"bpmn:ReceiveTask")&&r.length>0&&t.removeElements(r)}),this.postExecute("connection.reconnect",function(e){var i=e.context.oldSource,a=e.context.newSource;(0,be.is)(i,"bpmn:Gateway")&&(0,be.is)(a,"bpmn:EventBasedGateway")&&(0,l.forEach)(a.outgoing,function(e){var i=e.target,a=n(i);(0,be.is)(i,"bpmn:ReceiveTask")&&a.length>0&&t.removeElements(a)})})}function _n(e,t,n){function i(e){t.updateProperties(e,{isForCompensation:!0})}function a(e){t.updateProperties(e,{isForCompensation:void 0})}ft.A.call(this,e),this.preExecute("shape.replace",function(e){const{newData:n,oldShape:i}=e;if(An(e.oldShape)&&"bpmn:CompensateEventDefinition"!==n.eventDefinitionType||"bpmn:BoundaryEvent"!==n.type){const t=i.outgoing.find(({target:e})=>Sn(e));t&&t.target&&(e._connectionTarget=t.target)}else if(!An(e.oldShape)&&"bpmn:CompensateEventDefinition"===n.eventDefinitionType&&"bpmn:BoundaryEvent"===n.type){const n=i.outgoing.find(({target:e})=>Cn(e));n&&n.target&&(e._connectionTarget=n.target),function(e){const n=e.outgoing.filter(e=>(0,be.is)(e,"bpmn:SequenceFlow"));t.removeElements(n)}(i)}},!0),this.postExecuted("shape.replace",function(e){const{_connectionTarget:n,newShape:i}=e;n&&t.connect(i,n)},!0),this.preExecute("connection.create",function(e){const n=e.connection,a=e.source,r=e.target;An(a)&&Cn(r)&&(i(r),function(e,n){const i=e.outgoing.filter(e=>(0,be.is)(e,"bpmn:Association"));i.filter(e=>Sn(e.target)&&!n.includes(e)).forEach(e=>t.removeConnection(e))}(a,[n]))},!0),this.postExecuted("connection.delete",function(e){const t=e.source,n=e.target;An(t)&&Sn(n)&&a(n)},!0),this.postExecuted("connection.reconnect",function(e){const t=e.newTarget,n=e.oldSource,r=e.oldTarget;if(r!==t){const e=n;Sn(r)&&a(r),An(e)&&Cn(t)&&i(t)}},!0),this.postExecuted("element.updateProperties",function(e){const{element:i}=e;Sn(i)?(function(e){for(const i of e.incoming)n.canConnect(i.source,e)||t.removeConnection(i);for(const i of e.outgoing)n.canConnect(e,i.target)||t.removeConnection(i)}(i),function(e){const n=e.attachers.slice();n.length&&t.removeElements(n)}(i)):Cn(i)&&function(e){const n=e.incoming.filter(e=>An(e.source));t.removeElements(n)}(i)},!0)}function Sn(e){const t=(0,be.Cf)(e);return t&&t.get("isForCompensation")}function An(e){return e&&(0,be.is)(e,"bpmn:BoundaryEvent")&&(0,Fe.Ip)(e,"bpmn:CompensateEventDefinition")}function Cn(e){return e&&(0,be.is)(e,"bpmn:Activity")&&!(0,Fe.Q1)(e)}function Nn(e){e.invoke(ft.A,this),this.preExecute("shape.create",1500,function(e){var t=e.context,n=t.parent,i=t.shape;(0,be.is)(n,"bpmn:Lane")&&!(0,be.is)(i,"bpmn:Lane")&&(t.parent=Ut(n,"bpmn:Participant"))})}function Tn(e,t){ft.A.call(this,e),this.preExecute("shape.create",function(e){var n=e.context.shape;if((0,be.is)(n,"bpmn:DataObjectReference")&&"label"!==n.type){var i=t.create("bpmn:DataObject");i.isCollection=n.businessObject.dataObjectRef?.isCollection||!1,n.businessObject.dataObjectRef=i}})}(0,i.A)(vn,ft.A),vn.$inject=["eventBus","modeling"],(0,i.A)(yn,ft.A),yn.$inject=["eventBus"],(0,i.A)(bn,ft.A),bn.$inject=["injector","modeling"],En.$inject=["bpmnReplace","injector"],(0,i.A)(En,ft.A),En.prototype._replaceShape=function(e,t){var n,i,a=(n=e,(i=(0,be.Cf)(n).eventDefinitions)&&i[0]),r={type:"bpmn:BoundaryEvent",host:t};return a&&(r.eventDefinitionType=a.$type),this._bpmnReplace.replaceElement(e,r,{layoutConnection:!1})},wn.$inject=["eventBus","modeling"],(0,i.A)(wn,ft.A),(0,i.A)(_n,ft.A),_n.$inject=["eventBus","modeling","bpmnRules"],Nn.$inject=["injector"],(0,i.A)(Nn,ft.A),Tn.$inject=["eventBus","bpmnFactory"],(0,i.A)(Tn,ft.A);var Dn=2e3;function kn(e,t,n){function i(){var t=e.getRootElement();return(0,be.is)(t,"bpmn:Collaboration")?t:n.makeCollaboration()}ft.A.call(this,t),t.on(["create.start","shape.move.start"],Dn,function(t){var n=t.context,i=n.shape,a=e.getRootElement();if((0,be.is)(i,"bpmn:Participant")&&(0,be.is)(a,"bpmn:Process")&&a.children.length){var r=a.children.filter(function(e){return!(0,be.is)(e,"bpmn:Group")&&!(0,Oe.J2)(e)&&!(0,Oe.fX)(e)});if(r.length){var o=(0,Vt.U7)(r),s=function(e,t){t={width:t.width+40+30,height:t.height+40};var n=Math.max(e.width,t.width),i=Math.max(e.height,t.height);return{x:-n/2,y:-i/2,width:n,height:i}}(i,o);(0,l.assign)(i,s),n.createConstraints=function(e,t){return{bottom:(t=(0,st.Fy)(t)).top+e.height/2-20,left:t.right-e.width/2+20,top:t.bottom-e.height/2+20,right:t.left+e.width/2-20-30}}(i,o)}}}),t.on("create.start",Dn,function(n){var i=n.context.shape,a=e.getRootElement(),r=e.getGraphics(a);function o(e){e.element=a,e.gfx=r}(0,be.is)(i,"bpmn:Participant")&&(0,be.is)(a,"bpmn:Process")&&(t.on("element.hover",Dn,o),t.once("create.cleanup",function(){t.off("element.hover",o)}))}),this.preExecute("elements.create",Dn,function(e){var t,n=e.elements,a=e.parent,r=function(e){return(0,l.find)(e,function(e){return(0,be.is)(e,"bpmn:Participant")})}(n);r&&(0,be.is)(a,"bpmn:Process")&&(e.parent=i(),(t=e.hints=e.hints||{}).participant=r,t.process=a,t.processRef=(0,be.Cf)(r).get("processRef"))},!0),this.preExecute("shape.create",function(e){var t=e.parent,n=e.shape;(0,be.is)(n,"bpmn:Participant")&&(0,be.is)(t,"bpmn:Process")&&(e.parent=i(),e.process=t,e.processRef=(0,be.Cf)(n).get("processRef"))},!0),this.execute("shape.create",function(e){var t=e.hints||{},n=e.process||t.process,i=e.shape,a=t.participant;!n||a&&i!==a||(0,be.Cf)(i).set("processRef",(0,be.Cf)(n))},!0),this.revert("shape.create",function(e){var t=e.hints||{},n=e.process||t.process,i=e.processRef||t.processRef,a=e.shape,r=t.participant;!n||r&&a!==r||(0,be.Cf)(a).set("processRef",i)},!0),this.postExecute("shape.create",function(e){var t=e.hints||{},i=e.process||e.hints.process,a=e.shape,r=t.participant;if(i){var o=i.children.slice();r?a===r&&n.moveElements(o,{x:0,y:0},r):n.moveElements(o,{x:0,y:0},a)}},!0)}kn.$inject=["canvas","eventBus","modeling"],(0,i.A)(kn,ft.A);var Pn=n(93742),Rn="__targetRef_placeholder";function Bn(e,t){function n(e,n){var i=e.get("properties"),a=(0,l.find)(i,function(e){return e.name===Rn});return!a&&n&&(a=t.create("bpmn:Property",{name:Rn}),(0,Pn.WQ)(i,a)),a}function i(e,t){var i=n(e);i&&(function(e,t,n){var i=e.get("dataInputAssociations");return(0,l.find)(i,function(e){return e!==n&&e.targetRef===t})}(e,i,t)||(0,Pn.TF)(e.get("properties"),i))}function a(e){var t,a=e.context,r=a.connection,o=r.businessObject,s=r.target,c=s&&s.businessObject,p=a.newTarget,l=p&&p.businessObject,m=a.oldTarget||a.target,u=m&&m.businessObject,d=r.businessObject;u&&u!==c&&i(u,o),l&&l!==c&&i(l,o),c?(t=n(c,!0),d.targetRef=t):d.targetRef=null}ft.A.call(this,e),this.executed(["connection.create","connection.delete","connection.move","connection.reconnect"],Mn(a)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnect"],Mn(a))}function Mn(e){return function(t){var n=t.context.connection;if((0,be.is)(n,"bpmn:DataInputAssociation"))return e(t)}}function In(e){this._bpmnUpdater=e}function Fn(e,t,n,i){function a(e){return e.children.filter(function(e){return(0,be.is)(e,"bpmn:DataStoreReference")&&!e.labelTarget})}function r(e,i){var a=e.businessObject||e;if(i=i||n.filter(function(e){return(0,be.is)(e,"bpmn:Participant")&&(0,be.Cf)(e).processRef})[0]){var r=i.businessObject||i;t.execute("dataStore.updateContainment",{dataStoreBo:a,dataStoreDi:(0,be.S2)(e),newSemanticParent:r.processRef||r,newDiParent:(0,be.S2)(i)})}}ft.A.call(this,i),t.registerHandler("dataStore.updateContainment",In),this.preExecute("shape.create",function(e){var t=e.context,n=t.shape;(0,be.is)(n,"bpmn:DataStoreReference")&&"label"!==n.type&&(t.hints||(t.hints={}),t.hints.autoResize=!1)}),this.preExecute("elements.move",function(e){var t=e.context,n=t.shapes;n.filter(function(e){return(0,be.is)(e,"bpmn:DataStoreReference")}).length&&(t.hints||(t.hints={}),t.hints.autoResize=n.filter(function(e){return!(0,be.is)(e,"bpmn:DataStoreReference")}))}),this.postExecute("shape.create",function(e){var t=e.context.shape,n=t.parent;(0,be.is)(t,"bpmn:DataStoreReference")&&"label"!==t.type&&(0,be.is)(n,"bpmn:Collaboration")&&r(t)}),this.postExecute("shape.move",function(e){var t=e.context,n=t.shape,i=t.oldParent,a=n.parent;(0,be.is)(i,"bpmn:Collaboration")||(0,be.is)(n,"bpmn:DataStoreReference")&&"label"!==n.type&&(0,be.is)(a,"bpmn:Collaboration")&&r(n,(0,be.is)(i,"bpmn:Participant")?i:function(e){for(;e.parent;){if((0,be.is)(e.parent,"bpmn:Participant"))return e.parent;e=e.parent}}(i))}),this.postExecute("shape.delete",function(t){var n=t.context.shape,i=e.getRootElement();(0,be.f7)(n,["bpmn:Participant","bpmn:SubProcess"])&&(0,be.is)(i,"bpmn:Collaboration")&&a(i).filter(function(e){return function(e,t){for(var n=e.businessObject||e,i=t.businessObject||t;n.$parent;){if(n.$parent===i.processRef||i)return!0;n=n.$parent}return!1}(e,n)}).forEach(function(e){r(e)})}),this.postExecute("canvas.updateRoot",function(e){var t=e.context,n=t.oldRoot,i=t.newRoot;a(n).forEach(function(e){(0,be.is)(i,"bpmn:Process")&&r(e,i)})})}Bn.$inject=["eventBus","bpmnFactory"],(0,i.A)(Bn,ft.A),In.$inject=["bpmnUpdater"],In.prototype.execute=function(e){var t=e.dataStoreBo,n=e.dataStoreDi,i=e.newSemanticParent,a=e.newDiParent;return e.oldSemanticParent=t.$parent,e.oldDiParent=n.$parent,this._bpmnUpdater.updateSemanticParent(t,i),this._bpmnUpdater.updateDiParent(n,a),[]},In.prototype.revert=function(e){var t=e.dataStoreBo,n=e.dataStoreDi,i=e.oldSemanticParent,a=e.oldDiParent;return this._bpmnUpdater.updateSemanticParent(t,i),this._bpmnUpdater.updateDiParent(n,a),[]},Fn.$inject=["canvas","commandStack","elementRegistry","eventBus"],(0,i.A)(Fn,ft.A);var jn=n(60593),On=Math.abs,Ln=["bpmn:Participant","bpmn:Process","bpmn:SubProcess"],$n=30;function zn(e,t){return t=t||[],e.children.filter(function(e){(0,be.is)(e,"bpmn:Lane")&&(zn(e,t),t.push(e))}),t}function Vn(e){return e.children.filter(function(e){return(0,be.is)(e,"bpmn:Lane")})}function Gn(e){return Ut(e,Ln)||e}function Hn(e,t){ft.A.call(this,e),this.postExecuted("shape.delete",500,function(e){var n=e.context,i=n.hints,a=n.shape,r=n.oldParent;(0,be.is)(a,"bpmn:Lane")&&(i&&i.nested||function(e,n){var i,a,r,o,s,c=(0,Fe.$b)(e),p=Vn(n),l=[],m=[],u=[],d=[];(0,Vt.qO)(p,function(t){return c?t.y>e.y?m.push(t):l.push(t):t.x>e.x?d.push(t):u.push(t),t.children}),p.length&&(i=c?m.length&&l.length?e.height/2:e.height:d.length&&u.length?e.width/2:e.width,l.length&&(a=t.calculateAdjustments(l,"y",i,e.y-10),t.makeSpace(a.movingShapes,a.resizingShapes,{x:0,y:i},"s")),m.length&&(r=t.calculateAdjustments(m,"y",-i,e.y+e.height+10),t.makeSpace(r.movingShapes,r.resizingShapes,{x:0,y:-i},"n")),u.length&&(o=t.calculateAdjustments(u,"x",i,e.x-10),t.makeSpace(o.movingShapes,o.resizingShapes,{x:i,y:0},"e")),d.length&&(s=t.calculateAdjustments(d,"x",-i,e.x+e.width+10),t.makeSpace(s.movingShapes,s.resizingShapes,{x:-i,y:0},"w")))}(a,r))})}function Wn(e,t){t.invoke(ft.A,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",500,function(e){var t=e.elements;t.filter(function(e){return Un(e,e.host)}).map(function(e){return t.indexOf(e)}).forEach(function(i){e.elements[i]=n._replaceShape(t[i])})},!0),this.preExecute("elements.move",500,function(e){var t=e.shapes,i=e.newHost;t.forEach(function(e,a){var r,o=e.host;Un(e,(r=o,-1!==t.indexOf(r)?o:i))&&(t[a]=n._replaceShape(e))})},!0)}function Un(e,t){return!(0,Oe.J2)(e)&&(0,be.is)(e,"bpmn:BoundaryEvent")&&!t}Hn.$inject=["eventBus","spaceTool"],(0,i.A)(Hn,ft.A),Wn.$inject=["bpmnReplace","injector"],(0,i.A)(Wn,ft.A),Wn.prototype._replaceShape=function(e){var t,n,i,a=(n=e,(i=(0,be.Cf)(n).eventDefinitions)&&i[0]);return t=a?{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:a.$type}:{type:"bpmn:IntermediateThrowEvent"},this._bpmnReplace.replaceElement(e,t,{layoutConnection:!1})};var Kn=n(42596);function qn(e,t,n){function i(e,i,a){var r,o,s,c,p,m,u,d,h=i.waypoints,f=e.outgoing.slice(),v=e.incoming.slice();d=(0,l.isNumber)(a.width)?(0,st.pp)(a):a;var g=(0,Kn.C)(h,d);if(g){if(r=h.slice(0,g.index),o=h.slice(g.index+(g.bendpoint?1:0)),!r.length||!o.length)return;s=g.bendpoint?h[g.index]:d,1!==r.length&&Jn(e,r[r.length-1])||r.push(Xn(s)),1!==o.length&&Jn(e,o[0])||o.unshift(Xn(s))}c=i.source,p=i.target,t.canConnect(c,e,i)&&(n.reconnectEnd(i,e,r||d),m=i),t.canConnect(e,p,i)&&(m?u=n.connect(e,p,{type:i.type,waypoints:o}):(n.reconnectStart(i,e,o||d),u=i));var y=[].concat(m&&(0,l.filter)(v,function(e){return e.source===m.source})||[],u&&(0,l.filter)(f,function(e){return e.target===u.target})||[]);y.length&&n.removeElements(y)}ft.A.call(this,e),this.preExecute("elements.move",function(e){var n=e.newParent,i=e.shapes,a=e.delta,r=i[0];if(r&&n){n&&n.waypoints&&(e.newParent=n=n.parent);var o=(0,st.pp)(r),s={x:o.x+a.x,y:o.y+a.y},c=(0,l.find)(n.children,function(e){return t.canInsert(i,e)&&(0,Kn.C)(e.waypoints,s)});c&&(e.targetFlow=c,e.position=s)}},!0),this.postExecuted("elements.move",function(e){var t=e.shapes,n=e.targetFlow,a=e.position;n&&i(t[0],n,a)},!0),this.preExecute("shape.create",function(e){var n=e.parent,i=e.shape;t.canInsert(i,n)&&(e.targetFlow=n,e.parent=n.parent)},!0),this.postExecuted("shape.create",function(e){var t=e.shape,n=e.targetFlow,a=e.position;n&&i(t,n,a)},!0)}function Jn(e,t){var n=t.x,i=t.y;return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function Xn(e){return(0,l.assign)({},e)}function Yn(e,t){ft.A.call(this,e),this.preExecuted("connection.create",function(e){var n=e.context,i=n.connection,a=n.source,r=n.target,o=n.hints;o&&!1===o.createElementsBehavior||!Qn(i)||((0,be.is)(a,"bpmn:EventBasedGateway")?r.incoming.filter(e=>e!==i&&Qn(e)):r.incoming.filter(e=>e!==i&&Qn(e)&&(0,be.is)(e.source,"bpmn:EventBasedGateway"))).forEach(function(e){t.removeConnection(e)})}),this.preExecuted("shape.replace",function(e){var n=e.context.newShape;(0,be.is)(n,"bpmn:EventBasedGateway")&&n.outgoing.filter(Qn).reduce(function(e,t){return e.includes(t.target)?e:e.concat(t.target)},[]).forEach(function(e){e.incoming.filter(Qn).forEach(function(i){const a=e.incoming.filter(Qn).filter(function(e){return e.source===n});(i.source!==n||a.length>1)&&t.removeConnection(i)})})})}function Qn(e){return(0,be.is)(e,"bpmn:SequenceFlow")}(0,i.A)(qn,ft.A),qn.$inject=["eventBus","bpmnRules","modeling"],Yn.$inject=["eventBus","modeling"],(0,i.A)(Yn,ft.A);var Zn=1500;function ei(e,t,n){t.on(["create.hover","create.move","create.out","create.end","shape.move.hover","shape.move.move","shape.move.out","shape.move.end"],Zn,function(t){var i=t.context.shape||t.shape,a=t.hover;(0,be.is)(a,"bpmn:Lane")&&!(0,be.f7)(i,["bpmn:Lane","bpmn:Participant"])&&(t.hover=Gn(a),t.hoverGfx=e.getGraphics(t.hover));var r=n.getRootElement();a!==r&&(i.labelTarget||(0,be.f7)(i,["bpmn:Group","bpmn:TextAnnotation"]))&&(t.hover=r,t.hoverGfx=e.getGraphics(t.hover))}),t.on(["connect.hover","connect.out","connect.end","connect.cleanup","global-connect.hover","global-connect.out","global-connect.end","global-connect.cleanup"],Zn,function(t){var n=t.hover;(0,be.is)(n,"bpmn:Lane")&&(t.hover=Gn(n)||n,t.hoverGfx=e.getGraphics(t.hover))}),t.on(["bendpoint.move.hover"],Zn,function(t){var n=t.context,i=t.hover,a=n.type;(0,be.is)(i,"bpmn:Lane")&&/reconnect/.test(a)&&(t.hover=Gn(i)||i,t.hoverGfx=e.getGraphics(t.hover))}),t.on(["connect.start"],Zn,function(e){var t=e.context,n=t.start;(0,be.is)(n,"bpmn:Lane")&&(t.start=Gn(n)||n)}),t.on("shape.move.start",2e3,function(e){var t=e.shape;(0,be.is)(t,"bpmn:Lane")&&(e.shape=Gn(t)||t)}),t.on("spaceTool.move",2e3,function(e){var t=e.hover;t&&(0,be.is)(t,"bpmn:Lane")&&(e.hover=Gn(t))})}function ti(e,t,n,i,a,r){function o(e,t,i){var a=n.filter(function(e){return(0,be.is)(e,"bpmn:Group")}).filter(function(e){return e.businessObject!==i});t&&!function(e,t){return e.some(function(e){var n=(0,be.Cf)(e);return(n.categoryValueRef&&n.categoryValueRef.$parent)===t})}(a,t)&&function(e){var t=e.$parent;t&&((0,Pn.TF)(t.get("rootElements"),e),e.$parent=null)}(t),e&&!function(e,t){return e.some(function(e){return(0,be.Cf)(e).categoryValueRef===t})}(a,e)&&function(e){var t=e.$parent;t&&((0,Pn.TF)(t.get("categoryValue"),e),e.$parent=null)}(e)}function s(e,n){return function(e,t,n){return(0,Pn.WQ)(t.get("categoryValue"),e),e.$parent=t,(0,Pn.WQ)(n.get("rootElements"),t),t.$parent=n,e}(e,n,t.getDefinitions())}function c(n,i){var a=(0,be.Cf)(n),r=a.categoryValueRef;r||(r=a.categoryValueRef=i.categoryValue=i.categoryValue||function(e){return e.create("bpmn:CategoryValue")}(e));var o=r.$parent;o||(o=r.$parent=i.category=i.category||function(e){return e.create("bpmn:Category")}(e)),s(r,o,t.getDefinitions())}function p(e,t){var n=t.category,i=t.categoryValue,a=(0,be.Cf)(e);i?(a.categoryValueRef=null,o(i,n,a)):o(null,a.categoryValueRef.$parent,a)}function l(t,n){var i=e.create(t.$type);return r.copyElement(t,i,null,n)}a.invoke(ft.A,this),this.execute("label.create",function(e){var t=e.context,n=t.labelTarget;(0,be.is)(n,"bpmn:Group")&&c(n,t)}),this.revert("label.create",function(e){var t=e.context,n=t.labelTarget;(0,be.is)(n,"bpmn:Group")&&p(n,t)}),this.execute("shape.delete",function(e){var t=e.context,n=t.shape,i=(0,be.Cf)(n);if((0,be.is)(n,"bpmn:Group")&&!n.labelTarget){var a=t.categoryValue=i.categoryValueRef;a&&(o(a,t.category=a.$parent,i),i.categoryValueRef=null)}}),this.reverted("shape.delete",function(e){var t=e.context,n=t.shape;if((0,be.is)(n,"bpmn:Group")&&!n.labelTarget){var i=t.category,a=t.categoryValue,r=(0,be.Cf)(n);a&&(r.categoryValueRef=a,s(a,i))}}),this.execute("shape.create",function(e){var t=e.context,n=t.shape;(0,be.is)(n,"bpmn:Group")&&!n.labelTarget&&(0,be.Cf)(n).categoryValueRef&&c(n,t)}),this.reverted("shape.create",function(e){var t=e.context,n=t.shape;(0,be.is)(n,"bpmn:Group")&&!n.labelTarget&&(0,be.Cf)(n).categoryValueRef&&p(n,t)}),i.on("copyPaste.copyElement",770,function(e){var t=e.descriptor,n=e.element;if((0,be.is)(n,"bpmn:Group")&&!n.labelTarget){var i=(0,be.Cf)(n);if(i.categoryValueRef){var a=i.categoryValueRef;t.categoryValue=l(a,!0),a.$parent&&(t.category=l(a.$parent,!0))}}}),i.on("copyPaste.pasteElement",770,function(e){var t=e.descriptor,n=t.businessObject,i=t.categoryValue,a=t.category;i&&(i=n.categoryValueRef=l(i)),a&&(i.$parent=l(a)),delete t.category,delete t.categoryValue})}function ni(e,t,n,i){var a,r,o,s;return 0==(a=(i.y-n.y)*(t.x-e.x)-(i.x-n.x)*(t.y-e.y))?null:(r=e.y-n.y,o=e.x-n.x,s=((i.x-n.x)*r-(i.y-n.y)*o)/a,{x:Math.round(e.x+s*(t.x-e.x)),y:Math.round(e.y+s*(t.y-e.y))})}function ii(e){function t(e,t,n){var i,a={x:n.x,y:n.y-50},r={x:n.x-50,y:n.y},o=ni(e,t,n,a),s=ni(e,t,n,r);i=o&&s?ai(o,n)>ai(s,n)?s:o:o||s,e.original=i}e.on("bpmnElement.added",function(e){var n,i,a=e.element;a.waypoints&&(t((i=(n=a).waypoints)[0],i[1],(0,st.pp)(n.source)),t(i[i.length-1],i[i.length-2],(0,st.pp)(n.target)))})}function ai(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function ri(e){ft.A.call(this,e);var t=["bpmn:Participant","bpmn:Lane"];this.executed(["shape.move","shape.create","shape.resize"],function(e){var n=e.context.shape,i=(0,be.Cf)(n),a=(0,be.S2)(n);if((0,be.f7)(i,t)){var r=a.get("isHorizontal");void 0===r&&(r=!0),a.set("isHorizontal",r)}})}ei.$inject=["elementRegistry","eventBus","canvas"],ti.$inject=["bpmnFactory","bpmnjs","elementRegistry","eventBus","injector","moddleCopy"],(0,i.A)(ti,ft.A),ii.$inject=["eventBus"],ri.$inject=["eventBus"],(0,i.A)(ri,ft.A);var oi=n(67392),si=Math.sqrt,ci=Math.min,pi=Math.max,li=Math.abs;function mi(e){return Math.pow(e,2)}function ui(e,t){return si(mi(e.x-t.x)+mi(e.y-t.y))}function di(e,t,n,i){var a=t.x-e.x,r=t.y-e.y,o=n.x-e.x,s=n.y-e.y,c=a*a+r*r,p=(a*o+r*s)/c,l=p*p-(o*o+s*s-i*i)/c;if(l<0&&l>-1e-6&&(l=0),l<0)return[];var m=si(l),u=-p+m,d=-p-m,h={x:e.x-a*u,y:e.y-r*u};return 0===l?[h]:[h,{x:e.x-a*d,y:e.y-r*d}].filter(function(n){return function(e,t,n){return hi(e.x,t.x,n.x)&&hi(e.y,t.y,n.y)}(n,e,t)})}function hi(e,t,n){return e>=ci(t,n)-vi&&e<=pi(t,n)+vi}function fi(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}var vi=.1;function gi(e,t){return li(e.x-t.x)<=vi&&li(e.y-t.y)<=vi}function yi(e,t,n,i){var a=0,r=0,o={point:e,delta:{x:0,y:0}},s=function(e,t){var n,i,a,r,o,s,c,p,l,m,u=0;for(u=0;u<t.length-1;u++){if(gi(n=t[u],i=t[u+1])?s=[n]:(a=ui(e,n),r=ui(e,i),s=di(n,i,e,ci(a,r))),s.length<1)throw new Error("expected between [1, 2] circle -> line intersections");1===s.length&&(c={type:"bendpoint",position:s[0],segmentIndex:u,bendpointIndex:gi(n,s[0])?u:u+1}),2===s.length&&(c={type:"segment",position:o=fi(s[0],s[1]),segmentIndex:u,relativeLocation:ui(n,o)/ui(n,i)}),p=ui(c.position,e),(!m||l>p)&&(m=c,l=p)}return m}(e,n),c=s.segmentIndex,p=function(e,t,n,i){var a=n.segmentIndex,r=t.length-e.length;if(i.segmentMove){var o=i.segmentMove.segmentStartIndex,s=i.segmentMove.newSegmentStartIndex;return a===o?s:a>=s?a+r<s?s:a+r:a}if(i.bendpointMove){var c,p=i.bendpointMove.insert,l=i.bendpointMove.bendpointIndex;return 0===r?a:(a>=l&&(c=p?a+1:a-1),a<l&&(c=a,p&&"bendpoint"!==n.type&&l-1===a&&bi(t,l)<n.relativeLocation&&c++),c)}return 0===r?a:i.connectionStart&&0===a?0:i.connectionEnd&&a===e.length-2?t.length-2:Math.floor((t.length-2)/2)}(n,t,s,i);if(p<0||p>t.length-2||null===p)return o;var l,m,u,d,h,f,v,g=Ei(n,c),y=Ei(t,p),b=s.position,E=(d=g,h=b,f=(0,oi.kf)(d[0],d[1]),v=(0,oi.kf)(d[0],h),0===f?0:v/f),x=(l=g,m=y,u=(0,oi._H)(l),(0,oi._H)(m)-u);if("bendpoint"===s.type){var w=t.length-n.length,_=s.bendpointIndex,S=n[_];if(-1!==t.indexOf(S))return o;if(0===w){var A=t[_];return{delta:{x:a=A.x-s.position.x,y:r=A.y-s.position.y},point:{x:e.x+a,y:e.y+r}}}w<0&&0!==_&&_<n.length-1&&(E=bi(n,_))}var C={x:(y[1].x-y[0].x)*E+y[0].x,y:(y[1].y-y[0].y)*E+y[0].y},N=(0,oi.VE)({x:e.x-b.x,y:e.y-b.y},x);return a=C.x+N.x-e.x,r=C.y+N.y-e.y,{point:(0,st.PG)(C),delta:(0,st.PG)({x:a,y:r})}}function bi(e,t){var n=(0,oi.kf)(e[t-1],e[t]);return n/(n+(0,oi.kf)(e[t],e[t+1]))}function Ei(e,t){return[e[t],e[t+1]]}var xi=n(84410),wi="name",_i="text";function Si(e,t,n,i){function a(e){var n=e.context,a=n.element,r=n.properties;if(wi in r&&t.updateLabel(a,r[wi]),_i in r&&(0,be.is)(a,"bpmn:TextAnnotation")){var o=i.getTextAnnotationBounds({x:a.x,y:a.y,width:a.width,height:a.height},r[_i]||"");t.updateLabel(a,r.text,o)}}ft.A.call(this,e),this.postExecute("element.updateProperties",a),this.postExecute("element.updateModdleProperties",e=>{(0,be.Cf)(e.context.element)===e.context.moddleElement&&a(e)}),this.postExecute(["shape.create","connection.create"],function(e){var n=e.context;if(!1!==(n.hints||{}).createElementsBehavior){var i=n.shape||n.connection;!(0,Oe.J2)(i)&&(0,je.UC)(i)&&(0,je.p9)(i)&&t.updateLabel(i,(0,je.p9)(i))}}),this.postExecute("shape.delete",function(e){var n=e.context,i=n.labelTarget,a=n.hints||{};i&&!1!==a.unsetLabel&&t.updateLabel(i,null,null,{removeShape:!1})}),this.postExecute(["connection.layout","connection.updateWaypoints"],function(e){var n=e.context;if(!1!==(n.hints||{}).labelBehavior){var i,a=n.connection.label;a&&a.parent&&(i=function(e){var t=e.context,n=t.connection,i=n.label,a=(0,l.assign)({},t.hints),r=t.newWaypoints||n.waypoints,o=t.oldWaypoints;return void 0===a.startChanged&&(a.startChanged=!!a.connectionStart),void 0===a.endChanged&&(a.endChanged=!!a.connectionEnd),function(e,t,n,i){return yi((0,st.pp)(e),t,n,i).delta}(i,r,o,a)}(e),t.moveShape(a,i))}}),this.postExecute(["shape.replace"],function(e){var t=e.context,n=t.newShape,i=t.oldShape,a=(0,be.Cf)(n);a&&(0,je.UC)(a)&&i.label&&n.label&&(n.label.x=i.label.x,n.label.y=i.label.y)}),this.postExecute("shape.resize",function(e){var n,i=e.context,a=i.shape,r=i.newBounds,o=i.oldBounds;if((0,je.ur)(a)){var s=a.label,c=function(e,t,n){var i=(0,xi._)(e,t,n);return(0,st.PG)((0,hn.p)(i,e))}(function(e,t){if(t.length){var n=function(e,t){var n=t.map(function(t){return{line:t,distance:(0,oi.YZ)(e,t)}});return(0,l.sortBy)(n,"distance")[0].line}(e,t);return(0,oi.P0)(e,n)}}((0,st.pp)(s),[[{x:(n=o).x,y:n.y},{x:n.x+(n.width||0),y:n.y}],[{x:n.x+(n.width||0),y:n.y},{x:n.x+(n.width||0),y:n.y+(n.height||0)}],[{x:n.x,y:n.y+(n.height||0)},{x:n.x+(n.width||0),y:n.y+(n.height||0)}],[{x:n.x,y:n.y},{x:n.x,y:n.y+(n.height||0)}]]),o,r);t.moveShape(s,c)}})}function Ai(e,t){function n(e,t){var n=e.context,i=n.connection,a=(0,l.assign)({},n.hints),r=n.newWaypoints||i.waypoints,o=n.oldWaypoints;return void 0===a.startChanged&&(a.startChanged=!!a.connectionStart),void 0===a.endChanged&&(a.endChanged=!!a.connectionEnd),function(e,t,n,i){return yi(e,t,n,i).point}(t,r,o,a)}ft.A.call(this,e),this.postExecute(["connection.layout","connection.updateWaypoints"],function(e){var i=e.context.connection,a=i.outgoing;i.incoming.forEach(function(i){var a=i.waypoints[i.waypoints.length-1],r=n(e,a),o=[].concat(i.waypoints.slice(0,-1),[r]);t.updateWaypoints(i,o)}),a.forEach(function(i){var a=i.waypoints[0],r=n(e,a),o=[].concat([r],i.waypoints.slice(1));t.updateWaypoints(i,o)})}),this.postExecute(["connection.move"],function(e){var n=e.context,i=n.connection,a=i.outgoing,r=i.incoming,o=n.delta;r.forEach(function(e){var n=e.waypoints[e.waypoints.length-1],i={x:n.x+o.x,y:n.y+o.y},a=[].concat(e.waypoints.slice(0,-1),[i]);t.updateWaypoints(e,a)}),a.forEach(function(e){var n=e.waypoints[0],i={x:n.x+o.x,y:n.y+o.y},a=[].concat([i],e.waypoints.slice(1));t.updateWaypoints(e,a)})})}(0,i.A)(Si,ft.A),Si.$inject=["eventBus","modeling","bpmnFactory","textRenderer"],(0,i.A)(Ai,ft.A),Ai.$inject=["eventBus","modeling"];var Ci=n(44944);function Ni(e,t){ft.A.call(this,e),this.postExecute("shape.replace",function(e){var n=e.oldShape,i=e.newShape;if(function(e,t){return(0,be.is)(e,"bpmn:Participant")&&(0,Fe.Av)(e)&&(0,be.is)(t,"bpmn:Participant")&&!(0,Fe.Av)(t)}(n,i)){var a,r,o,s,c=(a=n,r=(0,Vt.cZ)([a],!1),o=[],s=[],r.forEach(function(e){e!==a&&(e.incoming.forEach(function(e){(0,be.is)(e,"bpmn:MessageFlow")&&o.push(e)}),e.outgoing.forEach(function(e){(0,be.is)(e,"bpmn:MessageFlow")&&s.push(e)}))},[]),{incoming:o,outgoing:s});c.incoming.forEach(function(e){var a=(0,Ci.tQ)(e,i,n);t.reconnectEnd(e,i,a)}),c.outgoing.forEach(function(e){var a=(0,Ci.Fe)(e,i,n);t.reconnectStart(e,i,a)})}},!0)}Ni.$inject=["eventBus","modeling"],(0,i.A)(Ni,ft.A);const Ti=["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:EscalationEventDefinition","bpmn:ConditionalEventDefinition","bpmn:SignalEventDefinition"];function Di(e){const t=(0,be.Cf)(e);if(!((0,be.is)(t,"bpmn:BoundaryEvent")||(0,be.is)(t,"bpmn:StartEvent")&&(0,Fe.Q1)(t.$parent)))return!1;const n=t.get("eventDefinitions");return!(!n||!n.length)&&Ti.some(e=>(0,be.is)(n[0],e))}function ki(e){return(0,be.is)(e,"bpmn:BoundaryEvent")?"cancelActivity":"isInterrupting"}function Pi(e,t){e.invoke(ft.A,this),this.postExecuted("shape.replace",function(e){const n=e.context.oldShape,i=e.context.newShape,a=e.context.hints;if(!Di(i))return;const r=ki(i);if(a.targetElement&&void 0!==a.targetElement[r])return;const o=(0,be.Cf)(n).get(r);o!==(0,be.Cf)(i).get(r)&&t.updateProperties(i,{[r]:o})})}function Ri(e,t){ft.A.call(this,e),this.preExecute("shape.resize",function(e){var n=e.shape,i=(0,be.S2)(n),a=i&&i.get("label");a&&a.get("bounds")&&t.updateModdleProperties(n,a,{bounds:void 0})},!0)}function Bi(e,t,n){ft.A.call(this,e),this.preExecute("shape.delete",function(e){var i,a,r,o=e.context.shape;if(1===o.incoming.length&&1===o.outgoing.length){var s=o.incoming[0],c=o.outgoing[0];if((0,be.is)(s,"bpmn:SequenceFlow")&&(0,be.is)(c,"bpmn:SequenceFlow")&&t.canConnect(s.source,c.target,s)){var p=(i=s.waypoints,a=c.waypoints,(r=ni(Mi(i[i.length-2]),Mi(i[i.length-1]),Mi(a[1]),Mi(a[0])))?[].concat(i.slice(0,i.length-1),[r],a.slice(1)):[Mi(i[0]),Mi(a[a.length-1])]);n.reconnectEnd(s,c.target,p)}}})}function Mi(e){return e.original||e}function Ii(e,t){ft.A.call(this,e),this.preExecute("shape.delete",function(e){var t=e.shape,n=t.parent;(0,be.is)(t,"bpmn:Participant")&&(e.collaborationRoot=n)},!0),this.postExecute("shape.delete",function(e){var n=e.collaborationRoot;if(n&&!n.businessObject.participants.length){var i=t.makeProcess(),a=n.children.slice();t.moveElements(a,{x:0,y:0},i)}},!0)}function Fi(e,t,n,i){ft.A.call(this,e);var a=i.get("dragging",!1);function r(e){var i,a,r=e.source,o=e.target;e.parent&&((0,be.is)(e,"bpmn:SequenceFlow")&&(n.canConnectSequenceFlow(r,o)||(a=!0),n.canConnectMessageFlow(r,o)&&(i="bpmn:MessageFlow")),(0,be.is)(e,"bpmn:MessageFlow")&&(n.canConnectMessageFlow(r,o)||(a=!0),n.canConnectSequenceFlow(r,o)&&(i="bpmn:SequenceFlow")),a&&t.removeConnection(e),i&&t.connect(r,o,{type:i,waypoints:e.waypoints.slice()}))}this.postExecuted("elements.move",function(e){var t=e.closure.allConnections;(0,l.forEach)(t,r)},!0),this.preExecute("connection.reconnect",function(e){var i,r,o=e.context,s=o.connection,c=o.newSource||s.source,p=o.newTarget||s.target;(i=n.canConnect(c,p))&&i.type!==s.type&&(r=t.connect(c,p,{type:i.type,associationDirection:i.associationDirection,waypoints:s.waypoints.slice()}),s.parent&&t.removeConnection(s),o.connection=r,a&&function(e,t){var n,i=a.context(),r=i&&i.payload.previousSelection;r&&r.length&&-1!==(n=r.indexOf(e))&&r.splice(n,1,t)}(s,r))}),this.postExecuted("element.updateProperties",function(e){var n,i=e.context,a=i.properties,r=i.element,o=r.businessObject;a.default&&(n=(0,l.find)(r.outgoing,(0,l.matchPattern)({id:r.businessObject.default.id})))&&t.updateProperties(n,{conditionExpression:void 0}),a.conditionExpression&&o.sourceRef.default===o&&t.updateProperties(r.source,{default:void 0})})}function ji(e,t,n,i,a,r){i.invoke(ft.A,this),this._bpmnReplace=e,this._elementRegistry=n,this._selection=r,this.postExecuted(["elements.create"],500,function(e){var n=e.context,i=n.parent,a=n.elements,r=(0,l.reduce)(a,function(e,n){var a=t.canReplace([n],n.host||n.parent||i);return a?e.concat(a.replacements):e},[]);r.length&&this._replaceElements(a,r)},this),this.postExecuted(["elements.move"],500,function(e){var n=e.context,i=n.newParent,a=n.newHost,r=[];(0,l.forEach)(n.closure.topLevel,function(e){r=(0,Fe.Q1)(e)?r.concat(e.children):r.concat(e)}),1===r.length&&a&&(i=a);var o=t.canReplace(r,i);o&&this._replaceElements(r,o.replacements,a)},this),this.postExecute(["shape.replace"],1500,function(e){var n,i=e.context,a=i.oldShape,r=i.newShape,o=a.attachers;o&&o.length&&(n=t.canReplace(o,r),this._replaceElements(o,n.replacements))},this),this.postExecuted(["shape.replace"],1500,function(e){var t=e.context,n=t.oldShape,i=t.newShape;a.unclaimId(n.businessObject.id,n.businessObject),a.updateProperties(i,{id:n.id})})}Pi.$inject=["injector","modeling"],(0,i.A)(Pi,ft.A),(0,i.A)(Ri,ft.A),Ri.$inject=["eventBus","modeling"],(0,i.A)(Bi,ft.A),Bi.$inject=["eventBus","bpmnRules","modeling"],Ii.$inject=["eventBus","modeling"],(0,i.A)(Ii,ft.A),(0,i.A)(Fi,ft.A),Fi.$inject=["eventBus","modeling","bpmnRules","injector"],(0,i.A)(ji,ft.A),ji.prototype._replaceElements=function(e,t){var n=this._elementRegistry,i=this._bpmnReplace,a=this._selection;(0,l.forEach)(t,function(t){var a={type:t.newElementType},r=n.get(t.oldElementId),o=e.indexOf(r);e[o]=i.replaceElement(r,a,{select:!1})}),t&&a.select(e)},ji.$inject=["bpmnReplace","bpmnRules","elementRegistry","injector","modeling","selection"];var Oi={width:140,height:120},Li={width:300,height:60},$i={width:60,height:300},zi={width:300,height:150},Vi={width:150,height:300},Gi={width:140,height:120},Hi={width:50,height:30};function Wi(e){e.on("resize.start",1500,function(e){var t=e.context,n=t.shape,i=t.direction,a=t.balanced;((0,be.is)(n,"bpmn:Lane")||(0,be.is)(n,"bpmn:Participant"))&&(t.resizeConstraints=function(e,t,n){var i=Gn(e),a=!0,r=!0,o=zn(i,[i]),s=(0,st.Fy)(e),c={},p={},l=(0,Fe.$b)(e),m=l?Li:$i;/n/.test(t)?p.top=s.bottom-m.height:/e/.test(t)?p.right=s.left+m.width:/s/.test(t)?p.bottom=s.top+m.height:/w/.test(t)&&(p.left=s.right-m.width),o.forEach(function(e){var i=(0,st.Fy)(e);l?(i.top<s.top-10&&(a=!1),i.bottom>s.bottom+10&&(r=!1)):(i.left<s.left-10&&(a=!1),i.right>s.right+10&&(r=!1)),/n/.test(t)&&(n&&Ui(s.top-i.bottom)<10&&Yi(c,"top",i.top+m.height),Ui(s.top-i.top)<5&&Xi(p,"top",i.bottom-m.height)),/e/.test(t)&&(n&&Ui(s.right-i.left)<10&&Xi(c,"right",i.right-m.width),Ui(s.right-i.right)<5&&Yi(p,"right",i.left+m.width)),/s/.test(t)&&(n&&Ui(s.bottom-i.top)<10&&Xi(c,"bottom",i.bottom-m.height),Ui(s.bottom-i.bottom)<5&&Yi(p,"bottom",i.top+m.height)),/w/.test(t)&&(n&&Ui(s.left-i.right)<10&&Yi(c,"left",i.left+m.width),Ui(s.left-i.left)<5&&Xi(p,"left",i.right-m.width))});var u=i.children.filter(function(e){return!e.hidden&&!e.waypoints&&((0,be.is)(e,"bpmn:FlowElement")||(0,be.is)(e,"bpmn:Artifact"))}),d=l?Qi:Zi;return u.forEach(function(e){var n=(0,st.Fy)(e);!/n/.test(t)||l&&!a||Xi(p,"top",n.top-d.top),/e/.test(t)&&(l||r)&&Yi(p,"right",n.right+d.right),!/s/.test(t)||l&&!r||Yi(p,"bottom",n.bottom+d.bottom),/w/.test(t)&&(l||a)&&Xi(p,"left",n.left-d.left)}),{min:p,max:c}}(n,i,a)),(0,be.is)(n,"bpmn:SubProcess")&&(0,Fe.Av)(n)&&(t.minDimensions=Gi),(0,be.is)(n,"bpmn:TextAnnotation")&&(t.minDimensions=Hi)})}Wi.$inject=["eventBus"];var Ui=Math.abs,Ki=Math.min,qi=Math.max;function Ji(e,t,n,i){var a=e[t];e[t]=void 0===a?n:i(n,a)}function Xi(e,t,n){return Ji(e,t,n,Ki)}function Yi(e,t,n){return Ji(e,t,n,qi)}var Qi={top:20,left:50,right:20,bottom:20},Zi={top:50,left:20,right:20,bottom:20},ea=n(72120);function ta(e,t){e.on("resize.start",1501,function(e){var t=e.context,n=t.shape;((0,be.is)(n,"bpmn:Lane")||(0,be.is)(n,"bpmn:Participant"))&&(t.balanced=!(0,ea.Io)(e))}),e.on("resize.end",1001,function(e){var n=e.context,i=n.shape,a=n.canExecute,r=n.newBounds;if((0,be.is)(i,"bpmn:Lane")||(0,be.is)(i,"bpmn:Participant"))return a&&(r=(0,st.Au)(r),t.resizeLane(i,r,n.balanced)),!1})}function na(e,t,n,i,a){function r(e){return(0,be.f7)(e,["bpmn:ReceiveTask","bpmn:SendTask"])||function(e,t){return(0,l.isArray)(t)||(t=[t]),(0,l.some)(t,function(t){return(0,Fe.Ip)(e,t)})}(e,["bpmn:ErrorEventDefinition","bpmn:EscalationEventDefinition","bpmn:MessageEventDefinition","bpmn:SignalEventDefinition"])}function o(t){var n=e.getDefinitions().get("rootElements");return!!(0,l.find)(n,(0,l.matchPattern)({id:t.id}))}function s(e){return(0,be.is)(e,"bpmn:ErrorEventDefinition")?"errorRef":(0,be.is)(e,"bpmn:EscalationEventDefinition")?"escalationRef":(0,be.is)(e,"bpmn:MessageEventDefinition")?"messageRef":(0,be.is)(e,"bpmn:SignalEventDefinition")?"signalRef":void 0}function c(e){if((0,be.f7)(e,["bpmn:ReceiveTask","bpmn:SendTask"]))return e.get("messageRef");var t=e.get("eventDefinitions")[0];return t.get(s(t))}n.invoke(ft.A,this),this.executed(["shape.create","element.updateProperties","element.updateModdleProperties"],function(t){var n=t.shape||t.element;if(r(n)){var i,a=c((0,be.Cf)(n));a&&!o(a)&&(i=e.getDefinitions().get("rootElements"),(0,Pn.WQ)(i,a),t.addedRootElement=a)}},!0),this.reverted(["shape.create","element.updateProperties","element.updateModdleProperties"],function(t){var n=t.addedRootElement;if(n){var i=e.getDefinitions().get("rootElements");(0,Pn.TF)(i,n)}},!0),t.on("copyPaste.copyElement",function(e){var t=e.descriptor,n=e.element;if(!n.labelTarget&&r(n)){var i=c((0,be.Cf)(n));i&&(t.referencedRootElement=i)}}),t.on("copyPaste.pasteElement",500,function(e){var t=e.descriptor,n=t.businessObject,r=t.referencedRootElement;r&&(o(r)||(r=i.copyElement(r,a.create(r.$type))),function(e,t){if((0,be.f7)(e,["bpmn:ReceiveTask","bpmn:SendTask"]))return e.set("messageRef",t);var n=e.get("eventDefinitions")[0];n.set(s(n),t)}(n,r),delete t.referencedRootElement)})}ta.$inject=["eventBus","modeling"],na.$inject=["bpmnjs","eventBus","injector","moddleCopy","bpmnFactory"],(0,i.A)(na,ft.A);var ia=Math.max;function aa(e){e.on("spaceTool.getMinDimensions",function(e){var t=e.shapes,n=e.axis,i=e.start,a={};return(0,l.forEach)(t,function(e){var t=e.id;(0,be.is)(e,"bpmn:Participant")&&(a[t]=function(e,t,n){var i=(0,Fe.$b)(e);if(!Vn(e).length)return i?zi:Vi;var a=function(e){return"x"===e}(t);return a?i?zi:{width:oa(e,n,a),height:Vi.height}:i?{width:zi.width,height:ra(e,n,a)}:Vi}(e,n,i)),(0,be.is)(e,"bpmn:Lane")&&(a[t]=(0,Fe.$b)(e)?Li:$i),(0,be.is)(e,"bpmn:SubProcess")&&(0,Fe.Av)(e)&&(a[t]=Gi),(0,be.is)(e,"bpmn:TextAnnotation")&&(a[t]=Hi),(0,be.is)(e,"bpmn:Group")&&(a[t]=Oi)}),a})}function ra(e,t,n){var i;return i=function(e,t,n){var i;return i=sa(Vn(e),t,n),e.height-i.height+Li.height}(e,t,n),ia(zi.height,i)}function oa(e,t,n){var i;return i=function(e,t,n){var i;return i=sa(Vn(e),t,n),e.width-i.width+$i.width}(e,t,n),ia(Vi.width,i)}function sa(e,t,n){var i,a,r;for(i=0;i<e.length;i++)if(a=e[i],!n&&t>=a.y&&t<=a.y+a.height||n&&t>=a.x&&t<=a.x+a.width)return(r=Vn(a)).length?sa(r,t,n):a}aa.$inject=["eventBus"];function ca(e,t,n,i,a,r,o){ft.A.call(this,t),this._canvas=e,this._eventBus=t,this._modeling=n,this._elementFactory=i,this._bpmnFactory=a,this._bpmnjs=r,this._elementRegistry=o;var s=this;function c(e){return(0,be.is)(e,"bpmn:SubProcess")&&!(0,Fe.Av)(e)}function p(t){var n=t.shape,i=t.newRootElement,a=(0,be.Cf)(n);i=s._addDiagram(i||a),t.newRootElement=e.addRootElement(i)}function m(t){var n=t.shape,i=(0,be.Cf)(n);s._removeDiagram(i);var a=t.newRootElement=o.get((0,bt.hJ)(i));e.removeRootElement(a)}this.executed("shape.create",function(e){c(e.shape)&&p(e)},!0),this.postExecuted("shape.create",function(e){var t=e.shape,n=e.newRootElement;n&&t.children&&(s._showRecursively(t.children),s._moveChildrenToShape(t,n))},!0),this.reverted("shape.create",function(e){c(e.shape)&&m(e)},!0),this.preExecuted("shape.delete",function(e){var t=e.shape;if(c(t)){var i=o.get((0,bt.hJ)(t));i&&n.removeElements(i.children.slice())}},!0),this.executed("shape.delete",function(e){c(e.shape)&&m(e)},!0),this.reverted("shape.delete",function(e){c(e.shape)&&p(e)},!0),this.preExecuted("shape.replace",function(t){var n=t.oldShape,i=t.newShape;c(n)&&c(i)&&(t.oldRoot=e.removeRootElement((0,bt.hJ)(n)))},!0),this.postExecuted("shape.replace",function(t){var i=t.newShape,a=t.oldRoot,r=e.findRoot((0,bt.hJ)(i));if(a&&r){var o=a.children;n.moveElements(o,{x:0,y:0},r)}},!0),this.executed("element.updateProperties",function(e){var t=e.element;if((0,be.is)(t,"bpmn:SubProcess")){var n=e.properties,i=e.oldProperties.id,a=n.id;if(i!==a){if((0,bt.hC)(t))return o.updateId(t,(0,bt.vY)(a)),void o.updateId(i,a);o.get((0,bt.vY)(i))&&o.updateId((0,bt.vY)(i),(0,bt.vY)(a))}}},!0),this.reverted("element.updateProperties",function(e){var t=e.element;if((0,be.is)(t,"bpmn:SubProcess")){var n=e.properties,i=e.oldProperties.id,a=n.id;if(i!==a){if((0,bt.hC)(t))return o.updateId(t,(0,bt.vY)(i)),void o.updateId(a,i);var r=o.get((0,bt.vY)(a));r&&o.updateId(r,(0,bt.vY)(i))}}},!0),t.on("element.changed",function(e){var n=e.element;if((0,bt.hC)(n)){var i=n,a=o.get((0,bt.rr)(i));a&&a!==i&&t.fire("element.changed",{element:a})}}),this.executed("shape.toggleCollapse",400,function(e){var t=e.shape;(0,be.is)(t,"bpmn:SubProcess")&&((0,Fe.Av)(t)?m(e):(p(e),s._showRecursively(t.children)))},!0),this.reverted("shape.toggleCollapse",400,function(e){var t=e.shape;(0,be.is)(t,"bpmn:SubProcess")&&((0,Fe.Av)(t)?m(e):(p(e),s._showRecursively(t.children)))},!0),this.postExecuted("shape.toggleCollapse",600,function(e){var t=e.shape;if((0,be.is)(t,"bpmn:SubProcess")){var n=e.newRootElement;n&&((0,Fe.Av)(t)?s._moveChildrenToShape(n,t):s._moveChildrenToShape(t,n))}},!0),t.on("copyPaste.createTree",function(e){var t=e.element,n=e.children;if(c(t)){var i=(0,bt.hJ)(t),a=o.get(i);a&&n.push.apply(n,a.children)}}),t.on("copyPaste.copyElement",function(e){var t=e.descriptor,n=e.element,i=e.elements,a=n.parent;if((0,be.is)((0,be.S2)(a),"bpmndi:BPMNPlane")){var r=(0,bt.rr)(a),o=(0,l.find)(i,function(e){return e.id===r});o&&(t.parent=o.id)}}),t.on("copyPaste.pasteElement",function(e){var t=e.descriptor;t.parent&&(c(t.parent)||t.parent.hidden)&&(t.hidden=!0)})}function pa(e,t){e.invoke(ft.A,this),this.postExecuted("shape.replace",function(e){var n=e.context.oldShape,i=e.context.newShape;if((0,be.is)(i,"bpmn:SubProcess")&&!(0,be.is)(i,"bpmn:AdHocSubProcess")&&((0,be.is)(n,"bpmn:Task")||(0,be.is)(n,"bpmn:CallActivity"))&&(0,Fe.Av)(i)){var a,r={x:(a=i).x+a.width/6,y:a.y+a.height/2};t.createShape({type:"bpmn:StartEvent"},r,i)}})}function la(e){ft.A.call(this,e),this.preExecute("connection.create",function(e){const{target:t}=e;(0,be.is)(t,"bpmn:TextAnnotation")&&(e.parent=t.parent)},!0),this.preExecute(["shape.create","shape.resize","elements.move"],function(e){const t=e.shapes||[e.shape];1===t.length&&(0,be.is)(t[0],"bpmn:TextAnnotation")&&(e.hints=e.hints||{},e.hints.autoResize=!1)},!0)}function ma(e,t){ft.A.call(this,e),this.postExecuted("shape.toggleCollapse",1500,function(e){var n=e.shape;if(!(0,Fe.Av)(n)){var i=(0,Vt.cZ)(n);i.forEach(function(e){var t=e.incoming.slice(),n=e.outgoing.slice();(0,l.forEach)(t,function(e){a(e,!0)}),(0,l.forEach)(n,function(e){a(e,!1)})})}function a(e,a){-1!==i.indexOf(e.source)&&-1!==i.indexOf(e.target)||(a?t.reconnectEnd(e,n,(0,st.pp)(n)):t.reconnectStart(e,n,(0,st.pp)(n)))}},!0)}function ua(e,t,n){ft.A.call(this,e),this.executed(["shape.toggleCollapse"],500,function(e){var t,n=e.context.shape;(0,be.is)(n,"bpmn:SubProcess")&&(n.collapsed?(0,be.S2)(n).isExpanded=!1:((t=n.children).length&&t.forEach(function(e){"label"!==e.type||e.businessObject.name||(e.hidden=!0)}),(0,be.S2)(n).isExpanded=!0))}),this.reverted(["shape.toggleCollapse"],500,function(e){var t=e.context.shape;t.collapsed?(0,be.S2)(t).isExpanded=!1:(0,be.S2)(t).isExpanded=!0}),this.postExecuted(["shape.toggleCollapse"],500,function(e){var i,a=e.context.shape,r=t.getDefaultSize(a);i=a.collapsed?function(e,t){return{x:e.x+(e.width-t.width)/2,y:e.y+(e.height-t.height)/2,width:t.width,height:t.height}}(a,r):function(e,t){var n,i,a,r=t;return n=(a=e.children,a.filter(function(e){return!e.hidden})).concat([e]),(i=(0,jn.uR)(n))?(r.width=Math.max(i.width,r.width),r.height=Math.max(i.height,r.height),r.x=i.x+(i.width-r.width)/2,r.y=i.y+(i.height-r.height)/2):(r.x=e.x+(e.width-r.width)/2,r.y=e.y+(e.height-r.height)/2),r}(a,r),n.resizeShape(a,i,null,{autoResize:!a.collapsed&&"nwse"})})}function da(e,t,n,i){t.invoke(ft.A,this),this.preExecute("shape.delete",function(e){var t=e.context.shape,a=t.businessObject;(0,Oe.J2)(t)||((0,be.is)(t,"bpmn:Participant")&&(0,Fe.Av)(t)&&n.ids.unclaim(a.processRef.id),i.unclaimId(a.id,a))}),this.preExecute("connection.delete",function(e){var t=e.context.connection.businessObject;i.unclaimId(t.id,t)}),this.preExecute("canvas.updateRoot",function(){var t=e.getRootElement(),i=t.businessObject;(0,be.is)(t,"bpmn:Collaboration")&&n.ids.unclaim(i.id)})}function ha(e,t){ft.A.call(this,e),this.preExecute("connection.delete",function(e){var n=e.context.connection,i=n.source;(function(e,t){if(!(0,be.is)(e,"bpmn:SequenceFlow"))return!1;var n=(0,be.Cf)(t),i=(0,be.Cf)(e);return n.get("default")===i})(n,i)&&t.updateProperties(i,{default:null})})}function fa(e,t){var n;ft.A.call(this,e);var i=["spaceTool","lane.add","lane.resize","lane.split","elements.create","elements.delete","elements.move","shape.create","shape.delete","shape.move","shape.resize"];this.preExecute(i,5e3,function(e){(n=n||new va).enter()}),this.postExecuted(i,500,function(e){!function(){if(!n)throw new Error("out of bounds release");n.leave()&&(t.updateLaneRefs(n.flowNodes,n.lanes),n=null)}()}),this.preExecute(["shape.create","shape.move","shape.delete","shape.resize"],function(e){var t=e.context.shape,i=function(){if(!n)throw new Error("out of bounds release");return n}();t.labelTarget||((0,be.is)(t,"bpmn:Lane")&&i.addLane(t),(0,be.is)(t,"bpmn:FlowNode")&&i.addFlowNode(t))})}function va(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(e){this.lanes.push(e)},this.addFlowNode=function(e){this.flowNodes.push(e)},this.enter=function(){this.counter++},this.leave=function(){return this.counter--,!this.counter}}function ga(e,t){ft.A.call(this,e),this.postExecuted("elements.create",function(e){const n=e.context.elements;for(const e of n)ya(e)&&!ba(e)&&t.updateProperties(e,{isForCompensation:void 0})})}function ya(e){const t=(0,be.Cf)(e);return t&&t.isForCompensation}function ba(e){return e.incoming.filter(e=>function(e){return e&&(0,be.is)(e,"bpmn:BoundaryEvent")&&(0,Fe.Ip)(e,"bpmn:CompensateEventDefinition")}(e.source)).length>0}(0,i.A)(ca,ft.A),ca.prototype._moveChildrenToShape=function(e,t){var n,i=this._modeling,a=e.children;if(a){var r=(a=a.concat(a.reduce(function(t,n){return n.label&&n.label.parent!==e?t.concat(n.label):t},[]))).filter(function(e){return!e.hidden});if(r.length){var o=(0,Vt.U7)(r);if(t.x){var s=(0,st.pp)(t),c=(0,st.pp)(o);n={x:s.x-c.x,y:s.y-c.y}}else n={x:180-o.x,y:160-o.y};i.moveElements(a,n,t,{autoResize:!1})}else i.moveElements(a,{x:0,y:0},t,{autoResize:!1})}},ca.prototype._showRecursively=function(e,t){var n=this,i=[];return e.forEach(function(e){e.hidden=!!t,i=i.concat(e),e.children&&(i=i.concat(n._showRecursively(e.children,e.collapsed||t)))}),i},ca.prototype._addDiagram=function(e){var t=this._bpmnjs.getDefinitions().diagrams;return e.businessObject||(e=this._createNewDiagram(e)),t.push(e.di.$parent),e},ca.prototype._createNewDiagram=function(e){var t=this._bpmnFactory,n=this._elementFactory,i=t.create("bpmndi:BPMNPlane",{bpmnElement:e}),a=t.create("bpmndi:BPMNDiagram",{plane:i});return i.$parent=a,n.createRoot({id:(0,bt.hJ)(e),type:e.$type,di:i,businessObject:e,collapsed:!0})},ca.prototype._removeDiagram=function(e){var t=this._bpmnjs.getDefinitions().diagrams,n=(0,l.find)(t,function(t){return t.plane.bpmnElement.id===e.id});return t.splice(t.indexOf(n),1),n},ca.$inject=["canvas","eventBus","modeling","elementFactory","bpmnFactory","bpmnjs","elementRegistry"],pa.$inject=["injector","modeling"],(0,i.A)(pa,ft.A),(0,i.A)(la,ft.A),la.$inject=["eventBus"],(0,i.A)(ma,ft.A),ma.$inject=["eventBus","modeling"],(0,i.A)(ua,ft.A),ua.$inject=["eventBus","elementFactory","modeling"],(0,i.A)(da,ft.A),da.$inject=["canvas","injector","moddle","modeling"],(0,i.A)(ha,ft.A),ha.$inject=["eventBus","modeling"],fa.$inject=["eventBus","modeling"],(0,i.A)(fa,ft.A),(0,i.A)(ga,ft.A),ga.$inject=["eventBus","modeling"];const Ea={__init__:["adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","compensateBoundaryEventBehaviour","createBehavior","createDataObjectBehavior","createParticipantBehavior","dataInputAssociationBehavior","dataStoreBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","fixHoverBehavior","groupBehavior","importDockingFix","isHorizontalFix","labelBehavior","layoutConnectionBehavior","messageFlowBehavior","nonInterruptingBehavior","removeElementBehavior","removeEmbeddedLabelBoundsBehavior","removeParticipantBehavior","replaceConnectionBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","rootElementReferenceBehavior","spaceToolBehavior","subProcessPlaneBehavior","subProcessStartEventBehavior","textAnnotationBehavior","toggleCollapseConnectionBehaviour","toggleElementCollapseBehaviour","unclaimIdBehavior","updateFlowNodeRefsBehavior","unsetDefaultFlowBehavior","setCompensationActivityAfterPasteBehavior"],adaptiveLabelPositioningBehavior:["type",vn],appendBehavior:["type",yn],associationBehavior:["type",bn],attachEventBehavior:["type",En],boundaryEventBehavior:["type",wn],compensateBoundaryEventBehaviour:["type",_n],createBehavior:["type",Nn],createDataObjectBehavior:["type",Tn],createParticipantBehavior:["type",kn],dataInputAssociationBehavior:["type",Bn],dataStoreBehavior:["type",Fn],deleteLaneBehavior:["type",Hn],detachEventBehavior:["type",Wn],dropOnFlowBehavior:["type",qn],eventBasedGatewayBehavior:["type",Yn],fixHoverBehavior:["type",ei],groupBehavior:["type",ti],importDockingFix:["type",ii],isHorizontalFix:["type",ri],labelBehavior:["type",Si],layoutConnectionBehavior:["type",Ai],messageFlowBehavior:["type",Ni],nonInterruptingBehavior:["type",Pi],removeElementBehavior:["type",Bi],removeEmbeddedLabelBoundsBehavior:["type",Ri],removeParticipantBehavior:["type",Ii],replaceConnectionBehavior:["type",Fi],replaceElementBehaviour:["type",ji],resizeBehavior:["type",Wi],resizeLaneBehavior:["type",ta],rootElementReferenceBehavior:["type",na],spaceToolBehavior:["type",aa],subProcessPlaneBehavior:["type",ca],subProcessStartEventBehavior:["type",pa],textAnnotationBehavior:["type",la],toggleCollapseConnectionBehaviour:["type",ma],toggleElementCollapseBehaviour:["type",ua],unclaimIdBehavior:["type",da],unsetDefaultFlowBehavior:["type",ha],updateFlowNodeRefsBehavior:["type",fa],setCompensationActivityAfterPasteBehavior:["type",ga]};var xa=n(81734);function wa(e,t){var n=(0,st.vc)(e,t,-15);return"intersect"!==n?n:null}function _a(e){zt.A.call(this,e)}function Sa(e){return!e||(0,Oe.J2)(e)}function Aa(e){do{if((0,be.is)(e,"bpmn:Process"))return(0,be.Cf)(e);if((0,be.is)(e,"bpmn:Participant"))return(0,be.Cf)(e).processRef||(0,be.Cf)(e)}while(e=e.parent)}function Ca(e){return(0,be.is)(e,"bpmn:TextAnnotation")}function Na(e){return(0,be.is)(e,"bpmn:Group")&&!e.labelTarget}function Ta(e){return(0,be.is)(e,"bpmn:BoundaryEvent")&&Ra(e,"bpmn:CompensateEventDefinition")}function Da(e){return(0,be.Cf)(e).isForCompensation}function ka(e){for(var t=e;t=t.parent;){if((0,be.is)(t,"bpmn:FlowElementsContainer"))return(0,be.Cf)(t);if((0,be.is)(t,"bpmn:Participant"))return(0,be.Cf)(t).processRef}return null}function Pa(e,t){return ka(e)===ka(t)}function Ra(e,t){var n=(0,be.Cf)(e);return!!(0,l.find)(n.eventDefinitions||[],function(e){return(0,be.is)(e,t)})}function Ba(e,t){return((0,be.Cf)(e).eventDefinitions||[]).every(function(e){return(0,be.is)(e,t)})}function Ma(e,t){var n=function(e){for(var t=[];e;)(e=e.parent)&&t.push(e);return t}(t);return-1!==n.indexOf(e)}function Ia(e,t,n){if(Sa(e)||Sa(t))return null;if(!(0,be.is)(n,"bpmn:DataAssociation")){if(Ja(e,t))return{type:"bpmn:MessageFlow"};if(Xa(e,t))return{type:"bpmn:SequenceFlow"}}return Ya(e,t)||(qa(e,t)?{type:"bpmn:Association",associationDirection:"One"}:!!Ka(e,t)&&{type:"bpmn:Association",associationDirection:"None"})}function Fa(e,t){return!(!(0,Oe.J2)(e)&&!Na(e))||!((0,be.is)(t,"bpmn:Participant")&&!(0,Fe.Av)(t))&&((0,be.is)(e,"bpmn:Participant")?(0,be.is)(t,"bpmn:Process")||(0,be.is)(t,"bpmn:Collaboration"):(0,be.f7)(e,["bpmn:DataInput","bpmn:DataOutput"])&&e.parent?t===e.parent:(0,be.is)(e,"bpmn:Lane")?(0,be.is)(t,"bpmn:Participant")||(0,be.is)(t,"bpmn:Lane"):!((0,be.is)(e,"bpmn:BoundaryEvent")&&(n=e,!(0,be.Cf)(n).cancelActivity||!La(n)&&!$a(n)))&&((0,be.is)(e,"bpmn:FlowElement")&&!(0,be.is)(e,"bpmn:DataStoreReference")?(0,be.is)(t,"bpmn:FlowElementsContainer")?(0,Fe.Av)(t):(0,be.f7)(t,["bpmn:Participant","bpmn:Lane"]):(0,be.is)(e,"bpmn:DataStoreReference")&&(0,be.is)(t,"bpmn:Collaboration")?(0,l.some)((0,be.Cf)(t).get("participants"),function(e){return!!e.get("processRef")}):(0,be.f7)(e,["bpmn:Artifact","bpmn:DataAssociation","bpmn:DataStoreReference"])?(0,be.f7)(t,["bpmn:Collaboration","bpmn:Lane","bpmn:Participant","bpmn:Process","bpmn:SubProcess"]):!!(0,be.is)(e,"bpmn:MessageFlow")&&((0,be.is)(t,"bpmn:Collaboration")||e.source.parent==t||e.target.parent==t)));var n}function ja(e){return!(0,Oe.J2)(e)&&(0,be.is)(e,"bpmn:BoundaryEvent")}function Oa(e){return(0,be.is)(e,"bpmn:Lane")}function La(e){var t=(0,be.Cf)(e);return t&&!(t.eventDefinitions&&t.eventDefinitions.length)}function $a(e){return za(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])}function za(e,t){return t.some(function(t){return Ra(e,t)})}function Va(e,t,n,i){if(Array.isArray(e)||(e=[e]),1!==e.length)return!1;var a=e[0];return!(0,Oe.J2)(a)&&!!function(e){return!!ja(e)||!(!(0,be.is)(e,"bpmn:IntermediateThrowEvent")||!La(e))||(0,be.is)(e,"bpmn:IntermediateCatchEvent")&&$a(e)}(a)&&!(0,Fe.Q1)(t)&&!(!(0,be.is)(t,"bpmn:Activity")||Da(t))&&!(i&&!wa(i,t))&&!function(e){return(0,be.is)(e,"bpmn:ReceiveTask")&&(0,l.find)(e.incoming,function(e){return(0,be.is)(e.source,"bpmn:EventBasedGateway")})}(t)&&"attach"}function Ga(e,t,n){if(!t)return!1;var i={replacements:[]};return(0,l.forEach)(e,function(e){(0,Fe.Q1)(t)||(0,be.is)(e,"bpmn:StartEvent")&&"label"!==e.type&&Fa(e,t)&&((0,Fe.oh)(e)||i.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"}),((0,Fe.GM)(e)||(0,Fe.ph)(e)||(0,Fe.fP)(e))&&i.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"}),za(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])&&(0,be.is)(t,"bpmn:SubProcess")&&i.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"})),(0,be.is)(t,"bpmn:Transaction")||Ra(e,"bpmn:CancelEventDefinition")&&"label"!==e.type&&((0,be.is)(e,"bpmn:EndEvent")&&Fa(e,t)&&i.replacements.push({oldElementId:e.id,newElementType:"bpmn:EndEvent"}),(0,be.is)(e,"bpmn:BoundaryEvent")&&Va(e,t,0,n)&&i.replacements.push({oldElementId:e.id,newElementType:"bpmn:BoundaryEvent"}))}),!!i.replacements.length&&i}function Ha(e,t){return!(0,l.some)(e,Oa)&&(!t||e.every(function(e){return Fa(e,t)}))}function Wa(e,t,n,i){return!!t&&(!(!(0,Oe.J2)(e)&&!Na(e))||n!==t&&(!n||!Ma(n,t))&&(Fa(e,t)||Qa(e,t)))}function Ua(e,t){return(0,be.is)(e,"bpmn:SubProcess")?(0,Fe.Av)(e)&&(!t||t.width>=100&&t.height>=80):!!((0,be.is)(e,"bpmn:Lane")||(0,be.is)(e,"bpmn:Participant")||Ca(e)||Na(e))}function Ka(e,t){return!(Ma(t,e)||Ma(e,t)||!function(e,t){var n=Ca(e),i=Ca(t);return(n||i)&&n!==i}(e,t)&&!Ya(e,t))}function qa(e,t){return Pa(e,t)&&Ta(e)&&(0,be.is)(t,"bpmn:Activity")&&(n=e,!t.attachers.includes(n))&&!(0,Fe.Q1)(t);var n}function Ja(e,t){return!(er(e)&&!er(t))&&(i=e,(0,be.is)(i,"bpmn:InteractionNode")&&!(0,be.is)(i,"bpmn:BoundaryEvent")&&(!(0,be.is)(i,"bpmn:Event")||(0,be.is)(i,"bpmn:ThrowEvent")&&Ba(i,"bpmn:MessageEventDefinition"))&&function(e){return(0,be.is)(e,"bpmn:InteractionNode")&&!Da(e)&&(!(0,be.is)(e,"bpmn:Event")||(0,be.is)(e,"bpmn:CatchEvent")&&Ba(e,"bpmn:MessageEventDefinition"))&&!((0,be.is)(e,"bpmn:BoundaryEvent")&&!Ra(e,"bpmn:MessageEventDefinition"))}(t)&&(n=t,!(Aa(e)===Aa(n))));var n,i}function Xa(e,t){return n=e,(0,be.is)(n,"bpmn:FlowNode")&&!(0,be.is)(n,"bpmn:EndEvent")&&!(0,Fe.Q1)(n)&&!((0,be.is)(n,"bpmn:IntermediateThrowEvent")&&Ra(n,"bpmn:LinkEventDefinition"))&&!Ta(n)&&!Da(n)&&function(e){return(0,be.is)(e,"bpmn:FlowNode")&&!(0,be.is)(e,"bpmn:StartEvent")&&!(0,be.is)(e,"bpmn:BoundaryEvent")&&!(0,Fe.Q1)(e)&&!((0,be.is)(e,"bpmn:IntermediateCatchEvent")&&Ra(e,"bpmn:LinkEventDefinition"))&&!Da(e)}(t)&&Pa(e,t)&&!((0,be.is)(e,"bpmn:EventBasedGateway")&&!function(e){return(0,be.is)(e,"bpmn:ReceiveTask")||(0,be.is)(e,"bpmn:IntermediateCatchEvent")&&(Ra(e,"bpmn:MessageEventDefinition")||Ra(e,"bpmn:TimerEventDefinition")||Ra(e,"bpmn:ConditionalEventDefinition")||Ra(e,"bpmn:SignalEventDefinition"))}(t));var n}function Ya(e,t){return(0,be.f7)(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&(0,be.f7)(t,["bpmn:Activity","bpmn:ThrowEvent"])?{type:"bpmn:DataInputAssociation"}:!(!(0,be.f7)(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])||!(0,be.f7)(e,["bpmn:Activity","bpmn:CatchEvent"]))&&{type:"bpmn:DataOutputAssociation"}}function Qa(e,t,n){if(!t)return!1;if(Array.isArray(e)){if(1!==e.length)return!1;e=e[0]}return t.source!==e&&t.target!==e&&(0,be.f7)(t,["bpmn:SequenceFlow","bpmn:MessageFlow"])&&!(0,Oe.J2)(t)&&(0,be.is)(e,"bpmn:FlowNode")&&!(0,be.is)(e,"bpmn:BoundaryEvent")&&Fa(e,t.parent)}function Za(e,t){return!!(0,Oe.J2)(t)||!((0,be.is)(t,"bpmn:Lane")&&!function(e,t){return e&&t&&-1!==e.indexOf(t)}(e,t.parent))}function er(e){return Ut(e,"bpmn:Process")||Ut(e,"bpmn:Collaboration")}(0,i.A)(_a,zt.A),_a.$inject=["eventBus"],_a.prototype.init=function(){this.addRule("connection.start",function(e){return Sa(t=e.source)?null:(0,be.f7)(t,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference","bpmn:Group","bpmn:TextAnnotation"]);var t}),this.addRule("connection.create",function(e){var t=e.source,n=e.target,i=e.hints||{},a=i.targetParent;if(i.targetAttach)return!1;a&&(n.parent=a);try{return Ia(t,n)}finally{a&&(n.parent=null)}}),this.addRule("connection.reconnect",function(e){var t=e.connection;return Ia(e.source,e.target,t)}),this.addRule("connection.updateWaypoints",function(e){return{type:e.connection.type}}),this.addRule("shape.resize",function(e){return Ua(e.shape,e.newBounds)}),this.addRule("elements.create",function(e){var t=e.elements,n=e.position,i=e.target;return!((0,Oe.fX)(i)&&!Qa(t,i))&&(0,l.every)(t,function(e){return(0,Oe.fX)(e)?Ia(e.source,e.target,e):e.host?Va(e,e.host,0,n):Wa(e,i,null)})}),this.addRule("elements.move",function(e){var t=e.target,n=e.shapes,i=e.position,a=e.hints;return(!a?.keyboardMove||!n.some(function(e){return ja(e)&&!n.includes(e.host)}))&&(Va(n,t,0,i)||Ga(n,t,i)||Ha(n,t)||Qa(n,t))}),this.addRule("shape.create",function(e){return Wa(e.shape,e.target,e.source,e.position)}),this.addRule("shape.attach",function(e){return Va(e.shape,e.target,0,e.position)}),this.addRule("element.copy",function(e){var t=e.element;return Za(e.elements,t)})},_a.prototype.canConnectMessageFlow=Ja,_a.prototype.canConnectSequenceFlow=Xa,_a.prototype.canConnectDataAssociation=Ya,_a.prototype.canConnectAssociation=Ka,_a.prototype.canConnectCompensationAssociation=qa,_a.prototype.canMove=Ha,_a.prototype.canAttach=Va,_a.prototype.canReplace=Ga,_a.prototype.canDrop=Fa,_a.prototype.canInsert=Qa,_a.prototype.canCreate=Wa,_a.prototype.canConnect=Ia,_a.prototype.canResize=Ua,_a.prototype.canCopy=Za;const tr={__depends__:[xa.A],__init__:["bpmnRules"],bpmnRules:["type",_a]};function nr(e,t){e.on("saveXML.start",2e3,function(){var e=t.getRootElements();(0,l.forEach)(e,function(e){var t,n,i=(0,be.S2)(e);t=(0,Vt.cZ)([e],!1),t=(0,l.filter)(t,function(t){return t!==e&&!t.labelTarget}),n=(0,l.map)(t,be.S2),i.set("planeElement",n)})})}nr.$inject=["eventBus","canvas"];const ir={__init__:["bpmnDiOrdering"],bpmnDiOrdering:["type",nr]};function ar(e){ft.A.call(this,e);var t=this;this.preExecute(["shape.create","connection.create"],function(e){var n=e.context,i=n.shape||n.connection,a=n.parent,r=t.getOrdering(i,a);r&&(void 0!==r.parent&&(n.parent=r.parent),n.parentIndex=r.index)}),this.preExecute(["shape.move","connection.move"],function(e){var n=e.context,i=n.shape||n.connection,a=n.newParent||i.parent,r=t.getOrdering(i,a);r&&(void 0!==r.parent&&(n.newParent=r.parent),n.newParentIndex=r.index)})}function rr(e,t){ar.call(this,e);var n=[{type:"bpmn:SubProcess",order:{level:6}},{type:"bpmn:SequenceFlow",order:{level:9,containers:["bpmn:Participant","bpmn:FlowElementsContainer"]}},{type:"bpmn:DataAssociation",order:{level:9,containers:["bpmn:Collaboration","bpmn:FlowElementsContainer"]}},{type:"bpmn:TextAnnotation",order:{level:9}},{type:"bpmn:MessageFlow",order:{level:9,containers:["bpmn:Collaboration"]}},{type:"bpmn:Association",order:{level:6,containers:["bpmn:Participant","bpmn:FlowElementsContainer","bpmn:Collaboration"]}},{type:"bpmn:BoundaryEvent",order:{level:8}},{type:"bpmn:Group",order:{level:10,containers:["bpmn:Collaboration","bpmn:FlowElementsContainer"]}},{type:"bpmn:FlowElement",order:{level:5}},{type:"bpmn:Participant",order:{level:-2}},{type:"bpmn:Lane",order:{level:-1}}];function i(e){var t=e.order;if(t||(e.order=t=function(e){if(e.labelTarget)return{level:10};var t=(0,l.find)(n,function(t){return(0,be.f7)(e,[t.type])});return t&&t.order||{level:1}}(e)),!t)throw new Error(`no order for <${e.id}>`);return t}this.getOrdering=function(e,n){if(e.labelTarget||(0,be.is)(e,"bpmn:TextAnnotation"))return{parent:t.findRoot(n)||t.getRootElement(),index:-1};var a=i(e);a.containers&&(n=function(e,t,n){for(var i=t;i&&!(0,be.f7)(i,n);)i=i.parent;if(!i)throw new Error(`no parent for <${e.id}> in <${t&&t.id}>`);return i}(e,n,a.containers));var r=n.children.indexOf(e),o=(0,l.findIndex)(n.children,function(t){return!(!e.labelTarget&&t.labelTarget)&&a.level<i(t).level});return-1!==o&&-1!==r&&r<o&&(o-=1),{index:o,parent:n}}}ar.prototype.getOrdering=function(e,t){return null},(0,i.A)(ar,ft.A),rr.$inject=["eventBus","canvas"],(0,i.A)(rr,ar);const or={__init__:["bpmnOrderingProvider"],bpmnOrderingProvider:["type",rr]};var sr=n(48909),cr=n(84322),pr=n(74071);function lr(e,t,n,i,a,r,o,s){this._canvas=e,this._create=t,this._elementFactory=i,this._eventBus=a,this._modeling=r,this._mouse=o,this._rules=s,a.on("copyPaste.copyElement",function(e){var t=e.descriptor,n=e.element,i=e.elements;t.priority=1,t.id=n.id,(0,l.find)(i,function(e){return e===n.parent})&&(t.parent=n.parent.id),function(e){return!!e.host}(n)&&(t.priority=2,t.host=n.host.id),(0,Oe.fX)(n)&&(t.priority=3,t.source=n.source.id,t.target=n.target.id,t.waypoints=function(e){return(0,l.map)(e.waypoints,function(e){return(e=mr(e)).original&&(e.original=mr(e.original)),e})}(n)),(0,Oe.J2)(n)&&(t.priority=4,t.labelTarget=n.labelTarget.id),(0,l.forEach)(["x","y","width","height"],function(e){(0,l.isNumber)(n[e])&&(t[e]=n[e])}),t.hidden=n.hidden,t.collapsed=n.collapsed}),a.on("copyPaste.elementsCopied",2e3,function(e){!1!==e.hints?.clip&&n.set(e.tree)}),a.on("copyPaste.pasteElements",2e3,function(e){e.tree||(e.tree=n.get())}),a.on("copyPaste.pasteElements",function(e){var t=e.hints;(0,l.assign)(t,{createElementsBehavior:!1})})}function mr(e){return(0,l.assign)({},e)}function ur(e,t){var n=t.indexOf(e);return-1===n?t:t.splice(n,1)}lr.$inject=["canvas","create","clipboard","elementFactory","eventBus","modeling","mouse","rules"],lr.prototype.copy=function(e,t={}){var n,i;return(0,l.isArray)(e)||(e=e?[e]:[]),i=!1===(n=this._eventBus.fire("copyPaste.canCopyElements",{elements:e}))?{}:this.createTree((0,l.isArray)(n)?n:e),this._eventBus.fire("copyPaste.elementsCopied",{elements:e,tree:i,hints:t}),i},lr.prototype.paste=function(e={}){var t=this._eventBus.createEvent({type:"copyPaste.pasteElements",hints:{},...e});if(!1!==this._eventBus.fire(t)){var n=t.tree;if(n){var i=t.hints,a=this._createElements(n);if(t.element&&t.point)return this._paste(a,t.element,t.point,i);this._create.start(this._mouse.getLastMoveEvent(),a,{hints:i})}}},lr.prototype.duplicate=function(e,t={}){var n=this.copy(e,{clip:!1});return this.paste({...t,tree:n})},lr.prototype.cut=function(e){var t=this.copy(e),n=this._getElementIdsFromTree(t),i=e.filter(function(e){return n[e.id]});return i.length>0&&this._modeling.removeElements(i),t},lr.prototype._getElementIdsFromTree=function(e){var t={};return(0,l.forEach)(e,function(e){(0,l.forEach)(e,function(e){e.id&&(t[e.id]=!0)})}),t},lr.prototype._paste=function(e,t,n,i){(0,l.forEach)(e,function(e){(0,l.isNumber)(e.x)||(e.x=0),(0,l.isNumber)(e.y)||(e.y=0)});var a=(0,Vt.U7)(e);return(0,l.forEach)(e,function(e){(0,Oe.fX)(e)&&(e.waypoints=(0,l.map)(e.waypoints,function(e){return{x:e.x-a.x-a.width/2,y:e.y-a.y-a.height/2}})),(0,l.assign)(e,{x:e.x-a.x-a.width/2,y:e.y-a.y-a.height/2})}),this._modeling.createElements(e,n,t,(0,l.assign)({},i))},lr.prototype._createElements=function(e){var t=this,n=this._eventBus,i={},a=[];return(0,l.forEach)(e,function(e,r){r=parseInt(r,10),e=(0,l.sortBy)(e,"priority"),(0,l.forEach)(e,function(e){var r,o=(0,l.assign)({},(0,l.omit)(e,["priority"]));return i[e.parent]?o.parent=i[e.parent]:delete o.parent,n.fire("copyPaste.pasteElement",{cache:i,descriptor:o}),(0,Oe.fX)(o)?(o.source=i[e.source],o.target=i[e.target],r=i[e.id]=t.createConnection(o),void a.push(r)):(0,Oe.J2)(o)?(o.labelTarget=i[o.labelTarget],r=i[e.id]=t.createLabel(o),void a.push(r)):(o.host&&(o.host=i[o.host]),r=i[e.id]=t.createShape(o),void a.push(r))})}),a},lr.prototype.createConnection=function(e){return this._elementFactory.createConnection((0,l.omit)(e,["id"]))},lr.prototype.createLabel=function(e){return this._elementFactory.createLabel((0,l.omit)(e,["id"]))},lr.prototype.createShape=function(e){return this._elementFactory.createShape((0,l.omit)(e,["id"]))},lr.prototype.hasRelations=function(e,t){var n,i;return!((0,Oe.fX)(e)&&(n=(0,l.find)(t,(0,l.matchPattern)({id:e.source.id})),i=(0,l.find)(t,(0,l.matchPattern)({id:e.target.id})),!n||!i)||(0,Oe.J2)(e)&&!(0,l.find)(t,(0,l.matchPattern)({id:e.labelTarget.id})))},lr.prototype.createTree=function(e){var t=this._rules,n=this,i={},a=[],r=(0,Vt.wT)(e);function o(e,t){var n=(0,l.find)(a,function(t){return e===t.element});n?n.depth<t&&(a=function(e,t){var n=t.indexOf(e);return-1!==n&&t.splice(n,1),t}(n,a),a.push({element:n.element,depth:t})):a.push({element:e,depth:t})}return(0,Vt.qO)(r,function(e,t,i){if(!(0,Oe.J2)(e)){(0,l.forEach)(e.labels,function(e){o(e,i)}),(0,l.forEach)([e.attachers,e.incoming,e.outgoing],function(e){e&&e.length&&(0,l.forEach)(e,function(e){(0,l.forEach)(e.labels,function(e){o(e,i)}),o(e,i)})}),o(e,i);var a=[];return e.children&&(a=e.children.slice()),n._eventBus.fire("copyPaste.createTree",{element:e,children:a}),a}}),e=(0,l.map)(a,function(e){return e.element}),a=(0,l.map)(a,function(t){return t.descriptor={},n._eventBus.fire("copyPaste.copyElement",{descriptor:t.descriptor,element:t.element,elements:e}),t}),a=(0,l.sortBy)(a,function(e){return e.descriptor.priority}),e=(0,l.map)(a,function(e){return e.element}),(0,l.forEach)(a,function(a){var r=a.depth;n.hasRelations(a.element,e)&&function(e,n){return t.allowed("element.copy",{element:e,elements:n})}(a.element,e)?(i[r]||(i[r]=[]),i[r].push(a.descriptor)):ur(a.element,e)}),i};const dr={__depends__:[sr.A,cr.A,pr.A,xa.A],__init__:["copyPaste"],copyPaste:["type",lr]};function hr(e,t,n){(0,l.isArray)(n)||(n=[n]),(0,l.forEach)(n,function(n){(0,l.isUndefined)(e[n])||(t[n]=e[n])})}function fr(e,t,n){function i(t,i){var a=e.create(t.$type);return n.copyElement(t,a,null,i)}t.on("copyPaste.copyElement",750,function(e){var t=e.descriptor,n=e.element,a=(0,be.Cf)(n);if((0,Oe.J2)(n))return t;var r=t.businessObject=i(a,!0),o=t.di=i((0,be.S2)(n),!0);o.bpmnElement=r,hr(r,t,"name"),hr(o,t,"isExpanded"),a.default&&(t.default=a.default.id)});var a="-bpmn-js-refs";t.on("copyPaste.pasteElement",function(e){var t=e.cache,n=e.descriptor,a=n.businessObject,r=n.di;if((0,Oe.J2)(n))return n.businessObject=(0,be.Cf)(t[n.labelTarget]),void(n.di=(0,be.S2)(t[n.labelTarget]));a=n.businessObject=i(a),(r=n.di=i(r)).bpmnElement=a,hr(n,a,["isExpanded","name"]),n.type=a.$type}),t.on("copyPaste.copyElement",750,function(e){var t=e.descriptor,n=e.element;if((0,be.is)(n,"bpmn:Participant")){var a=(0,be.Cf)(n);a.processRef&&(t.processRef=i(a.processRef,!0))}}),t.on("copyPaste.pasteElement",function(e){var t=e.descriptor,n=t.processRef;n&&(t.processRef=i(n))}),t.on("copyPaste.pasteElement",750,function(e){var t=e.cache;!function(e,t){e[a]=t}(t,function(e,t,n){var i=(0,be.Cf)(e);return e.default&&(n[e.default]={element:i,property:"default"}),e.host&&((0,be.Cf)(e).attachedToRef=(0,be.Cf)(t[e.host])),(0,l.omit)(n,(0,l.reduce)(n,function(t,n,a){var r=n.element,o=n.property;return a===e.id&&(r.set(o,i),t.push(e.id)),t},[]))}(e.descriptor,t,function(e){return e[a]=e[a]||{}}(t)))})}fr.$inject=["bpmnFactory","eventBus","moddleCopy"];const vr=["artifacts","dataInputAssociations","dataOutputAssociations","default","flowElements","lanes","incoming","outgoing","categoryValue"],gr=["errorRef","escalationRef","messageRef","signalRef","dataObjectRef"];function yr(e,t,n){this._bpmnFactory=t,this._eventBus=e,this._moddle=n,e.on("moddleCopy.canCopyProperties",e=>{const{propertyNames:t}=e;if(t&&t.length)return(0,l.sortBy)(t,e=>"extensionElements"===e)}),e.on("moddleCopy.canCopyProperty",e=>{const{parent:t,property:n,propertyName:i}=e,a=(0,l.isObject)(t)&&t.$descriptor;return i&&gr.includes(i)?n:(!i||!vr.includes(i))&&!(i&&a&&!(0,l.find)(a.properties,(0,l.matchPattern)({name:i})))&&void 0}),e.on("moddleCopy.canSetCopiedProperty",e=>{const{property:t}=e;if((0,be.is)(t,"bpmn:ExtensionElements")&&(!t.values||!t.values.length))return!1})}function br(e,t){return(0,l.reduce)(e.properties,(e,n)=>t&&n.default?e:e.concat(n.name),[])}yr.$inject=["eventBus","bpmnFactory","moddle"],yr.prototype.copyElement=function(e,t,n,i=!1){n&&!(0,l.isArray)(n)&&(n=[n]),n=n||br(e.$descriptor);const a=this._eventBus.fire("moddleCopy.canCopyProperties",{propertyNames:n,sourceElement:e,targetElement:t,clone:i});return!1===a||((0,l.isArray)(a)&&(n=a),(0,l.forEach)(n,n=>{let a;(0,l.has)(e,n)&&(a=e.get(n));const r=this.copyProperty(a,t,n,i);(0,l.isDefined)(r)&&!1!==this._eventBus.fire("moddleCopy.canSetCopiedProperty",{parent:t,property:r,propertyName:n})&&t.set(n,r)})),t},yr.prototype.copyProperty=function(e,t,n,i=!1){let a=this._eventBus.fire("moddleCopy.canCopyProperty",{parent:t,property:e,propertyName:n,clone:i});if(!1===a)return;if(a)return(0,l.isObject)(a)&&a.$type&&!a.$parent&&(a.$parent=t),a;const r=this._moddle.getPropertyDescriptor(t,n);if(!r.isReference){if(r.isId)return e&&this._copyId(e,t,i);if((0,l.isArray)(e))return(0,l.reduce)(e,(e,a)=>{const r=this.copyProperty(a,t,n,i);return r?e.concat(r):e},[]);if((0,l.isObject)(e)&&e.$type){if(this._moddle.getElementDescriptor(e).isGeneric)return;return a=this._bpmnFactory.create(e.$type),a.$parent=t,a=this.copyElement(e,a,null,i),a}return e}},yr.prototype._copyId=function(e,t,n=!1){return n?e:this._moddle.ids.assigned(e)?void 0:(this._moddle.ids.claim(e,t),e)};const Er={__depends__:[dr],__init__:["bpmnCopyPaste","moddleCopy"],bpmnCopyPaste:["type",fr],moddleCopy:["type",yr]};var xr=n(78303),wr=["cancelActivity","instantiate","eventGatewayType","triggeredByEvent","isInterrupting"];function _r(e,t,n,i,a,r){this.replaceElement=function(o,s,c){c=c||{};var p=s.type,m=o.businessObject;if(Sr(m)&&("bpmn:SubProcess"===p||"bpmn:AdHocSubProcess"===p)&&function(e,t){var n=e&&(0,l.has)(e,"collapsed")?e.collapsed:!(0,Fe.Av)(e);return n!==(t&&((0,l.has)(t,"collapsed")||(0,l.has)(t,"isExpanded"))?(0,l.has)(t,"collapsed")?t.collapsed:!t.isExpanded:n)}(o,s))return i.toggleCollapse(o),o;var u=e.create(p),d={type:p,businessObject:u,di:{}};"bpmn:ExclusiveGateway"===p&&(d.di.isMarkerVisible=!0),function(e,t,n){(0,l.isArray)(n)||(n=[n]),(0,l.forEach)(n,function(n){(0,l.isUndefined)(e[n])||(t[n]=e[n])})}(o.di,d.di,["fill","stroke","background-color","border-color","color"]);var h,f=br(m.$descriptor),v=br(u.$descriptor,!0),g=(h=v,f.filter(function(e){return h.includes(e)}));(0,l.assign)(u,(0,l.pick)(s,wr));var y=(0,l.filter)(g,function(e){return"eventDefinitions"===e?Ar(o,s.eventDefinitionType):"loopCharacteristics"===e?!(0,Fe.Q1)(u):!((0,l.has)(u,e)||"processRef"===e&&!1===s.isExpanded||"triggeredByEvent"===e||"isForCompensation"===e&&(0,Fe.Q1)(u))});if(u=n.copyElement(m,u,y),s.eventDefinitionType&&(Ar(u,s.eventDefinitionType)||(d.eventDefinitionType=s.eventDefinitionType,d.eventDefinitionAttrs=s.eventDefinitionAttrs)),(0,be.is)(m,"bpmn:Activity")){if(Sr(m))d.isExpanded=(0,Fe.Av)(o);else if(s&&(0,l.has)(s,"isExpanded")){d.isExpanded=s.isExpanded;var b=t.getDefaultSize(u,{isExpanded:d.isExpanded});d.width=b.width,d.height=b.height,d.x=o.x-(d.width-o.width)/2,d.y=o.y-(d.height-o.height)/2}(0,Fe.Av)(o)&&!(0,be.is)(m,"bpmn:Task")&&d.isExpanded&&(d.width=o.width,d.height=o.height)}if(Sr(m)&&!Sr(u)&&(c.moveChildren=!1),(0,be.is)(m,"bpmn:Participant")){!0===s.isExpanded?u.processRef=e.create("bpmn:Process"):c.moveChildren=!1;var E=(0,Fe.$b)(o);(0,be.S2)(o).isHorizontal||((0,be.S2)(d).isHorizontal=E),d.width=E?o.width:t.getDefaultSize(d).width,d.height=E?t.getDefaultSize(d).height:o.height}return r.allowed("shape.resize",{shape:u})||(d.height=t.getDefaultSize(d).height,d.width=t.getDefaultSize(d).width),u.name=m.name,(0,be.f7)(m,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(0,be.f7)(u,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(u.default=m.default),s.host&&!(0,be.is)(m,"bpmn:BoundaryEvent")&&(0,be.is)(u,"bpmn:BoundaryEvent")&&(d.host=s.host),"bpmn:DataStoreReference"!==d.type&&"bpmn:DataObjectReference"!==d.type||(d.x=o.x+(o.width-d.width)/2),a.replaceElement(o,d,{...c,targetElement:s})}}function Sr(e){return(0,be.is)(e,"bpmn:SubProcess")}function Ar(e,t){var n=(0,be.Cf)(e);return t&&n.get("eventDefinitions").some(function(e){return(0,be.is)(e,t)})}_r.$inject=["bpmnFactory","elementFactory","moddleCopy","modeling","replace","rules"];const Cr={__depends__:[Er,xr.A,Tt.A],bpmnReplace:["type",_r]};var Nr=n(43513),Tr=n(44391),Dr=n(27224),kr=n(25141),Pr=Math.abs,Rr=Math.round,Br={x:"width",y:"height"},Mr="crosshair",Ir={n:"top",w:"left",s:"bottom",e:"right"},Fr={n:"s",w:"e",s:"n",e:"w"};function jr(e,t,n,i,a,r,o){this._canvas=e,this._dragging=t,this._eventBus=n,this._modeling=i,this._rules=a,this._toolManager=r,this._mouse=o;var s=this;r.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),n.on("spaceTool.selection.end",function(e){n.once("spaceTool.selection.ended",function(){s.activateMakeSpace(e.originalEvent)})}),n.on("spaceTool.move",1500,function(e){var t=e.context,n=t.initialized;n||(n=t.initialized=s.init(e,t)),n&&Lr(e)}),n.on("spaceTool.end",function(e){var t=e.context,i=t.axis,a=t.direction,r=t.movingShapes,o=t.resizingShapes,c=t.start;if(t.initialized){Lr(e);var p={x:0,y:0};p[i]=Rr(e["d"+i]),s.makeSpace(r,o,p,a,c),n.once("spaceTool.ended",function(e){s.activateSelection(e.originalEvent,!0,!0)})}})}function Or(e){return{top:e.top-20,right:e.right+20,bottom:e.bottom+20,left:e.left-20}}function Lr(e){var t,n,i=e.context.spaceToolConstraints;i&&((0,l.isNumber)(i.left)&&(t=Math.max(e.x,i.left),e.dx=e.dx+t-e.x,e.x=t),(0,l.isNumber)(i.right)&&(t=Math.min(e.x,i.right),e.dx=e.dx+t-e.x,e.x=t),(0,l.isNumber)(i.top)&&(n=Math.max(e.y,i.top),e.dy=e.dy+n-e.y,e.y=n),(0,l.isNumber)(i.bottom)&&(n=Math.min(e.y,i.bottom),e.dy=e.dy+n-e.y,e.y=n))}function $r(e,t){return-1!==e.indexOf(t)}jr.$inject=["canvas","dragging","eventBus","modeling","rules","toolManager","mouse"],jr.prototype.activateSelection=function(e,t,n){this._dragging.init(e,"spaceTool.selection",{autoActivate:t,cursor:Mr,data:{context:{reactivate:n}},trapClick:!1})},jr.prototype.activateMakeSpace=function(e){this._dragging.init(e,"spaceTool",{autoActivate:!0,cursor:Mr,data:{context:{}}})},jr.prototype.makeSpace=function(e,t,n,i,a){return this._modeling.createSpace(e,t,n,i,a)},jr.prototype.init=function(e,t){var n=Pr(e.dx)>Pr(e.dy)?"x":"y",i=e["d"+n],a=e[n]-i;if(Pr(i)<5)return!1;i<0&&(i*=-1),(0,ea.Io)(e)&&(i*=-1);var r=(0,Dr.u6)(n,i),o=this._canvas.getRootElement();!(0,ea.KH)(e)&&e.hover&&(o=e.hover);var s=[...(0,Vt.cZ)(o,!0),...o.attachers||[]],c=this.calculateAdjustments(s,n,i,a),p=function(e,t,n,i,a){var r=e.movingShapes,o=e.resizingShapes;if(o.length){var s,c,p={};return(0,l.forEach)(o,function(e){var m,u,d,h,f,v,g=e.attachers,y=e.children,b=(0,st.Fy)(e),E=(0,l.filter)(y,function(e){return!((0,Oe.fX)(e)||(0,Oe.J2)(e)||$r(r,e)||$r(o,e))}),x=(0,l.filter)(y,function(e){return!(0,Oe.fX)(e)&&!(0,Oe.J2)(e)&&$r(r,e)}),w=[],_=[];E.length&&(u=Or((0,st.Fy)((0,Vt.U7)(E))),m=i-b[Ir[n]]+u[Ir[n]],"n"===n?p.bottom=c=(0,l.isNumber)(c)?Math.min(c,m):m:"w"===n?p.right=c=(0,l.isNumber)(c)?Math.min(c,m):m:"s"===n?p.top=s=(0,l.isNumber)(s)?Math.max(s,m):m:"e"===n&&(p.left=s=(0,l.isNumber)(s)?Math.max(s,m):m)),x.length&&(d=Or((0,st.Fy)((0,Vt.U7)(x))),m=i-d[Ir[Fr[n]]]+b[Ir[Fr[n]]],"n"===n?p.bottom=c=(0,l.isNumber)(c)?Math.min(c,m):m:"w"===n?p.right=c=(0,l.isNumber)(c)?Math.min(c,m):m:"s"===n?p.top=s=(0,l.isNumber)(s)?Math.max(s,m):m:"e"===n&&(p.left=s=(0,l.isNumber)(s)?Math.max(s,m):m)),g&&g.length&&(g.forEach(function(e){$r(r,e)?w.push(e):_.push(e)}),w.length&&(h=(0,st.Fy)((0,Vt.U7)(w.map(st.pp))),f=b[Ir[Fr[n]]]-(h[Ir[Fr[n]]]-i)),_.length&&(v=(0,st.Fy)((0,Vt.U7)(_.map(st.pp)))[Ir[n]]-(b[Ir[n]]-i)),"n"===n?(m=Math.min(f||1/0,v||1/0),p.bottom=c=(0,l.isNumber)(c)?Math.min(c,m):m):"w"===n?(m=Math.min(f||1/0,v||1/0),p.right=c=(0,l.isNumber)(c)?Math.min(c,m):m):"s"===n?(m=Math.max(f||-1/0,v||-1/0),p.top=s=(0,l.isNumber)(s)?Math.max(s,m):m):"e"===n&&(m=Math.max(f||-1/0,v||-1/0),p.left=s=(0,l.isNumber)(s)?Math.max(s,m):m));var S=a&&a[e.id];S&&("n"===n?(m=i+e[Br[t]]-S[Br[t]],p.bottom=c=(0,l.isNumber)(c)?Math.min(c,m):m):"w"===n?(m=i+e[Br[t]]-S[Br[t]],p.right=c=(0,l.isNumber)(c)?Math.min(c,m):m):"s"===n?(m=i-e[Br[t]]+S[Br[t]],p.top=s=(0,l.isNumber)(s)?Math.max(s,m):m):"e"===n&&(m=i-e[Br[t]]+S[Br[t]],p.left=s=(0,l.isNumber)(s)?Math.max(s,m):m))}),p}}(c,n,r,a,this._eventBus.fire("spaceTool.getMinDimensions",{axis:n,direction:r,shapes:c.resizingShapes,start:a}));return(0,l.assign)(t,c,{axis:n,direction:r,spaceToolConstraints:p,start:a}),(0,kr.hZ)("resize-"+("x"===n?"ew":"ns")),!0},jr.prototype.calculateAdjustments=function(e,t,n,i){var a=this._rules,r=[],o=[],s=[],c=[];function p(e){r.includes(e)||r.push(e);var t=e.label;t&&!r.includes(t)&&r.push(t)}(0,l.forEach)(e,function(e){if(e.parent&&!(0,Oe.J2)(e))if((0,Oe.fX)(e))c.push(e);else{var r=e[t],l=r+e[Br[t]];if(function(e){return!!e.host}(e)&&(n>0&&(0,st.pp)(e)[t]>i||n<0&&(0,st.pp)(e)[t]<i))s.push(e);else{var m;if(!(n>0&&r>i||n<0&&l<i))return r<i&&l>i&&a.allowed("shape.resize",{shape:e})?(m=e,void(o.includes(m)||o.push(m))):void 0;p(e)}}}),(0,l.forEach)(r,function(e){var t=e.attachers;t&&(0,l.forEach)(t,function(e){p(e)})});var m=r.concat(o);return(0,l.forEach)(s,function(e){var t=e.host;$r(m,t)&&p(e)}),m=r.concat(o),(0,l.forEach)(c,function(e){var t=e.source,n=e.target,i=e.label;$r(m,t)&&$r(m,n)&&i&&p(i)}),{movingShapes:r,resizingShapes:o}},jr.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)},jr.prototype.isActive=function(){var e=this._dragging.context();return!!e&&/^spaceTool/.test(e.prefix)};var zr="djs-dragging",Vr="djs-resizing",Gr=Math.max;function Hr(e,t,n,i,a){function r(e,t){(0,l.forEach)(e,function(e){a.addDragger(e,t),n.addMarker(e,zr)})}e.on("spaceTool.selection.start",function(e){var t=n.getLayer("space"),a=e.context,r=(0,h.vt)("g");(0,h.CF)(r,i.cls("djs-crosshair-group",["no-events"])),(0,h.BC)(t,r);var o=(0,h.vt)("path");(0,h.CF)(o,"d","M 0,-10000 L 0,10000"),(0,h.Ly)(o).add("djs-crosshair"),(0,h.BC)(r,o);var s=(0,h.vt)("path");(0,h.CF)(s,"d","M -10000,0 L 10000,0"),(0,h.Ly)(s).add("djs-crosshair"),(0,h.BC)(r,s),a.crosshairGroup=r}),e.on("spaceTool.selection.move",function(e){var t=e.context.crosshairGroup;(0,Xe.Tl)(t,e.x,e.y)}),e.on("spaceTool.selection.cleanup",function(e){var t=e.context.crosshairGroup;t&&(0,h.TF)(t)}),e.on("spaceTool.move",250,function(e){var o=e.context,s=o.line,c=o.axis,p=o.movingShapes,m=o.resizingShapes;if(o.initialized){if(!o.dragGroup){var u=n.getLayer("space");s=(0,h.vt)("path"),(0,h.CF)(s,"d","M0,0 L0,0"),(0,h.Ly)(s).add("djs-crosshair"),(0,h.BC)(u,s),o.line=s;var d=(0,h.vt)("g");(0,h.CF)(d,i.cls("djs-drag-group",["no-events"])),(0,h.BC)(n.getActiveLayer(),d),r(p,d),r(o.movingConnections=t.filter(function(e){var t=!1;(0,l.forEach)(p,function(n){(0,l.forEach)(n.outgoing,function(n){e===n&&(t=!0)})});var n=!1;(0,l.forEach)(p,function(t){(0,l.forEach)(t.incoming,function(t){e===t&&(n=!0)})});var i=!1;(0,l.forEach)(m,function(t){(0,l.forEach)(t.outgoing,function(t){e===t&&(i=!0)})});var a=!1;return(0,l.forEach)(m,function(t){(0,l.forEach)(t.incoming,function(t){e===t&&(a=!0)})}),(0,Oe.fX)(e)&&(t||i)&&(n||a)}),d),o.dragGroup=d}if(!o.frameGroup){var f=(0,h.vt)("g");(0,h.CF)(f,i.cls("djs-frame-group",["no-events"])),(0,h.BC)(n.getActiveLayer(),f);var v=[];(0,l.forEach)(m,function(e){var t=a.addFrame(e,f),i=t.getBBox();v.push({element:t,initialBounds:i}),n.addMarker(e,Vr)}),o.frameGroup=f,o.frames=v}var g={x:"M"+e.x+", -10000 L"+e.x+", 10000",y:"M -10000, "+e.y+" L 10000, "+e.y};(0,h.CF)(s,{d:g[c]});var y={x:e.dx,y:e.dy};y[{x:"y",y:"x"}[o.axis]]=0,(0,Xe.Tl)(o.dragGroup,y.x,y.y),(0,l.forEach)(o.frames,function(e){var t,n,i=e.element,a=e.initialBounds;"e"===o.direction?(0,h.CF)(i,{width:Gr(a.width+y.x,5)}):(t=Gr(a.width-y.x,5),(0,h.CF)(i,{width:t,x:a.x+a.width-t})),"s"===o.direction?(0,h.CF)(i,{height:Gr(a.height+y.y,5)}):(n=Gr(a.height-y.y,5),(0,h.CF)(i,{height:n,y:a.y+a.height-n}))})}}),e.on("spaceTool.cleanup",function(e){var t=e.context,i=t.movingShapes,a=t.movingConnections,r=t.resizingShapes,o=t.line,s=t.dragGroup,c=t.frameGroup;(0,l.forEach)(i,function(e){n.removeMarker(e,zr)}),(0,l.forEach)(a,function(e){n.removeMarker(e,zr)}),s&&((0,h.TF)(o),(0,h.TF)(s)),(0,l.forEach)(r,function(e){n.removeMarker(e,Vr)}),c&&(0,h.TF)(c)})}Hr.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];const Wr={__init__:["spaceToolPreview"],__depends__:[Nr.A,xa.A,Tr.A,pn.A,pr.A],spaceTool:["type",jr],spaceToolPreview:["type",Hr]};function Ur(e,t){e.invoke(jr,this),this._canvas=t}Ur.$inject=["injector","canvas"],(0,i.A)(Ur,jr),Ur.prototype.calculateAdjustments=function(e,t,n,i){var a=this._canvas.getRootElement(),r=e[0]===a?null:e[0],o=[];r&&(o=(0,l.values)((0,Vt.rx)(a.children.filter(e=>(0,be.is)(e,"bpmn:Artifact")),(0,Vt.U7)(r))));const s=[...e,...o];var c=jr.prototype.calculateAdjustments.call(this,s,t,n,i);return c.resizingShapes=c.resizingShapes.filter(function(e){return!((0,be.is)(e,"bpmn:TextAnnotation")||function(e){return(0,be.is)(e,"bpmn:Participant")&&!(0,be.Cf)(e).processRef}(e)&&("y"===t&&(0,Fe.$b)(e)||"x"===t&&!(0,Fe.$b)(e)))}),c};const Kr={__depends__:[Wr],spaceTool:["type",Ur]};var qr=n(19112),Jr=n(55063);function Xr(e,t,n){ft.A.call(this,t);var i=e.get("movePreview",!1);t.on("shape.move.start",1400,function(e){var t=e.context,n=t.shapes,i=t.validatedShapes;t.shapes=Yr(n),t.validatedShapes=Yr(i)}),i&&t.on("shape.move.start",250,function(e){var t=e.context,n=t.shapes,a=[];(0,l.forEach)(n,function(e){(0,l.forEach)(e.labels,function(n){n.hidden||-1!==t.shapes.indexOf(n)||a.push(n),e.labelTarget&&a.push(e)})}),(0,l.forEach)(a,function(e){i.makeDraggable(t,e,!0)})}),this.preExecuted("elements.move",1400,function(e){var t=e.context.closure,n=t.enclosedElements,i=[];(0,l.forEach)(n,function(e){(0,l.forEach)(e.labels,function(e){n[e.id]||i.push(e)})}),t.addAll(i)}),this.preExecute(["connection.delete","shape.delete"],function(e){var t=e.context,i=t.connection||t.shape;(0,Jr.l)(i.labels,function(e){n.removeShape(e,{nested:!0})})}),this.execute("shape.delete",function(e){var t=e.context,n=t.shape,i=n.labelTarget;i&&(t.labelTargetIndex=(0,Pn.qh)(i.labels,n),t.labelTarget=i,n.labelTarget=null)}),this.revert("shape.delete",function(e){var t=e.context,n=t.shape,i=t.labelTarget,a=t.labelTargetIndex;i&&((0,Pn.WQ)(i.labels,n,a),n.labelTarget=i)})}function Yr(e){return(0,l.filter)(e,function(t){return-1===e.indexOf(t.labelTarget)})}(0,i.A)(Xr,ft.A),Xr.$inject=["injector","eventBus","modeling"];const Qr={__init__:["labelSupport"],labelSupport:["type",Xr]};var Zr="attach-ok";function eo(e,t,n,i,a){ft.A.call(this,t);var r=e.get("movePreview",!1);t.on("shape.move.start",1401,function(e){var t,n,i=e.context,a=i.shapes,r=i.validatedShapes;i.shapes=(n=to(t=a),(0,l.unionBy)("id",t,n)),i.validatedShapes=function(e){var t=(0,l.groupBy)(e,"id");return(0,l.filter)(e,function(e){for(;e;){if(e.host&&t[e.host.id])return!1;e=e.parent}return!0})}(r)}),r&&t.on("shape.move.start",251,function(e){var t=e.context,n=to(t.shapes);(0,l.forEach)(n,function(e){r.makeDraggable(t,e,!0),(0,l.forEach)(e.labels,function(e){r.makeDraggable(t,e,!0)})})}),r&&t.on("shape.move.start",function(e){var i=e.context.shapes;if(1===i.length){var a=i[0].host;a&&(n.addMarker(a,Zr),t.once(["shape.move.out","shape.move.cleanup"],function(){n.removeMarker(a,Zr)}))}}),this.preExecuted("elements.move",1401,function(e){var t=e.context,n=t.closure,i=to(t.shapes);(0,l.forEach)(i,function(e){n.add(e,n.topLevel[e.host.id])})}),this.postExecuted("elements.move",function(e){var t,n=e.context,i=n.shapes,r=n.newHost;r&&1!==i.length||(t=r?i:(0,l.filter)(i,function(e){var t,n=e.host;return function(e){return!!e.host}(e)&&(t=n,!(-1!==i.indexOf(t)))}),(0,l.forEach)(t,function(e){a.updateAttachment(e,r)}))}),this.postExecuted("elements.move",function(e){var t=e.context.shapes;(0,l.forEach)(t,function(e){(0,l.forEach)(e.attachers,function(e){(0,l.forEach)(e.outgoing.slice(),function(e){i.allowed("connection.reconnect",{connection:e,source:e.source,target:e.target})||a.removeConnection(e)}),(0,l.forEach)(e.incoming.slice(),function(e){i.allowed("connection.reconnect",{connection:e,source:e.source,target:e.target})||a.removeConnection(e)})})})}),this.postExecute("shape.create",function(e){var t=e.context,n=t.shape,i=t.host;i&&a.updateAttachment(n,i)}),this.postExecute("shape.replace",function(e){var t=e.context,n=t.oldShape,r=t.newShape;(0,Jr.l)(n.attachers,function(e){"attach"===i.allowed("elements.move",{target:r,shapes:[e]})?a.updateAttachment(e,r):a.removeShape(e)}),r.attachers.length&&(0,l.forEach)(r.attachers,function(e){var t=(0,xi.D)(e,n,r);a.moveShape(e,t,e.parent)})}),this.postExecute("shape.resize",function(e){var t=e.context,n=t.shape,i=t.oldBounds,r=t.newBounds,o=n.attachers;!1!==(t.hints||{}).attachSupport&&(0,l.forEach)(o,function(e){var t=(0,xi.D)(e,i,r);a.moveShape(e,t,e.parent),(0,l.forEach)(e.labels,function(e){a.moveShape(e,t,e.parent)})})}),this.preExecute("shape.delete",function(e){var t=e.context.shape;(0,Jr.l)(t.attachers,function(e){a.removeShape(e)}),t.host&&a.updateAttachment(t,null)})}function to(e){return(0,l.flatten)((0,l.map)(e,function(e){return e.attachers||[]}))}(0,i.A)(eo,ft.A),eo.$inject=["injector","eventBus","canvas","rules","modeling"];const no={__depends__:[xa.A],__init__:["attachSupport"],attachSupport:["type",eo]};function io(e){this._model=e}function ao(e,t,n){ft.A.call(this,e),this._bpmnFactory=t;var i=this;function a(e){var t=e.context.oldRoot.children;(0,l.forEach)(t,function(e){(0,be.is)(e,"bpmn:BaseElement")&&i.updateParent(e)})}function r(e){var t=e.context.shape;(0,be.is)(t,"bpmn:BaseElement")&&i.updateBounds(t)}function o(e){i.updateConnection(e.context)}function s(e){i.updateConnectionWaypoints(e.context.connection)}function c(e){i.updateAttachment(e.context)}function p(e){const{element:n}=e.context,i=(0,je.p9)(n),a=(0,be.S2)(n),r=a&&a.get("label");(0,je.UC)(n)||(0,bt.hC)(n)||(i&&!r?a.set("label",t.create("bpmndi:BPMNLabel")):!i&&r&&a.set("label",void 0))}this.executed(["connection.layout","connection.create"],function(e){var t,i=e.context,a=i.hints||{};i.cropped||!1===a.createElementsBehavior||((t=i.connection).waypoints=n.getCroppedWaypoints(t),i.cropped=!0)}),this.reverted(["connection.layout"],function(e){delete e.context.cropped}),this.executed(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],ro(function(e){var t=e.context;i.updateParent(t.shape||t.connection,t.oldParent)})),this.reverted(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],ro(function(e){var t=e.context,n=t.shape||t.connection,a=t.parent||t.newParent;i.updateParent(n,a)})),this.executed(["canvas.updateRoot"],a),this.reverted(["canvas.updateRoot"],a),this.executed(["shape.move","shape.create","shape.resize"],ro(function(e){"label"!==e.context.shape.type&&r(e)})),this.reverted(["shape.move","shape.create","shape.resize"],ro(function(e){"label"!==e.context.shape.type&&r(e)})),e.on("shape.changed",function(e){"label"===e.element.type&&r({context:{shape:e.element}})}),this.executed(["connection.create","connection.move","connection.delete","connection.reconnect"],ro(o)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnect"],ro(o)),this.executed(["connection.layout","connection.move","connection.updateWaypoints"],ro(s)),this.reverted(["connection.layout","connection.move","connection.updateWaypoints"],ro(s)),this.executed("connection.reconnect",ro(function(e){var t=e.context,n=t.connection,i=t.oldSource,a=t.newSource,r=(0,be.Cf)(n),o=(0,be.Cf)(i),s=(0,be.Cf)(a);r.conditionExpression&&!(0,be.f7)(s,["bpmn:Activity","bpmn:ExclusiveGateway","bpmn:InclusiveGateway"])&&(t.oldConditionExpression=r.conditionExpression,delete r.conditionExpression),i!==a&&o.default===r&&(t.oldDefault=o.default,delete o.default)})),this.reverted("connection.reconnect",ro(function(e){var t=e.context,n=t.connection,i=t.oldSource,a=t.newSource,r=(0,be.Cf)(n),o=(0,be.Cf)(i),s=(0,be.Cf)(a);t.oldConditionExpression&&(r.conditionExpression=t.oldConditionExpression),t.oldDefault&&(o.default=t.oldDefault,delete s.default)})),this.executed(["element.updateAttachment"],ro(c)),this.reverted(["element.updateAttachment"],ro(c)),this.executed("element.updateLabel",ro(p)),this.reverted("element.updateLabel",ro(p))}function ro(e){return function(t){var n=t.context,i=n.shape||n.connection||n.element;(0,be.is)(i,"bpmn:BaseElement")&&e(t)}}io.$inject=["moddle"],io.prototype._needsId=function(e){return(0,be.f7)(e,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])},io.prototype._ensureId=function(e){var t;e.id?this._model.ids.claim(e.id,e):(t=(0,be.is)(e,"bpmn:Activity")?"Activity":(0,be.is)(e,"bpmn:Event")?"Event":(0,be.is)(e,"bpmn:Gateway")?"Gateway":(0,be.f7)(e,["bpmn:SequenceFlow","bpmn:MessageFlow"])?"Flow":(e.$type||"").replace(/^[^:]*:/g,""),t+="_",!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e)))},io.prototype.create=function(e,t){var n=this._model.create(e,t||{});return this._ensureId(n),n},io.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})},io.prototype.createDiShape=function(e,t){return this.create("bpmndi:BPMNShape",(0,l.assign)({bpmnElement:e,bounds:this.createDiBounds()},t))},io.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)},io.prototype.createDiWaypoints=function(e){var t=this;return(0,l.map)(e,function(e){return t.createDiWaypoint(e)})},io.prototype.createDiWaypoint=function(e){return this.create("dc:Point",(0,l.pick)(e,["x","y"]))},io.prototype.createDiEdge=function(e,t){return this.create("bpmndi:BPMNEdge",(0,l.assign)({bpmnElement:e,waypoint:this.createDiWaypoints([])},t))},io.prototype.createDiPlane=function(e,t){return this.create("bpmndi:BPMNPlane",(0,l.assign)({bpmnElement:e},t))},(0,i.A)(ao,ft.A),ao.$inject=["eventBus","bpmnFactory","connectionDocking"],ao.prototype.updateAttachment=function(e){var t=e.shape,n=t.businessObject,i=t.host;n.attachedToRef=i&&i.businessObject},ao.prototype.updateParent=function(e,t){if(!((0,Oe.J2)(e)||(0,be.is)(e,"bpmn:DataStoreReference")&&e.parent&&(0,be.is)(e.parent,"bpmn:Collaboration"))){var n=e.parent,i=e.businessObject,a=(0,be.S2)(e),r=n&&n.businessObject,o=(0,be.S2)(n);(0,be.is)(e,"bpmn:FlowNode")&&this.updateFlowNodeRefs(i,r,t&&t.businessObject),(0,be.is)(e,"bpmn:DataOutputAssociation")&&(r=e.source?e.source.businessObject:null),(0,be.is)(e,"bpmn:DataInputAssociation")&&(r=e.target?e.target.businessObject:null),this.updateSemanticParent(i,r),(0,be.is)(e,"bpmn:DataObjectReference")&&i.dataObjectRef&&this.updateSemanticParent(i.dataObjectRef,r),this.updateDiParent(a,o)}},ao.prototype.updateBounds=function(e){var t=(0,be.S2)(e),n=function(e){if((0,be.is)(e,"bpmn:Activity")){var t=(0,be.S2)(e);if(t){var n=t.get("label");if(n)return n.get("bounds")}}}(e);if(n){var i=(0,hn.p)(n,t.get("bounds"));(0,l.assign)(n,{x:e.x+i.x,y:e.y+i.y})}var a=(0,Oe.J2)(e)?this._getLabel(t):t,r=a.bounds;r||(r=this._bpmnFactory.createDiBounds(),a.set("bounds",r)),(0,l.assign)(r,{x:e.x,y:e.y,width:e.width,height:e.height})},ao.prototype.updateFlowNodeRefs=function(e,t,n){var i,a;n!==t&&((0,be.is)(n,"bpmn:Lane")&&(i=n.get("flowNodeRef"),(0,Pn.TF)(i,e)),(0,be.is)(t,"bpmn:Lane")&&(a=t.get("flowNodeRef"),(0,Pn.WQ)(a,e)))},ao.prototype.updateDiConnection=function(e,t,n){var i=(0,be.S2)(e),a=(0,be.S2)(t),r=(0,be.S2)(n);i.sourceElement&&i.sourceElement.bpmnElement!==(0,be.Cf)(t)&&(i.sourceElement=t&&a),i.targetElement&&i.targetElement.bpmnElement!==(0,be.Cf)(n)&&(i.targetElement=n&&r)},ao.prototype.updateDiParent=function(e,t){if(t&&!(0,be.is)(t,"bpmndi:BPMNPlane")&&(t=t.$parent),e.$parent!==t){var n=(t||e.$parent).get("planeElement");t?(n.push(e),e.$parent=t):((0,Pn.TF)(n,e),e.$parent=null)}},ao.prototype.getLaneSet=function(e){var t,n;return(0,be.is)(e,"bpmn:Lane")?((t=e.childLaneSet)||(t=this._bpmnFactory.create("bpmn:LaneSet"),e.childLaneSet=t,t.$parent=e),t):((0,be.is)(e,"bpmn:Participant")&&(e=e.processRef),(t=(n=e.get("laneSets"))[0])||((t=this._bpmnFactory.create("bpmn:LaneSet")).$parent=e,n.push(t)),t)},ao.prototype.updateSemanticParent=function(e,t,n){var i;if(e.$parent!==t&&(!(0,be.is)(e,"bpmn:DataInput")&&!(0,be.is)(e,"bpmn:DataOutput")||((0,be.is)(t,"bpmn:Participant")&&"processRef"in t&&(t=t.processRef),!("ioSpecification"in t)||t.ioSpecification!==e.$parent))){if((0,be.is)(e,"bpmn:Lane"))t&&(t=this.getLaneSet(t)),i="lanes";else if((0,be.is)(e,"bpmn:FlowElement")){if(t)if((0,be.is)(t,"bpmn:Participant"))t=t.processRef;else if((0,be.is)(t,"bpmn:Lane"))do{t=t.$parent.$parent}while((0,be.is)(t,"bpmn:Lane"));i="flowElements"}else if((0,be.is)(e,"bpmn:Artifact")){for(;t&&!(0,be.is)(t,"bpmn:Process")&&!(0,be.is)(t,"bpmn:SubProcess")&&!(0,be.is)(t,"bpmn:Collaboration");){if((0,be.is)(t,"bpmn:Participant")){t=t.processRef;break}t=t.$parent}i="artifacts"}else if((0,be.is)(e,"bpmn:MessageFlow"))i="messageFlows";else if((0,be.is)(e,"bpmn:Participant")){i="participants";var a,r=e.processRef;r&&(a=function(e){for(;e&&!(0,be.is)(e,"bpmn:Definitions");)e=e.$parent;return e}(e.$parent||t),e.$parent&&((0,Pn.TF)(a.get("rootElements"),r),r.$parent=null),t&&((0,Pn.WQ)(a.get("rootElements"),r),r.$parent=a))}else(0,be.is)(e,"bpmn:DataOutputAssociation")?i="dataOutputAssociations":(0,be.is)(e,"bpmn:DataInputAssociation")&&(i="dataInputAssociations");if(!i)throw new Error(`no parent for <${e.id}> in <${t.id}>`);var o;if(e.$parent&&(o=e.$parent.get(i),(0,Pn.TF)(o,e)),t?((o=t.get(i)).push(e),e.$parent=t):e.$parent=null,n){var s=n.get(i);(0,Pn.TF)(o,e),t&&(s||(s=[],t.set(i,s)),s.push(e))}}},ao.prototype.updateConnectionWaypoints=function(e){(0,be.S2)(e).set("waypoint",this._bpmnFactory.createDiWaypoints(e.waypoints))},ao.prototype.updateConnection=function(e){var t,n=e.connection,i=(0,be.Cf)(n),a=n.source,r=(0,be.Cf)(a),o=n.target,s=(0,be.Cf)(n.target);if((0,be.is)(i,"bpmn:DataAssociation"))(0,be.is)(i,"bpmn:DataInputAssociation")?(i.get("sourceRef")[0]=r,t=e.parent||e.newParent||s,this.updateSemanticParent(i,s,t)):(0,be.is)(i,"bpmn:DataOutputAssociation")&&(t=e.parent||e.newParent||r,this.updateSemanticParent(i,r,t),i.targetRef=s);else{var c=(0,be.is)(i,"bpmn:SequenceFlow");i.sourceRef!==r&&(c&&((0,Pn.TF)(i.sourceRef&&i.sourceRef.get("outgoing"),i),r&&r.get("outgoing")&&r.get("outgoing").push(i)),i.sourceRef=r),i.targetRef!==s&&(c&&((0,Pn.TF)(i.targetRef&&i.targetRef.get("incoming"),i),s&&s.get("incoming")&&s.get("incoming").push(i)),i.targetRef=s)}this.updateConnectionWaypoints(n),this.updateDiConnection(n,a,o)},ao.prototype._getLabel=function(e){return e.label||(e.label=this._bpmnFactory.createDiLabel()),e.label};var oo=n(87496);function so(e,t){oo.A.call(this),this._bpmnFactory=e,this._moddle=t}function co(e,t,n){return void 0===t[n]?t:(e[n]=t[n],(0,l.omit)(t,[n]))}(0,i.A)(so,oo.A),so.$inject=["bpmnFactory","moddle"],so.prototype._baseCreate=oo.A.prototype.create,so.prototype.create=function(e,t){if("label"===e){var n=t.di||this._bpmnFactory.createDiLabel();return this._baseCreate(e,(0,l.assign)({type:"label",di:n},je.X9,t))}return this.createElement(e,t)},so.prototype.createElement=function(e,t){var n,i,a,r,o=(t=(0,l.assign)({},t||{})).businessObject,s=t.di;if(!o){if(!t.type)throw new Error("no shape type specified");ve(o=this._bpmnFactory.create(t.type))}if(i=s,!(0,be.f7)(i,["bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane"])){var c=(0,l.assign)({},s||{},{id:o.id+"_di"});s="root"===e?this._bpmnFactory.createDiPlane(o,c):"connection"===e?this._bpmnFactory.createDiEdge(o,c):this._bpmnFactory.createDiShape(o,c)}return(0,be.is)(o,"bpmn:Group")&&(t=(0,l.assign)({isFrame:!0},t)),t=function(e,t){return(0,l.forEach)(["processRef","isInterrupting","associationDirection","isForCompensation"],function(n){t=co(e,t,n)}),t}(o,t),t.isExpanded&&(t=co(s,t,"isExpanded")),(0,be.f7)(o,["bpmn:Lane","bpmn:Participant"])&&(t=co(s,t,"isHorizontal")),(0,be.is)(o,"bpmn:SubProcess")&&(t.collapsed=!(0,Fe.Av)(o,s)),(0,be.is)(o,"bpmn:ExclusiveGateway")&&((0,l.has)(s,"isMarkerVisible")?void 0===s.isMarkerVisible&&(s.isMarkerVisible=!1):s.isMarkerVisible=!0),(0,l.isDefined)(t.triggeredByEvent)&&(o.triggeredByEvent=t.triggeredByEvent,delete t.triggeredByEvent),(0,l.isDefined)(t.cancelActivity)&&(o.cancelActivity=t.cancelActivity,delete t.cancelActivity),t.eventDefinitionType&&(a=o.get("eventDefinitions")||[],r=this._bpmnFactory.create(t.eventDefinitionType,t.eventDefinitionAttrs),"bpmn:ConditionalEventDefinition"===t.eventDefinitionType&&(r.condition=this._bpmnFactory.create("bpmn:FormalExpression")),a.push(r),r.$parent=o,o.eventDefinitions=a,delete t.eventDefinitionType),n=this.getDefaultSize(o,s),t=(0,l.assign)({id:o.id},n,t,{businessObject:o,di:s}),this._baseCreate(e,t)},so.prototype.getDefaultSize=function(e,t){var n=(0,be.Cf)(e);if(t=t||(0,be.S2)(e),(0,be.is)(n,"bpmn:SubProcess"))return(0,Fe.Av)(n,t)?{width:350,height:200}:{width:100,height:80};if((0,be.is)(n,"bpmn:Task"))return{width:100,height:80};if((0,be.is)(n,"bpmn:Gateway"))return{width:50,height:50};if((0,be.is)(n,"bpmn:Event"))return{width:36,height:36};if((0,be.is)(n,"bpmn:Participant")){var i=void 0===t.isHorizontal||!0===t.isHorizontal;return(0,Fe.Av)(n,t)?i?{width:600,height:250}:{width:250,height:600}:i?{width:400,height:60}:{width:60,height:400}}return(0,be.is)(n,"bpmn:Lane")?{width:400,height:100}:(0,be.is)(n,"bpmn:DataObjectReference")?{width:36,height:50}:(0,be.is)(n,"bpmn:DataStoreReference")?{width:50,height:50}:(0,be.is)(n,"bpmn:TextAnnotation")?{width:100,height:30}:(0,be.is)(n,"bpmn:Group")?{width:300,height:300}:{width:100,height:80}},so.prototype.createParticipantShape=function(e){return(0,l.isObject)(e)||(e={isExpanded:e}),!1!==(e=(0,l.assign)({type:"bpmn:Participant"},e||{})).isExpanded&&(e.processRef=this._bpmnFactory.create("bpmn:Process")),this.createShape(e)};var po=n(77550);function lo(e){this._elementRegistry=e}function mo(e,t){(0,l.forEach)(t,function(t,n){e.set(n,t)})}lo.$inject=["elementRegistry"],lo.prototype.execute=function(e){var t=e.element,n=e.moddleElement,i=e.properties;if(!n)throw new Error("<moddleElement> required");var a=e.changed||this._getVisualReferences(n).concat(t),r=e.oldProperties||function(e,t){return(0,l.reduce)(t,function(t,n){return t[n]=e.get(n),t},{})}(n,(0,l.keys)(i));return mo(n,i),e.oldProperties=r,e.changed=a,a},lo.prototype.revert=function(e){var t=e.oldProperties,n=e.moddleElement,i=e.changed;return mo(n,t),i},lo.prototype._getVisualReferences=function(e){var t=this._elementRegistry;return(0,be.is)(e,"bpmn:DataObject")?function(e,t){return t.filter(function(t){return(0,be.is)(t,"bpmn:DataObjectReference")&&(0,be.Cf)(t).dataObjectRef===e})}(e,t):[]};var uo="default",ho="id",fo={width:0,height:0};function vo(e,t,n,i){this._elementRegistry=e,this._moddle=t,this._modeling=n,this._textRenderer=i}function go(e,t){return ho in e&&e[ho]!==t[ho]}function yo(e,t){var n=e.businessObject,i=(0,be.S2)(e);(0,l.forEach)(t,function(e,t){"di"!==t?n.set(t,e):i&&function(e,t){(0,l.forEach)(t,function(t,n){e.set(n,t)})}(i,e)})}vo.$inject=["elementRegistry","moddle","modeling","textRenderer"],vo.prototype.execute=function(e){var t=e.element,n=[t];if(!t)throw new Error("element required");var i=this._elementRegistry,a=this._moddle.ids,r=t.businessObject,o=function(e){var t=(0,l.assign)({},e);return bo.forEach(function(n){n in e&&(t[n]=(0,be.Cf)(t[n]))}),t}(e.properties),s=e.oldProperties||function(e,t){var n=(0,l.keys)(t),i=e.businessObject,a=(0,be.S2)(e);return(0,l.reduce)(n,function(e,n){return e[n]="di"!==n?i.get(n):function(e,t){return(0,l.reduce)(t,function(t,n){return t[n]=e&&e.get(n),t},{})}(a,(0,l.keys)(t.di)),e},{})}(t,o);return go(o,r)&&(a.unclaim(r[ho]),i.updateId(t,o[ho]),a.claim(o[ho],r)),uo in o&&(o[uo]&&n.push(i.get(o[uo].id)),r[uo]&&n.push(i.get(r[uo].id))),yo(t,o),e.oldProperties=s,e.changed=n,n},vo.prototype.postExecute=function(e){var t=e.element.label,n=t&&(0,be.Cf)(t).name;if(n){var i=this._textRenderer.getExternalLabelBounds(t,n);this._modeling.resizeShape(t,i,fo)}},vo.prototype.revert=function(e){var t=e.element,n=e.properties,i=e.oldProperties,a=t.businessObject,r=this._elementRegistry,o=this._moddle.ids;return yo(t,i),go(n,a)&&(o.unclaim(n[ho]),r.updateId(t,i[ho]),o.claim(i[ho],a)),e.changed};var bo=["default"];function Eo(e,t){this._canvas=e,this._modeling=t}function xo(e,t){this._modeling=e,this._spaceTool=t}function wo(e){this._modeling=e}function _o(e,t){this._modeling=e,this._spaceTool=t}Eo.$inject=["canvas","modeling"],Eo.prototype.execute=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,a=t.getRootElement(),r=a.businessObject,o=r.$parent,s=(0,be.S2)(a);return t.setRootElement(n),t.removeRootElement(a),(0,Pn.WQ)(o.rootElements,i),i.$parent=o,(0,Pn.TF)(o.rootElements,r),r.$parent=null,a.di=null,s.bpmnElement=i,n.di=s,e.oldRoot=a,[]},Eo.prototype.revert=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,a=e.oldRoot,r=a.businessObject,o=i.$parent,s=(0,be.S2)(n);return t.setRootElement(a),t.removeRootElement(n),(0,Pn.TF)(o.rootElements,i),i.$parent=null,(0,Pn.WQ)(o.rootElements,r),r.$parent=o,n.di=null,s.bpmnElement=r,a.di=s,[]},xo.$inject=["modeling","spaceTool"],xo.prototype.preExecute=function(e){var t=this._spaceTool,n=this._modeling,i=e.shape,a=e.location,r=Gn(i),o=r===i,s=o?i:i.parent,c=Vn(s),p=(0,Fe.$b)(i);if(p?"left"===a?a="top":"right"===a&&(a="bottom"):"top"===a?a="left":"bottom"===a&&(a="right"),!c.length){var m=p?{x:i.x+$n,y:i.y,width:i.width-$n,height:i.height}:{x:i.x,y:i.y+$n,width:i.width,height:i.height-$n};n.createShape({type:"bpmn:Lane",isHorizontal:p},m,s)}var u,d,h,f,v,g=[];(0,Vt.qO)(r,function(e){return g.push(e),e.label&&g.push(e.label),e===i?[]:(0,l.filter)(e.children,function(e){return e!==i})}),"top"===a?(u=-120,h=(d=i.y)+10,f="n",v="y"):"left"===a?(u=-120,h=(d=i.x)+10,f="w",v="x"):"bottom"===a?(u=120,h=(d=i.y+i.height)-10,f="s",v="y"):"right"===a&&(u=120,h=(d=i.x+i.width)-10,f="e",v="x");var y=t.calculateAdjustments(g,v,u,h),b=p?{x:0,y:u}:{x:u,y:0};t.makeSpace(y.movingShapes,y.resizingShapes,b,f,h);var E=p?{x:i.x+(o?$n:0),y:d-("top"===a?120:0),width:i.width-(o?$n:0),height:120}:{x:d-("left"===a?120:0),y:i.y+(o?$n:0),width:120,height:i.height-(o?$n:0)};e.newLane=n.createShape({type:"bpmn:Lane",isHorizontal:p},E,s)},wo.$inject=["modeling"],wo.prototype.preExecute=function(e){var t=this._modeling,n=e.shape,i=e.count,a=Vn(n),r=a.length;if(r>i)throw new Error(`more than <${i}> child lanes`);var o,s,c,p,l=(0,Fe.$b)(n),m=l?n.height:n.width,u=Math.round(m/i);for(p=0;p<i;p++)o=p===i-1?m-u*p:u,s=l?{x:n.x+$n,y:n.y+p*u,width:n.width-$n,height:o}:{x:n.x+p*u,y:n.y+$n,width:o,height:n.height-$n},p<r?t.resizeShape(a[p],s):(c={type:"bpmn:Lane",isHorizontal:l},t.createShape(c,s,n))},_o.$inject=["modeling","spaceTool"],_o.prototype.preExecute=function(e){var t=e.shape,n=e.newBounds;!1!==e.balanced?this.resizeBalanced(t,n):this.resizeSpace(t,n)},_o.prototype.resizeBalanced=function(e,t){var n=this._modeling,i=function(e,t){var n=Gn(e),i=zn(n,(0,be.is)(n,"bpmn:Process")?[]:[n]),a=(0,st.Fy)(e),r=(0,st.Fy)(t),o=function(e,t){return(0,jn.Sc)((0,st.Fy)(t),(0,st.Fy)(e))}(e,t),s=[],c=(0,Fe.$b)(e);return i.forEach(function(t){if(t!==e){var n=c?0:o.top,i=c?o.right:0,p=c?0:o.bottom,l=c?o.left:0,m=(0,st.Fy)(t);o.top&&(On(m.bottom-a.top)<10&&(p=r.top-m.bottom),On(m.top-a.top)<5&&(n=r.top-m.top)),o.left&&(On(m.right-a.left)<10&&(i=r.left-m.right),On(m.left-a.left)<5&&(l=r.left-m.left)),o.bottom&&(On(m.top-a.bottom)<10&&(n=r.bottom-m.top),On(m.bottom-a.bottom)<5&&(p=r.bottom-m.bottom)),o.right&&(On(m.left-a.right)<10&&(l=r.right-m.left),On(m.right-a.right)<5&&(i=r.right-m.right)),(n||i||p||l)&&s.push({shape:t,newBounds:(0,jn.rF)(t,{top:n,right:i,bottom:p,left:l})})}}),s}(e,t);n.resizeShape(e,t),i.forEach(function(e){n.resizeShape(e.shape,e.newBounds)})},_o.prototype.resizeSpace=function(e,t){var n,i,a,r,o,s=this._spaceTool,c=(0,st.Fy)(e),p=(0,st.Fy)(t),l=(0,jn.Sc)(p,c),m=Gn(e),u=[],d=[];(0,Vt.qO)(m,function(e){return u.push(e),((0,be.is)(e,"bpmn:Lane")||(0,be.is)(e,"bpmn:Participant"))&&d.push(e),e.children}),(l.bottom||l.top)&&(n=l.bottom||l.top,i=e.y+(l.bottom?e.height:0)+(l.bottom?-10:10),a=l.bottom?"s":"n",r=l.top>0||l.bottom<0?-n:n,o=s.calculateAdjustments(u,"y",r,i),s.makeSpace(o.movingShapes,o.resizingShapes,{x:0,y:n},a)),(l.left||l.right)&&(n=l.right||l.left,i=e.x+(l.right?e.width:0)+(l.right?-10:100),a=l.right?"e":"w",r=l.left>0||l.right<0?-n:n,o=s.calculateAdjustments(d,"x",r,i),s.makeSpace(o.movingShapes,o.resizingShapes,{x:n,y:0},a))};var So="flowNodeRef",Ao="lanes";function Co(e){this._elementRegistry=e}function No(e){this._moddle=e}Co.$inject=["elementRegistry"],Co.prototype._computeUpdates=function(e,t){var n=[],i=[],a={},r=[];function o(e){-1===n.indexOf(e)&&(r.push(e),n.push(e))}return t.forEach(function(e){var t=Gn(e);t&&-1===n.indexOf(t)&&(t.children.filter(function(e){return(0,be.is)(e,"bpmn:FlowNode")}).forEach(o),n.push(t))}),e.forEach(o),r.forEach(function(e){var t=e.businessObject,n=t.get(Ao).slice(),r=function(e){if(!e.parent)return[];var t=function(e){var t=Gn(e);return a[t.id]||(a[t.id]=zn(t)),a[t.id]}(e);return t.filter(function(t){return n=e,i=t,a=(0,st.Fy)(i),r=n.x+n.width/2,o=n.y+n.height/2,r>a.left&&r<a.right&&o>a.top&&o<a.bottom;var n,i,a,r,o}).map(function(e){return e.businessObject})}(e);i.push({flowNode:t,remove:n,add:r})}),t.forEach(function(e){var t=e.businessObject;e.parent||t.get(So).forEach(function(e){i.push({flowNode:e,remove:[t],add:[]})})}),i},Co.prototype.execute=function(e){var t=e.updates;return t||(t=e.updates=this._computeUpdates(e.flowNodeShapes,e.laneShapes)),t.forEach(function(e){var t=e.flowNode,n=t.get(Ao);e.remove.forEach(function(e){(0,Pn.TF)(n,e),(0,Pn.TF)(e.get(So),t)}),e.add.forEach(function(e){(0,Pn.WQ)(n,e),(0,Pn.WQ)(e.get(So),t)})}),[]},Co.prototype.revert=function(e){return e.updates.forEach(function(e){var t=e.flowNode,n=t.get(Ao);e.add.forEach(function(e){(0,Pn.TF)(n,e),(0,Pn.TF)(e.get(So),t)}),e.remove.forEach(function(e){(0,Pn.WQ)(n,e),(0,Pn.WQ)(e.get(So),t)})}),[]},No.$inject=["moddle"],No.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,i=e.element;return e.claiming?t.claim(n,i):t.unclaim(n),[]},No.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,i=e.element;return e.claiming?t.unclaim(n):t.claim(n,i),[]};var To={fill:void 0,stroke:void 0};function Do(e){this._commandStack=e,this._normalizeColor=function(e){if(e){if((0,l.isString)(e)){var t=function(e){var t=document.createElement("canvas").getContext("2d");return t.fillStyle="transparent",t.fillStyle=e,/^#[0-9a-fA-F]{6}$/.test(t.fillStyle)?t.fillStyle:null}(e);if(t)return t}throw new Error(`invalid color value: ${e}`)}}}Do.$inject=["commandStack"],Do.prototype.postExecute=function(e){var t=e.elements,n=e.colors||To,i=this,a={};"fill"in n&&(0,l.assign)(a,{"background-color":this._normalizeColor(n.fill)}),"stroke"in n&&(0,l.assign)(a,{"border-color":this._normalizeColor(n.stroke)}),(0,l.forEach)(t,function(e){var t=(0,Oe.fX)(e)?(0,l.pick)(a,["border-color"]):a,n=(0,be.S2)(e);if(function(e){"border-color"in e&&(e.stroke=e["border-color"]),"background-color"in e&&(e.fill=e["background-color"])}(t),(0,Oe.J2)(e))i._commandStack.execute("element.updateModdleProperties",{element:e,moddleElement:n.label,properties:{color:a["border-color"]}});else{if(!(0,be.f7)(n,["bpmndi:BPMNEdge","bpmndi:BPMNShape"]))return;i._commandStack.execute("element.updateProperties",{element:e,properties:{di:t}})}})};var ko={width:0,height:0};function Po(e,t,n){function i(e,t){var n=e.label||e,i=e.labelTarget||e;return(0,je.je)(n,t,i!==n),[n,i]}this.preExecute=function(t){var n=t.element,i=n.businessObject,a=t.newLabel;if(!(0,Oe.J2)(n)&&(0,je.UC)(n)&&!(0,je.ur)(n)&&!Ro(a)){var r=(0,je.QX)(n);r={x:r.x,y:r.y+7},e.createLabel(n,r,{id:i.id+"_label",businessObject:i,di:n.di})}},this.execute=function(e){return e.oldLabel=(0,je.p9)(e.element),i(e.element,e.newLabel)},this.revert=function(e){return i(e.element,e.oldLabel)},this.postExecute=function(n){var i=n.element,a=i.label||i,r=n.newLabel,o=n.newBounds,s=n.hints||{};if((0,Oe.J2)(a)||(0,be.is)(a,"bpmn:TextAnnotation"))if((0,Oe.J2)(a)&&Ro(r))!1!==s.removeShape&&e.removeShape(a,{unsetLabel:!1});else{var c=(0,je.p9)(i);void 0===o&&(o=t.getExternalLabelBounds(a,c)),o&&e.resizeShape(a,o,ko)}}}function Ro(e){return!e||!e.trim()}function Bo(e,t,n,i){po.A.call(this,e,t,n),this._bpmnRules=i}Po.$inject=["modeling","textRenderer","bpmnFactory"],(0,i.A)(Bo,po.A),Bo.$inject=["eventBus","elementFactory","commandStack","bpmnRules"],Bo.prototype.getHandlers=function(){var e=po.A.prototype.getHandlers.call(this);return e["element.updateModdleProperties"]=lo,e["element.updateProperties"]=vo,e["canvas.updateRoot"]=Eo,e["lane.add"]=xo,e["lane.resize"]=_o,e["lane.split"]=wo,e["lane.updateRefs"]=Co,e["id.updateClaim"]=No,e["element.setColor"]=Do,e["element.updateLabel"]=Po,e},Bo.prototype.updateLabel=function(e,t,n,i){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t,newBounds:n,hints:i||{}})},Bo.prototype.connect=function(e,t,n,i){var a=this._bpmnRules;if(n||(n=a.canConnect(e,t)),n)return this.createConnection(e,t,n,e.parent,i)},Bo.prototype.updateModdleProperties=function(e,t,n){this._commandStack.execute("element.updateModdleProperties",{element:e,moddleElement:t,properties:n})},Bo.prototype.updateProperties=function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})},Bo.prototype.resizeLane=function(e,t,n){this._commandStack.execute("lane.resize",{shape:e,newBounds:t,balanced:n})},Bo.prototype.addLane=function(e,t){var n={shape:e,location:t};return this._commandStack.execute("lane.add",n),n.newLane},Bo.prototype.splitLane=function(e,t){this._commandStack.execute("lane.split",{shape:e,count:t})},Bo.prototype.makeCollaboration=function(){var e=this._create("root",{type:"bpmn:Collaboration"}),t={newRoot:e};return this._commandStack.execute("canvas.updateRoot",t),e},Bo.prototype.makeProcess=function(){var e=this._create("root",{type:"bpmn:Process"}),t={newRoot:e};return this._commandStack.execute("canvas.updateRoot",t),e},Bo.prototype.updateLaneRefs=function(e,t){this._commandStack.execute("lane.updateRefs",{flowNodeShapes:e,laneShapes:t})},Bo.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})},Bo.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})},Bo.prototype.setColor=function(e,t){e.length||(e=[e]),this._commandStack.execute("element.setColor",{elements:e,colors:t})};var Mo=n(57905),Io=n(71711),Fo=Math.round,jo={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function Oo(e,t,n){var i,a,r,o=(0,st.vc)(t,e,5),s=n.split(":")[0],c=Fo((t.x-e.x)/2+e.x),p=Fo((t.y-e.y)/2+e.y),l=(r=o,{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[s].test(r)),m=/h|r|l/.test(s),u=!1,d=!1;return l?(i=m?{x:c,y:e.y}:{x:e.x,y:p},a=m?"h:h":"v:v"):(u=function(e,t){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[t].test(e)}(o,s),a=m?"h:v":"v:h",u?m?(d=p===e.y,i={x:e.x+20*(/l/.test(s)?-1:1),y:d?p+20:p}):i={x:(d=c===e.x)?c+20:c,y:e.y+20*(/t/.test(s)?-1:1)}:i={x:c,y:p}),{waypoints:$o(e,i,a).concat(i),directions:a,turnNextDirections:d}}function Lo(e){return e.split(":").reverse().join(":")}function $o(e,t,n){if(!function(e){return e&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(e)}(n=n||"h:h"))throw new Error("unknown directions: <"+n+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(Ho(n)){var i=function(e,t,n){return Oo(e,t,n)}(e,t,n),a=function(e,t,n){var i=Oo(t,e,Lo(n));return{waypoints:i.waypoints.slice().reverse(),directions:Lo(i.directions),turnNextDirections:i.turnNextDirections}}(e,t,n),r=function(e,t){var n=e.directions.split(":")[1],i=t.directions.split(":")[0];e.turnNextDirections&&(n="h"==n?"v":"h"),t.turnNextDirections&&(i="h"==i?"v":"h");var a=n+":"+i;return{waypoints:$o(e.waypoints[e.waypoints.length-1],t.waypoints[0],a),directions:a}}(i,a);return[].concat(i.waypoints,r.waypoints,a.waypoints)}return function(e,t,n){var i=Fo((t.x-e.x)/2+e.x),a=Fo((t.y-e.y)/2+e.y);if("h:v"===n)return[{x:t.x,y:e.y}];if("v:h"===n)return[{x:e.x,y:t.y}];if("h:h"===n)return[{x:i,y:e.y},{x:i,y:t.y}];if("v:v"===n)return[{x:e.x,y:a},{x:t.x,y:a}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}(e,t,n)}function zo(e,t,n,i,a,r){var o;return(0,l.isArray)(n)&&(a=n,r=i,n=(0,st.pp)(e),i=(0,st.pp)(t)),a=a||[],o=-1!==(r=(0,l.assign)({preferredLayouts:[]},r)).preferredLayouts.indexOf("straight")&&function(e,t,n,i,a){var r,o,s={};return o=(0,st.vc)(e,t),/^(top|bottom|left|right)$/.test(o)?(/top|bottom/.test(o)&&(r="x"),/left|right/.test(o)&&(r="y"),"target"===a.preserveDocking?Vo(r,i,e)?(s[r]=i[r],[{x:void 0!==s.x?s.x:n.x,y:void 0!==s.y?s.y:n.y,original:{x:void 0!==s.x?s.x:n.x,y:void 0!==s.y?s.y:n.y}},{x:i.x,y:i.y}]):null:Vo(r,n,t)?(s[r]=n[r],[{x:n.x,y:n.y},{x:void 0!==s.x?s.x:i.x,y:void 0!==s.y?s.y:i.y,original:{x:void 0!==s.x?s.x:i.x,y:void 0!==s.y?s.y:i.y}}]):null):null}(e,t,n,i,r),o||(o=r.connectionEnd&&function(e,t,n,i){var a=i.slice().reverse();return(a=Go(e,t,n,a))?a.reverse():null}(t,e,i,a),o||(o=r.connectionStart&&Go(e,t,n,a))||(!r.connectionStart&&!r.connectionEnd&&a&&a.length?a:function(e,t,n,i,a){var r=a&&a.preferredLayouts||[],o=(0,l.without)(r,"straight")[0]||"h:h",s=jo[o]||0,c=(0,st.vc)(e,t,s),p=function(e,t){if(Ho(t))return t;switch(e){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return t}}(c,o);n=n||(0,st.pp)(e),i=i||(0,st.pp)(t);var m=p.split(":"),u=Wo(n,e,m[0],function(e){return{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[e]}(c));return function(e,t,n){var i=$o(e,t,n);return i.unshift(e),i.push(t),Uo(i)}(u,Wo(i,t,m[1],c),p)}(e,t,n,i,r)))}function Vo(e,t,n){return function(e,t,n){return e>=t&&e<=n}(t[e],n[e],n[e]+n[{x:"width",y:"height"}[e]])}function Go(e,t,n,i){if(function(e){return e.length<3||!(e.length>4)&&!!(0,l.find)(e,function(t,n){var i=e[n-1];return i&&(0,Io.cK)(t,i)<3})}(i))return null;var a,r=i[0],o=i.slice();return o[0]=n,o[1]=function(e,t,n){switch((0,Io.ke)(t,e)){case"v":return{x:n.x,y:e.y};case"h":return{x:e.x,y:n.y}}return{x:e.x,y:e.y}}(o[1],r,n),a=function(e,t,n){var i;for(i=e.length-2;0!==i;i--)if((0,Io.El)(e[i],t,20)||(0,Io.El)(e[i],n,20))return e.slice(i);return e}(o,e,t),a!==o&&(o=Go(e,t,n,a)),o&&(0,Io.ke)(o)?null:o}function Ho(e){return e&&/t|r|b|l/.test(e)}function Wo(e,t,n,i){if("h"===n&&(n=/left/.test(i)?"l":"r"),"v"===n&&(n=/top/.test(i)?"t":"b"),"t"===n)return{original:e,x:e.x,y:t.y};if("r"===n)return{original:e,x:t.x+t.width,y:e.y};if("b"===n)return{original:e,x:e.x,y:t.y+t.height};if("l"===n)return{original:e,x:t.x,y:e.y};throw new Error("unexpected dockingDirection: <"+n+">")}function Uo(e){return e.reduce(function(t,n,i){var a=t[t.length-1],r=e[i+1];return(0,Io.XP)(a,r,n,0)||t.push(n),t},[])}var Ko={default:["h:h"],fromGateway:["v:h"],toGateway:["h:v"],loop:{fromTop:["t:r"],fromRight:["r:b"],fromLeft:["l:t"],fromBottom:["b:l"]},boundaryLoop:{alternateHorizontalSide:"b",alternateVerticalSide:"l",default:"v"},messageFlow:["straight","v:v"],subProcess:["straight","h:h"],isHorizontal:!0},qo={default:["v:v"],fromGateway:["h:v"],toGateway:["v:h"],loop:{fromTop:["t:l"],fromRight:["r:t"],fromLeft:["l:b"],fromBottom:["b:r"]},boundaryLoop:{alternateHorizontalSide:"t",alternateVerticalSide:"r",default:"h"},messageFlow:["straight","h:h"],subProcess:["straight","v:v"],isHorizontal:!1},Jo={top:"bottom","top-right":"bottom-left","top-left":"bottom-right",right:"left",bottom:"top","bottom-right":"top-left","bottom-left":"top-right",left:"right"},Xo={top:"t",right:"r",bottom:"b",left:"l"};function Yo(e){this._elementRegistry=e}function Qo(e,t){return(0,be.is)(t,"bpmn:Participant")?"source":(0,be.is)(e,"bpmn:Participant")?"target":ns(t)?"source":ns(e)||(0,be.is)(t,"bpmn:Event")?"target":(0,be.is)(e,"bpmn:Event")?"source":null}function Zo(e){return ns(e)?"target":"source"}function es(e,t){return e?e.original||e:(0,st.pp)(t)}function ts(e,t){return(0,be.is)(t,"bpmn:Activity")&&(0,be.is)(e,"bpmn:BoundaryEvent")&&t.businessObject.isForCompensation}function ns(e){return(0,be.is)(e,"bpmn:SubProcess")&&(0,Fe.Av)(e)}function is(e,t){return e===t}function as(e){var t=/right|left/.exec(e);return t&&t[0]}function rs(e){var t=/top|bottom/.exec(e);return t&&t[0]}function os(e,t){return Jo[e]===t}function ss(e){return"right"===e||"left"===e}function cs(e,t,n){var i=t.waypoints,a=i&&i.length&&(0,st.vc)(i[0],e);return"top"===a?n.loop.fromTop:"right"===a?n.loop.fromRight:"left"===a?n.loop.fromLeft:n.loop.fromBottom}function ps(e,t,n,i){var a,r,o,s,c=(0,st.pp)(e),p=(0,st.pp)(t),l=(s=(o=e).host,(0,st.vc)((0,st.pp)(o),s,-10)),m=is(e.host,t),u=-1!==["top","right","bottom","left"].indexOf(l),d=(0,st.vc)(p,c,{x:e.width/2+t.width/2,y:e.height/2+t.height/2});return m?function(e,t,n,i,a,r){var o=t?e:r.isHorizontal?rs(e):as(e);return[Xo[o]+":"+(t?ss(e)?ls("y",n,i,a)?"h":r.boundaryLoop.alternateHorizontalSide:ls("x",n,i,a)?"v":r.boundaryLoop.alternateVerticalSide:r.boundaryLoop.default)]}(l,u,e,t,n,i):(a=function(e,t,n,i){if(n)return Xo[e];var a=rs(e),r=as(e),o=rs(t),s=as(t);if(i){if(is(a,o)||os(r,s))return Xo[a]}else if(is(r,s)||os(a,o))return Xo[r];return Xo[i?r:a]}(l,d,u,i.isHorizontal),r=function(e,t,n,i){return n?ss(e)?(a=t,r=as(e),o=Jo[r],-1!==a.indexOf(o)||is(e,t)?"h":"v"):function(e,t){var n=rs(e),i=Jo[n];return-1!==t.indexOf(i)}(e,t)||is(e,t)?"v":"h":i?is(rs(e),rs(t))?"h":"v":is(as(e),as(t))?"v":"h";var a,r,o}(l,d,u,i.isHorizontal),[a+":"+r])}function ls(e,t,n,i){return!(ms(e,i,n,40)||ms(e,i,{x:n.x+n.width,y:n.y+n.height},40)||ms(e,i,(0,st.pp)(t),40))}function ms(e,t,n,i){return Math.abs(t[e]-n[e])<i}(0,i.A)(Yo,Mo.A),Yo.prototype.layoutConnection=function(e,t){t||(t={});var n,i,a=t.source||e.source,r=t.target||e.target,o=t.waypoints||e.waypoints,s=t.connectionStart,c=t.connectionEnd,p=this._elementRegistry;if(s||(s=es(o&&o[0],a)),c||(c=es(o&&o[o.length-1],r)),((0,be.is)(e,"bpmn:Association")||(0,be.is)(e,"bpmn:DataAssociation"))&&o&&!ts(a,r))return[].concat([s],o.slice(1,-1),[c]);var m=Kt(a,p)?Ko:qo;return(0,be.is)(e,"bpmn:MessageFlow")?n=function(e,t,n){return{preferredLayouts:n.messageFlow,preserveDocking:Qo(e,t)}}(a,r,m):((0,be.is)(e,"bpmn:SequenceFlow")||ts(a,r))&&(n=a===r?{preferredLayouts:cs(a,e,m)}:(0,be.is)(a,"bpmn:BoundaryEvent")?{preferredLayouts:ps(a,r,c,m)}:ns(a)||ns(r)?{preferredLayouts:m.subProcess,preserveDocking:Zo(a)}:(0,be.is)(a,"bpmn:Gateway")?{preferredLayouts:m.fromGateway}:(0,be.is)(r,"bpmn:Gateway")?{preferredLayouts:m.toGateway}:{preferredLayouts:m.default}),n&&(i=Uo(zo(a,r,s,c,o,n=(0,l.assign)(n,t)))),i||[s,c]},Yo.$inject=["elementRegistry"];var us=n(10270);const ds={__init__:["modeling","bpmnUpdater"],__depends__:[Ea,tr,ir,or,Cr,qr.A,Qr,no,Tt.A,ht.A,Kr],bpmnFactory:["type",io],bpmnUpdater:["type",ao],elementFactory:["type",so],modeling:["type",Bo],layouter:["type",Yo],connectionDocking:["type",us.A]},hs=Math.round;function fs(e,t,n,i,a,r){this._complexPreview=e,this._connectionDocking=t,this._elementFactory=n,this._eventBus=i,this._layouter=a,this._rules=r}fs.prototype.create=function(e,t,n){const i=this._complexPreview,a=this._connectionDocking,r=this._elementFactory,o=this._eventBus,s=this._layouter,c=this._rules,p=r.createShape((0,l.assign)({type:t},n)),m=o.fire("autoPlace",{source:e,shape:p});if(!m)return;(0,l.assign)(p,{x:m.x-hs(p.width/2),y:m.y-hs(p.height/2)});const u=c.allowed("connection.create",{source:e,target:p,hints:{targetParent:e.parent}});let d=null;u&&(d=r.createConnection(u),d.waypoints=s.layoutConnection(d,{source:e,target:p}),d.waypoints=a.getCroppedWaypoints(d,e,p)),i.create({created:[p,d].filter(e=>!(0,l.isNil)(e))})},fs.prototype.cleanUp=function(){this._complexPreview.cleanUp()},fs.$inject=["complexPreview","connectionDocking","elementFactory","eventBus","layouter","rules"];const vs={__depends__:[Qt,dn,ds],__init__:["appendPreview"],appendPreview:["type",fs]};var gs=n(75560),ys=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],bs=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}],Es=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message intermediate catch event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate throw event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer intermediate catch event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation intermediate throw event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional intermediate catch event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link intermediate catch event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link intermediate throw event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation intermediate throw event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal intermediate catch event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate throw event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],xs=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message end event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation end event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error end event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel end event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation end event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal end event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate end event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],ws=[{label:"Exclusive gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event-based gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],_s=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Ad-hoc sub-process",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}},{label:"Sub-process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}}],Ss=[{label:"Sub-process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Ad-hoc sub-process (collapsed)",actionName:"replace-with-collapsed-ad-hoc-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:AdHocSubProcess",isExpanded:!1}}],As=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Sub-process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Ad-hoc sub-process",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}}],Cs=As,Ns=[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"User task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Service task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Send task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"Manual task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business rule task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Script task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub-process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub-process (expanded)",actionName:"replace-with-expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Ad-hoc sub-process (collapsed)",actionName:"replace-with-collapsed-ad-hoc-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:AdHocSubProcess",isExpanded:!1}},{label:"Ad-hoc sub-process (expanded)",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}}],Ts=[{label:"Data store reference",actionName:"replace-with-data-store-reference",className:"bpmn-icon-data-store",target:{type:"bpmn:DataStoreReference"}}],Ds=[{label:"Data object reference",actionName:"replace-with-data-object-reference",className:"bpmn-icon-data-object",target:{type:"bpmn:DataObjectReference"}}],ks=[{label:"Message boundary event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!0}},{label:"Timer boundary event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!0}},{label:"Escalation boundary event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!0}},{label:"Conditional boundary event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!0}},{label:"Error boundary event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",cancelActivity:!0}},{label:"Cancel boundary event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition",cancelActivity:!0}},{label:"Signal boundary event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!0}},{label:"Compensation boundary event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",cancelActivity:!0}},{label:"Message boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],Ps=[{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!0}},{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!0}},{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!0}},{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!0}},{label:"Error start event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",isInterrupting:!0}},{label:"Escalation start event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!0}},{label:"Compensation start event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",isInterrupting:!0}},{label:"Message start event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer start event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional start event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal start event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation start event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],Rs=[{label:"Sequence flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],Bs=[{label:"Expanded pool/participant",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:function(e){var t="Empty pool/participant";return e.children&&e.children.length&&(t+=" (removes content)"),t},actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}],Ms={"bpmn:MessageEventDefinition":[{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate catch event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate throw event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message end event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}}],"bpmn:TimerEventDefinition":[{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Timer intermediate catch event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}}],"bpmn:ConditionalEventDefinition":[{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Conditional intermediate catch event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}}],"bpmn:SignalEventDefinition":[{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate catch event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate throw event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal end event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],"bpmn:ErrorEventDefinition":[{label:"Error start event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Error end event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}}],"bpmn:EscalationEventDefinition":[{label:"Escalation start event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Escalation intermediate throw event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Escalation end event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}}],"bpmn:CompensateEventDefinition":[{label:"Compensation start event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Compensation intermediate throw event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Compensation end event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}}]};const Is='\n  <svg viewBox="0 0 2048 2048" xmlns="http://www.w3.org/2000/svg">\n    <g transform="translate(0 995.64)">\n      <path d="m1899 28.357c21.545 567.43-598.38 1023.5-1133.6 835.92-548.09-147.21-801.57-873.95-463.59-1330 302.62-480.3 1071.7-507.54 1407.6-49.847 122.14 153.12 190.07 348.07 189.59 543.91z" fill="none" stroke="currentColor" stroke-dasharray="418.310422, 361.2328165" stroke-linecap="round" stroke-width="100"/>\n    </g>\n  </svg>',Fs='\n  <svg viewBox="0 0 2048 2048" xmlns="http://www.w3.org/2000/svg">\n     <g transform="translate(0 995.64)" fill="none" stroke="currentColor" stroke-linecap="round">\n        <circle cx="1024" cy="28.357" r="875" stroke-dasharray="418.310422, 361.2328165" stroke-width="100"/>\n        <circle cx="1024" cy="28.357" r="685" stroke-dasharray="348.31044857,261.23283643" stroke-dashoffset="500" stroke-width="100"/>\n     </g>\n  </svg>';function js(e,t,n,i,a,r,o,s){this._bpmnFactory=e,this._popupMenu=t,this._modeling=n,this._moddle=i,this._bpmnReplace=a,this._rules=r,this._translate=o,this._moddleCopy=s,this._register()}js.$inject=["bpmnFactory","popupMenu","modeling","moddle","bpmnReplace","rules","translate","moddleCopy"],js.prototype._register=function(){this._popupMenu.registerProvider("bpmn-replace",this)},js.prototype.getPopupMenuEntries=function(e){var t,n=e.businessObject,i=this._rules,a=[],r=[];if((0,l.isArray)(e)||!i.allowed("shape.replace",{element:e}))return{};var o,s=(o=e,function(e){var t=e.target,n=(0,be.Cf)(o),i=n.eventDefinitions&&n.eventDefinitions[0],a=n.$type===t.type,r=(i&&i.$type)===t.eventDefinitionType,s=!!t.triggeredByEvent==!!n.triggeredByEvent,c=void 0===t.isExpanded||t.isExpanded===(0,Fe.Av)(o);return!(a&&r&&s&&c)});return(0,be.is)(n,"bpmn:DataObjectReference")?this._createEntries(e,Ts):(0,be.is)(n,"bpmn:DataStoreReference")&&!(0,be.is)(e.parent,"bpmn:Collaboration")?this._createEntries(e,Ds):((0,be.is)(n,"bpmn:Event")&&!(0,be.is)(n,"bpmn:BoundaryEvent")&&(t=n.get("eventDefinitions")[0]?.$type,a=Ms[t]||[],!(0,Fe.Q1)(n.$parent)&&(0,be.is)(n.$parent,"bpmn:SubProcess")&&(a=(0,l.filter)(a,function(e){return"bpmn:StartEvent"!==e.target.type}))),(0,be.is)(n,"bpmn:StartEvent")&&!(0,be.is)(n.$parent,"bpmn:SubProcess")?(r=(0,l.filter)(ys.concat(a),s),this._createEntries(e,r)):(0,be.is)(n,"bpmn:Participant")?(r=(0,l.filter)(Bs,function(t){return(0,Fe.Av)(e)!==t.target.isExpanded}),this._createEntries(e,r)):(0,be.is)(n,"bpmn:StartEvent")&&(0,Fe.Q1)(n.$parent)?(r=(0,l.filter)(Ps.concat(a),function(e){var t=!1!==e.target.isInterrupting,i=n.isInterrupting===t;return s(e)||!s(e)&&!i}),this._createEntries(e,r)):(0,be.is)(n,"bpmn:StartEvent")&&!(0,Fe.Q1)(n.$parent)&&(0,be.is)(n.$parent,"bpmn:SubProcess")?(r=(0,l.filter)(bs.concat(a),s),this._createEntries(e,r)):(0,be.is)(n,"bpmn:EndEvent")?(r=(0,l.filter)(xs.concat(a),function(e){return!("bpmn:CancelEventDefinition"==e.target.eventDefinitionType&&!(0,be.is)(n.$parent,"bpmn:Transaction"))&&s(e)}),this._createEntries(e,r)):(0,be.is)(n,"bpmn:BoundaryEvent")?(r=(0,l.filter)(ks,function(e){var t=e.target;if("bpmn:CancelEventDefinition"==t.eventDefinitionType&&!(0,be.is)(n.attachedToRef,"bpmn:Transaction"))return!1;var i=!1!==t.cancelActivity,a=n.cancelActivity==i;return s(e)||!s(e)&&!a}),this._createEntries(e,r)):(0,be.is)(n,"bpmn:IntermediateCatchEvent")||(0,be.is)(n,"bpmn:IntermediateThrowEvent")?(r=(0,l.filter)(Es.concat(a),s),this._createEntries(e,r)):(0,be.is)(n,"bpmn:Gateway")?(r=(0,l.filter)(ws,s),this._createEntries(e,r)):(0,be.is)(n,"bpmn:Transaction")?(r=(0,l.filter)(As,s),this._createEntries(e,r)):(0,Fe.Q1)(n)&&(0,Fe.Av)(e)?(r=(0,l.filter)(Cs,s),this._createEntries(e,r)):(0,be.is)(n,"bpmn:AdHocSubProcess")&&(0,Fe.Av)(e)?(r=(0,l.filter)(Ss,s),this._createEntries(e,r)):(0,be.is)(n,"bpmn:SubProcess")&&(0,Fe.Av)(e)?(r=(0,l.filter)(_s,s),this._createEntries(e,r)):(0,be.is)(n,"bpmn:SubProcess")&&!(0,Fe.Av)(e)?(r=(0,l.filter)(Ns,function(t){return t.target.type===e.type==(!0===t.target.isExpanded)}),this._createEntries(e,r)):(0,be.is)(n,"bpmn:SequenceFlow")?this._createSequenceFlowEntries(e,Rs):(0,be.is)(n,"bpmn:FlowNode")?(r=(0,l.filter)(Ns,s),this._createEntries(e,r)):{})},js.prototype.getPopupMenuHeaderEntries=function(e){var t={};return(0,be.is)(e,"bpmn:Activity")&&!(0,Fe.Q1)(e)&&(t={...t,...this._getLoopCharacteristicsHeaderEntries(e)}),(0,be.is)(e,"bpmn:DataObjectReference")&&(t={...t,...this._getCollectionHeaderEntries(e)}),(0,be.is)(e,"bpmn:Participant")&&(t={...t,...this._getParticipantMultiplicityHeaderEntries(e)}),Di(e)&&(t={...t,...this._getNonInterruptingHeaderEntries(e)}),t},js.prototype._createEntries=function(e,t){var n={},i=this;return(0,l.forEach)(t,function(t){n[t.actionName]=i._createEntry(t,e)}),n},js.prototype._createSequenceFlowEntries=function(e,t){var n=(0,be.Cf)(e),i={},a=this._modeling,r=this._moddle,o=this;return(0,l.forEach)(t,function(t){switch(t.actionName){case"replace-with-default-flow":n.sourceRef.default!==n&&((0,be.is)(n.sourceRef,"bpmn:ExclusiveGateway")||(0,be.is)(n.sourceRef,"bpmn:InclusiveGateway")||(0,be.is)(n.sourceRef,"bpmn:ComplexGateway")||(0,be.is)(n.sourceRef,"bpmn:Activity"))&&(i={...i,[t.actionName]:o._createEntry(t,e,function(){a.updateProperties(e.source,{default:n})})});break;case"replace-with-conditional-flow":!n.conditionExpression&&(0,be.is)(n.sourceRef,"bpmn:Activity")&&(i={...i,[t.actionName]:o._createEntry(t,e,function(){var t=r.create("bpmn:FormalExpression",{body:""});a.updateProperties(e,{conditionExpression:t})})});break;default:(0,be.is)(n.sourceRef,"bpmn:Activity")&&n.conditionExpression&&(i={...i,[t.actionName]:o._createEntry(t,e,function(){a.updateProperties(e,{conditionExpression:void 0})})}),((0,be.is)(n.sourceRef,"bpmn:ExclusiveGateway")||(0,be.is)(n.sourceRef,"bpmn:InclusiveGateway")||(0,be.is)(n.sourceRef,"bpmn:ComplexGateway")||(0,be.is)(n.sourceRef,"bpmn:Activity"))&&n.sourceRef.default===n&&(i={...i,[t.actionName]:o._createEntry(t,e,function(){a.updateProperties(e.source,{default:void 0})})})}}),i},js.prototype._createEntry=function(e,t,n){var i=this._translate,a=this._bpmnReplace.replaceElement,r=e.label;return r&&"function"==typeof r&&(r=r(t)),n=n||function(){return a(t,e.target)},{label:i(r),className:e.className,action:n}},js.prototype._getLoopCharacteristicsHeaderEntries=function(e){var t=this,n=this._translate;function i(n,i){if(i.active)t._modeling.updateProperties(e,{loopCharacteristics:void 0});else{var a=e.businessObject.get("loopCharacteristics");a&&(0,be.is)(a,i.options.loopCharacteristics)?t._modeling.updateModdleProperties(e,a,{isSequential:i.options.isSequential}):(a=t._moddle.create(i.options.loopCharacteristics,{isSequential:i.options.isSequential}),t._modeling.updateProperties(e,{loopCharacteristics:a}))}}var a,r,o,s=(0,be.Cf)(e).loopCharacteristics;return s&&(a=s.isSequential,r=void 0===s.isSequential,o=void 0!==s.isSequential&&!s.isSequential),{"toggle-parallel-mi":{className:"bpmn-icon-parallel-mi-marker",title:n("Parallel multi-instance"),active:o,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!1}},"toggle-sequential-mi":{className:"bpmn-icon-sequential-mi-marker",title:n("Sequential multi-instance"),active:a,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!0}},"toggle-loop":{className:"bpmn-icon-loop-marker",title:n("Loop"),active:r,action:i,options:{loopCharacteristics:"bpmn:StandardLoopCharacteristics"}}}},js.prototype._getCollectionHeaderEntries=function(e){var t=this,n=this._translate,i=e.businessObject.dataObjectRef;if(!i)return{};var a=i.isCollection;return{"toggle-is-collection":{className:"bpmn-icon-parallel-mi-marker",title:n("Collection"),active:a,action:function(n,a){t._modeling.updateModdleProperties(e,i,{isCollection:!a.active})}}}},js.prototype._getParticipantMultiplicityHeaderEntries=function(e){var t=this,n=this._bpmnFactory,i=this._translate,a=e.businessObject.participantMultiplicity;return{"toggle-participant-multiplicity":{className:"bpmn-icon-parallel-mi-marker",title:i("Participant multiplicity"),active:!!a,action:function(i,a){var r;a.active||(r=n.create("bpmn:ParticipantMultiplicity")),t._modeling.updateProperties(e,{participantMultiplicity:r})}}}},js.prototype._getNonInterruptingHeaderEntries=function(e){const t=this._translate,n=(0,be.Cf)(e),i=this,a=ki(e),r=(0,be.is)(e,"bpmn:BoundaryEvent")?Fs:Is,o=!n[a];return{"toggle-non-interrupting":{imageHtml:r,title:t("Toggle non-interrupting"),active:o,action:function(){i._modeling.updateProperties(e,{[a]:!!o})}}}};const Os={__depends__:[Ft.A,Cr,Qt],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",js]};function Ls(e,t,n,i,a,r,o,s,c,p,l,m,u){e=e||{},i.registerProvider(this),this._contextPad=i,this._modeling=a,this._elementFactory=r,this._connect=o,this._create=s,this._popupMenu=c,this._canvas=p,this._rules=l,this._translate=m,this._eventBus=n,this._appendPreview=u,!1!==e.autoPlace&&(this._autoPlace=t.get("autoPlace",!1)),n.on("create.end",250,function(e){var t=e.context.shape;if((0,ea.Io)(e)&&i.isOpen(t)){var n=i.getEntries(t);n.replace&&n.replace.action.click(e,t)}}),n.on("contextPad.close",function(){u.cleanUp()})}function $s(e,t,n){var i=e.$instanceOf(t),a=!1,r=e.eventDefinitions||[];return(0,l.forEach)(r,function(e){e.$type===n&&(a=!0)}),i&&a}Ls.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate","appendPreview"],Ls.prototype.getMultiElementContextPadEntries=function(e){var t=this._modeling,n={};return this._isDeleteAllowed(e)&&(0,l.assign)(n,{delete:{group:"edit",className:"bpmn-icon-trash",title:this._translate("Delete"),action:{click:function(e,n){t.removeElements(n.slice())}}}}),n},Ls.prototype._isDeleteAllowed=function(e){var t=this._rules.allowed("elements.delete",{elements:e});return(0,l.isArray)(t)?(0,l.every)(e,e=>t.includes(e)):t},Ls.prototype.getContextPadEntries=function(e){var t=this._contextPad,n=this._modeling,i=this._elementFactory,a=this._connect,r=this._create,o=this._popupMenu,s=this._autoPlace,c=this._translate,p=this._appendPreview,m={};if("label"===e.type)return this._isDeleteAllowed([e])&&(0,l.assign)(m,f()),m;var u=e.businessObject;function d(e,t){a.start(e,t)}function h(e,t){n.removeElements([t])}function f(){return{delete:{group:"edit",className:"bpmn-icon-trash",title:c("Delete"),action:{click:h}}}}function v(e,t,n,a){function o(t,n){var o=i.createShape((0,l.assign)({type:e},a));r.start(t,o,{source:n})}var c=s?function(t,n){var r=i.createShape((0,l.assign)({type:e},a));s.append(n,r)}:o,m=s?function(t,n){return p.create(n,e,a),()=>{p.cleanUp()}}:null;return{group:"model",className:t,title:n,action:{dragstart:o,click:c,hover:m}}}function g(e){return function(i,a){n.splitLane(a,e),t.open(a,!0)}}if((0,be.f7)(u,["bpmn:Lane","bpmn:Participant"])&&(0,Fe.Av)(e)){var y=Vn(e);(0,l.assign)(m,{"lane-insert-above":{group:"lane-insert-above",className:"bpmn-icon-lane-insert-above",title:c("Add lane above"),action:{click:function(e,t){n.addLane(t,"top")}}}}),y.length<2&&(((0,Fe.$b)(e)?e.height>=120:e.width>=120)&&(0,l.assign)(m,{"lane-divide-two":{group:"lane-divide",className:"bpmn-icon-lane-divide-two",title:c("Divide into two lanes"),action:{click:g(2)}}}),((0,Fe.$b)(e)?e.height>=180:e.width>=180)&&(0,l.assign)(m,{"lane-divide-three":{group:"lane-divide",className:"bpmn-icon-lane-divide-three",title:c("Divide into three lanes"),action:{click:g(3)}}})),(0,l.assign)(m,{"lane-insert-below":{group:"lane-insert-below",className:"bpmn-icon-lane-insert-below",title:c("Add lane below"),action:{click:function(e,t){n.addLane(t,"bottom")}}}})}return(0,be.is)(u,"bpmn:FlowNode")&&((0,be.is)(u,"bpmn:EventBasedGateway")?(0,l.assign)(m,{"append.receive-task":v("bpmn:ReceiveTask","bpmn-icon-receive-task",c("Append receive task")),"append.message-intermediate-event":v("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-message",c("Append message intermediate catch event"),{eventDefinitionType:"bpmn:MessageEventDefinition"}),"append.timer-intermediate-event":v("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-timer",c("Append timer intermediate catch event"),{eventDefinitionType:"bpmn:TimerEventDefinition"}),"append.condition-intermediate-event":v("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-condition",c("Append conditional intermediate catch event"),{eventDefinitionType:"bpmn:ConditionalEventDefinition"}),"append.signal-intermediate-event":v("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-signal",c("Append signal intermediate catch event"),{eventDefinitionType:"bpmn:SignalEventDefinition"})}):$s(u,"bpmn:BoundaryEvent","bpmn:CompensateEventDefinition")?(0,l.assign)(m,{"append.compensation-activity":v("bpmn:Task","bpmn-icon-task",c("Append compensation activity"),{isForCompensation:!0})}):(0,be.is)(u,"bpmn:EndEvent")||u.isForCompensation||$s(u,"bpmn:IntermediateThrowEvent","bpmn:LinkEventDefinition")||(0,Fe.Q1)(u)||(0,l.assign)(m,{"append.end-event":v("bpmn:EndEvent","bpmn-icon-end-event-none",c("Append end event")),"append.gateway":v("bpmn:ExclusiveGateway","bpmn-icon-gateway-none",c("Append gateway")),"append.append-task":v("bpmn:Task","bpmn-icon-task",c("Append task")),"append.intermediate-event":v("bpmn:IntermediateThrowEvent","bpmn-icon-intermediate-event-none",c("Append intermediate/boundary event"))})),o.isEmpty(e,"bpmn-replace")||(0,l.assign)(m,{replace:{group:"edit",className:"bpmn-icon-screw-wrench",title:c("Change element"),action:{click:function(e,n){var i=(0,l.assign)(function(e){var n=t.getPad(e).html.getBoundingClientRect();return{x:n.left,y:n.bottom+5}}(n),{cursor:{x:e.x,y:e.y}});o.open(n,"bpmn-replace",i,{title:c("Change element"),width:300,search:!0})}}}}),(0,be.is)(u,"bpmn:SequenceFlow")&&(0,l.assign)(m,{"append.text-annotation":v("bpmn:TextAnnotation","bpmn-icon-text-annotation",c("Add text annotation"))}),(0,be.is)(u,"bpmn:MessageFlow")&&(0,l.assign)(m,{"append.text-annotation":v("bpmn:TextAnnotation","bpmn-icon-text-annotation",c("Add text annotation"))}),(0,be.f7)(u,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])&&(0,l.assign)(m,{"append.text-annotation":v("bpmn:TextAnnotation","bpmn-icon-text-annotation",c("Add text annotation")),connect:{group:"connect",className:"bpmn-icon-connection-multi",title:c("Connect to other element"),action:{click:d,dragstart:d}}}),(0,be.is)(u,"bpmn:TextAnnotation")&&(0,l.assign)(m,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:c("Connect using association"),action:{click:d,dragstart:d}}}),(0,be.f7)(u,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&(0,l.assign)(m,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:c("Connect using data input association"),action:{click:d,dragstart:d}}}),(0,be.is)(u,"bpmn:Group")&&(0,l.assign)(m,{"append.text-annotation":v("bpmn:TextAnnotation","bpmn-icon-text-annotation",c("Add text annotation"))}),this._isDeleteAllowed([e])&&(0,l.assign)(m,f()),m};const zs={__depends__:[vs,gs.A,It.A,Tt.A,sn.A,cr.A,Os],__init__:["contextPadProvider"],contextPadProvider:["type",Ls]};var Vs=n(27855);function Gs(e){zt.A.call(this,e)}Gs.$inject=["eventBus"],(0,i.A)(Gs,zt.A),Gs.prototype.init=function(){this.addRule("elements.distribute",function(e){var t=e.elements;return t=(0,l.filter)(t,function(e){var t=(0,be.f7)(e,["bpmn:Association","bpmn:BoundaryEvent","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:Lane","bpmn:MessageFlow","bpmn:SequenceFlow","bpmn:TextAnnotation"]);return!(e.labelTarget||t)}),!((t=(0,Vt.wT)(t)).length<3)&&t})};const Hs='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">\n                <polyline points="450 400 450 150 1350 150 1350 400" style="fill:none;stroke:currentColor;stroke-width:100;stroke-linejoin:round;"/>\n                <rect x="150" y="450" width="600" height="1200" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n                <rect x="1050" y="450" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n              </svg>',Ws='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">\n              <polyline points="400 1350 150 1350 150 450 400 450" style="fill:none;stroke:currentColor;stroke-width:100;stroke-linejoin:round;"/>\n              <rect x="450" y="150" width="1200" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n              <rect x="450" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n            </svg>';function Us(e,t,n,i){this._distributeElements=t,this._translate=n,this._popupMenu=e,this._rules=i,e.registerProvider("align-elements",900,this)}Us.$inject=["popupMenu","distributeElements","translate","rules"],Us.prototype.getPopupMenuEntries=function(e){var t={};return this._isAllowed(e)&&(0,l.assign)(t,this._getEntries(e)),t},Us.prototype._isAllowed=function(e){return this._rules.allowed("elements.distribute",{elements:e})},Us.prototype._getEntries=function(e){var t=this._distributeElements,n=this._translate,i=this._popupMenu;return{"distribute-elements-horizontal":{group:"distribute",title:n("Distribute elements horizontally"),className:"bjs-align-elements-menu-entry",imageHtml:Hs,action:function(n,a){t.trigger(e,"horizontal"),i.close()}},"distribute-elements-vertical":{group:"distribute",title:n("Distribute elements vertically"),imageHtml:Ws,action:function(n,a){t.trigger(e,"vertical"),i.close()}}}};const Ks={__depends__:[Ft.A,Vs.A],__init__:["bpmnDistributeElements","distributeElementsMenuProvider"],bpmnDistributeElements:["type",Gs],distributeElementsMenuProvider:["type",Us]};var qs=n(88354),Js=n(46622);function Xs(e){e.invoke(Js.A,this)}(0,i.A)(Xs,Js.A),Xs.$inject=["injector"],Xs.prototype._registerDefaultActions=function(e){Js.A.prototype._registerDefaultActions.call(this,e);var t=e.get("canvas",!1),n=e.get("elementRegistry",!1),i=e.get("selection",!1),a=e.get("spaceTool",!1),r=e.get("lassoTool",!1),o=e.get("handTool",!1),s=e.get("globalConnect",!1),c=e.get("distributeElements",!1),p=e.get("alignElements",!1),m=e.get("directEditing",!1),u=e.get("searchPad",!1),d=e.get("modeling",!1),h=e.get("contextPad",!1);t&&n&&i&&this._registerAction("selectElements",function(){var e=t.getRootElement(),a=n.filter(function(t){return t!==e});return i.select(a),a}),a&&this._registerAction("spaceTool",function(){a.toggle()}),r&&this._registerAction("lassoTool",function(){r.toggle()}),o&&this._registerAction("handTool",function(){o.toggle()}),s&&this._registerAction("globalConnectTool",function(){s.toggle()}),i&&c&&this._registerAction("distributeElements",function(e){var t=i.get(),n=e.type;t.length&&c.trigger(t,n)}),i&&p&&this._registerAction("alignElements",function(e){var t=i.get(),n=[],a=e.type;t.length&&(n=(0,l.filter)(t,function(e){return!(0,be.is)(e,"bpmn:Lane")}),p.trigger(n,a))}),i&&d&&this._registerAction("setColor",function(e){var t=i.get();t.length&&d.setColor(t,e)}),i&&m&&this._registerAction("directEditing",function(){var e=i.get();e.length&&m.activate(e[0])}),u&&this._registerAction("find",function(){u.toggle()}),t&&d&&this._registerAction("moveToOrigin",function(){var e,i,a=t.getRootElement();i=(0,be.is)(a,"bpmn:Collaboration")?n.filter(function(e){return(0,be.is)(e.parent,"bpmn:Collaboration")}):n.filter(function(e){return e!==a&&!(0,be.is)(e.parent,"bpmn:SubProcess")}),e=(0,Vt.U7)(i),d.moveElements(i,{x:-e.x,y:-e.y},a)}),i&&h&&this._registerAction("replaceElement",function(e){h.triggerEntry("replace","click",e)})};const Ys={__depends__:[qs.A],editorActions:["type",Xs]};function Qs(e){e.on(["create.init","shape.move.init"],function(e){var t=e.context,n=e.shape;(0,be.f7)(n,["bpmn:Participant","bpmn:SubProcess","bpmn:TextAnnotation"])&&(t.gridSnappingContext||(t.gridSnappingContext={}),t.gridSnappingContext.snapLocation="top-left")})}Qs.$inject=["eventBus"];var Zs=n(54964);function ec(e,t,n){e.on("autoPlace",2e3,function(e){var i=e.source,a=(0,st.pp)(i),r=e.shape,o=Jt(i,r,n);return["x","y"].forEach(function(e){var n={};o[e]!==a[e]&&(o[e]>a[e]?n.min=o[e]:n.max=o[e],(0,be.is)(r,"bpmn:TextAnnotation")&&(function(e){return"x"===e}(e)?n.offset=-r.width/2:n.offset=-r.height/2),o[e]=t.snapValue(o[e],n))}),o})}function tc(e,t,n){t.on(["create.start","shape.move.start"],1750,function(t){var i=t.context,a=i.shape,r=e.getRootElement();(0,be.is)(a,"bpmn:Participant")&&(0,be.is)(r,"bpmn:Process")&&r.children.length&&i.createConstraints&&(a.width=n.snapValue(a.width,{min:a.width}),a.height=n.snapValue(a.height,{min:a.height}))})}function nc(e,t,n){ft.A.call(this,e),this._gridSnapping=t;var i=this;this.postExecuted(["connection.create","connection.layout"],3e3,function(e){var t=e.context,a=t.connection,r=t.hints||{},o=a.waypoints;r.connectionStart||r.connectionEnd||!1===r.createElementsBehavior||function(e){return e.length>3}(o)&&n.updateWaypoints(a,i.snapMiddleSegments(o))})}function ic(e,t,n){var i=(0,Io.ke)(t,n),a={};return function(e){return"h"===e}(i)&&(a.y=e.snapValue(t.y)),function(e){return"v"===e}(i)&&(a.x=e.snapValue(t.x)),("x"in a||"y"in a)&&(t=(0,l.assign)({},t,a),n=(0,l.assign)({},n,a)),[t,n]}ec.$inject=["eventBus","gridSnapping","elementRegistry"],tc.$inject=["canvas","eventBus","gridSnapping"],nc.$inject=["eventBus","gridSnapping","modeling"],(0,i.A)(nc,ft.A),nc.prototype.snapMiddleSegments=function(e){var t,n=this._gridSnapping;e=e.slice();for(var i=1;i<e.length-2;i++)t=ic(n,e[i],e[i+1]),e[i]=t[0],e[i+1]=t[1];return e};const ac={__init__:["gridSnappingAutoPlaceBehavior","gridSnappingParticipantBehavior","gridSnappingLayoutConnectionBehavior"],gridSnappingAutoPlaceBehavior:["type",ec],gridSnappingParticipantBehavior:["type",tc],gridSnappingLayoutConnectionBehavior:["type",nc]},rc={__depends__:[Zs.A,ac],__init__:["bpmnGridSnapping"],bpmnGridSnapping:["type",Qs]};function oc(e,t){this._interactionEvents=t;var n=this;e.on(["interactionEvents.createHit","interactionEvents.updateHit"],function(e){var t=e.element,i=e.gfx;return(0,be.is)(t,"bpmn:Lane")?n._createParticipantHit(t,i):(0,be.is)(t,"bpmn:Participant")?(0,Fe.Av)(t)?n._createParticipantHit(t,i):n._createDefaultHit(t,i):(0,be.is)(t,"bpmn:SubProcess")?(0,Fe.Av)(t)?n._createSubProcessHit(t,i):n._createDefaultHit(t,i):void 0})}oc.$inject=["eventBus","interactionEvents"],oc.prototype._createDefaultHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createDefaultHit(e,t),!0},oc.prototype._createParticipantHit=function(e,t){this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"no-move",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height});var n=(0,Fe.$b)(e)?{width:30,height:e.height}:{width:e.width,height:30};return this._interactionEvents.createBoxHit(t,"all",n),!0},oc.prototype._createSubProcessHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"no-move",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:e.width,height:30}),!0};const sc={__init__:["bpmnInteractionEvents"],bpmnInteractionEvents:["type",oc]};var cc=n(76137),pc=n(29725);function lc(e){e.invoke(pc.Ay,this)}(0,i.A)(lc,pc.Ay),lc.$inject=["injector"],lc.prototype.registerBindings=function(e,t){function n(n,i){t.isRegistered(n)&&e.addListener(i)}pc.Ay.prototype.registerBindings.call(this,e,t),n("selectElements",function(n){var i=n.keyEvent;if(e.isKey(["a","A"],i)&&e.isCmd(i))return t.trigger("selectElements"),!0}),n("find",function(n){var i=n.keyEvent;if(e.isKey(["f","F"],i)&&e.isCmd(i))return t.trigger("find"),!0}),n("spaceTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["s","S"],i)?(t.trigger("spaceTool"),!0):void 0}),n("lassoTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["l","L"],i)?(t.trigger("lassoTool"),!0):void 0}),n("handTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["h","H"],i)?(t.trigger("handTool"),!0):void 0}),n("globalConnectTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["c","C"],i)?(t.trigger("globalConnectTool"),!0):void 0}),n("directEditing",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["e","E"],i)?(t.trigger("directEditing"),!0):void 0}),n("replaceElement",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["r","R"],i)?(t.trigger("replaceElement",i),!0):void 0})};const mc={__depends__:[cc.A],__init__:["keyboardBindings"],keyboardBindings:["type",lc]};var uc=n(6188),dc=n(60188);function hc(e,t,n,i,a,r,o){function s(e,t){(t||(0,be.f7)(e,["bpmn:Task","bpmn:TextAnnotation","bpmn:Participant"])||fc(e))&&i.activate(e)}this._bpmnFactory=t,this._canvas=n,this._modeling=a,this._textRenderer=o,i.registerProvider(this),e.on("element.dblclick",function(e){s(e.element,!0)}),e.on(["autoPlace.start","canvas.viewbox.changing","drag.init","element.mousedown","popupMenu.open","root.set","selection.changed"],function(){i.isActive()&&i.complete()}),e.on(["shape.remove","connection.remove"],2e3,function(e){i.isActive(e.element)&&i.cancel()}),e.on(["commandStack.changed"],function(e){i.isActive()&&i.cancel()}),e.on("directEditing.activate",function(e){r.removeResizers()}),e.on("create.end",500,function(e){var t=e.context,n=t.shape,i=e.context.canExecute;e.isTouch||i&&(t.hints&&!1===t.hints.createElementsBehavior||s(n))}),e.on("autoPlace.end",500,function(e){s(e.shape)})}function fc(e){return(0,be.is)(e,"bpmn:SubProcess")&&!(0,Fe.Av)(e)}hc.$inject=["eventBus","bpmnFactory","canvas","directEditing","modeling","resizeHandles","textRenderer"],hc.prototype.activate=function(e){var t=(0,je.p9)(e);if(void 0!==t){var n={text:t},i=this.getEditingBBox(e);(0,l.assign)(n,i);var a={},r=n.style||{};return(0,l.assign)(r,{backgroundColor:null,border:null}),((0,be.f7)(e,["bpmn:Task","bpmn:Participant","bpmn:Lane","bpmn:CallActivity"])||fc(e))&&(0,l.assign)(a,{centerVertically:!0}),(0,je.UC)(e)&&((0,l.assign)(a,{autoResize:!0}),(0,l.assign)(r,{backgroundColor:"#ffffff",border:"1px solid #ccc"})),(0,be.is)(e,"bpmn:TextAnnotation")&&((0,l.assign)(a,{resizable:!0,autoResize:!0}),(0,l.assign)(r,{backgroundColor:"#ffffff",border:"1px solid #ccc"})),(0,l.assign)(n,{options:a,style:r}),n}},hc.prototype.getEditingBBox=function(e){var t=this._canvas,n=e.label||e,i=t.getAbsoluteBBox(n),a=i.x+i.width/2,r=i.y+i.height/2,o={x:i.x,y:i.y},s=t.zoom(),c=this._textRenderer.getDefaultStyle(),p=this._textRenderer.getExternalStyle(),m=p.fontSize*s,u=p.lineHeight,d=c.fontSize*s,h=c.lineHeight,f={fontFamily:this._textRenderer.getDefaultStyle().fontFamily,fontWeight:this._textRenderer.getDefaultStyle().fontWeight};if((0,be.is)(e,"bpmn:Lane")||function(e){return(0,be.is)(e,"bpmn:Participant")&&(0,Fe.Av)(e)}(e)){var v=(0,Fe.$b)(e),g=v?{width:i.height,height:30*s,x:i.x-i.height/2+15*s,y:r-30*s/2}:{width:i.width,height:30*s};(0,l.assign)(o,g),(0,l.assign)(f,{fontSize:d+"px",lineHeight:h,paddingTop:7*s+"px",paddingBottom:7*s+"px",paddingLeft:5*s+"px",paddingRight:5*s+"px",transform:v?"rotate(-90deg)":null})}if(function(e){return(0,be.is)(e,"bpmn:Participant")&&!(0,Fe.Av)(e)}(e)){var y=(0,Fe.$b)(e),b=y?{width:i.width,height:i.height}:{width:i.height,height:i.width,x:a-i.height/2,y:r-i.width/2};(0,l.assign)(o,b),(0,l.assign)(f,{fontSize:d+"px",lineHeight:h,paddingTop:7*s+"px",paddingBottom:7*s+"px",paddingLeft:5*s+"px",paddingRight:5*s+"px",transform:y?null:"rotate(-90deg)"})}((0,be.f7)(e,["bpmn:Task","bpmn:CallActivity"])||fc(e))&&((0,l.assign)(o,{width:i.width,height:i.height}),(0,l.assign)(f,{fontSize:d+"px",lineHeight:h,paddingTop:7*s+"px",paddingBottom:7*s+"px",paddingLeft:5*s+"px",paddingRight:5*s+"px"})),function(e){return(0,be.is)(e,"bpmn:SubProcess")&&(0,Fe.Av)(e)}(e)&&((0,l.assign)(o,{width:i.width,x:i.x}),(0,l.assign)(f,{fontSize:d+"px",lineHeight:h,paddingTop:7*s+"px",paddingBottom:7*s+"px",paddingLeft:5*s+"px",paddingRight:5*s+"px"}));var E=90*s,x=7*s,w=4*s;if(n.labelTarget&&((0,l.assign)(o,{width:E,height:i.height+x+w,x:a-E/2,y:i.y-x}),(0,l.assign)(f,{fontSize:m+"px",lineHeight:u,paddingTop:x+"px",paddingBottom:w+"px"})),(0,je.UC)(n)&&!(0,je.ur)(n)&&!(0,Oe.J2)(n)){var _=(0,je.QX)(e),S=t.getAbsoluteBBox({x:_.x,y:_.y,width:0,height:0}),A=m+x+w;(0,l.assign)(o,{width:E,height:A,x:S.x-E/2,y:S.y-A/2}),(0,l.assign)(f,{fontSize:m+"px",lineHeight:u,paddingTop:x+"px",paddingBottom:w+"px"})}return(0,be.is)(e,"bpmn:TextAnnotation")&&((0,l.assign)(o,{width:i.width,height:i.height,minWidth:30*s,minHeight:10*s}),(0,l.assign)(f,{textAlign:"left",paddingTop:5*s+"px",paddingBottom:7*s+"px",paddingLeft:7*s+"px",paddingRight:5*s+"px",fontSize:d+"px",lineHeight:h})),{bounds:o,style:f}},hc.prototype.update=function(e,t,n,i){var a,r,o;(0,be.is)(e,"bpmn:TextAnnotation")&&(r=this._canvas.getAbsoluteBBox(e),a={x:e.x,y:e.y,width:e.width/r.width*i.width,height:e.height/r.height*i.height}),(o=t)&&o.trim()||(t=null),this._modeling.updateLabel(e,t,a)};var vc="djs-element-hidden",gc="djs-label-hidden";function yc(e,t,n){var i,a,r,o=this,s=t.getDefaultLayer();e.on("directEditing.activate",function(e){var c=e.active;if(i=c.element.label||c.element,(0,be.is)(i,"bpmn:TextAnnotation")){a=t.getAbsoluteBBox(i),r=(0,h.vt)("g");var p=n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:i.width,containerHeight:i.height,position:{mx:0,my:0}}),l=o.path=(0,h.vt)("path");(0,h.CF)(l,{d:p,strokeWidth:2,stroke:bc(i)}),(0,h.BC)(r,l),(0,h.BC)(s,r),(0,Xe.Tl)(r,i.x,i.y)}(0,be.is)(i,"bpmn:TextAnnotation")||i.labelTarget?t.addMarker(i,vc):((0,be.is)(i,"bpmn:Task")||(0,be.is)(i,"bpmn:CallActivity")||(0,be.is)(i,"bpmn:SubProcess")||(0,be.is)(i,"bpmn:Participant")||(0,be.is)(i,"bpmn:Lane"))&&t.addMarker(i,gc)}),e.on("directEditing.resize",function(e){if((0,be.is)(i,"bpmn:TextAnnotation")){var t=e.height,r=e.dy,s=Math.max(i.height/a.height*(t+r),0),c=n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:i.width,containerHeight:s,position:{mx:0,my:0}});(0,h.CF)(o.path,{d:c})}}),e.on(["directEditing.complete","directEditing.cancel"],function(e){var n=e.active;n&&(t.removeMarker(n.element.label||n.element,vc),t.removeMarker(i,gc)),i=void 0,a=void 0,r&&((0,h.TF)(r),r=void 0)})}function bc(e,t){return(0,be.S2)(e).get("stroke")||t||"black"}yc.$inject=["eventBus","canvas","pathMap"];const Ec={__depends__:[ht.A,dc.A,gs.A],__init__:["labelEditingProvider","labelEditingPreview"],labelEditingProvider:["type",hc],labelEditingPreview:["type",yc]};var xc=n(46055);const wc=["bpmn:Event","bpmn:SequenceFlow","bpmn:Gateway"],_c={class:"bjs-label-link",stroke:"var(--element-selected-outline-secondary-stroke-color)",strokeDasharray:"5, 5"};function Sc(e,t,n,i,a){const r=t.getLayer("overlays");function o(e,t,n=[]){const i=(0,Le.RJ)([(0,st.pp)(t),(0,st.pp)(e)],_c),a=i.getAttribute("d"),o=n.includes(e)?s(e):c(e),p=(0,st.ki)(o,a);if(!p)return;const l=n.includes(t)?s(t):c(t),m=(0,st.ki)(l,a)||(0,st.pp)(t);(0,oi.kf)(m,p)<15||((0,Le.si)(i,[m,p]),(0,h.BC)(r,i))}function s(e){const t=i.getOutline(e),n=i.offset;return t?t.x?Ue({x:e.x+Ac(t,"x")-2,y:e.y+Ac(t,"y")-2,width:Ac(t,"width")+4,height:Ac(t,"height")+4},Ac(t,"rx")):t.cx?We({x:e.x-n,y:e.y-n,width:2*Ac(t,"r"),height:2*Ac(t,"r")}):void 0:c(e)}function c(e){return n.getShapePath(e)}e.on(["selection.changed","shape.changed"],function(){(0,m.YG)(`.${_c.class}`,r).forEach(h.TF)}),e.on("selection.changed",function({newSelection:e}){const t=e.filter(e=>(0,be.f7)(e,wc));if(1===t.length){const n=t[0];(0,Oe.J2)(n)?o(n,n.labelTarget,e):n.labels?.length&&o(n.labels[0],n,e)}if(2===t.length){const n=t.find(Oe.J2),i=t.find(e=>e.labels?.includes(n));n&&i&&o(n,i,e)}}),e.on("shape.changed",function({element:e}){(0,be.f7)(e,wc)&&function(e){return a.get().includes(e)}(e)&&((0,Oe.J2)(e)?o(e,e.labelTarget,a.get()):e.labels?.length&&o(e.labels[0],e,a.get()))})}function Ac(e,t){return parseFloat((0,h.CF)(e,t)||0)}Sc.$inject=["eventBus","canvas","graphicsFactory","outline","selection"];const Cc={__depends__:[Tt.A,xc.A],__init__:["labelLink"],labelLink:["type",Sc]};var Nc=n(43709),Tc=new Nc.A("tt");function Dc(e,t){e.style.display=!1===t?"none":""}var kc="djs-tooltip",Pc="."+kc;function Rc(e,t){var n,i;this._eventBus=e,this._canvas=t,this._ids=Tc,this._tooltipDefaults={show:{minZoom:.7,maxZoom:5}},this._tooltips={},this._tooltipRoot=(n=t.getContainer(),i=d()('<div class="djs-tooltip-container" />'),(0,m.HZ)(i,{position:"absolute",width:"0",height:"0"}),n.insertBefore(i,n.firstChild),i);var a=this;m.Mm.bind(this._tooltipRoot,Pc,"mousedown",function(e){e.stopPropagation()}),m.Mm.bind(this._tooltipRoot,Pc,"mouseover",function(e){a.trigger("mouseover",e)}),m.Mm.bind(this._tooltipRoot,Pc,"mouseout",function(e){a.trigger("mouseout",e)}),this._init()}Rc.$inject=["eventBus","canvas"],Rc.prototype.add=function(e){if(!e.position)throw new Error("must specifiy tooltip position");if(!e.html)throw new Error("must specifiy tooltip html");var t=this._ids.next();return e=(0,l.assign)({},this._tooltipDefaults,e,{id:t}),this._addTooltip(e),e.timeout&&this.setTimeout(e),t},Rc.prototype.trigger=function(e,t){var n=t.delegateTarget||t.target,i=this.get((0,m.CF)(n,"data-tooltip-id"));i&&("mouseover"===e&&i.timeout&&this.clearTimeout(i),"mouseout"===e&&i.timeout&&(i.timeout=1e3,this.setTimeout(i)))},Rc.prototype.get=function(e){return"string"!=typeof e&&(e=e.id),this._tooltips[e]},Rc.prototype.clearTimeout=function(e){if(e=this.get(e)){var t=e.removeTimer;t&&(clearTimeout(t),e.removeTimer=null)}},Rc.prototype.setTimeout=function(e){if(e=this.get(e)){this.clearTimeout(e);var t=this;e.removeTimer=setTimeout(function(){t.remove(e)},e.timeout)}},Rc.prototype.remove=function(e){var t=this.get(e);t&&((0,m.TF)(t.html),(0,m.TF)(t.htmlContainer),delete t.htmlContainer,delete this._tooltips[t.id])},Rc.prototype.show=function(){Dc(this._tooltipRoot)},Rc.prototype.hide=function(){Dc(this._tooltipRoot,!1)},Rc.prototype._updateRoot=function(e){var t=e.scale||1,n=e.scale||1,i="matrix("+t+",0,0,"+n+","+-1*e.x*t+","+-1*e.y*n+")";this._tooltipRoot.style.transform=i,this._tooltipRoot.style["-ms-transform"]=i},Rc.prototype._addTooltip=function(e){var t,n=e.id,i=e.html,a=this._tooltipRoot;i.get&&i.constructor.prototype.jquery&&(i=i.get(0)),(0,l.isString)(i)&&(i=d()(i)),t=d()('<div data-tooltip-id="'+n+'" class="'+kc+'">'),(0,m.HZ)(t,{position:"absolute"}),t.appendChild(i),e.type&&(0,m.Ly)(t).add("djs-tooltip-"+e.type),e.className&&(0,m.Ly)(t).add(e.className),e.htmlContainer=t,a.appendChild(t),this._tooltips[n]=e,this._updateTooltip(e)},Rc.prototype._updateTooltip=function(e){var t,n,i,a=e.position;t=e.htmlContainer,n=a.x,i=a.y,(0,m.HZ)(t,{left:n+"px",top:i+"px"})},Rc.prototype._updateTooltipVisibilty=function(e){(0,l.forEach)(this._tooltips,function(t){var n=t.show,i=t.htmlContainer,a=!0;n&&((n.minZoom>e.scale||n.maxZoom<e.scale)&&(a=!1),Dc(i,a))})},Rc.prototype._init=function(){var e=this;this._eventBus.on("canvas.viewbox.changing",function(t){e.hide()}),this._eventBus.on("canvas.viewbox.changed",function(t){var n;n=t.viewbox,e._updateRoot(n),e._updateTooltipVisibilty(n),e.show()})};const Bc={__init__:["tooltips"],tooltips:["type",Rc]};function Mc(e,t,n){function i(e,n,i){t.add({position:{x:e.x+5,y:e.y+5},type:"error",timeout:i||2e3,html:"<div>"+n+"</div>"})}e.on(["shape.move.rejected","create.rejected"],function(e){var t=e.context,a=t.shape,r=t.target;(0,be.is)(r,"bpmn:Collaboration")&&((0,be.is)(a,"bpmn:FlowNode")?i(e,n("flow elements must be children of pools/participants")):(0,be.is)(a,"bpmn:DataObjectReference")&&i(e,n("Data object must be placed within a pool/participant.")))})}Mc.$inject=["eventBus","tooltips","translate"];const Ic={__depends__:[Bc],__init__:["modelingFeedback"],modelingFeedback:["type",Mc]};var Fc=n(16351),jc=n(33266),Oc=n(2159),Lc=n(827),$c="connect-ok",zc="connect-not-ok";function Vc(e,t,n,i,a,r,o){var s=this;this._dragging=t,this._rules=r,this._mouse=o,a.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),e.on("global-connect.hover",function(e){var t=e.context,n=e.hover,a=t.canStartConnect=s.canStartConnect(n);null!==a&&(t.startTarget=n,i.addMarker(n,a?$c:zc))}),e.on(["global-connect.out","global-connect.cleanup"],function(e){var t=e.context.startTarget,n=e.context.canStartConnect;t&&i.removeMarker(t,n?$c:zc)}),e.on(["global-connect.ended"],function(t){var i=t.context.startTarget,a={x:t.x,y:t.y};if(s.canStartConnect(i))return e.once("element.out",function(){e.once(["connect.ended","connect.canceled"],function(){e.fire("global-connect.drag.ended")}),n.start(null,i,a)}),!1})}Vc.$inject=["eventBus","dragging","connect","canvas","toolManager","rules","mouse"],Vc.prototype.start=function(e,t){this._dragging.init(e,"global-connect",{autoActivate:t,trapClick:!1,data:{context:{}}})},Vc.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();return this.start(e,!!e)},Vc.prototype.isActive=function(){var e=this._dragging.context();return e&&/^global-connect/.test(e.prefix)},Vc.prototype.canStartConnect=function(e){return this._rules.allowed("connection.start",{source:e})};const Gc={__depends__:[sn.A,xa.A,Nr.A,Tr.A,pr.A],globalConnect:["type",Vc]};function Hc(e,t,n,i,a,r,o,s){this._palette=e,this._create=t,this._elementFactory=n,this._spaceTool=i,this._lassoTool=a,this._handTool=r,this._globalConnect=o,this._translate=s,e.registerProvider(this)}Hc.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"],Hc.prototype.getPaletteEntries=function(){var e={},t=this._create,n=this._elementFactory,i=this._spaceTool,a=this._lassoTool,r=this._handTool,o=this._globalConnect,s=this._translate;function c(e,i,a,r,o){function s(i){var a=n.createShape((0,l.assign)({type:e},o));t.start(i,a)}return{group:i,className:a,title:r,action:{dragstart:s,click:s}}}function p(e){var i=n.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),a=n.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:i});t.start(e,[i,a],{hints:{autoSelect:[i]}})}function m(e){t.start(e,n.createParticipantShape())}return(0,l.assign)(e,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:s("Activate hand tool"),action:{click:function(e){r.activateHand(e)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:s("Activate lasso tool"),action:{click:function(e){a.activateSelection(e)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:s("Activate create/remove space tool"),action:{click:function(e){i.activateSelection(e)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:s("Activate global connect tool"),action:{click:function(e){o.start(e)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":c("bpmn:StartEvent","event","bpmn-icon-start-event-none",s("Create start event")),"create.intermediate-event":c("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",s("Create intermediate/boundary event")),"create.end-event":c("bpmn:EndEvent","event","bpmn-icon-end-event-none",s("Create end event")),"create.exclusive-gateway":c("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",s("Create gateway")),"create.task":c("bpmn:Task","activity","bpmn-icon-task",s("Create task")),"create.data-object":c("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",s("Create data object reference")),"create.data-store":c("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",s("Create data store reference")),"create.subprocess-expanded":{group:"activity",className:"bpmn-icon-subprocess-expanded",title:s("Create expanded sub-process"),action:{dragstart:p,click:p}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:s("Create pool/participant"),action:{dragstart:m,click:m}},"create.group":c("bpmn:Group","artifact","bpmn-icon-group",s("Create group"))}),e};const Wc={__depends__:[jc.A,cr.A,Kr,Oc.A,Lc.A,Gc,ot.A],__init__:["paletteProvider"],paletteProvider:["type",Hc]};function Uc(e,t,n,i,a){ft.A.call(this,e),e.on("shape.move.move",250,function(e){var r=e.context,o=r.canExecute;r.visualReplacements||(r.visualReplacements={}),o&&o.replacements?function(e){var r=e.canExecute.replacements;(0,l.forEach)(r,function(r){var o=r.oldElementId,s={type:r.newElementType};if(!e.visualReplacements[o]){var c=t.get(o);(0,l.assign)(s,{x:c.x,y:c.y});var p=n.createShape(s);i.addShape(p,c.parent);var u=(0,m.P)('[data-element-id="'+(0,yt.F)(c.id)+'"]',e.dragGroup);u&&(0,h.CF)(u,{display:"none"});var d=a.addDragger(p,e.dragGroup);e.visualReplacements[o]=d,i.removeShape(p)}})}(r):function(e){var t=e.visualReplacements;(0,l.forEach)(t,function(n,i){var a=(0,m.P)('[data-element-id="'+(0,yt.F)(i)+'"]',e.dragGroup);a&&(0,h.CF)(a,{display:"inline"}),n.remove(),t[i]&&delete t[i]})}(r)})}Uc.$inject=["eventBus","elementRegistry","elementFactory","canvas","previewSupport"],(0,i.A)(Uc,ft.A);const Kc={__depends__:[pn.A],__init__:["bpmnReplacePreview"],bpmnReplacePreview:["type",Uc]};var qc=n(67633),Jc=n(56287),Xc=["x","y"],Yc=Math.abs;function Qc(e){e.on(["connect.hover","connect.move","connect.end"],1250,function(e){var t,n=e.context,i=n.canExecute,a=n.start,r=n.hover,o=n.source,s=n.target;e.originalEvent&&(0,Jc.nM)(e.originalEvent)||(n.initialConnectionStart||(n.initialConnectionStart=n.connectionStart),i&&r&&function(e,t,n){Xc.forEach(function(i){var a=tp(i,t);e[i]<t[i]+n?(0,qc.CU)(e,i,t[i]+n):e[i]>t[i]+a-n&&(0,qc.CU)(e,i,t[i]+a-n)})}(e,r,function(e){return(0,be.is)(e,"bpmn:Task")?10:20}(r)),r&&(t=i,(0,l.some)(["bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:SequenceFlow"],function(e){return ep(t,e)}))?(n.connectionStart=(0,qc.jz)(a),(0,be.f7)(r,["bpmn:Event","bpmn:Gateway"])&&Zc(e,(0,qc.jz)(r)),(0,be.f7)(r,["bpmn:Task","bpmn:SubProcess"])&&function(e,t){var n=(0,qc.jz)(t);Xc.forEach(function(i){(function(e,t,n){return e[n]>t[n]+20&&e[n]<t[n]+tp(n,t)-20})(e,t,i)&&(0,qc.CU)(e,i,n[i])})}(e,r),(0,be.is)(o,"bpmn:BoundaryEvent")&&s===o.host&&function(e){var t=e.context,n=t.source,i=t.target;if(!function(e){var t=e.hover,n=e.source;return t&&n&&t===n}(t)){var a=(0,qc.jz)(n),r=(0,st.vc)(a,i,-10),o=[];/top|bottom/.test(r)&&o.push("x"),/left|right/.test(r)&&o.push("y"),o.forEach(function(t){var n,i=e[t];Yc(i-a[t])<40&&(n=i>a[t]?a[t]+40:a[t]-40,(0,qc.CU)(e,t,n))})}}(e)):ep(i,"bpmn:MessageFlow")?((0,be.is)(a,"bpmn:Event")&&(n.connectionStart=(0,qc.jz)(a)),(0,be.is)(r,"bpmn:Event")&&Zc(e,(0,qc.jz)(r))):n.connectionStart=n.initialConnectionStart)})}function Zc(e,t){(0,qc.CU)(e,"x",t.x),(0,qc.CU)(e,"y",t.y)}function ep(e,t){return e&&e.type===t}function tp(e,t){return"x"===e?t.width:t.height}Qc.$inject=["eventBus"];var np=n(39680);function ip(e,t){t.invoke(np.A,this),e.on(["create.move","create.end"],1500,ap),e.on(["create.move","create.end","shape.move.move","shape.move.end"],1500,function(e){var t=e.context,n=t.canExecute,i=t.target;n&&("attach"===n||n.attach)&&!(0,qc.AC)(e)&&function(e,t){var n,i=(0,st.Fy)(t),a=wa(e,t),r=e.context.shape;n=r.parent?{x:0,y:0}:(0,st.pp)(r),/top/.test(a)?(0,qc.CU)(e,"y",i.top-n.y):/bottom/.test(a)&&(0,qc.CU)(e,"y",i.bottom-n.y),/left/.test(a)?(0,qc.CU)(e,"x",i.left-n.x):/right/.test(a)&&(0,qc.CU)(e,"x",i.right-n.x)}(e,i)})}function ap(e){var t=e.context.createConstraints;if(t){var n=t.top,i=t.right,a=t.bottom,r=t.left;(r&&r>=e.x||i&&i<=e.x)&&(0,qc.CU)(e,"x",e.x),(n&&n>=e.y||a&&a<=e.y)&&(0,qc.CU)(e,"y",e.y)}}function rp(e,t){return-1!==e.indexOf(t)}function op(e,t,n){return t?{x:e.x-n.x,y:e.y-n.y}:{x:e.x,y:e.y}}(0,i.A)(ip,np.A),ip.$inject=["eventBus","injector"],ip.prototype.initSnap=function(e){var t=np.A.prototype.initSnap.call(this,e),n=e.shape,i=!!this._elementRegistry.get(n.id);return(0,l.forEach)(n.outgoing,function(n){var a=n.waypoints[0];a=a.original||a,t.setSnapOrigin(n.id+"-docking",op(a,i,e))}),(0,l.forEach)(n.incoming,function(n){var a=n.waypoints[n.waypoints.length-1];a=a.original||a,t.setSnapOrigin(n.id+"-docking",op(a,i,e))}),(0,be.is)(n,"bpmn:Participant")&&t.setSnapLocations(["top-left","bottom-right","mid"]),t},ip.prototype.addSnapTargetPoints=function(e,t,n){np.A.prototype.addSnapTargetPoints.call(this,e,t,n);var i=this.getSnapTargets(t,n);(0,l.forEach)(i,function(n){var i;i=n,((0,be.is)(i,"bpmn:SubProcess")&&(0,Fe.Av)(i)||(0,be.is)(i,"bpmn:Participant")||[t,n].every(function(e){return(0,be.is)(e,"bpmn:TextAnnotation")}))&&(e.add("top-left",(0,qc.lA)(n)),e.add("bottom-right",(0,qc.oF)(n)))});var a=this._elementRegistry;return(0,l.forEach)(t.incoming,function(n){if(a.get(t.id)){rp(i,n.source)||e.add("mid",(0,st.pp)(n.source));var r=n.waypoints[0];e.add(n.id+"-docking",r.original||r)}}),(0,l.forEach)(t.outgoing,function(n){if(a.get(t.id)){rp(i,n.target)||e.add("mid",(0,st.pp)(n.target));var r=n.waypoints[n.waypoints.length-1];e.add(n.id+"-docking",r.original||r)}}),(0,be.is)(n,"bpmn:SequenceFlow")&&(e=this.addSnapTargetPoints(e,t,n.parent)),e},ip.prototype.getSnapTargets=function(e,t){return np.A.prototype.getSnapTargets.call(this,e,t).filter(function(e){return!(0,be.is)(e,"bpmn:Lane")})};const sp={__depends__:[n(56875).A],__init__:["connectSnapping","createMoveSnapping"],connectSnapping:["type",Qc],createMoveSnapping:["type",ip]};var cp=n(35506),pp=n(98294);function lp(e,t,n,i){this._elementRegistry=e,this._canvas=n,this._search=i,t.registerProvider(this)}function mp(e){const{item:{element:t},tokens:n}=e;return{element:t,primaryTokens:n.label,secondaryTokens:n.id}}lp.$inject=["elementRegistry","searchPad","canvas","search"],lp.prototype.find=function(e){var t=this._canvas.getRootElements(),n=this._elementRegistry.filter(function(e){return!(0,Oe.J2)(e)&&!t.includes(e)});return this._search(n.map(e=>({element:e,label:(0,je.p9)(e),id:e.id})),e,{keys:["label","id"]}).map(mp)};const up={__depends__:[cp.A,pp.A],__init__:["bpmnSearch"],bpmnSearch:["type",lp]},dp={width:36,height:50},hp={width:50,height:50};function fp(e,t,n){return(0,h.vt)("path",{d:e,strokeWidth:2,transform:`translate(${t.x}, ${t.y})`,...n})}function vp(e,t){this._styles=t,e.registerProvider(this)}function gp(e,t){var n;return"bpmn:DataObjectReference"===t?n=dp:"bpmn:DataStoreReference"===t&&(n=hp),e.width===n.width&&e.height===n.height}vp.$inject=["outline","styles"],vp.prototype.getOutline=function(e){const t=this._styles.cls("djs-outline",["no-fill"]);var n;return(0,je.gF)(e)?(n=(0,h.vt)("rect"),(0,h.CF)(n,(0,l.assign)({x:-5,y:-5,rx:4,width:e.width+10,height:e.height+10},t)),n):(0,Oe.J2)(e)?void 0:((0,be.is)(e,"bpmn:Gateway")?(n=(0,h.vt)("rect"),(0,l.assign)(n.style,{"transform-box":"fill-box",transform:"rotate(45deg)","transform-origin":"center"}),(0,h.CF)(n,(0,l.assign)({x:2,y:2,rx:4,width:e.width-4,height:e.height-4},t))):(0,be.f7)(e,["bpmn:Task","bpmn:SubProcess","bpmn:Group","bpmn:CallActivity"])?(n=(0,h.vt)("rect"),(0,h.CF)(n,(0,l.assign)({x:-5,y:-5,rx:14,width:e.width+10,height:e.height+10},t))):(0,be.is)(e,"bpmn:EndEvent")?(n=(0,h.vt)("circle"),(0,h.CF)(n,(0,l.assign)({cx:e.width/2,cy:e.height/2,r:e.width/2+5+1},t))):(0,be.is)(e,"bpmn:Event")?(n=(0,h.vt)("circle"),(0,h.CF)(n,(0,l.assign)({cx:e.width/2,cy:e.height/2,r:e.width/2+5},t))):(0,be.is)(e,"bpmn:DataObjectReference")&&gp(e,"bpmn:DataObjectReference")?n=fp("M44.7648 11.3263L36.9892 2.64074C36.0451 1.58628 34.5651 0.988708 33.1904 0.988708H5.98667C3.22688 0.988708 0.989624 3.34892 0.989624 6.26039V55.0235C0.989624 57.9349 3.22688 60.2952 5.98667 60.2952H40.966C43.7257 60.2952 45.963 57.9349 45.963 55.0235V14.9459C45.963 13.5998 45.6407 12.3048 44.7648 11.3263Z",{x:-6,y:-6},t):(0,be.is)(e,"bpmn:DataStoreReference")&&gp(e,"bpmn:DataStoreReference")&&(n=fp("M1.03845 48.1347C1.03845 49.3511 1.07295 50.758 1.38342 52.064C1.69949 53.3938 2.32428 54.7154 3.56383 55.6428C6.02533 57.4841 10.1161 58.7685 14.8212 59.6067C19.5772 60.4538 25.1388 60.8738 30.6831 60.8738C36.2276 60.8738 41.7891 60.4538 46.545 59.6067C51.2504 58.7687 55.3412 57.4842 57.8028 55.6429C59.0424 54.7156 59.6673 53.3938 59.9834 52.064C60.2938 50.7579 60.3285 49.351 60.3285 48.1344V13.8415C60.3285 12.6249 60.2938 11.218 59.9834 9.91171C59.6673 8.58194 59.0423 7.2602 57.8027 6.33294C55.341 4.49168 51.2503 3.20723 46.545 2.36914C41.7891 1.522 36.2276 1.10204 30.6831 1.10205C25.1388 1.10206 19.5772 1.52206 14.8213 2.36923C10.1162 3.20734 6.02543 4.49183 3.5639 6.33314C2.32433 7.26038 1.69951 8.58206 1.38343 9.91181C1.07295 11.2179 1.03845 12.6247 1.03845 13.8411V48.1347Z",{x:-6,y:-6},t)),n)},vp.prototype.updateOutline=function(e,t){if(!(0,Oe.J2)(e))return(0,be.f7)(e,["bpmn:SubProcess","bpmn:Group"])?((0,h.CF)(t,{width:e.width+10,height:e.height+10}),!0):!!(0,be.f7)(e,["bpmn:Event","bpmn:Gateway","bpmn:DataStoreReference","bpmn:DataObjectReference"])};const yp={__depends__:[xc.A],__init__:["outlineProvider"],outlineProvider:["type",vp]};function bp(e){Me.call(this,e)}(0,i.A)(bp,Me),bp.Viewer=Dt,bp.NavigatedViewer=Bt,bp.prototype.createDiagram=function(){return this.importXML('<?xml version="1.0" encoding="UTF-8"?><bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" targetNamespace="http://bpmn.io/schema/bpmn" id="Definitions_1"><bpmn:process id="Process_1" isExecutable="false"><bpmn:startEvent id="StartEvent_1"/></bpmn:process><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1"><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds height="36.0" width="36.0" x="173.0" y="102.0"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>')},bp.prototype._interactionModules=[kt.A,Pt.A,Rt.A],bp.prototype._modelingModules=[Ht,Qt,rn.A,an,on.A,sn.A,cn.A,zs,Er,cr.A,Ks,Ys,rc,sc,mc,uc.A,Ec,Cc,ds,Ic,Fc.A,Wc,Kc,dc.A,sp,up,yp],bp.prototype._modules=[].concat(Dt.prototype._modules,bp.prototype._interactionModules,bp.prototype._modelingModules);var Ep=new Nc.A,xp={min:.2,max:4};function wp(e,t,n,i,a){var r=this;function o(e){r._state._svgClientRect&&!Np(r._state._svgClientRect)||(r._state._svgClientRect=r._svg.getBoundingClientRect()),Sp(_p({x:e.x-r._state._svgClientRect.left,y:e.y-r._state._svgClientRect.top},r._svg,r._lastViewbox),r._canvas),r._update()}function s(e){return function(t){var n=Rp(t);r._state._svgClientRect&&!Np(r._state._svgClientRect)||(r._state._svgClientRect=r._svg.getBoundingClientRect()),e&&o(n);var a=_p({x:n.x-r._state._svgClientRect.left,y:n.y-r._state._svgClientRect.top},r._svg,r._lastViewbox),s=i.viewbox(),u=function(e,t){var n=t.x+t.width/2,i=t.y+t.height/2;return{x:e.x-n,y:e.y-i}}(a,s),d=r._viewportDom.getBoundingClientRect(),h={x:n.x-d.left+1,y:n.y-d.top+1};(0,l.assign)(r._state,{cachedViewbox:s,initialDragPosition:{x:n.x,y:n.y},isDragging:!0,offsetViewport:u,offsetViewportDom:h,viewportClientRect:r._viewport.getBoundingClientRect(),parentClientRect:r._parent.getBoundingClientRect()}),m.f0.bind(document,"mousemove",c),m.f0.bind(document,"mouseup",p)}}function c(e){var t=Rp(e);if(r._state.isDragging){r._state._svgClientRect&&!Np(r._state._svgClientRect)||(r._state._svgClientRect=r._svg.getBoundingClientRect());var n=r._state.offsetViewportDom,i=r._state.viewportClientRect,a=r._state.parentClientRect;(0,l.assign)(r._viewportDom.style,{top:t.y-n.y-a.top+"px",left:t.x-n.x-a.left+"px"});var o=Dp(a,{top:t.y-n.y-a.top,left:t.x-n.x-a.left,width:i.width,height:i.height});(0,l.assign)(r._overlay.style,{clipPath:o});var s=_p({x:t.x-r._state._svgClientRect.left,y:t.y-r._state._svgClientRect.top},r._svg,r._lastViewbox);Sp({x:s.x-r._state.offsetViewport.x,y:s.y-r._state.offsetViewport.y},r._canvas)}}function p(e){var t=Rp(e);r._state.isDragging&&(r._state.initialDragPosition.x===t.x&&r._state.initialDragPosition.y===t.y&&o(e),r._update(),(0,l.assign)(r._state,{cachedViewbox:null,initialDragPosition:null,isDragging:!1,offsetViewport:null,offsetViewportDom:null}),m.f0.unbind(document,"mousemove",c),m.f0.unbind(document,"mouseup",p))}this._canvas=i,this._elementRegistry=a,this._eventBus=n,this._injector=t,this._state={isOpen:void 0,isDragging:!1,initialDragPosition:null,offsetViewport:null,cachedViewbox:null,dragger:null,svgClientRect:null,parentClientRect:null,zoomDelta:0},this._minimapId=Ep.next(),this._init(),this.toggle(e&&e.open||!1),m.f0.bind(this._viewportDom,"mousedown",s(!1)),m.f0.bind(this._svg,"mousedown",s(!0)),m.f0.bind(this._parent,"wheel",function(e){if(e.preventDefault(),e.stopPropagation(),e.ctrlKey&&(r._state._svgClientRect&&!Np(r._state._svgClientRect)||(r._state._svgClientRect=r._svg.getBoundingClientRect()),t=e,n=r._state._svgClientRect,t.x>n.left&&t.x<n.left+n.width&&t.y>n.top&&t.y<n.top+n.height)){var t,n,a,o,s,c=0===e.deltaMode?.02:.32,p=Math.sqrt(Math.pow(e.deltaY,2)+Math.pow(e.deltaX,2))*Tp(e.deltaY)*-c;if(r._state.zoomDelta+=p,Math.abs(r._state.zoomDelta)>.1){var l=p>0?1:-1,m=Math.log(i.zoom())/Math.log(10),u=(a=xp,o=Math.log(a.min)/Math.log(10),s=Math.log(a.max)/Math.log(10),(Math.abs(o)+Math.abs(s))/20),d=Math.round(m/u)*u;d+=u*l;var h=Math.pow(10,d);i.zoom(function(e,t){return Math.max(e.min,Math.min(e.max,t))}(xp,h),f),r._state.zoomDelta=0;var f=_p({x:e.clientX-r._state._svgClientRect.left,y:e.clientY-r._state._svgClientRect.top},r._svg,r._lastViewbox);Sp(f,r._canvas),r._update()}}}),m.f0.bind(this._toggle,"click",function(e){e.preventDefault(),e.stopPropagation(),r.toggle()}),n.on(["shape.added","connection.added"],function(e){var t=e.element;r._addElement(t),r._update()}),n.on(["shape.removed","connection.removed"],function(e){var t=e.element;r._removeElement(t),r._update()}),n.on("elements.changed",250,function(e){e.elements.forEach(function(e){r._updateElement(e)}),r._update()}),n.on("element.updateId",function(e){var t=e.element,n=e.newId;r._updateElementId(t,n)}),n.on("canvas.viewbox.changed",function(){r._state.isDragging||r._update()}),n.on("canvas.resized",function(){document.body.contains(r._parent)&&(r._state.isDragging||r._update(),r._state._svgClientRect=r._svg.getBoundingClientRect())}),n.on(["root.set","plane.set"],function(e){r._clear(),(e.element||e.plane.rootElement).children.forEach(function(e){r._addElement(e)}),r._update()})}function _p(e,t,n){var i=t.getBoundingClientRect(),a=function(e,t){var n=e.width/e.height,i=(0,l.assign)({},{x:e.x,y:e.y,width:e.width,height:e.height});if(n>t){var a=i.width*(1/t),r=i.y-(a-i.height)/2;(0,l.assign)(i,{y:r,height:a})}else if(n<t){var o=i.height*t,s=i.x-(o-i.width)/2;(0,l.assign)(i,{x:s,width:o})}return i}(n,i.width/i.height);return{x:Ap(e.x,0,i.width,a.x,a.x+a.width),y:Ap(e.y,0,i.height,a.y,a.y+a.height)}}function Sp(e,t){var n=t.viewbox(),i=n.width,a=n.height;t.viewbox({x:e.x-i/2,y:e.y-a/2,width:i,height:a})}function Ap(e,t,n,i,a){return(e-t)*(a-i)/(n-t)+i}function Cp(e,t,n){var i=function(e){var t=(0,m.P)(".children",e);return t||(t=(0,h.vt)("g",{class:"children"}),(0,h.BC)(e,t)),t}(t),a=[].slice.call(i.childNodes)[n];a?t.insertBefore(e,a.nextSibling):t.appendChild(e)}function Np(e){return 0===e.width&&0===e.height}wp.$inject=["config.minimap","injector","eventBus","canvas","elementRegistry"],wp.prototype._init=function(){var e=this._canvas.getContainer(),t=this._parent=document.createElement("div");(0,m.Ly)(t).add("djs-minimap"),e.appendChild(t);var n=this._toggle=document.createElement("div");(0,m.Ly)(n).add("toggle"),t.appendChild(n);var i=this._map=document.createElement("div");(0,m.Ly)(i).add("map"),t.appendChild(i);var a=this._svg=(0,h.vt)("svg");(0,h.CF)(a,{width:"100%",height:"100%"}),(0,h.BC)(i,a);var r=this._elementsGroup=(0,h.vt)("g");(0,h.BC)(a,r);var o=this._viewportGroup=(0,h.vt)("g");(0,h.BC)(a,o);var s=this._viewport=(0,h.vt)("rect");(0,h.Ly)(s).add("viewport"),(0,h.BC)(o,s),m.f0.bind(t,"mousedown",function(e){e.stopPropagation()});var c=this._viewportDom=document.createElement("div");(0,m.Ly)(c).add("viewport-dom"),this._parent.appendChild(c);var p=this._overlay=document.createElement("div");(0,m.Ly)(p).add("overlay"),this._parent.appendChild(p)},wp.prototype._update=function(){var e=this._canvas.viewbox(),t=e.inner,n=e.outer;if(Pp(e)){var i,a,r,o,s=n.width-t.width,c=n.height-t.height;t.width<n.width?(i=t.x-s/2,r=n.width,t.x+t.width<n.width&&(i=Math.min(0,t.x))):(i=t.x,r=t.width),t.height<n.height?(a=t.y-c/2,o=n.height,t.y+t.height<n.height&&(a=Math.min(0,t.y))):(a=t.y,o=t.height),i-=50,a-=50,r+=100,o+=100,this._lastViewbox={x:i,y:a,width:r,height:o},(0,h.CF)(this._svg,{viewBox:i+", "+a+", "+r+", "+o}),(0,h.CF)(this._viewport,{x:e.x,y:e.y,width:e.width,height:e.height});var p=this._state._parentClientRect=this._parent.getBoundingClientRect(),m=this._viewport.getBoundingClientRect(),u={top:m.top-p.top,left:m.left-p.left,width:m.width,height:m.height};(0,l.assign)(this._viewportDom.style,{top:u.top+"px",left:u.left+"px",width:u.width+"px",height:u.height+"px"});var d=Dp(p,u);(0,l.assign)(this._overlay.style,{clipPath:d})}},wp.prototype.open=function(){(0,l.assign)(this._state,{isOpen:!0}),(0,m.Ly)(this._parent).add("open");var e=this._injector.get("translate",!1)||function(e){return e};(0,m.CF)(this._toggle,"title",e("Close minimap")),this._update(),this._eventBus.fire("minimap.toggle",{open:!0})},wp.prototype.close=function(){(0,l.assign)(this._state,{isOpen:!1}),(0,m.Ly)(this._parent).remove("open");var e=this._injector.get("translate",!1)||function(e){return e};(0,m.CF)(this._toggle,"title",e("Open minimap")),this._eventBus.fire("minimap.toggle",{open:!1})},wp.prototype.toggle=function(e){var t=this.isOpen();void 0===e&&(e=!t),e!=t&&(e?this.open():this.close())},wp.prototype.isOpen=function(){return this._state.isOpen},wp.prototype._updateElement=function(e){try{void 0!==e.parent&&null!==e.parent&&(this._removeElement(e),this._addElement(e))}catch(e){console.warn("Minimap#_updateElement errored",e)}},wp.prototype._updateElementId=function(e,t){try{var n=(0,m.P)("#"+(0,yt.F)(this._prefixId(e.id)),this._elementsGroup);n&&(n.id=this._prefixId(t))}catch(e){console.warn("Minimap#_updateElementId errored",e)}},wp.prototype.isOnActivePlane=function(e){var t=this._canvas;return t.findRoot?t.findRoot(e)===t.getRootElement():!t.findPlane||t.findPlane(e)===t.getActivePlane()},wp.prototype._addElement=function(e){var t=this;if(this._removeElement(e),this.isOnActivePlane(e)){var n,i,a,r=this._createElement(e),o=(0,m.P)("#"+(0,yt.F)(this._prefixId(e.parent.id)),this._elementsGroup);if(r){var s=function(e,t){var n=(0,m.P)(".djs-children",t.parentNode);if(n){var i=[].slice.call(n.childNodes),a=-1;return i.forEach(function(t,n){(0,m.P)(".djs-element",t)===e&&(a=n)}),a}}(this._elementRegistry.getGraphics(e),this._elementRegistry.getGraphics(e.parent));return"undefined"!==s&&o?o.childNodes.length>s?Cp(r,o,s):Cp(r,o,o.childNodes.length-1):this._elementsGroup.appendChild(r),function(e){return e.waypoints}(e)?(i=0,a=0,void 0!==(n=e.parent).x&&void 0!==n.y&&(i=-n.x,a=-n.y),(0,h.CF)(r,{transform:"translate("+i+" "+a+")"})):(i=e.x,a=e.y,o&&(i-=(n=e.parent).x,a-=n.y),(0,h.CF)(r,{transform:"translate("+i+" "+a+")"})),e.children&&e.children.length&&e.children.forEach(function(e){t._addElement(e)}),r}}},wp.prototype._removeElement=function(e){var t=this._svg.getElementById(this._prefixId(e.id));t&&(0,h.TF)(t)},wp.prototype._createElement=function(e){var t,n=this._elementRegistry.getGraphics(e);if(n&&(t=(0,ln.P)(n))){var i=function(e){return(0,m.YG)("[id]",e).forEach(function(e){e.remove()}),e}((0,h.o8)(t));return(0,h.CF)(i,{id:this._prefixId(e.id)}),i}},wp.prototype._clear=function(){(0,h.IU)(this._elementsGroup)},wp.prototype._prefixId=function(e){return"djs-minimap-"+e+"-"+this._minimapId};var Tp=Math.sign||function(e){return e>=0?1:-1};function Dp(e,t){return"polygon("+[kp(t.left,t.top),kp(t.left+t.width,t.top),kp(t.left+t.width,t.top+t.height),kp(t.left,t.top+t.height),kp(t.left,e.height),kp(e.width,e.height),kp(e.width,0),kp(0,0),kp(0,e.height),kp(t.left,e.height)].join(", ")+")"}function kp(e,t){return e+"px "+t+"px"}function Pp(e){return(0,l.every)(e,function(e){return(0,l.isObject)(e)?Pp(e):(0,l.isNumber)(e)&&isFinite(e)})}function Rp(e){return e.center?e.center:{x:e.clientX,y:e.clientY}}var Bp={__init__:["minimap"],minimap:["type",wp]},Mp=n(78338);function Ip(e,t){this._canvas=e;var n=this;t.on("diagram.init",function(){n._init(),n.toggle(!0)}),t.on("gridSnapping.toggle",function(e){var t=e.active;n.toggle(t),n._centerGridAroundViewbox()}),t.on("canvas.viewbox.changed",function(e){var t=e.viewbox;n._centerGridAroundViewbox(t)})}Ip.prototype._init=function(){var e=(0,m.P)("defs",this._canvas._svg);e||(e=(0,h.vt)("defs"),(0,h.BC)(this._canvas._svg,e));var t=this._pattern=(0,h.vt)("pattern"),n="djs-grid-pattern-"+Math.trunc(1e6*Math.random());(0,h.CF)(t,{id:n,width:Mp.E,height:Mp.E,patternUnits:"userSpaceOnUse"});var i=this._circle=(0,h.vt)("circle");(0,h.CF)(i,{cx:.5,cy:.5,r:.5,fill:"#ccc"}),(0,h.BC)(t,i),(0,h.BC)(e,t);var a=this._gfx=(0,h.vt)("rect");(0,h.CF)(a,{x:-5e4,y:-5e4,width:1e5,height:1e5,fill:`url(#${n})`})},Ip.prototype._centerGridAroundViewbox=function(e){e||(e=this._canvas.viewbox());var t=(0,st.pp)(e);(0,h.CF)(this._gfx,{x:-5e4+(0,Mp.y)(t.x,Mp.E),y:-5e4+(0,Mp.y)(t.y,Mp.E)})},Ip.prototype.isVisible=function(){return this._visible},Ip.prototype.toggle=function(e){if(void 0===e&&(e=!this._visible),e!==this._visible){var t=this._getParent();e?(0,h.BC)(t,this._gfx):(0,h.IU)(t),this._visible=e}},Ip.prototype._getParent=function(){return this._canvas.getLayer("djs-grid",-2)},Ip.$inject=["canvas","eventBus"];var Fp={__init__:["grid"],grid:["type",Ip]},jp=n(72969),Op=n(99186);function Lp(e){function t(e){if(!e.labelTarget){var t=(0,be.Cf)(e);(0,be.is)(t,"bpmn:Participant")&&(t=t.processRef),(0,be.is)(t,"bpmn:Process")&&(t.isExecutable=!!t.isExecutable)}}e.on(["shape.added","root.added"],function(e){t(e.element)}),e.on("elements.changed",function(e){e.elements.forEach(function(e){t(e)})})}Lp.$inject=["eventBus"];const $p={__init__:[Lp]},zp="bpmn-js-clip----";class Vp{constructor(e,t,n){this._eventBus=e,this._handleCopied=e=>{!1!==e.hints?.clip&&(navigator.clipboard.writeText(zp+JSON.stringify(e.tree)).catch(e=>{this._handleError("failed to populate clipboard",e)}),e.hints.clip=!1)},this._handlePaste=e=>{if(e.tree)return;const i={...e};return navigator.clipboard.readText().then(e=>{if(!e?.startsWith(zp))return;const a=JSON.parse(e.substring(16),function(e){const t={};return function(n,i){if((0,l.isObject)(i)&&(0,l.isString)(i.$type)){const{id:n}=i;if(n&&t[n])return t[n];const a=i.$type,r=Object.assign({},i);if(delete r.$type,!e.getTypeDescriptor(a))return;const o=e.create(a,r);return n&&(t[n]=o),o}return i}}(n));t.paste({...i,tree:a})}).catch(e=>{this._handleError("failed to paste from clipboard",e)}),!1},this._handleError=(e,t)=>{console.error("[native-copy-paste]",e,t),this._eventBus.fire("native-copy-paste:error",{message:e,error:t})},this.toggle(void 0!==navigator.clipboard)}toggle(e){this._active!==e&&(e?(this._eventBus.on("copyPaste.elementsCopied",2050,this._handleCopied),this._eventBus.on("copyPaste.pasteElements",2050,this._handlePaste)):(this._eventBus.off("copyPaste.elementsCopied",this._handleCopied),this._eventBus.off("copyPaste.pasteElements",this._handlePaste)),this._active=e)}}Vp.$inject=["eventBus","copyPaste","moddle"];const Gp={__init__:["nativeCopyPaste"],nativeCopyPaste:["type",Vp]};var Hp=n(62124);function Wp(e={}){bp.call(this,e)}(0,i.A)(Wp,bp),Wp.prototype.getModules=function(e={}){return[...bp.prototype.getModules.call(this,e),e.disableAdjustOrigin?jp.A:Op.A,e.disableGrid?{}:Fp]},Wp.prototype._extensionModules=[Bp,$p,Gp,Hp.BpmnPropertiesPanelModule,Hp.BpmnPropertiesProviderModule],Wp.prototype._modules=[].concat(bp.prototype._modules,Wp.prototype._extensionModules)}}]);
//# sourceMappingURL=5297.js.map