"use strict";(self.webpackChunkcamunda_modeler_client=self.webpackChunkcamunda_modeler_client||[]).push([[6492],{36492(e,t,n){n.d(t,{A:()=>_});var a=n(7475),r=n(99719),o=n(70868),s=n(57094);class i{constructor(e){e.on("moddleCopy.canCopyProperty",e=>{const{parent:t,property:n}=e;return this.canCopyProperty(n,t)})}canCopyProperty(e,t){return!((0,s.isObject)(e)&&!function(e,t){var n=e.$type&&e.$model.getTypeDescriptor(e.$type),a=n&&n.meta&&n.meta.allowedIn;return!(a&&!function(e){return e.includes("*")}(a))||(0,s.some)(a,function(e){return c(t,e)})}(e,t))&&!((0,o.is)(e,"camunda:InputOutput")&&!this.canHostInputOutput(t))&&!((0,o.f7)(e,["camunda:Connector","camunda:Field"])&&!this.canHostConnector(t))&&!((0,o.is)(e,"camunda:In")&&!this.canHostIn(t))&&void 0}canHostInputOutput(e){if(c(e,"camunda:Connector"))return!0;const t=c(e,"bpmn:FlowNode");return!(!t||(0,o.f7)(t,["bpmn:StartEvent","bpmn:Gateway","bpmn:BoundaryEvent"])||(0,o.is)(t,"bpmn:SubProcess")&&t.get("triggeredByEvent"))}canHostConnector(e){const t=c(e,"camunda:ServiceTaskLike");return!(0,o.is)(t,"bpmn:MessageEventDefinition")||c(e,"bpmn:IntermediateThrowEvent")||c(e,"bpmn:EndEvent")}canHostIn(e){return!!c(e,"bpmn:CallActivity")||(!c(e,"bpmn:SignalEventDefinition")||c(e,"bpmn:IntermediateThrowEvent")||c(e,"bpmn:EndEvent"))}}function c(e,t){return t?(0,o.is)(e,t)?e:e.$parent?c(e.$parent,t):void 0:e.$parent}i.$inject=["eventBus"];var u=n(98142),d=n(93742);class m extends u.A{constructor(e,t,n,a){function r(e){const n=t.getDefinitions().get("rootElements");return!!(0,s.find)(n,(0,s.matchPattern)({id:e.get("id")}))}super(n),this.executed("shape.create",e=>{const{shape:n}=e,a=(0,o.Cf)(n);if(!f(a))return;const s=v(a,p(n)),i=t.getDefinitions().get("rootElements");e.addedRootElements=[],s.forEach(t=>{const{referencedElement:n}=t;n&&!r(n)&&((0,d.WQ)(i,n),e.addedRootElements.push(n))})},!0),this.reverted("shape.create",e=>{const{addedRootElements:n}=e;if(!n)return;const a=t.getDefinitions().get("rootElements");n.forEach(e=>{(0,d.TF)(a,e)})},!0),n.on("copyPaste.copyElement",function(e){const{descriptor:t,element:n}=e,a=(0,o.Cf)(n);if(n.labelTarget||!f(a))return;const r=v(a,p(n));r&&(t.referencedRootElements=r)}),n.on("copyPaste.pasteElement",500,t=>{const{descriptor:n}=t,{businessObject:o,referencedRootElements:s}=n;s&&(s.forEach(t=>{let{idx:n,referencedElement:s}=t;s&&(r(s)||(s=a.copyElement(s,e.create(s.$type))),function(e,t,n){const a=e.get("extensionElements").get("values")[n];a.set(l(a),t)}(o,s,n))}),delete n.referencedRootElements)})}}function p(e){if((0,o.is)(e,"bpmn:ServiceTask"))return"camunda:ErrorEventDefinition"}function l(e){if((0,o.is)(e,"camunda:ErrorEventDefinition"))return"errorRef"}function f(e){return(0,o.is)(e,"bpmn:ServiceTask")&&"external"===e.get("type")}function v(e,t){const n=e.get("extensionElements");return n?n.get("values").filter(e=>(0,o.is)(e,t)).reduce((t,n)=>{const a=n.get(l(n));return a&&t.push({idx:E(e,n),referencedElement:a}),t},[]):[]}function E(e,t){const n=e.get("extensionElements");return n?n.get("values").indexOf(t):-1}m.$inject=["bpmnFactory","bpmnjs","eventBus","moddleCopy"];var h=n(93693);class y extends u.A{constructor(e,t){super(t),this.postExecute(["element.updateProperties","element.updateModdleProperties"],5e3,function(t){const{element:n,moddleElement:a,properties:r}=t,s=a||(0,o.Cf)(n);if((0,o.is)(n,"camunda:ExternalCapable")&&(0,o.is)(s,"camunda:ExternalCapable")&&"external"!==r["camunda:type"]){const t=(0,h.t)(s,"camunda:ErrorEventDefinition");t.length&&(0,h.V)(n,s,t,e)}},!0)}}y.$inject=["commandStack","eventBus"];var g=n(30261);class b extends u.A{constructor(e,t){super(t),this.postExecute(["element.updateProperties","element.updateModdleProperties"],5e3,function(t){const{element:n,moddleElement:a,properties:r={}}=t,s=r["camunda:asyncAfter"],i=r["camunda:asyncBefore"],c=a||(0,o.Cf)(n),u=function(e){return(0,h.t)(e,"camunda:FailedJobRetryTimeCycle")[0]}(n);!(0,o.is)(n,"camunda:AsyncCapable")||!(0,o.is)(c,"camunda:AsyncCapable")||!1!==s&&!1!==i||!u||function(e){return function(e){const t=(0,o.Cf)(e).get("eventDefinitions");if(t&&t.length)return t.find(e=>(0,o.is)(e,"bpmn:TimerEventDefinition"))}(e)}(n)||function(e){return!(!e.get("camunda:asyncBefore")&&!e.get("camunda:async"))}(c)||function(e){return!!e.get("camunda:asyncAfter")}(c)||(0,h.V)(n,c,u,e)},!0)}}b.$inject=["commandStack","eventBus"];class B extends u.A{constructor(e,t){super(e),this._modeling=t,this.postExecuted(["element.updateProperties","element.updateModdleProperties"],250,e=>{const t=e.shape||e.newShape||e.element;(0,o.is)(t,"bpmn:CallActivity")&&this.orderCallActivityExtensionElements(t)},!0)}orderCallActivityExtensionElements(e){const t=e.businessObject.get("extensionElements");if(!t)return;const{input:n,output:a,rest:r}=(0,h.t)(e).reduce((e,t)=>((0,o.is)(t,"camunda:In")?e.input.push(t):(0,o.is)(t,"camunda:Out")?e.output.push(t):e.rest.push(t),e),{input:[],output:[],rest:[]});P(n),P(a);const s=[...n,...a,...r],i=t.get("values");JSON.stringify(i)!==JSON.stringify(s)&&this._modeling.updateModdleProperties(e,t,{values:s})}}function P(e){const t=e.findIndex(e=>!!e.variables);if(t>0){const n=e.splice(t,1)[0];e.unshift(n)}}B.$inject=["eventBus","modeling"];class x extends u.A{constructor(e,t){super(e),this.postExecuted(["shape.create","shape.move"],e=>{const{shape:n,parent:a,newParent:r=a}=e,i=(0,o.Cf)(n);(0,o.is)(n,"bpmn:StartEvent")&&(0,s.isDefined)(i.get("camunda:initiator"))&&(0,o.is)(r||a,"bpmn:SubProcess")&&t.updateProperties(n,{"camunda:initiator":void 0})},!0)}}x.$inject=["eventBus","modeling"];class C extends u.A{constructor(e,t,n,a){super(t),this.postExecuted(["shape.create","shape.move"],t=>{const{parent:r,newParent:s=r,shape:i}=t,c=(0,o.Cf)(s),u=(0,o.Cf)(i);if((0,o.is)(i,"bpmn:StartEvent")&&(!(0,o.is)(s,"bpmn:SubProcess")||!c.get("triggeredByEvent"))){const t=u.get("eventDefinitions").slice();t.reduce((a,r,s)=>{if((0,o.is)(r,"bpmn:ConditionalEventDefinition")){if(r.get("camunda:variableEvents")){const a=e.create("bpmn:ConditionalEventDefinition");return n.copyElement(r,a),a.$parent=r.$parent,a.variableEvents=void 0,t[s]=a,!0}return a}},!1)&&a.updateProperties(i,{eventDefinitions:t})}},!0)}}C.$inject=["bpmnFactory","eventBus","moddleCopy","modeling"];class A extends u.A{constructor(e){super(e),this.preExecute(["element.updateProperties","element.updateModdleProperties"],5e3,function(e){const{element:t,moddleElement:n,properties:a={}}=e,r=n||(0,o.Cf)(t),s=a["camunda:asyncAfter"],i=a["camunda:asyncBefore"];!(0,o.is)(t,"camunda:AsyncCapable")||!(0,o.is)(r,"camunda:AsyncCapable")||!1!==s&&!1!==i||function(e){return!!e.get("camunda:exclusive")}(r)||function(e){return!!e.get("camunda:asyncAfter")}(r)&&!1!==s||function(e){return!(!e.get("camunda:asyncBefore")&&!e.get("camunda:async"))}(r)&&!1!==i||!0===s||!0===i||(a["camunda:exclusive"]=!0)},!0)}}A.$inject=["eventBus"];class R extends u.A{constructor(e,t){super(t),this.postExecuted("element.updateModdleProperties",250,function(t){const{element:n,moddleElement:a}=t;(0,o.is)(a,"camunda:InputOutput")&&function(e){const t=function(e){return e.get("inputParameters")}(e),n=function(e){return e.get("outputParameters")}(e);return!t.length&&!n.length}(a)&&(0,h.V)(n,(0,o.Cf)(n),a,e)},!0)}}R.$inject=["commandStack","eventBus"];class D extends u.A{constructor(e){super(e),this.preExecute(["element.updateProperties","element.updateModdleProperties"],5e3,function(e){const{element:t,moddleElement:n,properties:a}=e,r=n||(0,o.Cf)(t);var i;(0,o.is)(t,"camunda:DmnCapable")&&(0,o.is)(r,"camunda:DmnCapable")&&(0,s.has)(a,"camunda:resultVariable")&&(null==(i=a["camunda:resultVariable"])||""===i)&&(a["camunda:mapDecisionResult"]=void 0)},!0)}}D.$inject=["eventBus"];class j extends u.A{constructor(e){super(e),this.preExecute(["element.updateProperties","element.updateModdleProperties"],function(e){const{element:t,moddleElement:n,properties:a}=e,r=n||(0,o.Cf)(t);(0,s.has)(a,"camunda:formKey")?Object.assign(a,{"camunda:formRef":void 0,"camunda:formRefBinding":void 0,"camunda:formRefVersion":void 0}):(0,s.has)(a,"camunda:formRef")&&(Object.assign(a,{"camunda:formKey":void 0}),(0,s.isUndefined)(a["camunda:formRef"])&&Object.assign(a,{"camunda:formRefBinding":void 0,"camunda:formRefVersion":void 0}),!(0,s.has)(a,"camunda:formRefBinding")&&(0,s.isUndefined)(r.get("camunda:formRefBinding"))&&Object.assign(a,{"camunda:formRefBinding":"latest"})),(0,s.has)(a,"camunda:formRefBinding")&&"version"!==a["camunda:formRefBinding"]&&Object.assign(a,{"camunda:formRefVersion":void 0})},!0)}}j.$inject=["eventBus"];class $ extends u.A{constructor(e,t){super(e),this.preExecute("element.updateModdleProperties",function(e){const{moddleElement:t,properties:n}=e;(0,o.is)(t,"camunda:FormField")&&("type"in n&&"enum"!==n.type||"camunda:type"in n&&"enum"!==n["camunda:type"])&&(n["camunda:values"]=void 0)},!0),this.preExecute("element.updateModdleProperties",function(e){const{element:n,moddleElement:a,properties:r}=e;if(!(0,o.is)(a,"camunda:FormField")||!(0,s.has)(r,"id")&&!(0,s.has)(r,"camunda:id"))return;const i=function(e){const t=(0,o.Cf)(e).get("extensionElements");if(t)return t.get("values").find(e=>(0,o.is)(e,"camunda:FormData"))}(n);i.get("camunda:businessKey")&&function(e,t){return e.get("camunda:id")===t.get("camunda:businessKey")}(a,i)&&t.updateModdleProperties(n,i,{"camunda:businessKey":(0,s.has)(r,"id")?r.id:r["camunda:id"]})},!0),this.postExecute("element.updateModdleProperties",function(e){const{element:n,moddleElement:a,properties:r}=e;if(!(0,o.is)(a,"camunda:FormData")||!(0,s.has)(r,"fields"))return;const i=a.get("camunda:businessKey");i&&(a.get("fields").find(e=>e.get("camunda:id")===i)||t.updateModdleProperties(n,a,{"camunda:businessKey":void 0}))},!0)}}$.$inject=["eventBus","modeling"];const O={__init__:["copyPasteBehavior","copyPasteRootElementBehavior","deleteErrorEventDefinitionBehavior","deleteParticipantBehaviour","deleteRetryTimeCycleBehavior","orderExtensionElementsBehavior","removeInitiatorBehaviour","removeVariableEventBehaviour","updateCamundaExclusiveBehavior","updateResultVariableBehavior","updateInputOutputBehavior","userTaskFormsBehavior","userTaskGeneratedFormsBehavior"],copyPasteBehavior:["type",i],copyPasteRootElementBehavior:["type",m],deleteErrorEventDefinitionBehavior:["type",y],deleteParticipantBehaviour:["type",g.A],deleteRetryTimeCycleBehavior:["type",b],orderExtensionElementsBehavior:["type",B],removeInitiatorBehaviour:["type",x],removeVariableEventBehaviour:["type",C],updateCamundaExclusiveBehavior:["type",A],updateResultVariableBehavior:["type",D],updateInputOutputBehavior:["type",R],userTaskFormsBehavior:["type",j],userTaskGeneratedFormsBehavior:["type",$]};var M=n(62124),T=n(72584),F=n(28148);const I={camunda:n(91708)};var S=n(5418),k=n(33428);function _(e={}){e={...e,moddleExtensions:{...I,...e.moddleExtensions},propertiesPanel:{tooltip:M.CamundaPlatformTooltipProvider,...e.propertiesPanel}},r.A.call(this,e)}(0,a.A)(_,r.A),_.prototype._camundaPlatformModules=[O,M.CamundaPlatformPropertiesProviderModule,T.mJ,S.A,k.t7,F.e1,k.y],_.prototype._modules=[].concat(r.A.prototype._modules,_.prototype._camundaPlatformModules)}}]);
//# sourceMappingURL=6492.js.map