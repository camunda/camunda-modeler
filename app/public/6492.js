"use strict";(self.webpackChunkcamunda_modeler_client=self.webpackChunkcamunda_modeler_client||[]).push([[6492],{36492:(e,t,n)=>{n.d(t,{A:()=>_});var r=n(7475),a=n(51311),o=n(70868),s=n(76522);class i{constructor(e){e.on("moddleCopy.canCopyProperty",(e=>{const{parent:t,property:n}=e;return this.canCopyProperty(n,t)}))}canCopyProperty(e,t){return!((0,s.Gv)(e)&&!function(e,t){var n=e.$type&&e.$model.getTypeDescriptor(e.$type),r=n&&n.meta&&n.meta.allowedIn;return!(r&&!function(e){return e.includes("*")}(r))||(0,s.zN)(r,(function(e){return c(t,e)}))}(e,t))&&!((0,o.is)(e,"camunda:InputOutput")&&!this.canHostInputOutput(t))&&!((0,o.f7)(e,["camunda:Connector","camunda:Field"])&&!this.canHostConnector(t))&&!((0,o.is)(e,"camunda:In")&&!this.canHostIn(t))&&void 0}canHostInputOutput(e){if(c(e,"camunda:Connector"))return!0;const t=c(e,"bpmn:FlowNode");return!(!t||(0,o.f7)(t,["bpmn:StartEvent","bpmn:Gateway","bpmn:BoundaryEvent"])||(0,o.is)(t,"bpmn:SubProcess")&&t.get("triggeredByEvent"))}canHostConnector(e){const t=c(e,"camunda:ServiceTaskLike");return!(0,o.is)(t,"bpmn:MessageEventDefinition")||c(e,"bpmn:IntermediateThrowEvent")||c(e,"bpmn:EndEvent")}canHostIn(e){return!!c(e,"bpmn:CallActivity")||(!c(e,"bpmn:SignalEventDefinition")||c(e,"bpmn:IntermediateThrowEvent")||c(e,"bpmn:EndEvent"))}}function c(e,t){return t?(0,o.is)(e,t)?e:e.$parent?c(e.$parent,t):void 0:e.$parent}i.$inject=["eventBus"];var u=n(98142),d=n(93742);class m extends u.A{constructor(e,t,n,r){function a(e){const n=t.getDefinitions().get("rootElements");return!!(0,s.I6)(n,(0,s.gH)({id:e.get("id")}))}super(n),this.executed("shape.create",(e=>{const{shape:n}=e,r=(0,o.Cf)(n);if(!f(r))return;const s=v(r,p(n)),i=t.getDefinitions().get("rootElements");e.addedRootElements=[],s.forEach((t=>{const{referencedElement:n}=t;n&&!a(n)&&((0,d.WQ)(i,n),e.addedRootElements.push(n))}))}),!0),this.reverted("shape.create",(e=>{const{addedRootElements:n}=e;if(!n)return;const r=t.getDefinitions().get("rootElements");n.forEach((e=>{(0,d.TF)(r,e)}))}),!0),n.on("copyPaste.copyElement",(function(e){const{descriptor:t,element:n}=e,r=(0,o.Cf)(n);if(n.labelTarget||!f(r))return;const a=v(r,p(n));a&&(t.referencedRootElements=a)})),n.on("copyPaste.pasteElement",500,(t=>{const{descriptor:n}=t,{businessObject:o,referencedRootElements:s}=n;s&&(s.forEach((t=>{let{idx:n,referencedElement:s}=t;s&&(a(s)||(s=r.copyElement(s,e.create(s.$type))),function(e,t,n){const r=e.get("extensionElements").get("values")[n];r.set(l(r),t)}(o,s,n))})),delete n.referencedRootElements)}))}}function p(e){if((0,o.is)(e,"bpmn:ServiceTask"))return"camunda:ErrorEventDefinition"}function l(e){if((0,o.is)(e,"camunda:ErrorEventDefinition"))return"errorRef"}function f(e){return(0,o.is)(e,"bpmn:ServiceTask")&&"external"===e.get("type")}function v(e,t){const n=e.get("extensionElements");return n?n.get("values").filter((e=>(0,o.is)(e,t))).reduce(((t,n)=>{const r=n.get(l(n));return r&&t.push({idx:y(e,n),referencedElement:r}),t}),[]):[]}function y(e,t){const n=e.get("extensionElements");return n?n.get("values").indexOf(t):-1}m.$inject=["bpmnFactory","bpmnjs","eventBus","moddleCopy"];var E=n(93693);class h extends u.A{constructor(e,t){super(t),this.postExecute(["element.updateProperties","element.updateModdleProperties"],5e3,(function(t){const{element:n,moddleElement:r,properties:a}=t,s=r||(0,o.Cf)(n);if((0,o.is)(n,"camunda:ExternalCapable")&&(0,o.is)(s,"camunda:ExternalCapable")&&"external"!==a["camunda:type"]){const t=(0,E.t)(s,"camunda:ErrorEventDefinition");t.length&&(0,E.V)(n,s,t,e)}}),!0)}}h.$inject=["commandStack","eventBus"];var g=n(30261);class b extends u.A{constructor(e,t){super(t),this.postExecute(["element.updateProperties","element.updateModdleProperties"],5e3,(function(t){const{element:n,moddleElement:r,properties:a={}}=t,s=a["camunda:asyncAfter"],i=a["camunda:asyncBefore"],c=r||(0,o.Cf)(n),u=function(e){return(0,E.t)(e,"camunda:FailedJobRetryTimeCycle")[0]}(n);!(0,o.is)(n,"camunda:AsyncCapable")||!(0,o.is)(c,"camunda:AsyncCapable")||!1!==s&&!1!==i||!u||function(e){return function(e){const t=(0,o.Cf)(e).get("eventDefinitions");if(t&&t.length)return t.find((e=>(0,o.is)(e,"bpmn:TimerEventDefinition")))}(e)}(n)||function(e){return!(!e.get("camunda:asyncBefore")&&!e.get("camunda:async"))}(c)||function(e){return!!e.get("camunda:asyncAfter")}(c)||(0,E.V)(n,c,u,e)}),!0)}}b.$inject=["commandStack","eventBus"];class B extends u.A{constructor(e,t){super(e),this._modeling=t,this.postExecuted(["element.updateProperties","element.updateModdleProperties"],250,(e=>{const t=e.shape||e.newShape||e.element;(0,o.is)(t,"bpmn:CallActivity")&&this.orderCallActivityExtensionElements(t)}),!0)}orderCallActivityExtensionElements(e){const t=e.businessObject.get("extensionElements");if(!t)return;const{input:n,output:r,rest:a}=(0,E.t)(e).reduce(((e,t)=>((0,o.is)(t,"camunda:In")?e.input.push(t):(0,o.is)(t,"camunda:Out")?e.output.push(t):e.rest.push(t),e)),{input:[],output:[],rest:[]});P(n),P(r);const s=[...n,...r,...a],i=t.get("values");JSON.stringify(i)!==JSON.stringify(s)&&this._modeling.updateModdleProperties(e,t,{values:s})}}function P(e){const t=e.findIndex((e=>!!e.variables));if(t>0){const n=e.splice(t,1)[0];e.unshift(n)}}B.$inject=["eventBus","modeling"];class x extends u.A{constructor(e,t){super(e),this.postExecuted(["shape.create","shape.move"],(e=>{const{shape:n,parent:r,newParent:a=r}=e,i=(0,o.Cf)(n);(0,o.is)(n,"bpmn:StartEvent")&&(0,s.O9)(i.get("camunda:initiator"))&&(0,o.is)(a||r,"bpmn:SubProcess")&&t.updateProperties(n,{"camunda:initiator":void 0})}),!0)}}x.$inject=["eventBus","modeling"];class C extends u.A{constructor(e,t,n,r){super(t),this.postExecuted(["shape.create","shape.move"],(t=>{const{parent:a,newParent:s=a,shape:i}=t,c=(0,o.Cf)(s),u=(0,o.Cf)(i);if((0,o.is)(i,"bpmn:StartEvent")&&(!(0,o.is)(s,"bpmn:SubProcess")||!c.get("triggeredByEvent"))){const t=u.get("eventDefinitions").slice();t.reduce(((r,a,s)=>{if((0,o.is)(a,"bpmn:ConditionalEventDefinition")){if(a.get("camunda:variableEvents")){const r=e.create("bpmn:ConditionalEventDefinition");return n.copyElement(a,r),r.$parent=a.$parent,r.variableEvents=void 0,t[s]=r,!0}return r}}),!1)&&r.updateProperties(i,{eventDefinitions:t})}}),!0)}}C.$inject=["bpmnFactory","eventBus","moddleCopy","modeling"];class A extends u.A{constructor(e){super(e),this.preExecute(["element.updateProperties","element.updateModdleProperties"],5e3,(function(e){const{element:t,moddleElement:n,properties:r={}}=e,a=n||(0,o.Cf)(t),s=r["camunda:asyncAfter"],i=r["camunda:asyncBefore"];!(0,o.is)(t,"camunda:AsyncCapable")||!(0,o.is)(a,"camunda:AsyncCapable")||!1!==s&&!1!==i||function(e){return!!e.get("camunda:exclusive")}(a)||function(e){return!!e.get("camunda:asyncAfter")}(a)&&!1!==s||function(e){return!(!e.get("camunda:asyncBefore")&&!e.get("camunda:async"))}(a)&&!1!==i||!0===s||!0===i||(r["camunda:exclusive"]=!0)}),!0)}}A.$inject=["eventBus"];class R extends u.A{constructor(e,t){super(t),this.postExecuted("element.updateModdleProperties",250,(function(t){const{element:n,moddleElement:r}=t;(0,o.is)(r,"camunda:InputOutput")&&function(e){const t=function(e){return e.get("inputParameters")}(e),n=function(e){return e.get("outputParameters")}(e);return!t.length&&!n.length}(r)&&(0,E.V)(n,(0,o.Cf)(n),r,e)}),!0)}}R.$inject=["commandStack","eventBus"];class D extends u.A{constructor(e){super(e),this.preExecute(["element.updateProperties","element.updateModdleProperties"],5e3,(function(e){const{element:t,moddleElement:n,properties:r}=e,a=n||(0,o.Cf)(t);var i;(0,o.is)(t,"camunda:DmnCapable")&&(0,o.is)(a,"camunda:DmnCapable")&&(0,s.zy)(r,"camunda:resultVariable")&&(null==(i=r["camunda:resultVariable"])||""===i)&&(r["camunda:mapDecisionResult"]=void 0)}),!0)}}D.$inject=["eventBus"];class $ extends u.A{constructor(e){super(e),this.preExecute(["element.updateProperties","element.updateModdleProperties"],(function(e){const{element:t,moddleElement:n,properties:r}=e,a=n||(0,o.Cf)(t);(0,s.zy)(r,"camunda:formKey")?Object.assign(r,{"camunda:formRef":void 0,"camunda:formRefBinding":void 0,"camunda:formRefVersion":void 0}):(0,s.zy)(r,"camunda:formRef")&&(Object.assign(r,{"camunda:formKey":void 0}),(0,s.b0)(r["camunda:formRef"])&&Object.assign(r,{"camunda:formRefBinding":void 0,"camunda:formRefVersion":void 0}),!(0,s.zy)(r,"camunda:formRefBinding")&&(0,s.b0)(a.get("camunda:formRefBinding"))&&Object.assign(r,{"camunda:formRefBinding":"latest"})),(0,s.zy)(r,"camunda:formRefBinding")&&"version"!==r["camunda:formRefBinding"]&&Object.assign(r,{"camunda:formRefVersion":void 0})}),!0)}}$.$inject=["eventBus"];class j extends u.A{constructor(e,t){super(e),this.preExecute("element.updateModdleProperties",(function(e){const{moddleElement:t,properties:n}=e;(0,o.is)(t,"camunda:FormField")&&("type"in n&&"enum"!==n.type||"camunda:type"in n&&"enum"!==n["camunda:type"])&&(n["camunda:values"]=void 0)}),!0),this.preExecute("element.updateModdleProperties",(function(e){const{element:n,moddleElement:r,properties:a}=e;if(!(0,o.is)(r,"camunda:FormField")||!(0,s.zy)(a,"id")&&!(0,s.zy)(a,"camunda:id"))return;const i=function(e){const t=(0,o.Cf)(e).get("extensionElements");if(t)return t.get("values").find((e=>(0,o.is)(e,"camunda:FormData")))}(n);i.get("camunda:businessKey")&&function(e,t){return e.get("camunda:id")===t.get("camunda:businessKey")}(r,i)&&t.updateModdleProperties(n,i,{"camunda:businessKey":(0,s.zy)(a,"id")?a.id:a["camunda:id"]})}),!0),this.postExecute("element.updateModdleProperties",(function(e){const{element:n,moddleElement:r,properties:a}=e;if(!(0,o.is)(r,"camunda:FormData")||!(0,s.zy)(a,"fields"))return;const i=r.get("camunda:businessKey");i&&(r.get("fields").find((e=>e.get("camunda:id")===i))||t.updateModdleProperties(n,r,{"camunda:businessKey":void 0}))}),!0)}}j.$inject=["eventBus","modeling"];const O={__init__:["copyPasteBehavior","copyPasteRootElementBehavior","deleteErrorEventDefinitionBehavior","deleteParticipantBehaviour","deleteRetryTimeCycleBehavior","orderExtensionElementsBehavior","removeInitiatorBehaviour","removeVariableEventBehaviour","updateCamundaExclusiveBehavior","updateResultVariableBehavior","updateInputOutputBehavior","userTaskFormsBehavior","userTaskGeneratedFormsBehavior"],copyPasteBehavior:["type",i],copyPasteRootElementBehavior:["type",m],deleteErrorEventDefinitionBehavior:["type",h],deleteParticipantBehaviour:["type",g.A],deleteRetryTimeCycleBehavior:["type",b],orderExtensionElementsBehavior:["type",B],removeInitiatorBehaviour:["type",x],removeVariableEventBehaviour:["type",C],updateCamundaExclusiveBehavior:["type",A],updateResultVariableBehavior:["type",D],updateInputOutputBehavior:["type",R],userTaskFormsBehavior:["type",$],userTaskGeneratedFormsBehavior:["type",j]};var I=n(92106),M=n(75864),T=n(84639);const F={camunda:n(91708)};var S=n(5418),k=n(33428);function _(e={}){e={...e,moddleExtensions:{...F,...e.moddleExtensions},propertiesPanel:{tooltip:I.CamundaPlatformTooltipProvider,...e.propertiesPanel}},a.A.call(this,e)}(0,r.A)(_,a.A),_.prototype._camundaPlatformModules=[O,I.CamundaPlatformPropertiesProviderModule,M.mJ,S.A,k.t7,T.e1,k.y],_.prototype._modules=[].concat(a.A.prototype._modules,_.prototype._camundaPlatformModules)}}]);
//# sourceMappingURL=6492.js.map