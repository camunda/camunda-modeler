"use strict";(self.webpackChunkcamunda_modeler_client=self.webpackChunkcamunda_modeler_client||[]).push([[6827],{3164:(e,t,n)=>{function o(e,t,n){function o(e){n.activateMove(e),window.removeEventListener("mousemove",o)}t.register("activateHandtool",(function(){n.isActive()||window.addEventListener("mousemove",o)})),t.register("deactivateHandtool",(function(){window.removeEventListener("mousemove",o),e.cancel()}))}n.d(t,{A:()=>r}),o.$inject=["dragging","editorActions","handTool"];const r={__init__:["handToolOnSpace"],handToolOnSpace:["type",o]}},11876:(e,t,n)=>{function o(e,t,n,o){if(!o)throw new Error("<config.changeTemplateCommand> not provided");const r=e.getAll().reduce(((e,n)=>{const r=t.getDefault(n);if(!r)return e;const i=function(e,t,n){return{cmd:n,context:{element:e,newTemplate:t}}}(n,r,o);return[...e,i]}),[]);0!==r.length&&(n.execute("properties-panel.multi-command-executor",r),n.clear())}n.d(t,{A:()=>o}),o.$inject=["elementRegistry","elementTemplates","commandStack","config.changeTemplateCommand"]},22764:(e,t,n)=>{n.d(t,{r:()=>r});var o=n(13);function r(e){const{defaultCopyCutPaste:t,defaultUndoRedo:n}=e;return[n?(0,o.ce)(!0):(0,o.lP)(e),t?(0,o.Ox)(!0):(0,o.$C)(e),(0,o.Tm)(e),(0,o.Bk)(e),(0,o.en)(e),(0,o.f7)(e),[...(0,o.f9)(e),...(0,o.$v)(e)]]}},23719:(e,t,n)=>{function o(e){return function({copy:e,paste:t}){return[{label:"Copy",accelerator:"CommandOrControl+C",enabled:e,action:"copy"},{label:"Paste",accelerator:"CommandOrControl+V",enabled:t,action:"paste"}]}(e)}n.d(t,{A:()=>o})},23863:(e,t,n)=>{function o(e){e.register({appendElement:function(...t){return e.trigger("appendCreatePad",...t)}})}n.d(t,{S:()=>r}),o.$inject=["editorActions"];const r={__depends__:[n(27616).SE],__init__:["improvedCanvasEditorActionsAdapter"],improvedCanvasEditorActionsAdapter:["type",o]}},28228:(e,t,n)=>{function o(e){return[...r(e),...i(e),...a(e)]}function r({zoom:e}){return e?[{label:"Zoom In",accelerator:"CommandOrControl+=",action:"zoomIn"},{label:"Zoom Out",accelerator:"CommandOrControl+-",action:"zoomOut"},{label:"Zoom to Actual Size",accelerator:"CommandOrControl+0",action:"resetZoom"},{label:"Zoom to Fit Diagram",accelerator:"CommandOrControl+1",action:"zoomFit"},{type:"separator"}]:[]}function i({propertiesPanel:e}){return e?[{label:"Toggle Properties Panel",accelerator:"CommandOrControl+P",action:"toggleProperties"}]:[]}function a({grid:e}){return e?[{label:"Toggle Grid",accelerator:"CommandOrControl+G",action:"toggleGrid"}]:[]}n.d(t,{A:()=>o})},66827:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ae});var o=n(63696),r=n(29905),i=n(45782),a=n(46165),s=n(99492),l=n(28340),d=n(36492),c=n(49281),p=n(76566);const m={clipboard:["value",new(n(62639).A)]};var g=n(3164),h=n(23395),A=n(30939),u=n(66778),f=n(57834),v=n(40802),y=n(56927),C=n(65321),b=n(8493),E=n(23863),x=n(63417);class P extends d.A{constructor(e={}){let{additionalModules:t=[],moddleExtensions:n={},settings:o,...r}=e;o.get("app.newContextPad")&&(t=[...t,{__depends__:[E.S],resourceLinkingContextPadProvider:["value",null],resourceLinkingRules:["value",null],showComments:["value",null]}]),super({...r,additionalModules:t,moddleExtensions:n,disableAdjustOrigin:x.Ay.get(x.Uo),canvas:{autoFocus:!0}})}}const k=d.A.prototype._modules,M=[c.A,p.A,m,g.A,h.A,A.A,u.A,f.A,v.A,y.A,C.A,b.A];P.prototype._modules=[...k,...M];var L=n(2249),w=n(23719),I=n(22764),T=n(28228),S=n(95292),B=n.n(S),D=n(49893),N=n.n(D),_=n(9383),j=n.n(_),R=n(56884),z=n.n(R),O=n(99088),H=n.n(O),X=n(27997),F=n.n(X),U=n(94820),Z={};Z.styleTagTransform=F(),Z.setAttributes=z(),Z.insert=j().bind(null,"head"),Z.domAPI=N(),Z.insertStyleElement=H(),B()(U.Ay,Z),U.Ay&&U.Ay.locals&&U.Ay.locals;var G=n(63062),J=n(11876),V=n(82472),$=n(81993),W=n(32901),Y=n(32133),q=n(45369),Q=n(82665),K=n(30006);const ee={uri:"http://camunda.org/schema/1.0/bpmn",prefix:"camunda"},te=["png","jpeg","svg"],ne={executionPlatform:Q.ug.PLATFORM};class oe extends s.OB{constructor(e){super(e),this.state={},this.ref=o.createRef(),this.propertiesPanelRef=o.createRef(),this.engineProfile=new q.A({get:()=>{const e=this.getModeler().getDefinitions();return(0,Y.FX)(e,ne)},set:e=>{const t=this.getModeler(),n=t.get("canvas"),o=t.get("modeling"),r=t.getDefinitions(),{executionPlatform:i,executionPlatformVersion:a}=e;o.updateModdleProperties(n.getRootElement(),r,{"modeler:executionPlatform":i,"modeler:executionPlatformVersion":a})},getCached:()=>this.getCached(),setCached:e=>this.setCached(e)}),this.handleResize=(0,a.sg)(this.handleResize),this.handleLintingDebounced=(0,a.sg)(this.handleLinting.bind(this)),this.handlePropertiesPanelLayoutChange=this.handlePropertiesPanelLayoutChange.bind(this),this.handleLayoutChange=this.handleLayoutChange.bind(this)}async componentDidMount(){this._isMounted=!0;const{layout:e}=this.props,t=this.getModeler();this.listen("on"),t.attachTo(this.ref.current),t.get("minimap").toggle(!0===e.minimap?.open),t.get("grid").toggle(!1!==e.grid?.visible);const n=t.get("propertiesPanel");e.propertiesPanel&&n.setLayout(e.propertiesPanel),n.attachTo(this.propertiesPanelRef.current);try{await this.loadTemplates()}catch(e){this.handleError({error:e})}this.checkImport()}componentWillUnmount(){this._isMounted=!1;const e=this.getModeler();this.listen("off"),e.detach(),e.get("propertiesPanel").detach()}componentDidUpdate(e){this.checkImport(e),function(e,t){return e.cachedState!==t.cachedState}(e,this.props)&&this.handleChanged(),e.linting!==this.props.linting&&this.getModeler().get("linting").setErrors(this.props.linting||[]),e.file!==this.props.file&&this.loadTemplates();const{layout:t={}}=this.props,{panel:n={}}=t;n.open&&"linting"===n.tab?this.getModeler().get("linting").activate():n.open&&"linting"===n.tab||this.getModeler().get("linting").deactivate(),function(e,t){return t.layout!==e.layout&&(!t.layout||!e.layout||JSON.stringify(e.layout.propertiesPanel)!==JSON.stringify(t.layout.propertiesPanel))}(e,this.props)&&this.getModeler().get("propertiesPanel").setLayout(this.props.layout.propertiesPanel),function(e,t){return t.layout?.grid?.visible!==e.layout?.grid?.visible}(e,this.props)&&this.getModeler().get("grid").toggle(!1!==this.props.layout?.grid?.visible)}listen(e){const t=this.getModeler();t[e]("attach",this.handleAttach),["import.done","saveXML.done","commandStack.changed","selection.changed","attach","elements.copied","propertiesPanel.focusin","propertiesPanel.focusout","canvas.focus.changed"].forEach((n=>{t[e](n,this.handleChanged)})),t[e]("elementTemplates.errors",this.handleElementTemplateErrors),t[e]("error",1500,this.handleError),t[e]("minimap.toggle",this.handleMinimapToggle),t[e]("propertiesPanel.layoutChanged",this.handlePropertiesPanelLayoutChange),"on"===e?t[e]("commandStack.changed",500,this.handleLintingDebounced):"off"===e&&t[e]("commandStack.changed",this.handleLintingDebounced)}handlePropertiesPanelLayoutChange(e){this.handleLayoutChange({propertiesPanel:e.layout})}async loadTemplates(){const{getConfig:e}=this.props,t=this.getModeler().get("elementTemplatesLoader"),n=await e("bpmn.elementTemplates");t.setTemplates((0,K.R)(n))}undo=()=>{this.getModeler().get("commandStack").undo()};redo=()=>{this.getModeler().get("commandStack").redo()};handleAlignElements=e=>{this.triggerAction("alignElements",{type:e})};handleMinimapToggle=e=>{this.handleLayoutChange({minimap:{open:e.open}})};handleElementTemplateErrors=e=>{const{onWarning:t}=this.props,{errors:n}=e;n.forEach((e=>{t({message:e.message})}))};handleAttach=e=>{this.getModeler().get("canvas").focus()};handleError=e=>{const{error:t}=e,{onError:n}=this.props;n(t)};handleNamespace=async e=>{const t=(0,V.e)(e,"http://activiti.org/bpmn");if(!t)return e;if(!await this.shouldConvert())return e;const{onContentUpdated:n}=this.props,o=await(0,V.n)(e,t,ee);return n(o),o};async shouldConvert(){const{button:e}=await this.props.onAction("show-dialog",{type:"warning",title:"Deprecated <activiti> namespace detected",buttons:[{id:"cancel",label:"Cancel"},{id:"yes",label:"Yes"}],message:"Would you like to convert your diagram to the <camunda> namespace?",detail:["This will allow you to maintain execution related properties.","","<camunda> namespace support works from Camunda BPM versions 7.4.0, 7.3.3, 7.2.6 onwards."].join("\n")});return"yes"===e}handleImport=(e,t)=>{const{isNew:n,onImport:o,xml:r}=this.props;let{defaultTemplatesApplied:i}=this.getCached();const a=this.getModeler(),s=a.get("commandStack")._stackIdx;let l=null;if(!e)try{l=this.engineProfile.get(!0)}catch(t){e=t}if(!e&&n&&!i)try{a.invoke(J.A),i=!0}catch(t){e=t}if(e?this.setCached({defaultTemplatesApplied:!1,engineProfile:null,lastXML:null}):this.setCached({defaultTemplatesApplied:i,engineProfile:l,lastXML:r,stackIdx:s}),!e)try{this.handleLinting()}catch(t){e=t}this.setState({importing:!1}),o(e,t)};handleChanged=()=>{const e=this.getModeler(),{onChanged:t}=this.props,n=this.isDirty(),o=e.get("commandStack"),i=e.get("selection").get().length,a=(0,L.v)(),s=e.get("canvas").isFocused(),l={align:i>1,appendElement:s,canvasFocused:s,close:!0,copy:!!i,cut:!1,duplicate:s&&!!i,createElement:s,defaultCopyCutPaste:!s,defaultUndoRedo:!s,dirty:n,distribute:i>2,editLabel:s&&1===i,exportAs:te,find:s,globalConnectTool:s,handTool:s,inputActive:a,lassoTool:s,moveCanvas:s,moveToOrigin:s,moveSelection:s&&!!i,paste:!0,platform:"platform",propertiesPanel:!0,grid:!0,redo:s&&o.canRedo(),removeSelected:s&&!!i,replaceElement:s&&1==i,save:!0,selectAll:s||a,setColor:!!i,spaceTool:s,undo:s&&o.canUndo(),zoom:!0,bpmn:!0,editable:!0};l.elementsSelected=!!i,l.inactiveInput=!a;const d=(0,w.A)(l),c=(0,I.r)(l),p=(0,T.A)(l);(0,r.Tn)(t)&&t({...l,contextMenu:d,editMenu:c,windowMenu:p}),this.setState(l);try{const e=this.engineProfile.get();this.engineProfile.setCached(e)}catch(e){}};handleLinting=()=>{const{engineProfile:e,modeler:t}=this.getCached();if(!e)return;const n=t.getDefinitions(),{onAction:o}=this.props;o("lint-tab",{contents:n})};isLintingActive=()=>this.getModeler().get("linting").isActive();isDirty(){const{modeler:e,stackIdx:t}=this.getCached();return e.get("commandStack")._stackIdx!==t}checkImport(e){if(!this.isImportNeeded(e))return;const{xml:t}=this.props;this.importXML(t)}isImportNeeded(e){const{importing:t}=this.state;if(t)return!1;const{xml:n}=this.props;if(e&&e.xml===n)return!1;const{lastXML:o}=this.getCached();return n!==o}async importXML(e){this.setState({importing:!0});const t=this.getModeler(),n=await this.handleNamespace(e);let o=null,r=null;try{r=(await t.importXML(n)).warnings}catch(e){o=e,r=e.warnings}this._isMounted&&this.handleImport(o,r)}getModeler(){const{modeler:e}=this.getCached();return e}async getXML(){const{lastXML:e,modeler:t}=this.getCached(),n=t.get("commandStack");if(!this.isDirty())return e||this.props.xml;try{const{xml:e}=await t.saveXML({format:!0}),o=n._stackIdx;return this.setCached({lastXML:e,stackIdx:o}),e}catch(e){return this.handleError({error:e}),Promise.reject(e)}}async exportAs(e){let t;try{t=await this.exportSVG()}catch(e){return this.handleError({error:e}),Promise.reject(e)}return"svg"===e?t:(0,G.A)(e,t)}async exportSVG(){const e=this.getModeler();try{const{svg:t}=await e.saveSVG();return t}catch(e){return Promise.reject(e)}}triggerAction=(e,t={})=>{const{layout:n={}}=this.props,{propertiesPanel:o={}}=n,r=this.getModeler();if("resize"===e)return this.handleResize();if("toggleGrid"===e){const e={grid:{visible:!1===n.grid?.visible}};return this.handleLayoutChange(e)}if("toggleProperties"===e){const e={propertiesPanel:{...l.zR,...o,open:!o.open}};return this.handleLayoutChange(e)}if("zoomIn"===e&&(e="stepZoom",t={value:1}),"zoomOut"===e&&(e="stepZoom",t={value:-1}),"resetZoom"===e&&(e="zoom",t={value:1}),"zoomFit"===e&&(e="zoom",t={value:"fit-viewport"}),"showLintError"!==e)return"elementTemplates.reload"===e?this.loadTemplates():r.get("editorActions").trigger(e,t);this.getModeler().get("linting").showError(t)};handleSetColor=(e,t)=>{this.triggerAction("setColor",{fill:e,stroke:t})};handleDistributeElements=e=>{this.triggerAction("distributeElements",{type:e})};handleContextMenu=e=>{const{onContextMenu:t}=this.props;(0,r.Tn)(t)&&t(e)};handleLayoutChange(e){const{onLayoutChanged:t}=this.props;(0,r.Tn)(t)&&t(e)}handleResize=()=>{const e=this.getModeler(),t=e.get("canvas"),n=e.get("eventBus");t.resized(),n.fire("propertiesPanel.resized")};render(){const e=this.engineProfile.getCached(),{layout:t}=this.props,n=this.getModeler().getDefinitions(),{importing:r}=this.state;return o.createElement("div",{className:U.j$},o.createElement(i.aH,{hidden:n&&!r}),o.createElement("div",{className:"editor"},o.createElement("div",{className:"diagram",ref:this.ref,onFocus:this.handleChanged,onContextMenu:this.handleContextMenu}),o.createElement(l.Ay,{ref:this.propertiesPanelRef,layout:t,onLayoutChanged:this.handleLayoutChange})),e&&o.createElement(Y.Si,{type:"bpmn",engineProfile:e,onChange:e=>this.engineProfile.set(e)}))}static createCachedState(e){const{name:t,version:n}=W.A,{getPlugins:o,onAction:i,onError:a,layout:s={},settings:l}=e,{options:d,warnings:c}=(0,$.A)(o,{exporter:{name:t,version:n},settings:l},(e=>{i("emit-event",{type:"bpmn.modeler.configure",payload:{middlewares:e}})}),"platform");c.length&&(0,r.Tn)(a)&&a("Problem(s) configuring BPMN editor: \n\t"+c.map((e=>e.message)).join("\n\t")+"\n");const p=new P({...d,position:"absolute",changeTemplateCommand:"propertiesPanel.camunda.changeTemplate",linting:{active:s.panel&&s.panel.open&&"linting"===s.panel.tab},propertiesPanel:{layout:s.propertiesPanel},keyboard:{bind:!1}}),m=p.get("commandStack")._stackIdx;return i("emit-event",{type:"bpmn.modeler.created",payload:{modeler:p}}),{__destroy:()=>{p.destroy()},engineProfile:null,lastXML:null,modeler:p,namespaceDialogShown:!1,stackIdx:m,templatesLoaded:!1}}}const re=(0,s.rx)((0,s.cP)(oe));var ie=n(53620);const ae=(0,n(32528).a)("BpmnTab",[{type:"bpmn",editor:re,defaultName:"Diagram (Camunda Platform)"},{type:"xml",editor:ie.A,isFallback:!0,defaultName:"XML"}])},81993:(e,t,n)=>{function o(e,t={},n,o){const r=[];function i(e){"string"==typeof e&&(e=new Error(e)),r.push(e)}const a=e("bpmn.modeler.configure").map((e=>function(t,n){try{const o=e(t,n);return o||n("bpmn.modeler.configure does not return options"),o||t}catch(e){n(e)}return t})),s=[function(t){const n=[...e("bpmn.modeler.additionalModules"),...o?e("bpmn."+o+".modeler.additionalModules"):[]];return n.length?{...t,additionalModules:[...t.additionalModules||[],...n]}:t},function(t,n){var r=e("bpmn.modeler.moddleExtension");o&&(r=r.concat(e("bpmn."+o+".modeler.moddleExtension")));const i=r.reduce(((e,t)=>{let{name:o}=t;return"string"!=typeof o?(n("A bpmn moddle extension plugin is missing a <name> property"),e):(o in(e=e||{})&&n("A bpmn moddle extension with name <"+o+"> was overriden due to a clash"),{...e,[o]:t})}),t.moddleExtensions);return i?{...t,moddleExtensions:i}:t},...a];"function"==typeof n&&n(s);let l={...t};return s.forEach((e=>{l=e(l,i)})),{options:l,warnings:r}}n.d(t,{A:()=>o})},94820:(e,t,n)=>{n.d(t,{Ay:()=>l,j$:()=>s});var o=n(34942),r=n.n(o),i=n(60278),a=n.n(i)()(r());a.push([e.id,".rbarD0ILp5726HNr9ksk {\n  display: flex;\n  flex: 1;\n  overflow: hidden;\n  flex-direction: column;\n  /* @camunda/improved-canvas restets */\n}\n.rbarD0ILp5726HNr9ksk .editor {\n  flex: 1;\n  display: flex;\n  flex-direction: row;\n}\n.rbarD0ILp5726HNr9ksk .editor .diagram {\n  flex: 1;\n  position: relative;\n}\n.rbarD0ILp5726HNr9ksk .bjs-container {\n  --bjs-font-family: var(--font-family);\n}\n.rbarD0ILp5726HNr9ksk .djs-container.bio-improved-canvas {\n  background-color: var(--color-white);\n}\n.rbarD0ILp5726HNr9ksk .bio-improved-canvas defs pattern circle {\n  fill: #ccc !important;\n}\n.rbarD0ILp5726HNr9ksk .djs-minimap .toggle {\n  color: var(--color-grey-225-10-35);\n}\n.rbarD0ILp5726HNr9ksk .djs-minimap .toggle:hover {\n  color: var(--color-blue-205-100-45);\n}\n.rbarD0ILp5726HNr9ksk .djs-minimap:not(.open) .toggle:before {\n  content: '\\f278';\n  font-family: 'app';\n  font-size: 20px;\n}\n.rbarD0ILp5726HNr9ksk .djs-minimap.open .toggle {\n  padding: 3px 5px;\n  margin-right: 4px;\n  line-height: 24px;\n  text-align: right;\n  opacity: 0.5;\n}\n.rbarD0ILp5726HNr9ksk .djs-minimap.open .toggle:before {\n  content: '\\e80a';\n  font-family: 'app';\n  font-size: 14px;\n}\n.rbarD0ILp5726HNr9ksk .djs-minimap.open .toggle:hover {\n  opacity: 1;\n}\n.rbarD0ILp5726HNr9ksk .djs-minimap.open .viewport-dom {\n  border-color: var(--color-blue-205-100-50);\n}\n.EvRPUtn9gk1oLIgtUw4h {\n  border: solid 1px var(--color-grey-225-10-15);\n  margin: 4px;\n  width: 64px;\n  height: 16px;\n}\n","",{version:3,sources:["webpack://./src/app/tabs/bpmn/BpmnEditor.less"],names:[],mappings:"AAAA;EACE,aAAA;EACA,OAAA;EACA,gBAAA;EAEA,sBAAA;EAAA,qCAAqC;AACvC;AANA;EAQI,OAAA;EAEA,aAAA;EACA,mBAAA;AAAJ;AAXA;EAcM,OAAA;EACA,kBAAA;AAAN;AAfA;EAoBI,qCAAA;AAFJ;AAlBA;EAyBI,oCAAA;AAJJ;AArBA;EA6BI,qBAAA;AALJ;AAxBA;EAmCM,kCAAA;AARN;AA3BA;EAuCM,mCAAA;AATN;AAYI;EACE,gBAAA;EACA,kBAAA;EACA,eAAA;AAVN;AAaI;EAEI,gBAAA;EACA,iBAAA;EAEA,iBAAA;EACA,iBAAA;EAEA,YAAA;AAdR;AAMI;EAYI,gBAAA;EACA,kBAAA;EACA,eAAA;AAfR;AACI;EAkBI,UAAA;AAhBR;AAFI;EAsBI,0CAAA;AAjBR;AAuBA;EACE,6CAAA;EACA,WAAA;EACA,WAAA;EACA,YAAA;AArBF",sourcesContent:[":local(.BpmnEditor) {\n  display: flex;\n  flex: 1;\n  overflow: hidden;\n\n  flex-direction: column;\n\n  .editor {\n    flex: 1;\n\n    display: flex;\n    flex-direction: row;\n\n    .diagram {\n      flex: 1;\n      position: relative;\n    }\n  }\n\n  .bjs-container {\n    --bjs-font-family: var(--font-family);\n  }\n\n  /* @camunda/improved-canvas restets */\n  .djs-container.bio-improved-canvas {\n    background-color: var(--color-white);\n  }\n\n  .bio-improved-canvas defs pattern circle {\n    fill: #ccc !important;\n  }\n\n  .djs-minimap {\n\n    .toggle {\n      color: var(--color-grey-225-10-35);\n    }\n\n    .toggle:hover {\n      color: var(--color-blue-205-100-45);\n    }\n\n    &:not(.open) .toggle:before {\n      content: '\\f278';\n      font-family: 'app';\n      font-size: 20px;\n    }\n\n    &.open {\n      .toggle {\n        padding: 3px 5px;\n        margin-right: 4px;\n\n        line-height: 24px;\n        text-align: right;\n\n        opacity: 0.5;\n      }\n\n      .toggle:before {\n        content: '\\e80a';\n        font-family: 'app';\n        font-size: 14px;\n      }\n\n      .toggle:hover {\n        opacity: 1;\n      }\n\n      .viewport-dom {\n        border-color: var(--color-blue-205-100-50);\n      }\n    }\n  }\n}\n\n:local(.Color) {\n  border: solid 1px var(--color-grey-225-10-15);\n  margin: 4px;\n  width: 64px;\n  height: 16px;\n}\n"],sourceRoot:""}]);var s="rbarD0ILp5726HNr9ksk";const l=a}}]);
//# sourceMappingURL=6827.js.map