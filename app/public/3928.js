"use strict";(self.webpackChunkcamunda_modeler_client=self.webpackChunkcamunda_modeler_client||[]).push([[3928],{13928(e,t,n){n.d(t,{Ay:()=>rn});var i={};n.r(i),n.d(i,{MonacoLspClient:()=>Vt,WebSocketTransport:()=>Qt,createTransportToIFrame:()=>Zt,createTransportToWorker:()=>Xt});var r={};n.r(r),n.d(r,{CancellationTokenSource:()=>w.CancellationTokenSource,Emitter:()=>w.Emitter,KeyCode:()=>w.KeyCode,KeyMod:()=>w.KeyMod,MarkerSeverity:()=>w.MarkerSeverity,MarkerTag:()=>w.MarkerTag,Position:()=>w.Position,Range:()=>w.Range,Selection:()=>w.Selection,SelectionDirection:()=>w.SelectionDirection,Token:()=>w.Token,Uri:()=>w.Uri,createWebWorker:()=>en.V,css:()=>m,editor:()=>w.editor,html:()=>h,json:()=>p,languages:()=>w.languages,lsp:()=>i,typescript:()=>_}),n(95199),n(83565),n(65637),n(114),n(35951),n(94906),n(8831),n(23180),n(61888),n(52463),n(25886),n(38500),n(59864),n(43323),n(15356),n(50575),n(63980),n(26270),n(7784),n(89368),n(30893),n(60556),n(20667),n(19472),n(76930),n(41664),n(22693),n(98611),n(82901),n(12791),n(70819),n(80548),n(46114),n(25304),n(59160),n(48601);var o,s,a,c,l,d,u,g=n(7278),m=(n(48820),n(66390),n(37441),n(82786),n(18164),n(1471),n(84308),n(42287),n(26173),n(5450),n(32401),n(38454),n(73807),n(36709),n(37817),n(18938),n(32346),n(38012),n(8668),n(23033),n(80386),n(5910),n(7996),n(35610),n(88126),n(9646),n(32923),n(15324),n(63138),n(17628)),h=n(97122),p=n(43969),_=n(30793),w=(n(58950),n(64682),n(56983),n(85316),n(41156),n(66348),n(99612),n(26618),n(33128),n(51596),n(60868),n(22924),n(83020),n(29044),n(77086),n(17572),n(31740),n(43068),n(70846),n(26380),n(89886),n(44084),n(36710),n(65836),n(52648),n(98892),n(11538),n(76172),n(96248),n(7428),n(2952),n(59248),n(10552),n(30298),n(29770),n(59948),n(78828),n(50300),n(81200),n(38464),n(65292),n(10598),n(83684),n(68940),n(67436),n(40076),n(13844),n(86084),n(6252),n(72448),n(16412),n(39328),n(87670),n(90328),n(64528),n(93944),n(47980),n(42316),n(25644),n(53402),n(32218),n(10952),n(18860),n(59468),n(68674),n(34720),n(44040),n(18566),n(96360),n(62144),n(88252),n(90068),n(44636),n(74284),n(32288),n(61948),n(47740),n(39142),n(49956),n(33964),n(30956),n(34302),n(86399),n(14236),n(94789),n(42537),n(56265),n(9089),n(45002)),D=Object.defineProperty,x=(e,t,n)=>((e,t,n)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);(d||(d={})).create=function(e){return e},function(e){function t(e){return-32099<=e&&e<=-32e3}e.parseError=-32700,e.invalidRequest=-32600,e.methodNotFound=-32601,e.invalidParams=-32602,e.internalError=-32603,e.isServerError=t,e.serverError=function(e){if(!t(e))throw new Error("Invalid range for a server error.");return e},e.unexpectedServerError=-32e3,e.isApplicationError=function(e){return!0},e.applicationError=function(e){return e},e.genericApplicationError=-320100}(u||(u={}));var f=class{constructor(){x(this,"listeners",new Set),x(this,"event",e=>(this.listeners.add(e),{dispose:()=>{this.listeners.delete(e)}}))}fire(e){this.listeners.forEach(t=>t(e))}},y=class{constructor(e){x(this,"_value"),x(this,"eventEmitter"),this._value=e,this.eventEmitter=new f}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this.eventEmitter.fire(e))}get onChange(){return this.eventEmitter.event}};function b(e,t,n){return e instanceof Set?(e.add(t),{dispose:()=>e.delete(t)}):(e.set(t,n),{dispose:()=>e.delete(t)})}var v,S,C=class{constructor(){x(this,"_state","none"),x(this,"promise"),x(this,"resolve",()=>{}),x(this,"reject",()=>{}),this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}get state(){return this._state}},k=(o=class{constructor(){x(this,"_unprocessedMessages",[]),x(this,"_messageListener"),x(this,"id",o.id++),x(this,"_state",new y({state:"open"})),x(this,"state",this._state)}setListener(e){if(this._messageListener=e,e)for(;this._unprocessedMessages.length>0&&void 0!==this._messageListener;){const e=this._unprocessedMessages.shift();this._messageListener(e)}}send(e){return this._sendImpl(e)}_dispatchReceivedMessage(e){0===this._unprocessedMessages.length&&this._messageListener?this._messageListener(e):this._unprocessedMessages.push(e)}_onConnectionClosed(){this._state.value={state:"closed",error:void 0}}log(e){return new R(this,e??new T)}},x(o,"id",0),o),R=class{constructor(e,t){x(this,"baseStream"),x(this,"logger"),this.baseStream=e,this.logger=t}get state(){return this.baseStream.state}setListener(e){void 0!==e?this.baseStream.setListener(t=>{this.logger.log(this.baseStream,"incoming",t),e(t)}):this.baseStream.setListener(void 0)}send(e){return this.logger.log(this.baseStream,"outgoing",e),this.baseStream.send(e)}toString(){return`StreamLogger/${this.baseStream.toString()}`}},T=class{log(e,t,n){const i="incoming"===t?"<-":"->";console.log(`${i} [${e.toString()}] ${JSON.stringify(n)}`)}},I=class e{constructor(e){x(this,"connect"),this.connect=e}mapContext(t){return new e(e=>this.connect(e?function(e,t){return{handleNotification:(n,i)=>e.handleNotification(n,t(i)),handleRequest:(n,i,r)=>e.handleRequest(n,i,t(r))}}(e,t):void 0))}},E=class e{constructor(e,t,n){x(this,"_stream"),x(this,"_listener"),x(this,"_logger"),x(this,"_unprocessedResponses",new Map),x(this,"_lastUsedRequestId",0),this._stream=e,this._listener=t,this._logger=n,this._stream.setListener(e=>{void 0!==e.method?void 0===e.id?this._processNotification(e):this._processRequest(e):this._processResponse(e)})}static createChannel(t,n){let i=!1;return new I(r=>{if(i)throw new Error(`A channel to the stream ${t} was already constructed!`);return i=!0,new e(t,r,n)})}get state(){return this._stream.state}async _processNotification(e){if(void 0!==e.id)throw new Error;if(this._listener)try{await this._listener.handleNotification({method:e.method,params:e.params||null})}catch(t){this._logger&&this._logger.warn({text:`Exception was thrown while handling notification: ${t}`,exception:t,message:e})}else this._logger&&this._logger.debug({text:"Notification ignored",message:e})}async _processRequest(e){if(void 0===e.id)throw new Error;let t,n;if(this._listener)try{t=await this._listener.handleRequest({method:e.method,params:e.params||null},e.id)}catch(n){this._logger&&this._logger.warn({text:`Exception was thrown while handling request: ${n}`,message:e,exception:n}),t={error:{code:u.internalError,message:"An unexpected exception was thrown.",data:void 0}}}else this._logger&&this._logger.debug({text:"Received request even though not listening for requests",message:e}),t={error:{code:u.methodNotFound,message:"This endpoint does not listen for requests or notifications.",data:void 0}};n="result"in t?{jsonrpc:"2.0",id:e.id,result:t.result}:{jsonrpc:"2.0",id:e.id,error:t.error},await this._stream.send(n)}_processResponse(e){const t=""+e.id,n=this._unprocessedResponses.get(t);n?(this._unprocessedResponses.delete(t),n(e)):this._logger&&this._logger.debug({text:"Got an unexpected response message",message:e})}_newRequestId(){return this._lastUsedRequestId++}sendRequest(e,t,n){const i={jsonrpc:"2.0",id:this._newRequestId(),method:e.method,params:e.params||void 0};return n&&n(i.id),new Promise((e,t)=>{const n=""+i.id;this._unprocessedResponses.set(n,n=>{"result"in n?e({result:n.result}):(n.error||t(new Error("Response had neither 'result' nor 'error' field set.")),e({error:n.error}))}),this._stream.send(i).then(void 0,e=>{this._unprocessedResponses.delete(n),t(e)})})}sendNotification(e,t){const n={jsonrpc:"2.0",id:void 0,method:e.method,params:e.params||void 0};return this._stream.send(n)}toString(){return"StreamChannel/"+this._stream.toString()}};(S=v||(v={})).sAny=function(){return{deserializeFromJson:e=>({hasErrors:!1,value:e}),serializeToJson:e=>e}},S.sEmptyObject=function(){return{deserializeFromJson:e=>({hasErrors:!1,value:{}}),serializeToJson:e=>({})}},S.sVoidFromNull=function(){return{deserializeFromJson:e=>({hasErrors:!1,value:void 0}),serializeToJson:e=>null}};const M=Symbol("OptionalMethodNotFound");var H=class{contextualize(e){return new P(this,e)}},P=class extends H{constructor(e,t){super(),x(this,"underylingTypedChannel"),x(this,"converters"),this.underylingTypedChannel=e,this.converters=t}async request(e,t,n){const i=await this.converters.getSendContext(n);return this.underylingTypedChannel.request(e,t,i)}async notify(e,t,n){const i=await this.converters.getSendContext(n);return this.underylingTypedChannel.notify(e,t,i)}registerNotificationHandler(e,t){return this.underylingTypedChannel.registerNotificationHandler(e,async(e,n)=>await t(e,await this.converters.getNewContext(n)))}registerRequestHandler(e,t){return this.underylingTypedChannel.registerRequestHandler(e,async(e,n,i)=>await t(e,n,await this.converters.getNewContext(i)))}},F=class e extends H{constructor(e,t={}){super(),x(this,"channelCtor"),x(this,"_requestSender"),x(this,"_handler",new Map),x(this,"_unknownNotificationHandler",new Set),x(this,"_timeout"),x(this,"sendExceptionDetails",!1),x(this,"_logger"),x(this,"listeningDeferred",new C),x(this,"onListening",this.listeningDeferred.promise),x(this,"_requestDidErrorEventEmitter",new f),x(this,"onRequestDidError",this._requestDidErrorEventEmitter.event),this.channelCtor=e,this._logger=t.logger,this.sendExceptionDetails=!!t.sendExceptionDetails,this._timeout=function(e,t){const n=setTimeout(t,1e3);return{dispose:()=>clearTimeout(n)}}(0,()=>{this._requestSender||console.warn(`"${this.startListen.name}" has not been called within 1 second after construction of this channel. Did you forget to call it?`,this)})}static fromTransport(t,n={}){return new e(E.createChannel(t,n.logger),n)}startListen(){if(this._requestSender)throw new Error(`"${this.startListen.name}" can be called only once, but it already has been called.`);this._timeout&&(this._timeout.dispose(),this._timeout=void 0),this._requestSender=this.channelCtor.connect({handleRequest:(e,t,n)=>this.handleRequest(e,t,n),handleNotification:(e,t)=>this.handleNotification(e,t)}),this.listeningDeferred.resolve()}checkChannel(e){if(!e)throw new Error(`"${this.startListen.name}" must be called before any messages can be sent or received.`);return!0}async handleRequest(e,t,n){const i=this._handler.get(e.method);if(!i)return this._logger&&this._logger.debug({text:`No request handler for "${e.method}".`,data:{requestObject:e}}),{error:{code:u.methodNotFound,message:`No request handler for "${e.method}".`,data:{method:e.method}}};if("request"!=i.kind){const t=`"${e.method}" is registered as notification, but was sent as request.`;return this._logger&&this._logger.debug({text:t,data:{requestObject:e}}),{error:{code:u.invalidRequest,message:t,data:{method:e.method}}}}const r=i.requestType.paramsSerializer.deserializeFromJson(e.params);if(r.hasErrors){const t=`Got invalid params: ${r.errorMessage}`;return this._logger&&this._logger.debug({text:t,data:{requestObject:e,errorMessage:r.errorMessage}}),{error:{code:u.invalidParams,message:t,data:{errors:r.errorMessage}}}}{const o=r.value;let s;try{const e=await i.handler(o,t,n);if("error"in e||"errorMessage"in e){const t=e.error?i.requestType.errorSerializer.serializeToJson(e.error):void 0;s={error:{code:e.errorCode||u.genericApplicationError,message:e.errorMessage||"An error was returned",data:t}}}else s={result:i.requestType.resultSerializer.serializeToJson(e.ok)}}catch(t){t instanceof K?s={error:{code:t.code,message:t.message}}:(this._logger&&this._logger.warn({text:`An exception was thrown while handling a request: ${t}.`,exception:t,data:{requestObject:e}}),s={error:{code:u.unexpectedServerError,message:this.sendExceptionDetails?`An exception was thrown while handling a request: ${t}.`:"Server has thrown an unexpected exception"}})}return s}}async handleNotification(e,t){const n=this._handler.get(e.method);if(!n){for(const t of this._unknownNotificationHandler)t(e);return void(0===this._unknownNotificationHandler.size&&this._logger&&this._logger.debug({text:`Unhandled notification "${e.method}"`,data:{requestObject:e}}))}if("notification"!=n.kind)return void(this._logger&&this._logger.debug({text:`"${e.method}" is registered as request, but was sent as notification.`,data:{requestObject:e}}));const i=n.notificationType.paramsSerializer.deserializeFromJson(e.params);if(i.hasErrors)return void(this._logger&&this._logger.debug({text:`Got invalid params: ${i}`,data:{requestObject:e,errorMessage:i.errorMessage}}));const r=i.value;for(const i of n.handlers)try{i(r,t)}catch(t){this._logger&&this._logger.warn({text:`An exception was thrown while handling a notification: ${t}.`,exception:t,data:{requestObject:e}})}}registerUnknownNotificationHandler(e){return b(this._unknownNotificationHandler,e)}registerRequestHandler(e,t){if(this._handler.get(e.method))throw new Error(`Handler with method "${e.method}" already registered.`);return b(this._handler,e.method,{kind:"request",requestType:e,handler:t})}registerNotificationHandler(e,t){let n=this._handler.get(e.method);if(n){if("notification"!==n.kind)throw new Error(`Method "${e.method}" was already registered as request handler.`);if(n.notificationType!==e)throw new Error(`Method "${e.method}" was registered for a different type.`)}else n={kind:"notification",notificationType:e,handlers:new Set},this._handler.set(e.method,n);return b(n.handlers,t)}getRegisteredTypes(){const e=[];for(const t of this._handler.values())"notification"===t.kind?e.push(t.notificationType):"request"===t.kind&&e.push(t.requestType);return e}async request(e,t,n){if(!this.checkChannel(this._requestSender))throw new Error("Impossible");const i=e.paramsSerializer.serializeToJson(t);L(i);const r=await this._requestSender.sendRequest({method:e.method,params:i},n);if("error"in r){if(e.isOptional&&r.error.code===u.methodNotFound)return M;let t;if(void 0!==r.error.data){const n=e.errorSerializer.deserializeFromJson(r.error.data);if(n.hasErrors)throw new Error(n.errorMessage);t=n.value}else t=void 0;const n=new K(r.error.message,t,r.error.code);throw this._requestDidErrorEventEmitter.fire({error:n}),n}{const t=e.resultSerializer.deserializeFromJson(r.result);if(t.hasErrors)throw new Error("Could not deserialize response: "+t.errorMessage+`\n\n${JSON.stringify(r,null,2)}`);return t.value}}async notify(e,t,n){if(!this.checkChannel(this._requestSender))throw new Error;const i=e.paramsSerializer.serializeToJson(t);L(i),this._requestSender.sendNotification({method:e.method,params:i},n)}};function L(e){if(null!==e&&Array.isArray(e)&&"object"!=typeof e)throw new Error("Invalid value! Only null, array and object is allowed.")}var K=class e extends Error{constructor(t,n,i=u.genericApplicationError){super(t),x(this,"data"),x(this,"code"),this.data=n,this.code=i,Object.setPrototypeOf(this,e.prototype)}},q=class e{constructor(e,t,n,i,r=!1){x(this,"method"),x(this,"paramsSerializer"),x(this,"resultSerializer"),x(this,"errorSerializer"),x(this,"isOptional"),x(this,"kind","request"),this.method=e,this.paramsSerializer=t,this.resultSerializer=n,this.errorSerializer=i,this.isOptional=r}withMethod(t){return new e(t,this.paramsSerializer,this.resultSerializer,this.errorSerializer)}optional(){return new e(this.method,this.paramsSerializer,this.resultSerializer,this.errorSerializer,!0)}},A=class e{constructor(e,t){x(this,"method"),x(this,"paramsSerializer"),x(this,"kind","notification"),this.method=e,this.paramsSerializer=t}withMethod(t){return new e(t,this.paramsSerializer)}};function O(e){return new q((e||{}).method,v.sAny(),v.sAny(),v.sAny())}function N(e){return new A((e||{}).method,v.sAny())}const W=Symbol();var z=(s=W,a=class{constructor(e){x(this,"error"),x(this,s),this.error=e}},x(a,"factory",e=>new a(e)),a);function j(e){const t={};for(const[n,i]of Object.entries(e)){const e=i.method?i.method:n;t[n]=i.withMethod(e)}return t}var $=class e{constructor(e=[],t,n){x(this,"tags"),x(this,"server"),x(this,"client"),this.tags=e,this.server=t,this.client=n}_onlyDesignTime(){return new Error("This property is not meant to be accessed at runtime")}get TContractObject(){throw this._onlyDesignTime()}get TClientInterface(){throw this._onlyDesignTime()}get TServerInterface(){throw this._onlyDesignTime()}get TClientHandler(){throw this._onlyDesignTime()}get TServerHandler(){throw this._onlyDesignTime()}get TTags(){throw this._onlyDesignTime()}getInterface(e,t,n,i){const r=this.buildCounterpart(e,n),o=this.registerHandlers(e,t,i,r);return{counterpart:r,dispose:()=>o.dispose()}}buildCounterpart(e,t){const n={};for(const[i,r]of Object.entries(t)){let t;t="request"===r.kind?r.isOptional?async(t,n)=>{void 0===t&&(t={});try{return await e.request(r,t,n)}catch(e){if(e&&e.code===u.methodNotFound)return M;throw e}}:(t,n)=>(void 0===t&&(t={}),e.request(r,t,n)):(t,n)=>(void 0===t&&(t={}),e.notify(r,t,n)),n[i]=t}return n}registerHandlers(e,t,n,i){const r=[];for(const[o,s]of Object.entries(t))if("request"===s.kind){let t=n[o];if(!t)continue;const a=this.createRequestHandler(i,t);r.push(e.registerRequestHandler(s,a))}else{const t=n[o];t&&r.push(e.registerNotificationHandler(s,(e,n)=>{t(e,{context:n,counterpart:i})}))}return{dispose:()=>r.forEach(e=>e.dispose())}}createRequestHandler(e,t){return async(n,i,r)=>{const o=await t(n,{context:r,counterpart:e,newErr:z.factory,requestId:i});return o instanceof z?o.error:{ok:o}}}static getServerFromStream(e,t,n,i){const r=F.fromTransport(t,n),{server:o}=e.getServer(r,i);return r.startListen(),{channel:r,server:o}}static registerServerToStream(e,t,n,i){const r=F.fromTransport(t,n),{client:o}=e.registerServer(r,i);return r.startListen(),{channel:r,client:o}}getServer(e,t){const{counterpart:n,dispose:i}=this.getInterface(e,this.client,this.server,t);return{server:n,dispose:i}}registerServer(e,t){const{counterpart:n,dispose:i}=this.getInterface(e,this.server,this.client,t);return{client:n,dispose:i}}withContext(){return new e(this.tags,this.server,this.client)}};let U=function(e){return e.Comment="comment",e.Imports="imports",e.Region="region",e}({}),B=function(e){return e[e.File=1]="File",e[e.Module=2]="Module",e[e.Namespace=3]="Namespace",e[e.Package=4]="Package",e[e.Class=5]="Class",e[e.Method=6]="Method",e[e.Property=7]="Property",e[e.Field=8]="Field",e[e.Constructor=9]="Constructor",e[e.Enum=10]="Enum",e[e.Interface=11]="Interface",e[e.Function=12]="Function",e[e.Variable=13]="Variable",e[e.Constant=14]="Constant",e[e.String=15]="String",e[e.Number=16]="Number",e[e.Boolean=17]="Boolean",e[e.Array=18]="Array",e[e.Object=19]="Object",e[e.Key=20]="Key",e[e.Null=21]="Null",e[e.EnumMember=22]="EnumMember",e[e.Struct=23]="Struct",e[e.Event=24]="Event",e[e.Operator=25]="Operator",e[e.TypeParameter=26]="TypeParameter",e}({}),V=function(e){return e[e.Deprecated=1]="Deprecated",e}({}),J=function(e){return e[e.Type=1]="Type",e[e.Parameter=2]="Parameter",e}({}),G=function(e){return e[e.None=0]="None",e[e.Full=1]="Full",e[e.Incremental=2]="Incremental",e}({}),Q=function(e){return e[e.Text=1]="Text",e[e.Method=2]="Method",e[e.Function=3]="Function",e[e.Constructor=4]="Constructor",e[e.Field=5]="Field",e[e.Variable=6]="Variable",e[e.Class=7]="Class",e[e.Interface=8]="Interface",e[e.Module=9]="Module",e[e.Property=10]="Property",e[e.Unit=11]="Unit",e[e.Value=12]="Value",e[e.Enum=13]="Enum",e[e.Keyword=14]="Keyword",e[e.Snippet=15]="Snippet",e[e.Color=16]="Color",e[e.File=17]="File",e[e.Reference=18]="Reference",e[e.Folder=19]="Folder",e[e.EnumMember=20]="EnumMember",e[e.Constant=21]="Constant",e[e.Struct=22]="Struct",e[e.Event=23]="Event",e[e.Operator=24]="Operator",e[e.TypeParameter=25]="TypeParameter",e}({}),Y=function(e){return e[e.Deprecated=1]="Deprecated",e}({}),X=function(e){return e[e.PlainText=1]="PlainText",e[e.Snippet=2]="Snippet",e}({}),Z=function(e){return e[e.Text=1]="Text",e[e.Read=2]="Read",e[e.Write=3]="Write",e}({}),ee=function(e){return e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll",e}({}),te=function(e){return e.PlainText="plaintext",e.Markdown="markdown",e}({}),ne=function(e){return e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint",e}({}),ie=function(e){return e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated",e}({}),re=function(e){return e[e.Invoked=1]="Invoked",e[e.TriggerCharacter=2]="TriggerCharacter",e[e.TriggerForIncompleteCompletions=3]="TriggerForIncompleteCompletions",e}({}),oe=function(e){return e[e.Invoked=1]="Invoked",e[e.TriggerCharacter=2]="TriggerCharacter",e[e.ContentChange=3]="ContentChange",e}({}),se=function(e){return e[e.Invoked=1]="Invoked",e[e.Automatic=2]="Automatic",e}({}),ae=function(e){return e.Relative="relative",e}({});var ce=class{constructor(e){this.method=e}};const le={textDocumentImplementation:new ce("textDocument/implementation"),textDocumentTypeDefinition:new ce("textDocument/typeDefinition"),textDocumentDocumentColor:new ce("textDocument/documentColor"),textDocumentColorPresentation:new ce("textDocument/colorPresentation"),textDocumentFoldingRange:new ce("textDocument/foldingRange"),textDocumentDeclaration:new ce("textDocument/declaration"),textDocumentSelectionRange:new ce("textDocument/selectionRange"),textDocumentPrepareCallHierarchy:new ce("textDocument/prepareCallHierarchy"),textDocumentSemanticTokensFull:new ce("textDocument/semanticTokens/full"),textDocumentSemanticTokensFullDelta:new ce("textDocument/semanticTokens/full/delta"),textDocumentLinkedEditingRange:new ce("textDocument/linkedEditingRange"),workspaceWillCreateFiles:new ce("workspace/willCreateFiles"),workspaceWillRenameFiles:new ce("workspace/willRenameFiles"),workspaceWillDeleteFiles:new ce("workspace/willDeleteFiles"),textDocumentMoniker:new ce("textDocument/moniker"),textDocumentPrepareTypeHierarchy:new ce("textDocument/prepareTypeHierarchy"),textDocumentInlineValue:new ce("textDocument/inlineValue"),textDocumentInlayHint:new ce("textDocument/inlayHint"),textDocumentDiagnostic:new ce("textDocument/diagnostic"),textDocumentInlineCompletion:new ce("textDocument/inlineCompletion"),textDocumentWillSaveWaitUntil:new ce("textDocument/willSaveWaitUntil"),textDocumentCompletion:new ce("textDocument/completion"),textDocumentHover:new ce("textDocument/hover"),textDocumentSignatureHelp:new ce("textDocument/signatureHelp"),textDocumentDefinition:new ce("textDocument/definition"),textDocumentReferences:new ce("textDocument/references"),textDocumentDocumentHighlight:new ce("textDocument/documentHighlight"),textDocumentDocumentSymbol:new ce("textDocument/documentSymbol"),textDocumentCodeAction:new ce("textDocument/codeAction"),workspaceSymbol:new ce("workspace/symbol"),textDocumentCodeLens:new ce("textDocument/codeLens"),textDocumentDocumentLink:new ce("textDocument/documentLink"),textDocumentFormatting:new ce("textDocument/formatting"),textDocumentRangeFormatting:new ce("textDocument/rangeFormatting"),textDocumentRangesFormatting:new ce("textDocument/rangesFormatting"),textDocumentOnTypeFormatting:new ce("textDocument/onTypeFormatting"),textDocumentRename:new ce("textDocument/rename"),workspaceExecuteCommand:new ce("workspace/executeCommand"),workspaceDidCreateFiles:new ce("workspace/didCreateFiles"),workspaceDidRenameFiles:new ce("workspace/didRenameFiles"),workspaceDidDeleteFiles:new ce("workspace/didDeleteFiles"),workspaceDidChangeConfiguration:new ce("workspace/didChangeConfiguration"),textDocumentDidOpen:new ce("textDocument/didOpen"),textDocumentDidChange:new ce("textDocument/didChange"),textDocumentDidClose:new ce("textDocument/didClose"),textDocumentDidSave:new ce("textDocument/didSave"),textDocumentWillSave:new ce("textDocument/willSave"),workspaceDidChangeWatchedFiles:new ce("workspace/didChangeWatchedFiles")},de=function(e){const t=j(e.server),n=j(e.client);return new $(e.tags||[],t,n)}({server:{textDocumentImplementation:O({method:"textDocument/implementation"}),textDocumentTypeDefinition:O({method:"textDocument/typeDefinition"}),textDocumentDocumentColor:O({method:"textDocument/documentColor"}),textDocumentColorPresentation:O({method:"textDocument/colorPresentation"}),textDocumentFoldingRange:O({method:"textDocument/foldingRange"}),textDocumentDeclaration:O({method:"textDocument/declaration"}),textDocumentSelectionRange:O({method:"textDocument/selectionRange"}),textDocumentPrepareCallHierarchy:O({method:"textDocument/prepareCallHierarchy"}),callHierarchyIncomingCalls:O({method:"callHierarchy/incomingCalls"}),callHierarchyOutgoingCalls:O({method:"callHierarchy/outgoingCalls"}),textDocumentSemanticTokensFull:O({method:"textDocument/semanticTokens/full"}),textDocumentSemanticTokensFullDelta:O({method:"textDocument/semanticTokens/full/delta"}),textDocumentSemanticTokensRange:O({method:"textDocument/semanticTokens/range"}),textDocumentLinkedEditingRange:O({method:"textDocument/linkedEditingRange"}),workspaceWillCreateFiles:O({method:"workspace/willCreateFiles"}),workspaceWillRenameFiles:O({method:"workspace/willRenameFiles"}),workspaceWillDeleteFiles:O({method:"workspace/willDeleteFiles"}),textDocumentMoniker:O({method:"textDocument/moniker"}),textDocumentPrepareTypeHierarchy:O({method:"textDocument/prepareTypeHierarchy"}),typeHierarchySupertypes:O({method:"typeHierarchy/supertypes"}),typeHierarchySubtypes:O({method:"typeHierarchy/subtypes"}),textDocumentInlineValue:O({method:"textDocument/inlineValue"}),textDocumentInlayHint:O({method:"textDocument/inlayHint"}),inlayHintResolve:O({method:"inlayHint/resolve"}),textDocumentDiagnostic:O({method:"textDocument/diagnostic"}),workspaceDiagnostic:O({method:"workspace/diagnostic"}),textDocumentInlineCompletion:O({method:"textDocument/inlineCompletion"}),initialize:O({method:"initialize"}),shutdown:O({method:"shutdown"}),textDocumentWillSaveWaitUntil:O({method:"textDocument/willSaveWaitUntil"}),textDocumentCompletion:O({method:"textDocument/completion"}),completionItemResolve:O({method:"completionItem/resolve"}),textDocumentHover:O({method:"textDocument/hover"}),textDocumentSignatureHelp:O({method:"textDocument/signatureHelp"}),textDocumentDefinition:O({method:"textDocument/definition"}),textDocumentReferences:O({method:"textDocument/references"}),textDocumentDocumentHighlight:O({method:"textDocument/documentHighlight"}),textDocumentDocumentSymbol:O({method:"textDocument/documentSymbol"}),textDocumentCodeAction:O({method:"textDocument/codeAction"}),codeActionResolve:O({method:"codeAction/resolve"}),workspaceSymbol:O({method:"workspace/symbol"}),workspaceSymbolResolve:O({method:"workspaceSymbol/resolve"}),textDocumentCodeLens:O({method:"textDocument/codeLens"}),codeLensResolve:O({method:"codeLens/resolve"}),textDocumentDocumentLink:O({method:"textDocument/documentLink"}),documentLinkResolve:O({method:"documentLink/resolve"}),textDocumentFormatting:O({method:"textDocument/formatting"}),textDocumentRangeFormatting:O({method:"textDocument/rangeFormatting"}),textDocumentRangesFormatting:O({method:"textDocument/rangesFormatting"}),textDocumentOnTypeFormatting:O({method:"textDocument/onTypeFormatting"}),textDocumentRename:O({method:"textDocument/rename"}),textDocumentPrepareRename:O({method:"textDocument/prepareRename"}),workspaceExecuteCommand:O({method:"workspace/executeCommand"}),workspaceDidChangeWorkspaceFolders:N({method:"workspace/didChangeWorkspaceFolders"}),windowWorkDoneProgressCancel:N({method:"window/workDoneProgress/cancel"}),workspaceDidCreateFiles:N({method:"workspace/didCreateFiles"}),workspaceDidRenameFiles:N({method:"workspace/didRenameFiles"}),workspaceDidDeleteFiles:N({method:"workspace/didDeleteFiles"}),notebookDocumentDidOpen:N({method:"notebookDocument/didOpen"}),notebookDocumentDidChange:N({method:"notebookDocument/didChange"}),notebookDocumentDidSave:N({method:"notebookDocument/didSave"}),notebookDocumentDidClose:N({method:"notebookDocument/didClose"}),initialized:N({method:"initialized"}),exit:N({method:"exit"}),workspaceDidChangeConfiguration:N({method:"workspace/didChangeConfiguration"}),textDocumentDidOpen:N({method:"textDocument/didOpen"}),textDocumentDidChange:N({method:"textDocument/didChange"}),textDocumentDidClose:N({method:"textDocument/didClose"}),textDocumentDidSave:N({method:"textDocument/didSave"}),textDocumentWillSave:N({method:"textDocument/willSave"}),workspaceDidChangeWatchedFiles:N({method:"workspace/didChangeWatchedFiles"}),setTrace:N({method:"$/setTrace"}),cancelRequest:N({method:"$/cancelRequest"}),progress:N({method:"$/progress"})},client:{workspaceWorkspaceFolders:O({method:"workspace/workspaceFolders"}).optional(),workspaceConfiguration:O({method:"workspace/configuration"}).optional(),workspaceFoldingRangeRefresh:O({method:"workspace/foldingRange/refresh"}).optional(),windowWorkDoneProgressCreate:O({method:"window/workDoneProgress/create"}).optional(),workspaceSemanticTokensRefresh:O({method:"workspace/semanticTokens/refresh"}).optional(),windowShowDocument:O({method:"window/showDocument"}).optional(),workspaceInlineValueRefresh:O({method:"workspace/inlineValue/refresh"}).optional(),workspaceInlayHintRefresh:O({method:"workspace/inlayHint/refresh"}).optional(),workspaceDiagnosticRefresh:O({method:"workspace/diagnostic/refresh"}).optional(),clientRegisterCapability:O({method:"client/registerCapability"}).optional(),clientUnregisterCapability:O({method:"client/unregisterCapability"}).optional(),windowShowMessageRequest:O({method:"window/showMessageRequest"}).optional(),workspaceCodeLensRefresh:O({method:"workspace/codeLens/refresh"}).optional(),workspaceApplyEdit:O({method:"workspace/applyEdit"}).optional(),windowShowMessage:N({method:"window/showMessage"}),windowLogMessage:N({method:"window/logMessage"}),telemetryEvent:N({method:"telemetry/event"}),textDocumentPublishDiagnostics:N({method:"textDocument/publishDiagnostics"}),logTrace:N({method:"$/logTrace"}),cancelRequest:N({method:"$/cancelRequest"}),progress:N({method:"$/progress"})}});function ue(e,t){if(e.textModel!==t)throw new Error(`Expected text model to be ${t}, but got ${e.textModel}`);return e}var ge=(c=class{constructor(){x(this,"_store",new me)}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},x(c,"None",Object.freeze({dispose(){}})),c),me=(l=class{constructor(){x(this,"_toDispose",new Set),x(this,"_isDisposed",!1)}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}clear(){if(0!==this._toDispose.size)try{for(const e of this._toDispose)e.dispose()}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?l.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}},x(l,"DISABLE_DISPOSED_WARNING",!1),l);const he=new Map([[ee.Empty,""],[ee.QuickFix,"quickfix"],[ee.Refactor,"refactor"],[ee.RefactorExtract,"refactor.extract"],[ee.RefactorInline,"refactor.inline"],[ee.RefactorRewrite,"refactor.rewrite"],[ee.Source,"source"],[ee.SourceOrganizeImports,"source.organizeImports"],[ee.SourceFixAll,"source.fixAll"]]);function pe(e){if(e)return he.get(e)??e}const _e=new Map([[w.languages.CodeActionTriggerType.Invoke,se.Invoked],[w.languages.CodeActionTriggerType.Auto,se.Automatic]]),we=new Map([[Q.Text,w.languages.CompletionItemKind.Text],[Q.Method,w.languages.CompletionItemKind.Method],[Q.Function,w.languages.CompletionItemKind.Function],[Q.Constructor,w.languages.CompletionItemKind.Constructor],[Q.Field,w.languages.CompletionItemKind.Field],[Q.Variable,w.languages.CompletionItemKind.Variable],[Q.Class,w.languages.CompletionItemKind.Class],[Q.Interface,w.languages.CompletionItemKind.Interface],[Q.Module,w.languages.CompletionItemKind.Module],[Q.Property,w.languages.CompletionItemKind.Property],[Q.Unit,w.languages.CompletionItemKind.Unit],[Q.Value,w.languages.CompletionItemKind.Value],[Q.Enum,w.languages.CompletionItemKind.Enum],[Q.Keyword,w.languages.CompletionItemKind.Keyword],[Q.Snippet,w.languages.CompletionItemKind.Snippet],[Q.Color,w.languages.CompletionItemKind.Color],[Q.File,w.languages.CompletionItemKind.File],[Q.Reference,w.languages.CompletionItemKind.Reference],[Q.Folder,w.languages.CompletionItemKind.Folder],[Q.EnumMember,w.languages.CompletionItemKind.EnumMember],[Q.Constant,w.languages.CompletionItemKind.Constant],[Q.Struct,w.languages.CompletionItemKind.Struct],[Q.Event,w.languages.CompletionItemKind.Event],[Q.Operator,w.languages.CompletionItemKind.Operator],[Q.TypeParameter,w.languages.CompletionItemKind.TypeParameter]]),De=new Map([[Y.Deprecated,w.languages.CompletionItemTag.Deprecated]]);function xe(e){return De.get(e)}const fe=new Map([[w.languages.CompletionTriggerKind.Invoke,re.Invoked],[w.languages.CompletionTriggerKind.TriggerCharacter,re.TriggerCharacter],[w.languages.CompletionTriggerKind.TriggerForIncompleteCompletions,re.TriggerForIncompleteCompletions]]),ye=new Map([[X.Snippet,w.languages.CompletionItemInsertTextRule.InsertAsSnippet]]),be=new Map([[B.File,w.languages.SymbolKind.File],[B.Module,w.languages.SymbolKind.Module],[B.Namespace,w.languages.SymbolKind.Namespace],[B.Package,w.languages.SymbolKind.Package],[B.Class,w.languages.SymbolKind.Class],[B.Method,w.languages.SymbolKind.Method],[B.Property,w.languages.SymbolKind.Property],[B.Field,w.languages.SymbolKind.Field],[B.Constructor,w.languages.SymbolKind.Constructor],[B.Enum,w.languages.SymbolKind.Enum],[B.Interface,w.languages.SymbolKind.Interface],[B.Function,w.languages.SymbolKind.Function],[B.Variable,w.languages.SymbolKind.Variable],[B.Constant,w.languages.SymbolKind.Constant],[B.String,w.languages.SymbolKind.String],[B.Number,w.languages.SymbolKind.Number],[B.Boolean,w.languages.SymbolKind.Boolean],[B.Array,w.languages.SymbolKind.Array],[B.Object,w.languages.SymbolKind.Object],[B.Key,w.languages.SymbolKind.Key],[B.Null,w.languages.SymbolKind.Null],[B.EnumMember,w.languages.SymbolKind.EnumMember],[B.Struct,w.languages.SymbolKind.Struct],[B.Event,w.languages.SymbolKind.Event],[B.Operator,w.languages.SymbolKind.Operator],[B.TypeParameter,w.languages.SymbolKind.TypeParameter]]);function ve(e){return be.get(e)??w.languages.SymbolKind.File}const Se=new Map([[V.Deprecated,w.languages.SymbolTag.Deprecated]]);function Ce(e){return Se.get(e)}const ke=new Map([[Z.Text,w.languages.DocumentHighlightKind.Text],[Z.Read,w.languages.DocumentHighlightKind.Read],[Z.Write,w.languages.DocumentHighlightKind.Write]]),Re=new Map([[U.Comment,w.languages.FoldingRangeKind.Comment],[U.Imports,w.languages.FoldingRangeKind.Imports],[U.Region,w.languages.FoldingRangeKind.Region]]);function Te(e){if(e)return Re.get(e)}const Ie=new Map([[w.MarkerSeverity.Error,ne.Error],[w.MarkerSeverity.Warning,ne.Warning],[w.MarkerSeverity.Info,ne.Information],[w.MarkerSeverity.Hint,ne.Hint]]),Ee=new Map([[ne.Error,w.MarkerSeverity.Error],[ne.Warning,w.MarkerSeverity.Warning],[ne.Information,w.MarkerSeverity.Info],[ne.Hint,w.MarkerSeverity.Hint]]),Me=new Map([[ie.Unnecessary,w.MarkerTag.Unnecessary],[ie.Deprecated,w.MarkerTag.Deprecated]]),He=new Map([[w.languages.SignatureHelpTriggerKind.Invoke,oe.Invoked],[w.languages.SignatureHelpTriggerKind.TriggerCharacter,oe.TriggerCharacter],[w.languages.SignatureHelpTriggerKind.ContentChange,oe.ContentChange]]);function Pe(e){if(e)return{id:e.command,title:e.title,arguments:e.arguments}}const Fe=new Map([[J.Type,w.languages.InlayHintKind.Type],[J.Parameter,w.languages.InlayHintKind.Parameter]]);function Le(e,t){if("targetUri"in e){const n=t.bridge.translateBackRange({uri:e.targetUri},e.targetRange);return{uri:n.textModel.uri,range:n.range,originSelectionRange:e.originSelectionRange?t.bridge.translateBackRange({uri:e.targetUri},e.originSelectionRange).range:void 0,targetSelectionRange:e.targetSelectionRange?t.bridge.translateBackRange({uri:e.targetUri},e.targetSelectionRange).range:void 0}}{const n=t.bridge.translateBackRange({uri:e.uri},e.range);return{uri:n.textModel.uri,range:n.range}}}function Ke(e){return e&&0!==e.length?e.map(e=>"notebook"in e?"string"==typeof e.notebook?{notebookType:e.notebook,language:e.language}:{notebookType:e.notebook.notebookType,language:e.language,pattern:e.notebook.pattern,scheme:e.notebook.scheme}:{language:e.language,pattern:e.pattern,scheme:e.scheme}):{language:"*"}}function qe(e){const t={severity:(n=e.severity,n?Ee.get(n)??w.MarkerSeverity.Error:w.MarkerSeverity.Error),startLineNumber:e.range.start.line+1,startColumn:e.range.start.character+1,endLineNumber:e.range.end.line+1,endColumn:e.range.end.character+1,message:e.message,source:e.source,code:"string"==typeof e.code?e.code:e.code?.toString()};var n;return e.tags&&(t.tags=e.tags.map(e=>function(e){return Me.get(e)}(e)).filter(e=>void 0!==e)),e.relatedInformation&&(t.relatedInformation=e.relatedInformation.map(e=>({resource:w.Uri.parse(e.location.uri),startLineNumber:e.location.range.start.line+1,startColumn:e.location.range.start.character+1,endLineNumber:e.location.range.end.line+1,endColumn:e.location.range.end.character+1,message:e.message}))),t}var Ae=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{completion:{dynamicRegistration:!0,contextSupport:!0,completionItemKind:{valueSet:Array.from(we.keys())},completionItem:{tagSupport:{valueSet:Array.from(De.keys())},commitCharactersSupport:!0,deprecatedSupport:!0,preselectSupport:!0}}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentCompletion,!0,e=>w.languages.registerCompletionItemProvider(Ke(e.documentSelector),new Oe(this._connection,e))))}},Oe=class{constructor(e,t){x(this,"resolveCompletionItem"),this._client=e,this._capabilities=t,t.resolveProvider&&(this.resolveCompletionItem=async(e,t)=>(We(e,await this._client.server.completionItemResolve(e._lspItem),this._client.bridge,e._translated,e._model),e))}get triggerCharacters(){return this._capabilities.triggerCharacters}async provideCompletionItems(e,t,n,i){const r=this._client.bridge.translate(e,t),o=await this._client.server.textDocumentCompletion({textDocument:r.textDocument,position:r.position,context:n.triggerCharacter?{triggerKind:(s=n.triggerKind,fe.get(s)??re.Invoked),triggerCharacter:n.triggerCharacter}:void 0});var s;return o?{suggestions:(Array.isArray(o)?o:o.items).map(n=>({...Ne(n,this._client.bridge,r,e,t),_lspItem:n,_translated:r,_model:e}))}:{suggestions:[]}}};function Ne(e,t,n,i,r){let o,s=e.insertText||e.label;e.textEdit&&("range"in e.textEdit?(s=e.textEdit.newText,o=ue(t.translateBackRange(n.textDocument,e.textEdit.range),i).range):(s=e.textEdit.newText,o={insert:ue(t.translateBackRange(n.textDocument,e.textEdit.insert),i).range,replace:ue(t.translateBackRange(n.textDocument,e.textEdit.replace),i).range})),o||(o=w.Range.fromPositions(r,r));const a={label:e.label,kind:(c=e.kind,c?we.get(c)??w.languages.CompletionItemKind.Text:w.languages.CompletionItemKind.Text),insertText:s,sortText:e.sortText,filterText:e.filterText,preselect:e.preselect,commitCharacters:e.commitCharacters,range:o};var c;return We(a,e,t,n,i),a}function We(e,t,n,i,r){var o;void 0!==t.detail&&(e.detail=t.detail),void 0!==t.documentation&&(e.documentation=(o=t.documentation)?"string"==typeof o?o:{value:o.value,isTrusted:!0}:void 0),void 0!==t.insertTextFormat&&(e.insertTextRules=function(e){if(e)return ye.get(e)}(t.insertTextFormat)),t.tags&&t.tags.length>0&&(e.tags=t.tags.map(xe).filter(e=>void 0!==e)),t.additionalTextEdits&&t.additionalTextEdits.length>0&&(e.additionalTextEdits=t.additionalTextEdits.map(e=>({range:ue(n.translateBackRange(i.textDocument,e.range),r).range,text:e.newText}))),t.command&&(e.command=Pe(t.command))}var ze=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{hover:{dynamicRegistration:!0,contentFormat:[te.Markdown,te.PlainText]}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentHover,!0,e=>w.languages.registerHoverProvider(Ke(e.documentSelector),new je(this._connection,e))))}},je=class{constructor(e,t){this._client=e,this._capabilities=t}async provideHover(e,t,n){const i=this._client.bridge.translate(e,t),r=await this._client.server.textDocumentHover({textDocument:i.textDocument,position:i.position});return r&&r.contents?{contents:(o=r.contents,Array.isArray(o)?o.map(e=>$e(e)):[$e(o)]),range:r.range?this._client.bridge.translateBackRange(i.textDocument,r.range).range:void 0}:null;var o}};function $e(e){return"string"==typeof e?{value:e,isTrusted:!0}:"kind"in e?{value:e.value,isTrusted:!0}:{value:`\`\`\`${e.language}\n${e.value}\n\`\`\``,isTrusted:!0}}var Ue=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{signatureHelp:{dynamicRegistration:!0,contextSupport:!0,signatureInformation:{documentationFormat:[te.Markdown,te.PlainText],parameterInformation:{labelOffsetSupport:!0},activeParameterSupport:!0}}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentSignatureHelp,!0,e=>w.languages.registerSignatureHelpProvider(Ke(e.documentSelector),new Be(this._connection,e))))}},Be=class{constructor(e,t){x(this,"signatureHelpTriggerCharacters"),x(this,"signatureHelpRetriggerCharacters"),this._client=e,this._capabilities=t,this.signatureHelpTriggerCharacters=t.triggerCharacters,this.signatureHelpRetriggerCharacters=t.retriggerCharacters}async provideSignatureHelp(e,t,n,i){const r=this._client.bridge.translate(e,t),o=await this._client.server.textDocumentSignatureHelp({textDocument:r.textDocument,position:r.position,context:{triggerKind:(s=i.triggerKind,He.get(s)??oe.Invoked),triggerCharacter:i.triggerCharacter,isRetrigger:i.isRetrigger}});var s;return o?{value:{signatures:o.signatures.map(e=>({label:e.label,documentation:Ve(e.documentation),parameters:e.parameters?.map(e=>({label:e.label,documentation:Ve(e.documentation)}))||[],activeParameter:e.activeParameter})),activeSignature:o.activeSignature||0,activeParameter:o.activeParameter||0},dispose:()=>{}}:null}};function Ve(e){if(e)return"string"==typeof e?e:{value:e.value,isTrusted:!0}}var Je=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{definition:{dynamicRegistration:!0,linkSupport:!0}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentDefinition,!0,e=>w.languages.registerDefinitionProvider(Ke(e.documentSelector),new Ge(this._connection,e))))}},Ge=class{constructor(e,t){this._client=e,this._capabilities=t}async provideDefinition(e,t,n){const i=this._client.bridge.translate(e,t),r=await this._client.server.textDocumentDefinition({textDocument:i.textDocument,position:i.position});return r?Array.isArray(r)?r.map(e=>Le(e,this._client)):Le(r,this._client):null}},Qe=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{declaration:{dynamicRegistration:!0,linkSupport:!0}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentDeclaration,!0,e=>w.languages.registerDeclarationProvider(Ke(e.documentSelector),new Ye(this._connection,e))))}},Ye=class{constructor(e,t){this._client=e,this._capabilities=t}async provideDeclaration(e,t,n){const i=this._client.bridge.translate(e,t),r=await this._client.server.textDocumentDeclaration({textDocument:i.textDocument,position:i.position});return r?Array.isArray(r)?r.map(e=>Le(e,this._client)):Le(r,this._client):null}},Xe=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{typeDefinition:{dynamicRegistration:!0,linkSupport:!0}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentTypeDefinition,!0,e=>w.languages.registerTypeDefinitionProvider(Ke(e.documentSelector),new Ze(this._connection,e))))}},Ze=class{constructor(e,t){this._client=e,this._capabilities=t}async provideTypeDefinition(e,t,n){const i=this._client.bridge.translate(e,t),r=await this._client.server.textDocumentTypeDefinition({textDocument:i.textDocument,position:i.position});return r?Array.isArray(r)?r.map(e=>Le(e,this._client)):Le(r,this._client):null}},et=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{implementation:{dynamicRegistration:!0,linkSupport:!0}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentImplementation,!0,e=>w.languages.registerImplementationProvider(Ke(e.documentSelector),new tt(this._connection,e))))}},tt=class{constructor(e,t){this._client=e,this._capabilities=t}async provideImplementation(e,t,n){const i=this._client.bridge.translate(e,t),r=await this._client.server.textDocumentImplementation({textDocument:i.textDocument,position:i.position});return r?Array.isArray(r)?r.map(e=>Le(e,this._client)):Le(r,this._client):null}},nt=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{references:{dynamicRegistration:!0}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentReferences,!0,e=>w.languages.registerReferenceProvider(Ke(e.documentSelector),new it(this._connection,e))))}},it=class{constructor(e,t){this._client=e,this._capabilities=t}async provideReferences(e,t,n,i){const r=this._client.bridge.translate(e,t),o=await this._client.server.textDocumentReferences({textDocument:r.textDocument,position:r.position,context:{includeDeclaration:n.includeDeclaration}});return o?o.map(e=>{const t=this._client.bridge.translateBackRange({uri:e.uri},e.range);return{uri:t.textModel.uri,range:t.range}}):null}},rt=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{documentHighlight:{dynamicRegistration:!0}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentDocumentHighlight,!0,e=>w.languages.registerDocumentHighlightProvider(Ke(e.documentSelector),new ot(this._connection,e))))}},ot=class{constructor(e,t){this._client=e,this._capabilities=t}async provideDocumentHighlights(e,t,n){const i=this._client.bridge.translate(e,t),r=await this._client.server.textDocumentDocumentHighlight({textDocument:i.textDocument,position:i.position});return r?r.map(e=>{return{range:this._client.bridge.translateBackRange(i.textDocument,e.range).range,kind:(t=e.kind,t?ke.get(t)??w.languages.DocumentHighlightKind.Text:w.languages.DocumentHighlightKind.Text)};var t}):null}},st=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{documentSymbol:{dynamicRegistration:!0,hierarchicalDocumentSymbolSupport:!0,symbolKind:{valueSet:Array.from(be.keys())},tagSupport:{valueSet:[V.Deprecated]}}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentDocumentSymbol,!0,e=>w.languages.registerDocumentSymbolProvider(Ke(e.documentSelector),new at(this._connection,e))))}},at=class{constructor(e,t){this._client=e,this._capabilities=t}async provideDocumentSymbols(e,t){const n=this._client.bridge.translate(e,new w.Position(1,1)),i=await this._client.server.textDocumentDocumentSymbol({textDocument:n.textDocument});return i?Array.isArray(i)&&i.length>0?"location"in i[0]?i.map(e=>function(e,t){return{name:e.name,detail:"",kind:ve(e.kind),tags:e.tags?.map(e=>Ce(e)).filter(e=>void 0!==e)||[],range:t.bridge.translateBackRange({uri:e.location.uri},e.location.range).range,selectionRange:t.bridge.translateBackRange({uri:e.location.uri},e.location.range).range,children:[]}}(e,this._client)):i.map(e=>ct(e,this._client,n.textDocument)):[]:null}};function ct(e,t,n){return{name:e.name,detail:e.detail||"",kind:ve(e.kind),tags:e.tags?.map(e=>Ce(e)).filter(e=>void 0!==e)||[],range:t.bridge.translateBackRange(n,e.range).range,selectionRange:t.bridge.translateBackRange(n,e.selectionRange).range,children:e.children?.map(e=>ct(e,t,n))||[]}}var lt=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{rename:{dynamicRegistration:!0,prepareSupport:!0}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentRename,!0,e=>w.languages.registerRenameProvider(Ke(e.documentSelector),new dt(this._connection,e))))}},dt=class{constructor(e,t){this._client=e,this._capabilities=t}async provideRenameEdits(e,t,n,i){const r=this._client.bridge.translate(e,t),o=await this._client.server.textDocumentRename({textDocument:r.textDocument,position:r.position,newName:n});return o?function(e,t){const n=[];if(e.changes)for(const i in e.changes){const r=e.changes[i];for(const e of r){const r=t.bridge.translateBackRange({uri:i},e.range);n.push({resource:r.textModel.uri,versionId:void 0,textEdit:{range:r.range,text:e.newText}})}}if(e.documentChanges)for(const i of e.documentChanges)if("textDocument"in i){const e=i.textDocument.uri;for(const r of i.edits){const o=t.bridge.translateBackRange({uri:e},r.range);n.push({resource:o.textModel.uri,versionId:i.textDocument.version,textEdit:{range:o.range,text:r.newText}})}}return{edits:n}}(o,this._client):null}async resolveRenameLocation(e,t,n){if(!this._capabilities.prepareProvider)return null;const i=this._client.bridge.translate(e,t),r=await this._client.server.textDocumentPrepareRename({textDocument:i.textDocument,position:i.position});if(!r)return null;if("range"in r&&"placeholder"in r)return{range:this._client.bridge.translateBackRange(i.textDocument,r.range).range,text:r.placeholder};if("defaultBehavior"in r)return null;if("start"in r&&"end"in r){const t=this._client.bridge.translateBackRange(i.textDocument,r).range;return{range:t,text:e.getValueInRange(t)}}return null}},ut=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{codeAction:{dynamicRegistration:!0,codeActionLiteralSupport:{codeActionKind:{valueSet:Array.from(he.keys())}},isPreferredSupport:!0,disabledSupport:!0,dataSupport:!0,resolveSupport:{properties:["edit"]}}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentCodeAction,!0,e=>w.languages.registerCodeActionProvider(Ke(e.documentSelector),new gt(this._connection,e))))}},gt=class{constructor(e,t){x(this,"resolveCodeAction"),this._client=e,this._capabilities=t,t.resolveProvider&&(this.resolveCodeAction=async(e,t)=>{if(e._lspAction){const t=await this._client.server.codeActionResolve(e._lspAction);t.edit&&(e.edit=mt(t.edit,this._client)),t.command&&(e.command=Pe(t.command))}return e})}async provideCodeActions(e,t,n,i){const r=this._client.bridge.translate(e,t.getStartPosition()),o=await this._client.server.textDocumentCodeAction({textDocument:r.textDocument,range:this._client.bridge.translateRange(e,t),context:{diagnostics:n.markers.map(t=>{return{range:this._client.bridge.translateRange(e,w.Range.lift(t)),message:t.message,severity:(n=t.severity,Ie.get(n)??ne.Error)};var n}),triggerKind:(s=n.trigger,_e.get(s)??se.Invoked)}});var s;return o?{actions:(Array.isArray(o)?o:[o]).map(e=>{if("title"in e&&!("kind"in e)){const t=e;return{title:t.title,command:Pe(t)}}{const t=e;return{title:t.title,kind:pe(t.kind),isPreferred:t.isPreferred,disabled:t.disabled?.reason,edit:t.edit?mt(t.edit,this._client):void 0,command:Pe(t.command),_lspAction:t}}}),dispose:()=>{}}:null}};function mt(e,t){const n=[];if(e.changes)for(const i in e.changes){const r=e.changes[i];for(const e of r){const r=t.bridge.translateBackRange({uri:i},e.range);n.push({resource:r.textModel.uri,versionId:void 0,textEdit:{range:r.range,text:e.newText}})}}if(e.documentChanges)for(const i of e.documentChanges)if("textDocument"in i){const e=i.textDocument.uri;for(const r of i.edits){const o=t.bridge.translateBackRange({uri:e},r.range);n.push({resource:o.textModel.uri,versionId:i.textDocument.version??void 0,textEdit:{range:o.range,text:r.newText}})}}return{edits:n}}var ht=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{codeLens:{dynamicRegistration:!0}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentCodeLens,!0,e=>w.languages.registerCodeLensProvider(Ke(e.documentSelector),new pt(this._connection,e))))}},pt=class{constructor(e,t){this._client=e,this._capabilities=t}async provideCodeLenses(e,t){const n=this._client.bridge.translate(e,new w.Position(1,1)),i=await this._client.server.textDocumentCodeLens({textDocument:n.textDocument});return i?{lenses:i.map(t=>({range:ue(this._client.bridge.translateBackRange(n.textDocument,t.range),e).range,command:Pe(t.command),_lspCodeLens:t})),dispose:()=>{}}:null}async resolveCodeLens(e,t,n){if(!this._capabilities.resolveProvider||!t._lspCodeLens)return t;const i=await this._client.server.codeLensResolve(t._lspCodeLens);return i.command&&(t.command={id:i.command.command,title:i.command.title,arguments:i.command.arguments}),t}},_t=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{documentLink:{dynamicRegistration:!0,tooltipSupport:!0}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentDocumentLink,!0,e=>w.languages.registerLinkProvider(Ke(e.documentSelector),new wt(this._connection,e))))}},wt=class{constructor(e,t){this._client=e,this._capabilities=t}async provideLinks(e,t){const n=this._client.bridge.translate(e,new w.Position(1,1)),i=await this._client.server.textDocumentDocumentLink({textDocument:n.textDocument});return i?{links:i.map(e=>({range:this._client.bridge.translateBackRange(n.textDocument,e.range).range,url:e.target,tooltip:e.tooltip}))}:null}async resolveLink(e,t){return this._capabilities.resolveProvider,e}},Dt=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{formatting:{dynamicRegistration:!0}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentFormatting,!0,e=>w.languages.registerDocumentFormattingEditProvider(Ke(e.documentSelector),new xt(this._connection,e))))}},xt=class{constructor(e,t){this._client=e,this._capabilities=t}async provideDocumentFormattingEdits(e,t,n){const i=this._client.bridge.translate(e,new w.Position(1,1)),r=await this._client.server.textDocumentFormatting({textDocument:i.textDocument,options:{tabSize:t.tabSize,insertSpaces:t.insertSpaces}});return r?r.map(e=>({range:this._client.bridge.translateBackRange(i.textDocument,e.range).range,text:e.newText})):null}},ft=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{rangeFormatting:{dynamicRegistration:!0}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentRangeFormatting,!0,e=>w.languages.registerDocumentRangeFormattingEditProvider(Ke(e.documentSelector),new yt(this._connection,e))))}},yt=class{constructor(e,t){this._client=e,this._capabilities=t}async provideDocumentRangeFormattingEdits(e,t,n,i){const r=this._client.bridge.translate(e,t.getStartPosition()),o=await this._client.server.textDocumentRangeFormatting({textDocument:r.textDocument,range:this._client.bridge.translateRange(e,t),options:{tabSize:n.tabSize,insertSpaces:n.insertSpaces}});return o?o.map(e=>({range:this._client.bridge.translateBackRange(r.textDocument,e.range).range,text:e.newText})):null}},bt=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{onTypeFormatting:{dynamicRegistration:!0}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentOnTypeFormatting,!0,e=>w.languages.registerOnTypeFormattingEditProvider(Ke(e.documentSelector),new vt(this._connection,e))))}},vt=class{constructor(e,t){x(this,"autoFormatTriggerCharacters"),this._client=e,this._capabilities=t,this.autoFormatTriggerCharacters=[t.firstTriggerCharacter,...t.moreTriggerCharacter||[]]}async provideOnTypeFormattingEdits(e,t,n,i,r){const o=this._client.bridge.translate(e,t),s=await this._client.server.textDocumentOnTypeFormatting({textDocument:o.textDocument,position:o.position,ch:n,options:{tabSize:i.tabSize,insertSpaces:i.insertSpaces}});return s?s.map(e=>({range:this._client.bridge.translateBackRange(o.textDocument,e.range).range,text:e.newText})):null}},St=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{foldingRange:{dynamicRegistration:!0,rangeLimit:5e3,lineFoldingOnly:!1,foldingRangeKind:{valueSet:[U.Comment,U.Imports,U.Region]}}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentFoldingRange,!0,e=>w.languages.registerFoldingRangeProvider(Ke(e.documentSelector),new Ct(this._connection,e))))}},Ct=class{constructor(e,t){this._client=e,this._capabilities=t}async provideFoldingRanges(e,t,n){const i=this._client.bridge.translate(e,new w.Position(1,1)),r=await this._client.server.textDocumentFoldingRange({textDocument:i.textDocument});return r?r.map(e=>({start:e.startLine+1,end:e.endLine+1,kind:Te(e.kind)})):null}},kt=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{selectionRange:{dynamicRegistration:!0}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentSelectionRange,!0,e=>w.languages.registerSelectionRangeProvider(Ke(e.documentSelector),new Rt(this._connection,e))))}},Rt=class{constructor(e,t){this._client=e,this._capabilities=t}async provideSelectionRanges(e,t,n){const i=this._client.bridge.translate(e,t[0]),r=await this._client.server.textDocumentSelectionRange({textDocument:i.textDocument,positions:t.map(t=>this._client.bridge.translate(e,t).position)});return r?r.map(e=>this.convertSelectionRange(e,i.textDocument)):null}convertSelectionRange(e,t){const n=[];let i=e;for(;i;)n.push({range:this._client.bridge.translateBackRange(t,i.range).range}),i=i.parent;return n}},Tt=class extends ge{constructor(e){super(),x(this,"_providers",new Set),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{inlayHint:{dynamicRegistration:!0,resolveSupport:{properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]}}},workspace:{inlayHint:{refreshSupport:!0}}})),this._register(this._connection.connection.registerRequestHandler(de.client.workspaceInlayHintRefresh,async()=>{for(const e of this._providers)e.refresh();return{ok:null}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentInlayHint,!0,e=>{const t=new It(this._connection,e);this._providers.add(t);const n=w.languages.registerInlayHintsProvider(Ke(e.documentSelector),t);return{dispose:()=>{this._providers.delete(t),n.dispose()}}}))}},It=class{constructor(e,t){x(this,"_onDidChangeInlayHints",new w.Emitter),x(this,"onDidChangeInlayHints",this._onDidChangeInlayHints.event),x(this,"resolveInlayHint"),this._client=e,this._capabilities=t,t.resolveProvider&&(this.resolveInlayHint=async(e,t)=>{const n=await this._client.server.inlayHintResolve(e._lspInlayHint);return n.tooltip&&(e.tooltip=Mt(n.tooltip)),n.label!==e._lspInlayHint.label&&(e.label=Et(n.label)),n.textEdits&&(e.textEdits=n.textEdits.map(t=>({range:this._client.bridge.translateBackRange({uri:e._targetUri},t.range).range,text:t.newText}))),e})}refresh(){this._onDidChangeInlayHints.fire()}async provideInlayHints(e,t,n){const i=this._client.bridge.translate(e,t.getStartPosition()),r=await async function(e){for(let t=3;;t--)try{return await e()}catch(e){if("content modified"===e.message&&t>0)continue;throw e}}(async()=>await this._client.server.textDocumentInlayHint({textDocument:i.textDocument,range:this._client.bridge.translateRange(e,t)}));return r?{hints:r.map(t=>{return{label:Et(t.label),position:ue(this._client.bridge.translateBack(i.textDocument,t.position),e).position,kind:(n=t.kind,n?Fe.get(n)??w.languages.InlayHintKind.Type:w.languages.InlayHintKind.Type),tooltip:Mt(t.tooltip),paddingLeft:t.paddingLeft,paddingRight:t.paddingRight,textEdits:t.textEdits?.map(t=>({range:ue(this._client.bridge.translateBackRange(i.textDocument,t.range),e).range,text:t.newText})),_lspInlayHint:t,_targetUri:i.textDocument.uri};var n}),dispose:()=>{}}:null}};function Et(e){return"string"==typeof e?e:e.map(e=>{const t={label:e.value,tooltip:Mt(e.tooltip),command:Pe(e.command)};return e.location&&(t.location={uri:w.Uri.parse(e.location.uri),range:new w.Range(e.location.range.start.line+1,e.location.range.start.character+1,e.location.range.end.line+1,e.location.range.end.character+1)}),t})}function Mt(e){if(e)return"string"==typeof e?e:{value:e.value,isTrusted:!0}}var Ht=class extends ge{constructor(e){super(),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{semanticTokens:{dynamicRegistration:!0,requests:{range:!0,full:{delta:!0}},tokenTypes:["namespace","type","class","enum","interface","struct","typeParameter","parameter","variable","property","enumMember","event","function","method","macro","keyword","modifier","comment","string","number","regexp","operator","decorator"],tokenModifiers:["declaration","definition","readonly","static","deprecated","abstract","async","modification","documentation","defaultLibrary"],formats:[ae.Relative],overlappingTokenSupport:!1,multilineTokenSupport:!0}}})),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentSemanticTokensFull,!0,e=>w.languages.registerDocumentSemanticTokensProvider(Ke(e.documentSelector),new Pt(this._connection,e))))}},Pt=class{constructor(e,t){this._client=e,this._capabilities=t}getLegend(){return{tokenTypes:this._capabilities.legend.tokenTypes,tokenModifiers:this._capabilities.legend.tokenModifiers}}releaseDocumentSemanticTokens(e){}async provideDocumentSemanticTokens(e,t,n){const i=this._client.bridge.translate(e,e.getPositionAt(0)),r=this._capabilities.full;if(t&&r&&"object"==typeof r&&r.delta){const e=await this._client.server.textDocumentSemanticTokensFullDelta({textDocument:i.textDocument,previousResultId:t});return e?"edits"in e?{resultId:e.resultId,edits:e.edits.map(e=>({start:e.start,deleteCount:e.deleteCount,data:e.data?new Uint32Array(e.data):void 0}))}:{resultId:e.resultId,data:new Uint32Array(e.data)}:null}const o=await this._client.server.textDocumentSemanticTokensFull({textDocument:i.textDocument});return o?{resultId:o.resultId,data:new Uint32Array(o.data)}:null}async provideDocumentSemanticTokensEdits(e,t,n){return this.provideDocumentSemanticTokens(e,t,n)}},Ft=class extends ge{constructor(e){super(),x(this,"_diagnosticsMarkerOwner","lsp"),x(this,"_pullDiagnosticProviders",new Map),this._connection=e,this._register(this._connection.capabilities.addStaticClientCapabilities({textDocument:{publishDiagnostics:{relatedInformation:!0,tagSupport:{valueSet:[...Me.keys()]},versionSupport:!0,codeDescriptionSupport:!0,dataSupport:!0},diagnostic:{dynamicRegistration:!0,relatedDocumentSupport:!0}}})),this._register(this._connection.connection.registerNotificationHandler(de.client.textDocumentPublishDiagnostics,e=>this._handlePublishDiagnostics(e))),this._register(this._connection.capabilities.registerCapabilityHandler(le.textDocumentDiagnostic,!0,e=>{const t=new me;for(const n of w.editor.getModels())this._addPullDiagnosticProvider(n,e,t);return t.add(w.editor.onDidCreateModel(n=>{this._addPullDiagnosticProvider(n,e,t)})),t}))}_addPullDiagnosticProvider(e,t,n){if(e.getLanguageId(),!function(e,t){if(!t)return!0;const n=e.getLanguageId();if(e.uri.toString(!0),!t||0===t.length)return!0;for(const e of t)if(!e.language||"*"===e.language||e.language===n)return!0;return!1}(e,t.documentSelector))return;const i=new Lt(e,this._connection,this._diagnosticsMarkerOwner,t);this._pullDiagnosticProviders.set(e,i),n.add(i),n.add(e.onWillDispose(()=>{this._pullDiagnosticProviders.delete(e)}))}_handlePublishDiagnostics(e){const t=e.uri;try{const n=this._connection.bridge.translateBack({uri:t},{line:0,character:0}).textModel;if(!n||n.isDisposed())return;const i=e.diagnostics.map(e=>qe(e));w.editor.setModelMarkers(n,this._diagnosticsMarkerOwner,i)}catch(e){console.debug(`Could not set diagnostics for ${t}:`,e)}}},Lt=class extends ge{constructor(e,t,n,i){super(),x(this,"_updateHandle"),x(this,"_previousResultId"),this._model=e,this._connection=t,this._markerOwner=n,this._capability=i,this._register(this._model.onDidChangeContent(()=>{this._scheduleDiagnosticUpdate()})),this._scheduleDiagnosticUpdate()}_scheduleDiagnosticUpdate(){void 0!==this._updateHandle&&clearTimeout(this._updateHandle),this._updateHandle=window.setTimeout(()=>{this._updateHandle=void 0,this._requestDiagnostics()},500)}async _requestDiagnostics(){if(!this._model.isDisposed())try{const e=this._connection.bridge.translate(this._model,new w.Position(1,1)),t=await this._connection.server.textDocumentDiagnostic({textDocument:e.textDocument,identifier:this._capability.identifier,previousResultId:this._previousResultId});if(this._model.isDisposed())return;this._handleDiagnosticReport(t)}catch(e){console.error("Error requesting diagnostics:",e)}}_handleDiagnosticReport(e){if("full"===e.kind){this._previousResultId=e.resultId;const t=e.items.map(e=>qe(e));w.editor.setModelMarkers(this._model,this._markerOwner,t),"relatedDocuments"in e&&e.relatedDocuments&&this._handleRelatedDocuments(e.relatedDocuments)}else"unchanged"===e.kind&&(this._previousResultId=e.resultId)}_handleRelatedDocuments(e){for(const[t,n]of Object.entries(e))try{const e=this._connection.bridge.translateBack({uri:t},{line:0,character:0}).textModel;if(!e||e.isDisposed())continue;if("full"===n.kind){const t=n.items.map(e=>qe(e));w.editor.setModelMarkers(e,this._markerOwner,t)}}catch(e){console.debug(`Could not set related diagnostics for ${t}:`,e)}}dispose(){void 0!==this._updateHandle&&(clearTimeout(this._updateHandle),this._updateHandle=void 0),super.dispose()}},Kt=class{constructor(e,t,n,i){this.server=e,this.bridge=t,this.capabilities=n,this.connection=i}},qt=class extends ge{constructor(e){super(),x(this,"_staticCapabilities",new Set),x(this,"_dynamicFromStatic",jt.create()),x(this,"_registrations",new Map),x(this,"_serverCapabilities"),this._connection=e,this._register(this._connection.registerRequestHandler(de.client.clientRegisterCapability,async e=>{for(const t of e.registrations){const e=Wt(t.method),n=new Ot(t.id,e,t.registerOptions,!1);this._registerCapabilityOptions(n)}return{ok:null}})),this._register(this._connection.registerRequestHandler(de.client.clientUnregisterCapability,async e=>{for(const t of e.unregisterations){const e=Wt(t.method),n=this._registrations.get(e),i=n?.registrations.get(t.id);if(!i)throw new Error(`No registration for method ${t.method} with id ${t.id}`);i?.handlerDisposables.forEach(e=>e.dispose()),n?.registrations.delete(t.id)}return{ok:null}}))}_registerCapabilityOptions(e){let t=this._registrations.get(e.capability);if(t||(t=new zt,this._registrations.set(e.capability,t)),t.registrations.has(e.id))throw new Error(`Handler for method ${e.capability.method} with id ${e.id} already registered`);t.registrations.set(e.id,e);for(const n of t.handlers)!n.handleStaticCapability&&e.isFromStatic||e.handlerDisposables.set(n,n.handler(e.options))}setServerCapabilities(e){if(this._serverCapabilities)throw new Error("Server capabilities already set");this._serverCapabilities=e;for(const t of Object.values(le)){const n=this._dynamicFromStatic.getOptions(t,e);n&&this._registerCapabilityOptions(new Ot(t.method,t,n,!0))}}getClientCapabilities(){const e={};for(const t of this._staticCapabilities)$t(e,t.cap);return e}addStaticClientCapabilities(e){const t={cap:e};return this._staticCapabilities.add(t),{dispose:()=>{this._staticCapabilities.delete(t)}}}registerCapabilityHandler(e,t,n){let i=this._registrations.get(e);i||(i=new zt,this._registrations.set(e,i));const r=new At(e,t,n);i.handlers.add(r);for(const e of i.registrations.values())!r.handleStaticCapability&&e.isFromStatic||e.handlerDisposables.set(r,n(e.options));return{dispose:()=>{i.handlers.delete(r);for(const e of i.registrations.values()){const t=e.handlerDisposables.get(r);t&&(t.dispose(),e.handlerDisposables.delete(r))}}}}},At=class{constructor(e,t,n){this.capability=e,this.handleStaticCapability=t,this.handler=n}},Ot=class{constructor(e,t,n,i){x(this,"handlerDisposables",new Map),this.id=e,this.capability=t,this.options=n,this.isFromStatic=i}};const Nt=new Map([...Object.values(le)].map(e=>[e.method,e]));function Wt(e){const t=Nt.get(e);if(!t)throw new Error(`No capability found for method ${e}`);return t}var zt=class{constructor(){x(this,"handlers",new Set),x(this,"registrations",new Map)}},jt=class e{constructor(){x(this,"_mappings",new Map)}static create(){const t=new e;return t.set(le.textDocumentDidChange,e=>{if(void 0!==e.textDocumentSync)return"object"==typeof e.textDocumentSync?{syncKind:e.textDocumentSync.change??G.None,documentSelector:null}:{syncKind:e.textDocumentSync,documentSelector:null}}),t.set(le.textDocumentCompletion,e=>e.completionProvider),t.set(le.textDocumentHover,e=>e.hoverProvider),t.set(le.textDocumentSignatureHelp,e=>e.signatureHelpProvider),t.set(le.textDocumentDefinition,e=>e.definitionProvider),t.set(le.textDocumentReferences,e=>e.referencesProvider),t.set(le.textDocumentDocumentHighlight,e=>e.documentHighlightProvider),t.set(le.textDocumentDocumentSymbol,e=>e.documentSymbolProvider),t.set(le.textDocumentCodeAction,e=>e.codeActionProvider),t.set(le.textDocumentCodeLens,e=>e.codeLensProvider),t.set(le.textDocumentDocumentLink,e=>e.documentLinkProvider),t.set(le.textDocumentFormatting,e=>e.documentFormattingProvider),t.set(le.textDocumentRangeFormatting,e=>e.documentRangeFormattingProvider),t.set(le.textDocumentOnTypeFormatting,e=>e.documentOnTypeFormattingProvider),t.set(le.textDocumentRename,e=>e.renameProvider),t.set(le.textDocumentFoldingRange,e=>e.foldingRangeProvider),t.set(le.textDocumentDeclaration,e=>e.declarationProvider),t.set(le.textDocumentTypeDefinition,e=>e.typeDefinitionProvider),t.set(le.textDocumentImplementation,e=>e.implementationProvider),t.set(le.textDocumentDocumentColor,e=>e.colorProvider),t.set(le.textDocumentSelectionRange,e=>e.selectionRangeProvider),t.set(le.textDocumentLinkedEditingRange,e=>e.linkedEditingRangeProvider),t.set(le.textDocumentPrepareCallHierarchy,e=>e.callHierarchyProvider),t.set(le.textDocumentSemanticTokensFull,e=>e.semanticTokensProvider),t.set(le.textDocumentInlayHint,e=>e.inlayHintProvider),t.set(le.textDocumentInlineValue,e=>e.inlineValueProvider),t.set(le.textDocumentDiagnostic,e=>e.diagnosticProvider),t.set(le.textDocumentMoniker,e=>e.monikerProvider),t.set(le.textDocumentPrepareTypeHierarchy,e=>e.typeHierarchyProvider),t.set(le.workspaceSymbol,e=>e.workspaceSymbolProvider),t.set(le.workspaceExecuteCommand,e=>e.executeCommandProvider),t}set(e,t){if(this._mappings.has(e.method))throw new Error(`Capability for method ${e.method} already registered`);this._mappings.set(e.method,t)}getOptions(e,t){const n=this._mappings.get(e.method);if(n)return n(t)}};function $t(e,t){for(const n of Object.keys(t)){const i=t[n];if(void 0===i)continue;const r=e[n];void 0!==r&&"object"==typeof i&&null!==i&&"object"==typeof r&&null!==r?$t(r,i):e[n]=i}}var Ut=class extends ge{constructor(e,t){super(),x(this,"_managedModels",new Map),x(this,"_managedModelsReverse",new Map),x(this,"_started",!1),this._server=e,this._capabilities=t,this._register(this._capabilities.addStaticClientCapabilities({textDocument:{synchronization:{dynamicRegistration:!0,willSave:!1,willSaveWaitUntil:!1,didSave:!1}}})),this._register(t.registerCapabilityHandler(le.textDocumentDidChange,!0,e=>{if(this._started)return{dispose:()=>{}};this._started=!0,this._register(w.editor.onDidCreateModel(e=>{this._getOrCreateManagedModel(e)}));for(const e of w.editor.getModels())this._getOrCreateManagedModel(e);return{dispose:()=>{}}}))}_getOrCreateManagedModel(e){if(!this._started)throw new Error("Not started");const t=e.uri.toString(!0).toLowerCase();let n=this._managedModels.get(e);return n||(n=new Bt(e,this._server),this._managedModels.set(e,n),this._managedModelsReverse.set(t,e)),e.onWillDispose(()=>{n.dispose(),this._managedModels.delete(e),this._managedModelsReverse.delete(t)}),n}translateBack(e,t){const n=e.uri.toLowerCase(),i=this._managedModelsReverse.get(n);if(!i)throw new Error(`No text model for uri ${n}`);return{textModel:i,position:new w.Position(t.line+1,t.character+1)}}translateBackRange(e,t){const n=e.uri.toLowerCase(),i=this._managedModelsReverse.get(n);if(!i)throw new Error(`No text model for uri ${n}`);return{textModel:i,range:new w.Range(t.start.line+1,t.start.character+1,t.end.line+1,t.end.character+1)}}translate(e,t){return{textDocument:{uri:e.uri.toString(!0)},position:{line:t.lineNumber-1,character:t.column-1}}}translateRange(e,t){return{start:{line:t.startLineNumber-1,character:t.startColumn-1},end:{line:t.endLineNumber-1,character:t.endColumn-1}}}},Bt=class extends ge{constructor(e,t){super(),this._textModel=e,this._api=t;const n=e.uri.toString(!0).toLowerCase();this._api.textDocumentDidOpen({textDocument:{languageId:e.getLanguageId(),uri:n,version:e.getVersionId(),text:e.getValue()}}),this._register(e.onDidChangeContent(t=>{const i=t.changes.map(e=>{return{range:(t=(n=e).range,{start:{line:t.startLineNumber-1,character:t.startColumn-1},end:{line:t.endLineNumber-1,character:t.endColumn-1}}),rangeLength:n.rangeLength,text:n.text};var t,n});this._api.textDocumentDidChange({textDocument:{uri:n,version:e.getVersionId()},contentChanges:i})})),this._register({dispose:()=>{this._api.textDocumentDidClose({textDocument:{uri:n}})}})}};var Vt=class{constructor(e){x(this,"_connection"),x(this,"_capabilitiesRegistry"),x(this,"_bridge"),x(this,"_initPromise");const t=F.fromTransport(e),n=de.getServer(t,{});t.startListen(),this._capabilitiesRegistry=new qt(t),this._bridge=new Ut(n.server,this._capabilitiesRegistry),this._connection=new Kt(n.server,this._bridge,this._capabilitiesRegistry,t),this.createFeatures(),this._initPromise=this._init()}async _init(){const e=await this._connection.server.initialize({processId:null,capabilities:this._capabilitiesRegistry.getClientCapabilities(),rootUri:null});this._connection.server.initialized({}),this._capabilitiesRegistry.setServerCapabilities(e.capabilities)}createFeatures(){const e=new me;return e.add(new Ae(this._connection)),e.add(new ze(this._connection)),e.add(new Ue(this._connection)),e.add(new Je(this._connection)),e.add(new Qe(this._connection)),e.add(new Xe(this._connection)),e.add(new et(this._connection)),e.add(new nt(this._connection)),e.add(new rt(this._connection)),e.add(new st(this._connection)),e.add(new lt(this._connection)),e.add(new ut(this._connection)),e.add(new ht(this._connection)),e.add(new _t(this._connection)),e.add(new Dt(this._connection)),e.add(new ft(this._connection)),e.add(new bt(this._connection)),e.add(new St(this._connection)),e.add(new kt(this._connection)),e.add(new Tt(this._connection)),e.add(new Ht(this._connection)),e.add(new Ft(this._connection)),e}},Jt=null;"undefined"!=typeof WebSocket?Jt=WebSocket:"undefined"!=typeof MozWebSocket?Jt=MozWebSocket:"undefined"!=typeof global?Jt=global.WebSocket||global.MozWebSocket:"undefined"!=typeof window?Jt=window.WebSocket||window.MozWebSocket:"undefined"!=typeof self&&(Jt=self.WebSocket||self.MozWebSocket);var Gt=Jt,Qt=class e extends k{constructor(e){super(),x(this,"socket"),x(this,"errorEmitter",new f),x(this,"onError",this.errorEmitter),this.socket=e,e.onmessage=e=>{try{const t=e.data;if("string"!=typeof t)throw new Error("Not supported");{const e=JSON.parse(t);this._dispatchReceivedMessage(e)}}catch(e){this.errorEmitter.fire({error:e})}},e.onclose=e=>{this._onConnectionClosed()}}static connectTo(t){const n=new Gt(function(e){return"host"in e?{address:`${e.forceTls?"wss":"ws"}://${e.host}:${e.port}`}:e}(t).address);return new Promise((t,i)=>{n.onerror=e=>{i(e)},n.onopen=()=>{t(new e(n))}})}static fromWebSocket(t){return new e(t)}close(){this.socket.close()}dispose(){this.close()}_sendImpl(e){const t=JSON.stringify(e);return new Promise((e,n)=>{this.socket.send(t,t=>{t?n(t):e()})})}toString(){return`${this.id}@${this.socket.url}`}},Yt=class extends k{constructor(e,t=void 0,n=void 0){super(),x(this,"_windowLike"),x(this,"_source"),x(this,"_loadingState"),x(this,"_disposed",!1),x(this,"_messageHandler",({data:e,source:t})=>{this._source&&t!==this._source||"object"==typeof e&&e&&this._dispatchReceivedMessage(e)}),this._windowLike=e,this._source=t,this._loadingState=n,this._windowLike.addEventListener("message",this._messageHandler)}async _sendImpl(e){if(this._disposed)throw new Error("Transport is disposed");this._loadingState&&!this._loadingState.loaded&&await this._loadingState.onLoaded,this._windowLike.postMessage(e)}toString(){return`${this.id}@${this._windowLike}`}dispose(){this._disposed||(this._disposed=!0,this._windowLike.removeEventListener("message",this._messageHandler))}};function Xt(e){if("undefined"==typeof window)throw new Error("call this function from the main browser thread");return new Yt(e)}function Zt(e){if("undefined"==typeof window)throw new Error("call this function from the main browser thread");return new Yt(e.contentWindow,e.contentWindow,{loaded:"complete"===window.document.readyState,onLoaded:new Promise(e=>{window.addEventListener("load",()=>e())})})}var en=n(71549);const tn=(0,g.B)();var nn;tn.languages.css=m,tn.languages.html=h,tn.languages.typescript=_,tn.languages.json=p,self.MonacoEnvironment=(nn={editorWorkerService:"editor.worker.js",css:"css.worker.js",html:"html.worker.js",json:"json.worker.js",typescript:"ts.worker.js",javascript:"ts.worker.js",less:"css.worker.js",scss:"css.worker.js",handlebars:"html.worker.js",razor:"html.worker.js"},{globalAPI:!1,getWorkerUrl:function(e,t){var i=n.p,r=(i?i.replace(/\/$/,"")+"/":"")+nn[t];if(/^((http:)|(https:)|(file:)|(\/\/))/.test(r)){var o=String(window.location),s=o.substr(0,o.length-window.location.hash.length-window.location.search.length-window.location.pathname.length);if(r.substring(0,s.length)!==s){/^(\/\/)/.test(r)&&(r=window.location.protocol+r);var a="/*"+t+"*/",c=new Blob([a+='import "'+r+'";'],{type:"application/javascript"});return URL.createObjectURL(c)}}return r}});const rn=r},71549(e,t,n){n.d(t,{V:()=>o}),n(65637),n(8831),n(43323),n(95199),n(83565),n(34302),n(114),n(35951),n(94906),n(23180),n(52463),n(25886),n(38500),n(59864),n(50575),n(86399),n(26270),n(7784),n(30893),n(60556),n(20667),n(63980),n(46114),n(25304),n(14236),n(41664),n(19472),n(22693),n(98611),n(70819),n(80548),n(12791),n(59160),n(48820),n(66390),n(37441),n(82786),n(18164),n(1471),n(84308),n(42287),n(26173),n(37817),n(18938),n(94789),n(32346),n(38012),n(8668),n(23033),n(42537),n(80386),n(35610),n(7996),n(88126),n(9646),n(32923),n(15324),n(63138),n(73807),n(15356),n(89368),n(56265),n(61888),n(9089),n(82901),n(48601),n(32401),n(76930),n(38454),n(5450),n(36709),n(5910);var i=n(45002);let r;function o(e){const t=Promise.resolve(function(e){const t=e.label,n=globalThis.MonacoEnvironment;if(n){if("function"==typeof n.getWorker)return n.getWorker("workerMain.js",t);if("function"==typeof n.getWorkerUrl){const e=n.getWorkerUrl("workerMain.js",t);return new Worker(r?r.createScriptURL(e):e,{name:t,type:"module"})}}if(e.createWorker)return e.createWorker();throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}({label:e.label??"monaco-editor-worker",moduleId:e.moduleId,createWorker:e.createWorker})).then(t=>(t.postMessage("ignore"),t.postMessage(e.createData),t));return i.editor.createWebWorker({worker:t,host:e.host,keepIdleModels:e.keepIdleModels})}r="object"==typeof self&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name&&void 0!==globalThis.workerttPolicy?globalThis.workerttPolicy:function(e,t){const n=globalThis.MonacoEnvironment;if(n?.createTrustedTypesPolicy)try{return n.createTrustedTypesPolicy(e,t)}catch(e){return void console.error(e)}try{return globalThis.trustedTypes?.createPolicy(e,t)}catch(e){return void console.error(e)}}("defaultWorkerFactory",{createScriptURL:e=>e})}}]);
//# sourceMappingURL=3928.js.map